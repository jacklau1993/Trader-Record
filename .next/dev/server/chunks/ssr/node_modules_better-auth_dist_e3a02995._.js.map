{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/dialect-D9ZUZA4J.mjs"],"sourcesContent":["import { Kysely, MssqlDialect, MysqlDialect, PostgresDialect, SqliteDialect } from \"kysely\";\n\n//#region src/adapters/kysely-adapter/dialect.ts\nfunction getKyselyDatabaseType(db) {\n\tif (!db) return null;\n\tif (\"dialect\" in db) return getKyselyDatabaseType(db.dialect);\n\tif (\"createDriver\" in db) {\n\t\tif (db instanceof SqliteDialect) return \"sqlite\";\n\t\tif (db instanceof MysqlDialect) return \"mysql\";\n\t\tif (db instanceof PostgresDialect) return \"postgres\";\n\t\tif (db instanceof MssqlDialect) return \"mssql\";\n\t}\n\tif (\"aggregate\" in db) return \"sqlite\";\n\tif (\"getConnection\" in db) return \"mysql\";\n\tif (\"connect\" in db) return \"postgres\";\n\tif (\"fileControl\" in db) return \"sqlite\";\n\tif (\"open\" in db && \"close\" in db && \"prepare\" in db) return \"sqlite\";\n\treturn null;\n}\nconst createKyselyAdapter = async (config) => {\n\tconst db = config.database;\n\tif (!db) return {\n\t\tkysely: null,\n\t\tdatabaseType: null,\n\t\ttransaction: void 0\n\t};\n\tif (\"db\" in db) return {\n\t\tkysely: db.db,\n\t\tdatabaseType: db.type,\n\t\ttransaction: db.transaction\n\t};\n\tif (\"dialect\" in db) return {\n\t\tkysely: new Kysely({ dialect: db.dialect }),\n\t\tdatabaseType: db.type,\n\t\ttransaction: db.transaction\n\t};\n\tlet dialect = void 0;\n\tconst databaseType = getKyselyDatabaseType(db);\n\tif (\"createDriver\" in db) dialect = db;\n\tif (\"aggregate\" in db && !(\"createSession\" in db)) dialect = new SqliteDialect({ database: db });\n\tif (\"getConnection\" in db) dialect = new MysqlDialect(db);\n\tif (\"connect\" in db) dialect = new PostgresDialect({ pool: db });\n\tif (\"fileControl\" in db) {\n\t\tconst { BunSqliteDialect } = await import(\"./bun-sqlite-dialect-C3P_ISb5.mjs\");\n\t\tdialect = new BunSqliteDialect({ database: db });\n\t}\n\tif (\"createSession\" in db && typeof window === \"undefined\") {\n\t\tlet DatabaseSync = void 0;\n\t\ttry {\n\t\t\tlet nodeSqlite = \"node:sqlite\";\n\t\t\t({DatabaseSync} = await import(\n\t\t\t\t/* @vite-ignore */\n\t\t\t\t/* webpackIgnore: true */\n\t\t\t\tnodeSqlite\n));\n\t\t} catch (error) {\n\t\t\tif (error !== null && typeof error === \"object\" && \"code\" in error && error.code !== \"ERR_UNKNOWN_BUILTIN_MODULE\") throw error;\n\t\t}\n\t\tif (DatabaseSync && db instanceof DatabaseSync) {\n\t\t\tconst { NodeSqliteDialect } = await import(\"./node-sqlite-dialect-D6w8Ekdz.mjs\");\n\t\t\tdialect = new NodeSqliteDialect({ database: db });\n\t\t}\n\t}\n\treturn {\n\t\tkysely: dialect ? new Kysely({ dialect }) : null,\n\t\tdatabaseType,\n\t\ttransaction: void 0\n\t};\n};\n\n//#endregion\nexport { getKyselyDatabaseType as n, createKyselyAdapter as t };"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEA,gDAAgD;AAChD,SAAS,sBAAsB,EAAE;IAChC,IAAI,CAAC,IAAI,OAAO;IAChB,IAAI,aAAa,IAAI,OAAO,sBAAsB,GAAG,OAAO;IAC5D,IAAI,kBAAkB,IAAI;QACzB,IAAI,cAAc,gMAAa,EAAE,OAAO;QACxC,IAAI,cAAc,6LAAY,EAAE,OAAO;QACvC,IAAI,cAAc,sMAAe,EAAE,OAAO;QAC1C,IAAI,cAAc,6LAAY,EAAE,OAAO;IACxC;IACA,IAAI,eAAe,IAAI,OAAO;IAC9B,IAAI,mBAAmB,IAAI,OAAO;IAClC,IAAI,aAAa,IAAI,OAAO;IAC5B,IAAI,iBAAiB,IAAI,OAAO;IAChC,IAAI,UAAU,MAAM,WAAW,MAAM,aAAa,IAAI,OAAO;IAC7D,OAAO;AACR;AACA,MAAM,sBAAsB,OAAO;IAClC,MAAM,KAAK,OAAO,QAAQ;IAC1B,IAAI,CAAC,IAAI,OAAO;QACf,QAAQ;QACR,cAAc;QACd,aAAa,KAAK;IACnB;IACA,IAAI,QAAQ,IAAI,OAAO;QACtB,QAAQ,GAAG,EAAE;QACb,cAAc,GAAG,IAAI;QACrB,aAAa,GAAG,WAAW;IAC5B;IACA,IAAI,aAAa,IAAI,OAAO;QAC3B,QAAQ,IAAI,yJAAM,CAAC;YAAE,SAAS,GAAG,OAAO;QAAC;QACzC,cAAc,GAAG,IAAI;QACrB,aAAa,GAAG,WAAW;IAC5B;IACA,IAAI,UAAU,KAAK;IACnB,MAAM,eAAe,sBAAsB;IAC3C,IAAI,kBAAkB,IAAI,UAAU;IACpC,IAAI,eAAe,MAAM,CAAC,CAAC,mBAAmB,EAAE,GAAG,UAAU,IAAI,gMAAa,CAAC;QAAE,UAAU;IAAG;IAC9F,IAAI,mBAAmB,IAAI,UAAU,IAAI,6LAAY,CAAC;IACtD,IAAI,aAAa,IAAI,UAAU,IAAI,sMAAe,CAAC;QAAE,MAAM;IAAG;IAC9D,IAAI,iBAAiB,IAAI;QACxB,MAAM,EAAE,gBAAgB,EAAE,GAAG;QAC7B,UAAU,IAAI,iBAAiB;YAAE,UAAU;QAAG;IAC/C;IACA,IAAI,mBAAmB,MAAM,kDAAkB,aAAa;QAC3D,IAAI,eAAe,KAAK;QACxB,IAAI;YACH,IAAI,aAAa;YACjB,CAAC,EAAC,YAAY,EAAC,GAAG,MAAM,MAAM,CAC7B,gBAAgB,GAChB,uBAAuB,GACvB,WACH;QACC,EAAE,OAAO,OAAO;YACf,IAAI,UAAU,QAAQ,OAAO,UAAU,YAAY,UAAU,SAAS,MAAM,IAAI,KAAK,8BAA8B,MAAM;QAC1H;QACA,IAAI,gBAAgB,cAAc,cAAc;YAC/C,MAAM,EAAE,iBAAiB,EAAE,GAAG;YAC9B,UAAU,IAAI,kBAAkB;gBAAE,UAAU;YAAG;QAChD;IACD;IACA,OAAO;QACN,QAAQ,UAAU,IAAI,yJAAM,CAAC;YAAE;QAAQ,KAAK;QAC5C;QACA,aAAa,KAAK;IACnB;AACD","ignoreList":[0]}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/get-model-name-D4DUV7S2.mjs"],"sourcesContent":["import { BetterAuthError } from \"@better-auth/core/error\";\n\n//#region src/db/get-tables.ts\nconst getAuthTables = (options) => {\n\tconst pluginSchema = (options.plugins ?? []).reduce((acc, plugin) => {\n\t\tconst schema = plugin.schema;\n\t\tif (!schema) return acc;\n\t\tfor (const [key, value] of Object.entries(schema)) acc[key] = {\n\t\t\tfields: {\n\t\t\t\t...acc[key]?.fields,\n\t\t\t\t...value.fields\n\t\t\t},\n\t\t\tmodelName: value.modelName || key\n\t\t};\n\t\treturn acc;\n\t}, {});\n\tconst shouldAddRateLimitTable = options.rateLimit?.storage === \"database\";\n\tconst rateLimitTable = { rateLimit: {\n\t\tmodelName: options.rateLimit?.modelName || \"rateLimit\",\n\t\tfields: {\n\t\t\tkey: {\n\t\t\t\ttype: \"string\",\n\t\t\t\tfieldName: options.rateLimit?.fields?.key || \"key\"\n\t\t\t},\n\t\t\tcount: {\n\t\t\t\ttype: \"number\",\n\t\t\t\tfieldName: options.rateLimit?.fields?.count || \"count\"\n\t\t\t},\n\t\t\tlastRequest: {\n\t\t\t\ttype: \"number\",\n\t\t\t\tbigint: true,\n\t\t\t\tfieldName: options.rateLimit?.fields?.lastRequest || \"lastRequest\"\n\t\t\t}\n\t\t}\n\t} };\n\tconst { user, session, account, ...pluginTables } = pluginSchema;\n\tconst sessionTable = { session: {\n\t\tmodelName: options.session?.modelName || \"session\",\n\t\tfields: {\n\t\t\texpiresAt: {\n\t\t\t\ttype: \"date\",\n\t\t\t\trequired: true,\n\t\t\t\tfieldName: options.session?.fields?.expiresAt || \"expiresAt\"\n\t\t\t},\n\t\t\ttoken: {\n\t\t\t\ttype: \"string\",\n\t\t\t\trequired: true,\n\t\t\t\tfieldName: options.session?.fields?.token || \"token\",\n\t\t\t\tunique: true\n\t\t\t},\n\t\t\tcreatedAt: {\n\t\t\t\ttype: \"date\",\n\t\t\t\trequired: true,\n\t\t\t\tfieldName: options.session?.fields?.createdAt || \"createdAt\",\n\t\t\t\tdefaultValue: () => /* @__PURE__ */ new Date()\n\t\t\t},\n\t\t\tupdatedAt: {\n\t\t\t\ttype: \"date\",\n\t\t\t\trequired: true,\n\t\t\t\tfieldName: options.session?.fields?.updatedAt || \"updatedAt\",\n\t\t\t\tonUpdate: () => /* @__PURE__ */ new Date()\n\t\t\t},\n\t\t\tipAddress: {\n\t\t\t\ttype: \"string\",\n\t\t\t\trequired: false,\n\t\t\t\tfieldName: options.session?.fields?.ipAddress || \"ipAddress\"\n\t\t\t},\n\t\t\tuserAgent: {\n\t\t\t\ttype: \"string\",\n\t\t\t\trequired: false,\n\t\t\t\tfieldName: options.session?.fields?.userAgent || \"userAgent\"\n\t\t\t},\n\t\t\tuserId: {\n\t\t\t\ttype: \"string\",\n\t\t\t\tfieldName: options.session?.fields?.userId || \"userId\",\n\t\t\t\treferences: {\n\t\t\t\t\tmodel: options.user?.modelName || \"user\",\n\t\t\t\t\tfield: \"id\",\n\t\t\t\t\tonDelete: \"cascade\"\n\t\t\t\t},\n\t\t\t\trequired: true,\n\t\t\t\tindex: true\n\t\t\t},\n\t\t\t...session?.fields,\n\t\t\t...options.session?.additionalFields\n\t\t},\n\t\torder: 2\n\t} };\n\treturn {\n\t\tuser: {\n\t\t\tmodelName: options.user?.modelName || \"user\",\n\t\t\tfields: {\n\t\t\t\tname: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.user?.fields?.name || \"name\",\n\t\t\t\t\tsortable: true\n\t\t\t\t},\n\t\t\t\temail: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\tunique: true,\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.user?.fields?.email || \"email\",\n\t\t\t\t\tsortable: true\n\t\t\t\t},\n\t\t\t\temailVerified: {\n\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\tdefaultValue: false,\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.user?.fields?.emailVerified || \"emailVerified\",\n\t\t\t\t\tinput: false\n\t\t\t\t},\n\t\t\t\timage: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: false,\n\t\t\t\t\tfieldName: options.user?.fields?.image || \"image\"\n\t\t\t\t},\n\t\t\t\tcreatedAt: {\n\t\t\t\t\ttype: \"date\",\n\t\t\t\t\tdefaultValue: () => /* @__PURE__ */ new Date(),\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.user?.fields?.createdAt || \"createdAt\"\n\t\t\t\t},\n\t\t\t\tupdatedAt: {\n\t\t\t\t\ttype: \"date\",\n\t\t\t\t\tdefaultValue: () => /* @__PURE__ */ new Date(),\n\t\t\t\t\tonUpdate: () => /* @__PURE__ */ new Date(),\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.user?.fields?.updatedAt || \"updatedAt\"\n\t\t\t\t},\n\t\t\t\t...user?.fields,\n\t\t\t\t...options.user?.additionalFields\n\t\t\t},\n\t\t\torder: 1\n\t\t},\n\t\t...!options.secondaryStorage || options.session?.storeSessionInDatabase ? sessionTable : {},\n\t\taccount: {\n\t\t\tmodelName: options.account?.modelName || \"account\",\n\t\t\tfields: {\n\t\t\t\taccountId: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.account?.fields?.accountId || \"accountId\"\n\t\t\t\t},\n\t\t\t\tproviderId: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.account?.fields?.providerId || \"providerId\"\n\t\t\t\t},\n\t\t\t\tuserId: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\treferences: {\n\t\t\t\t\t\tmodel: options.user?.modelName || \"user\",\n\t\t\t\t\t\tfield: \"id\",\n\t\t\t\t\t\tonDelete: \"cascade\"\n\t\t\t\t\t},\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.account?.fields?.userId || \"userId\",\n\t\t\t\t\tindex: true\n\t\t\t\t},\n\t\t\t\taccessToken: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: false,\n\t\t\t\t\tfieldName: options.account?.fields?.accessToken || \"accessToken\"\n\t\t\t\t},\n\t\t\t\trefreshToken: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: false,\n\t\t\t\t\tfieldName: options.account?.fields?.refreshToken || \"refreshToken\"\n\t\t\t\t},\n\t\t\t\tidToken: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: false,\n\t\t\t\t\tfieldName: options.account?.fields?.idToken || \"idToken\"\n\t\t\t\t},\n\t\t\t\taccessTokenExpiresAt: {\n\t\t\t\t\ttype: \"date\",\n\t\t\t\t\trequired: false,\n\t\t\t\t\tfieldName: options.account?.fields?.accessTokenExpiresAt || \"accessTokenExpiresAt\"\n\t\t\t\t},\n\t\t\t\trefreshTokenExpiresAt: {\n\t\t\t\t\ttype: \"date\",\n\t\t\t\t\trequired: false,\n\t\t\t\t\tfieldName: options.account?.fields?.refreshTokenExpiresAt || \"refreshTokenExpiresAt\"\n\t\t\t\t},\n\t\t\t\tscope: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: false,\n\t\t\t\t\tfieldName: options.account?.fields?.scope || \"scope\"\n\t\t\t\t},\n\t\t\t\tpassword: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: false,\n\t\t\t\t\tfieldName: options.account?.fields?.password || \"password\"\n\t\t\t\t},\n\t\t\t\tcreatedAt: {\n\t\t\t\t\ttype: \"date\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.account?.fields?.createdAt || \"createdAt\",\n\t\t\t\t\tdefaultValue: () => /* @__PURE__ */ new Date()\n\t\t\t\t},\n\t\t\t\tupdatedAt: {\n\t\t\t\t\ttype: \"date\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.account?.fields?.updatedAt || \"updatedAt\",\n\t\t\t\t\tonUpdate: () => /* @__PURE__ */ new Date()\n\t\t\t\t},\n\t\t\t\t...account?.fields,\n\t\t\t\t...options.account?.additionalFields\n\t\t\t},\n\t\t\torder: 3\n\t\t},\n\t\tverification: {\n\t\t\tmodelName: options.verification?.modelName || \"verification\",\n\t\t\tfields: {\n\t\t\t\tidentifier: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.verification?.fields?.identifier || \"identifier\",\n\t\t\t\t\tindex: true\n\t\t\t\t},\n\t\t\t\tvalue: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.verification?.fields?.value || \"value\"\n\t\t\t\t},\n\t\t\t\texpiresAt: {\n\t\t\t\t\ttype: \"date\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tfieldName: options.verification?.fields?.expiresAt || \"expiresAt\"\n\t\t\t\t},\n\t\t\t\tcreatedAt: {\n\t\t\t\t\ttype: \"date\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tdefaultValue: () => /* @__PURE__ */ new Date(),\n\t\t\t\t\tfieldName: options.verification?.fields?.createdAt || \"createdAt\"\n\t\t\t\t},\n\t\t\t\tupdatedAt: {\n\t\t\t\t\ttype: \"date\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tdefaultValue: () => /* @__PURE__ */ new Date(),\n\t\t\t\t\tonUpdate: () => /* @__PURE__ */ new Date(),\n\t\t\t\t\tfieldName: options.verification?.fields?.updatedAt || \"updatedAt\"\n\t\t\t\t}\n\t\t\t},\n\t\t\torder: 4\n\t\t},\n\t\t...pluginTables,\n\t\t...shouldAddRateLimitTable ? rateLimitTable : {}\n\t};\n};\n\n//#endregion\n//#region src/adapters/adapter-factory/get-default-model-name.ts\nconst initGetDefaultModelName = ({ usePlural, schema }) => {\n\t/**\n\t* This function helps us get the default model name from the schema defined by devs.\n\t* Often times, the user will be using the `modelName` which could had been customized by the users.\n\t* This function helps us get the actual model name useful to match against the schema. (eg: schema[model])\n\t*\n\t* If it's still unclear what this does:\n\t*\n\t* 1. User can define a custom modelName.\n\t* 2. When using a custom modelName, doing something like `schema[model]` will not work.\n\t* 3. Using this function helps us get the actual model name based on the user's defined custom modelName.\n\t*/\n\tconst getDefaultModelName = (model) => {\n\t\tif (usePlural && model.charAt(model.length - 1) === \"s\") {\n\t\t\tlet pluralessModel = model.slice(0, -1);\n\t\t\tlet m$1 = schema[pluralessModel] ? pluralessModel : void 0;\n\t\t\tif (!m$1) m$1 = Object.entries(schema).find(([_, f]) => f.modelName === pluralessModel)?.[0];\n\t\t\tif (m$1) return m$1;\n\t\t}\n\t\tlet m = schema[model] ? model : void 0;\n\t\tif (!m) m = Object.entries(schema).find(([_, f]) => f.modelName === model)?.[0];\n\t\tif (!m) throw new BetterAuthError(`Model \"${model}\" not found in schema`);\n\t\treturn m;\n\t};\n\treturn getDefaultModelName;\n};\n\n//#endregion\n//#region src/adapters/adapter-factory/get-default-field-name.ts\nconst initGetDefaultFieldName = ({ schema, usePlural }) => {\n\tconst getDefaultModelName = initGetDefaultModelName({\n\t\tschema,\n\t\tusePlural\n\t});\n\t/**\n\t* This function helps us get the default field name from the schema defined by devs.\n\t* Often times, the user will be using the `fieldName` which could had been customized by the users.\n\t* This function helps us get the actual field name useful to match against the schema. (eg: schema[model].fields[field])\n\t*\n\t* If it's still unclear what this does:\n\t*\n\t* 1. User can define a custom fieldName.\n\t* 2. When using a custom fieldName, doing something like `schema[model].fields[field]` will not work.\n\t*/\n\tconst getDefaultFieldName = ({ field, model: unsafeModel }) => {\n\t\tif (field === \"id\" || field === \"_id\") return \"id\";\n\t\tconst model = getDefaultModelName(unsafeModel);\n\t\tlet f = schema[model]?.fields[field];\n\t\tif (!f) {\n\t\t\tconst result = Object.entries(schema[model].fields).find(([_, f$1]) => f$1.fieldName === field);\n\t\t\tif (result) {\n\t\t\t\tf = result[1];\n\t\t\t\tfield = result[0];\n\t\t\t}\n\t\t}\n\t\tif (!f) throw new BetterAuthError(`Field ${field} not found in model ${model}`);\n\t\treturn field;\n\t};\n\treturn getDefaultFieldName;\n};\n\n//#endregion\n//#region src/adapters/adapter-factory/get-field-name.ts\nconst initGetFieldName = ({ schema, usePlural }) => {\n\tconst getDefaultModelName = initGetDefaultModelName({\n\t\tschema,\n\t\tusePlural\n\t});\n\tconst getDefaultFieldName = initGetDefaultFieldName({\n\t\tschema,\n\t\tusePlural\n\t});\n\t/**\n\t* Get the field name which is expected to be saved in the database based on the user's schema.\n\t*\n\t* This function is useful if you need to save the field name to the database.\n\t*\n\t* For example, if the user has defined a custom field name for the `user` model, then you can use this function to get the actual field name from the schema.\n\t*/\n\tfunction getFieldName({ model: modelName, field: fieldName }) {\n\t\tconst model = getDefaultModelName(modelName);\n\t\tconst field = getDefaultFieldName({\n\t\t\tmodel,\n\t\t\tfield: fieldName\n\t\t});\n\t\treturn schema[model]?.fields[field]?.fieldName || field;\n\t}\n\treturn getFieldName;\n};\n\n//#endregion\n//#region src/adapters/adapter-factory/get-model-name.ts\nconst initGetModelName = ({ usePlural, schema }) => {\n\tconst getDefaultModelName = initGetDefaultModelName({\n\t\tschema,\n\t\tusePlural\n\t});\n\t/**\n\t* Users can overwrite the default model of some tables. This function helps find the correct model name.\n\t* Furthermore, if the user passes `usePlural` as true in their adapter config,\n\t* then we should return the model name ending with an `s`.\n\t*/\n\tconst getModelName = (model) => {\n\t\tconst defaultModelKey = getDefaultModelName(model);\n\t\tif (schema && schema[defaultModelKey] && schema[defaultModelKey].modelName !== model) return usePlural ? `${schema[defaultModelKey].modelName}s` : schema[defaultModelKey].modelName;\n\t\treturn usePlural ? `${model}s` : model;\n\t};\n\treturn getModelName;\n};\n\n//#endregion\nexport { getAuthTables as a, initGetDefaultModelName as i, initGetFieldName as n, initGetDefaultFieldName as r, initGetModelName as t };"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 473, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/crypto-CFUhAR9W.mjs"],"sourcesContent":["import { BetterAuthError } from \"@better-auth/core/error\";\nimport { createHash } from \"@better-auth/utils/hash\";\nimport { xchacha20poly1305 } from \"@noble/ciphers/chacha.js\";\nimport { bytesToHex, hexToBytes, managedNonce, utf8ToBytes } from \"@noble/ciphers/utils.js\";\nimport { hkdf } from \"@noble/hashes/hkdf.js\";\nimport { sha256 } from \"@noble/hashes/sha2.js\";\nimport { EncryptJWT, SignJWT, base64url, calculateJwkThumbprint, jwtDecrypt, jwtVerify } from \"jose\";\nimport { hex } from \"@better-auth/utils/hex\";\nimport { scryptAsync } from \"@noble/hashes/scrypt.js\";\nimport { hexToBytes as hexToBytes$1 } from \"@noble/hashes/utils.js\";\nimport { createRandomStringGenerator } from \"@better-auth/utils/random\";\n\n//#region src/crypto/buffer.ts\n/**\n* Compare two buffers in constant time.\n*/\nfunction constantTimeEqual(a, b) {\n\tif (typeof a === \"string\") a = new TextEncoder().encode(a);\n\tif (typeof b === \"string\") b = new TextEncoder().encode(b);\n\tconst aBuffer = new Uint8Array(a);\n\tconst bBuffer = new Uint8Array(b);\n\tlet c = aBuffer.length ^ bBuffer.length;\n\tconst length = Math.max(aBuffer.length, bBuffer.length);\n\tfor (let i = 0; i < length; i++) c |= (i < aBuffer.length ? aBuffer[i] : 0) ^ (i < bBuffer.length ? bBuffer[i] : 0);\n\treturn c === 0;\n}\n\n//#endregion\n//#region src/crypto/jwt.ts\nasync function signJWT(payload, secret, expiresIn = 3600) {\n\treturn await new SignJWT(payload).setProtectedHeader({ alg: \"HS256\" }).setIssuedAt().setExpirationTime(Math.floor(Date.now() / 1e3) + expiresIn).sign(new TextEncoder().encode(secret));\n}\nasync function verifyJWT(token, secret) {\n\ttry {\n\t\treturn (await jwtVerify(token, new TextEncoder().encode(secret))).payload;\n\t} catch (error) {\n\t\treturn null;\n\t}\n}\nconst info = new Uint8Array([\n\t66,\n\t101,\n\t116,\n\t116,\n\t101,\n\t114,\n\t65,\n\t117,\n\t116,\n\t104,\n\t46,\n\t106,\n\t115,\n\t32,\n\t71,\n\t101,\n\t110,\n\t101,\n\t114,\n\t97,\n\t116,\n\t101,\n\t100,\n\t32,\n\t69,\n\t110,\n\t99,\n\t114,\n\t121,\n\t112,\n\t116,\n\t105,\n\t111,\n\t110,\n\t32,\n\t75,\n\t101,\n\t121\n]);\nconst now = () => Date.now() / 1e3 | 0;\nconst alg = \"dir\";\nconst enc = \"A256CBC-HS512\";\nasync function symmetricEncodeJWT(payload, secret, salt, expiresIn = 3600) {\n\tconst encryptionSecret = hkdf(sha256, new TextEncoder().encode(secret), new TextEncoder().encode(salt), info, 64);\n\tconst thumbprint = await calculateJwkThumbprint({\n\t\tkty: \"oct\",\n\t\tk: base64url.encode(encryptionSecret)\n\t}, \"sha256\");\n\treturn await new EncryptJWT(payload).setProtectedHeader({\n\t\talg,\n\t\tenc,\n\t\tkid: thumbprint\n\t}).setIssuedAt().setExpirationTime(now() + expiresIn).setJti(crypto.randomUUID()).encrypt(encryptionSecret);\n}\nasync function symmetricDecodeJWT(token, secret, salt) {\n\tif (!token) return null;\n\ttry {\n\t\tconst { payload } = await jwtDecrypt(token, async ({ kid }) => {\n\t\t\tconst encryptionSecret = hkdf(sha256, new TextEncoder().encode(secret), new TextEncoder().encode(salt), info, 64);\n\t\t\tif (kid === void 0) return encryptionSecret;\n\t\t\tif (kid === await calculateJwkThumbprint({\n\t\t\t\tkty: \"oct\",\n\t\t\t\tk: base64url.encode(encryptionSecret)\n\t\t\t}, \"sha256\")) return encryptionSecret;\n\t\t\tthrow new Error(\"no matching decryption secret\");\n\t\t}, {\n\t\t\tclockTolerance: 15,\n\t\t\tkeyManagementAlgorithms: [alg],\n\t\t\tcontentEncryptionAlgorithms: [enc, \"A256GCM\"]\n\t\t});\n\t\treturn payload;\n\t} catch (error) {\n\t\treturn null;\n\t}\n}\n\n//#endregion\n//#region src/crypto/password.ts\nconst config = {\n\tN: 16384,\n\tr: 16,\n\tp: 1,\n\tdkLen: 64\n};\nasync function generateKey(password, salt) {\n\treturn await scryptAsync(password.normalize(\"NFKC\"), salt, {\n\t\tN: config.N,\n\t\tp: config.p,\n\t\tr: config.r,\n\t\tdkLen: config.dkLen,\n\t\tmaxmem: 128 * config.N * config.r * 2\n\t});\n}\nconst hashPassword = async (password) => {\n\tconst salt = hex.encode(crypto.getRandomValues(new Uint8Array(16)));\n\tconst key = await generateKey(password, salt);\n\treturn `${salt}:${hex.encode(key)}`;\n};\nconst verifyPassword = async ({ hash, password }) => {\n\tconst [salt, key] = hash.split(\":\");\n\tif (!salt || !key) throw new BetterAuthError(\"Invalid password hash\");\n\treturn constantTimeEqual(await generateKey(password, salt), hexToBytes$1(key));\n};\n\n//#endregion\n//#region src/crypto/random.ts\nconst generateRandomString = createRandomStringGenerator(\"a-z\", \"0-9\", \"A-Z\", \"-_\");\n\n//#endregion\n//#region src/crypto/index.ts\nconst symmetricEncrypt = async ({ key, data }) => {\n\tconst keyAsBytes = await createHash(\"SHA-256\").digest(key);\n\tconst dataAsBytes = utf8ToBytes(data);\n\treturn bytesToHex(managedNonce(xchacha20poly1305)(new Uint8Array(keyAsBytes)).encrypt(dataAsBytes));\n};\nconst symmetricDecrypt = async ({ key, data }) => {\n\tconst keyAsBytes = await createHash(\"SHA-256\").digest(key);\n\tconst dataAsBytes = hexToBytes(data);\n\tconst chacha = managedNonce(xchacha20poly1305)(new Uint8Array(keyAsBytes));\n\treturn new TextDecoder().decode(chacha.decrypt(dataAsBytes));\n};\n\n//#endregion\nexport { verifyPassword as a, symmetricEncodeJWT as c, hashPassword as i, verifyJWT as l, symmetricEncrypt as n, signJWT as o, generateRandomString as r, symmetricDecodeJWT as s, symmetricDecrypt as t, constantTimeEqual as u };"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 679, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/utils-db7gNqd-.mjs"],"sourcesContent":["import { n as symmetricEncrypt, r as generateRandomString, t as symmetricDecrypt } from \"./crypto-CFUhAR9W.mjs\";\nimport { defineRequestState } from \"@better-auth/core/context\";\nimport { APIError } from \"better-call\";\nimport * as z from \"zod\";\nimport { createRandomStringGenerator } from \"@better-auth/utils/random\";\n\n//#region src/api/middlewares/oauth.ts\nconst { get: getOAuthState, set: setOAuthState } = defineRequestState(() => null);\n\n//#endregion\n//#region src/oauth2/state.ts\nasync function generateState(c, link, additionalData) {\n\tconst callbackURL = c.body?.callbackURL || c.context.options.baseURL;\n\tif (!callbackURL) throw new APIError(\"BAD_REQUEST\", { message: \"callbackURL is required\" });\n\tconst codeVerifier = generateRandomString(128);\n\tconst state = generateRandomString(32);\n\tconst storeStateStrategy = c.context.oauthConfig?.storeStateStrategy || \"cookie\";\n\tconst stateData = {\n\t\t...additionalData ? additionalData : {},\n\t\tcallbackURL,\n\t\tcodeVerifier,\n\t\terrorURL: c.body?.errorCallbackURL,\n\t\tnewUserURL: c.body?.newUserCallbackURL,\n\t\tlink,\n\t\texpiresAt: Date.now() + 600 * 1e3,\n\t\trequestSignUp: c.body?.requestSignUp\n\t};\n\tawait setOAuthState(stateData);\n\tif (storeStateStrategy === \"cookie\") {\n\t\tconst encryptedData = await symmetricEncrypt({\n\t\t\tkey: c.context.secret,\n\t\t\tdata: JSON.stringify(stateData)\n\t\t});\n\t\tconst stateCookie$1 = c.context.createAuthCookie(\"oauth_state\", { maxAge: 600 * 1e3 });\n\t\tc.setCookie(stateCookie$1.name, encryptedData, stateCookie$1.attributes);\n\t\treturn {\n\t\t\tstate,\n\t\t\tcodeVerifier\n\t\t};\n\t}\n\tconst stateCookie = c.context.createAuthCookie(\"state\", { maxAge: 300 * 1e3 });\n\tawait c.setSignedCookie(stateCookie.name, state, c.context.secret, stateCookie.attributes);\n\tconst expiresAt = /* @__PURE__ */ new Date();\n\texpiresAt.setMinutes(expiresAt.getMinutes() + 10);\n\tconst verification = await c.context.internalAdapter.createVerificationValue({\n\t\tvalue: JSON.stringify(stateData),\n\t\tidentifier: state,\n\t\texpiresAt\n\t});\n\tif (!verification) {\n\t\tc.context.logger.error(\"Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database\");\n\t\tthrow new APIError(\"INTERNAL_SERVER_ERROR\", { message: \"Unable to create verification\" });\n\t}\n\treturn {\n\t\tstate: verification.identifier,\n\t\tcodeVerifier\n\t};\n}\nasync function parseState(c) {\n\tconst state = c.query.state || c.body.state;\n\tconst storeStateStrategy = c.context.oauthConfig.storeStateStrategy || \"cookie\";\n\tconst stateDataSchema = z.looseObject({\n\t\tcallbackURL: z.string(),\n\t\tcodeVerifier: z.string(),\n\t\terrorURL: z.string().optional(),\n\t\tnewUserURL: z.string().optional(),\n\t\texpiresAt: z.number(),\n\t\tlink: z.object({\n\t\t\temail: z.string(),\n\t\t\tuserId: z.coerce.string()\n\t\t}).optional(),\n\t\trequestSignUp: z.boolean().optional()\n\t});\n\tlet parsedData;\n\tif (storeStateStrategy === \"cookie\") {\n\t\tconst stateCookie = c.context.createAuthCookie(\"oauth_state\");\n\t\tconst encryptedData = c.getCookie(stateCookie.name);\n\t\tif (!encryptedData) {\n\t\t\tc.context.logger.error(\"State Mismatch. OAuth state cookie not found\", { state });\n\t\t\tconst errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n\t\t\tthrow c.redirect(`${errorURL}?error=please_restart_the_process`);\n\t\t}\n\t\ttry {\n\t\t\tconst decryptedData = await symmetricDecrypt({\n\t\t\t\tkey: c.context.secret,\n\t\t\t\tdata: encryptedData\n\t\t\t});\n\t\t\tparsedData = stateDataSchema.parse(JSON.parse(decryptedData));\n\t\t} catch (error) {\n\t\t\tc.context.logger.error(\"Failed to decrypt or parse OAuth state cookie\", { error });\n\t\t\tconst errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n\t\t\tthrow c.redirect(`${errorURL}?error=please_restart_the_process`);\n\t\t}\n\t\tc.setCookie(stateCookie.name, \"\", { maxAge: 0 });\n\t} else {\n\t\tconst data = await c.context.internalAdapter.findVerificationValue(state);\n\t\tif (!data) {\n\t\t\tc.context.logger.error(\"State Mismatch. Verification not found\", { state });\n\t\t\tconst errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n\t\t\tthrow c.redirect(`${errorURL}?error=please_restart_the_process`);\n\t\t}\n\t\tparsedData = stateDataSchema.parse(JSON.parse(data.value));\n\t\tconst stateCookie = c.context.createAuthCookie(\"state\");\n\t\tconst stateCookieValue = await c.getSignedCookie(stateCookie.name, c.context.secret);\n\t\tif (!c.context.oauthConfig?.skipStateCookieCheck && (!stateCookieValue || stateCookieValue !== state)) {\n\t\t\tconst errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n\t\t\tthrow c.redirect(`${errorURL}?error=state_mismatch`);\n\t\t}\n\t\tc.setCookie(stateCookie.name, \"\", { maxAge: 0 });\n\t\tawait c.context.internalAdapter.deleteVerificationValue(data.id);\n\t}\n\tif (!parsedData.errorURL) parsedData.errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n\tif (parsedData.expiresAt < Date.now()) {\n\t\tconst errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n\t\tthrow c.redirect(`${errorURL}?error=please_restart_the_process`);\n\t}\n\tif (parsedData) await setOAuthState(parsedData);\n\treturn parsedData;\n}\n\n//#endregion\n//#region src/utils/hide-metadata.ts\nconst HIDE_METADATA = { isAction: false };\n\n//#endregion\n//#region src/utils/id.ts\nconst generateId = (size) => {\n\treturn createRandomStringGenerator(\"a-z\", \"A-Z\", \"0-9\")(size || 32);\n};\n\n//#endregion\nexport { getOAuthState as a, parseState as i, HIDE_METADATA as n, generateState as r, generateId as t };"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 848, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/schema-Bb7wzeK_.mjs"],"sourcesContent":["import { APIError } from \"better-call\";\n\n//#region src/utils/date.ts\nconst getDate = (span, unit = \"ms\") => {\n\treturn new Date(Date.now() + (unit === \"sec\" ? span * 1e3 : span));\n};\n\n//#endregion\n//#region src/db/schema.ts\nconst cache = /* @__PURE__ */ new WeakMap();\nfunction parseOutputData(data, schema) {\n\tconst fields = schema.fields;\n\tconst parsedData = {};\n\tfor (const key in data) {\n\t\tconst field = fields[key];\n\t\tif (!field) {\n\t\t\tparsedData[key] = data[key];\n\t\t\tcontinue;\n\t\t}\n\t\tif (field.returned === false) continue;\n\t\tparsedData[key] = data[key];\n\t}\n\treturn parsedData;\n}\nfunction getAllFields(options, table) {\n\tif (!cache.has(options)) cache.set(options, /* @__PURE__ */ new Map());\n\tconst tableCache = cache.get(options);\n\tif (tableCache.has(table)) return tableCache.get(table);\n\tlet schema = {\n\t\t...table === \"user\" ? options.user?.additionalFields : {},\n\t\t...table === \"session\" ? options.session?.additionalFields : {}\n\t};\n\tfor (const plugin of options.plugins || []) if (plugin.schema && plugin.schema[table]) schema = {\n\t\t...schema,\n\t\t...plugin.schema[table].fields\n\t};\n\tcache.get(options).set(table, schema);\n\treturn schema;\n}\nfunction parseUserOutput(options, user) {\n\treturn {\n\t\t...parseOutputData(user, { fields: getAllFields(options, \"user\") }),\n\t\tid: user.id\n\t};\n}\nfunction parseAccountOutput(options, account) {\n\treturn parseOutputData(account, { fields: getAllFields(options, \"account\") });\n}\nfunction parseSessionOutput(options, session) {\n\treturn parseOutputData(session, { fields: getAllFields(options, \"session\") });\n}\nfunction parseInputData(data, schema) {\n\tconst action = schema.action || \"create\";\n\tconst fields = schema.fields;\n\tconst parsedData = Object.assign(Object.create(null), null);\n\tfor (const key in fields) {\n\t\tif (key in data) {\n\t\t\tif (fields[key].input === false) {\n\t\t\t\tif (fields[key].defaultValue !== void 0) {\n\t\t\t\t\tif (action !== \"update\") {\n\t\t\t\t\t\tparsedData[key] = fields[key].defaultValue;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (data[key]) throw new APIError(\"BAD_REQUEST\", { message: `${key} is not allowed to be set` });\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (fields[key].validator?.input && data[key] !== void 0) {\n\t\t\t\tparsedData[key] = fields[key].validator.input[\"~standard\"].validate(data[key]);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (fields[key].transform?.input && data[key] !== void 0) {\n\t\t\t\tparsedData[key] = fields[key].transform?.input(data[key]);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tparsedData[key] = data[key];\n\t\t\tcontinue;\n\t\t}\n\t\tif (fields[key].defaultValue !== void 0 && action === \"create\") {\n\t\t\tif (typeof fields[key].defaultValue === \"function\") {\n\t\t\t\tparsedData[key] = fields[key].defaultValue();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tparsedData[key] = fields[key].defaultValue;\n\t\t\tcontinue;\n\t\t}\n\t\tif (fields[key].required && action === \"create\") throw new APIError(\"BAD_REQUEST\", { message: `${key} is required` });\n\t}\n\treturn parsedData;\n}\nfunction parseUserInput(options, user = {}, action) {\n\treturn parseInputData(user, {\n\t\tfields: getAllFields(options, \"user\"),\n\t\taction\n\t});\n}\nfunction parseAdditionalUserInput(options, user) {\n\tconst schema = getAllFields(options, \"user\");\n\treturn parseInputData(user || {}, { fields: schema });\n}\nfunction parseAccountInput(options, account) {\n\treturn parseInputData(account, { fields: getAllFields(options, \"account\") });\n}\nfunction parseSessionInput(options, session) {\n\treturn parseInputData(session, { fields: getAllFields(options, \"session\") });\n}\nfunction mergeSchema(schema, newSchema) {\n\tif (!newSchema) return schema;\n\tfor (const table in newSchema) {\n\t\tconst newModelName = newSchema[table]?.modelName;\n\t\tif (newModelName) schema[table].modelName = newModelName;\n\t\tfor (const field in schema[table].fields) {\n\t\t\tconst newField = newSchema[table]?.fields?.[field];\n\t\t\tif (!newField) continue;\n\t\t\tschema[table].fields[field].fieldName = newField;\n\t\t}\n\t}\n\treturn schema;\n}\n\n//#endregion\nexport { parseInputData as a, parseUserInput as c, parseAdditionalUserInput as i, parseUserOutput as l, parseAccountInput as n, parseSessionInput as o, parseAccountOutput as r, parseSessionOutput as s, mergeSchema as t, getDate as u };"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1009, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/get-request-ip-D6st-mto.mjs"],"sourcesContent":["import { isDevelopment, isTest } from \"@better-auth/core/env\";\nimport * as z from \"zod\";\n\n//#region src/utils/get-request-ip.ts\nconst LOCALHOST_IP = \"127.0.0.1\";\nfunction getIp(req, options) {\n\tif (options.advanced?.ipAddress?.disableIpTracking) return null;\n\tif (isTest() || isDevelopment()) return LOCALHOST_IP;\n\tconst headers = \"headers\" in req ? req.headers : req;\n\tconst ipHeaders = options.advanced?.ipAddress?.ipAddressHeaders || [\"x-forwarded-for\"];\n\tfor (const key of ipHeaders) {\n\t\tconst value = \"get\" in headers ? headers.get(key) : headers[key];\n\t\tif (typeof value === \"string\") {\n\t\t\tconst ip = value.split(\",\")[0].trim();\n\t\t\tif (isValidIP(ip)) return ip;\n\t\t}\n\t}\n\treturn null;\n}\nfunction isValidIP(ip) {\n\tif (z.ipv4().safeParse(ip).success) return true;\n\tif (z.ipv6().safeParse(ip).success) return true;\n\treturn false;\n}\n\n//#endregion\nexport { getIp as t };"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AACA;;;AAEA,qCAAqC;AACrC,MAAM,eAAe;AACrB,SAAS,MAAM,GAAG,EAAE,OAAO;IAC1B,IAAI,QAAQ,QAAQ,EAAE,WAAW,mBAAmB,OAAO;IAC3D,IAAI,IAAA,6MAAM,OAAM,IAAA,2NAAa,KAAI,OAAO;IACxC,MAAM,UAAU,aAAa,MAAM,IAAI,OAAO,GAAG;IACjD,MAAM,YAAY,QAAQ,QAAQ,EAAE,WAAW,oBAAoB;QAAC;KAAkB;IACtF,KAAK,MAAM,OAAO,UAAW;QAC5B,MAAM,QAAQ,SAAS,UAAU,QAAQ,GAAG,CAAC,OAAO,OAAO,CAAC,IAAI;QAChE,IAAI,OAAO,UAAU,UAAU;YAC9B,MAAM,KAAK,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI;YACnC,IAAI,UAAU,KAAK,OAAO;QAC3B;IACD;IACA,OAAO;AACR;AACA,SAAS,UAAU,EAAE;IACpB,IAAI,uJAAM,GAAG,SAAS,CAAC,IAAI,OAAO,EAAE,OAAO;IAC3C,IAAI,uJAAM,GAAG,SAAS,CAAC,IAAI,OAAO,EAAE,OAAO;IAC3C,OAAO;AACR","ignoreList":[0]}},
    {"offset": {"line": 1047, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/json-CnHxKYpj.mjs"],"sourcesContent":["import { logger } from \"@better-auth/core/env\";\n\n//#region src/utils/json.ts\nfunction safeJSONParse(data) {\n\tfunction reviver(_, value) {\n\t\tif (typeof value === \"string\") {\n\t\t\tif (/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?Z$/.test(value)) {\n\t\t\t\tconst date = new Date(value);\n\t\t\t\tif (!isNaN(date.getTime())) return date;\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\ttry {\n\t\tif (typeof data !== \"string\") return data;\n\t\treturn JSON.parse(data, reviver);\n\t} catch (e) {\n\t\tlogger.error(\"Error parsing JSON\", { error: e });\n\t\treturn null;\n\t}\n}\n\n//#endregion\nexport { safeJSONParse as t };"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEA,2BAA2B;AAC3B,SAAS,cAAc,IAAI;IAC1B,SAAS,QAAQ,CAAC,EAAE,KAAK;QACxB,IAAI,OAAO,UAAU,UAAU;YAC9B,IAAI,mDAAmD,IAAI,CAAC,QAAQ;gBACnE,MAAM,OAAO,IAAI,KAAK;gBACtB,IAAI,CAAC,MAAM,KAAK,OAAO,KAAK,OAAO;YACpC;QACD;QACA,OAAO;IACR;IACA,IAAI;QACH,IAAI,OAAO,SAAS,UAAU,OAAO;QACrC,OAAO,KAAK,KAAK,CAAC,MAAM;IACzB,EAAE,OAAO,GAAG;QACX,6MAAM,CAAC,KAAK,CAAC,sBAAsB;YAAE,OAAO;QAAE;QAC9C,OAAO;IACR;AACD","ignoreList":[0]}},
    {"offset": {"line": 1080, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/get-migration-Bf0TuCzm.mjs"],"sourcesContent":["import { t as createKyselyAdapter } from \"./dialect-D9ZUZA4J.mjs\";\nimport { a as getAuthTables, n as initGetFieldName, t as initGetModelName } from \"./get-model-name-D4DUV7S2.mjs\";\nimport { t as generateId } from \"./utils-db7gNqd-.mjs\";\nimport { l as parseUserOutput, o as parseSessionInput, s as parseSessionOutput, u as getDate } from \"./schema-Bb7wzeK_.mjs\";\nimport { t as getIp } from \"./get-request-ip-D6st-mto.mjs\";\nimport { t as safeJSONParse } from \"./json-CnHxKYpj.mjs\";\nimport { getCurrentAdapter, getCurrentAuthContext, runWithTransaction } from \"@better-auth/core/context\";\nimport { createLogger, logger } from \"@better-auth/core/env\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\nimport { sql } from \"kysely\";\nimport * as z from \"zod\";\n\n//#region src/db/adapter-base.ts\nasync function getBaseAdapter(options, handleDirectDatabase) {\n\tlet adapter;\n\tif (!options.database) {\n\t\tconst tables = getAuthTables(options);\n\t\tconst memoryDB = Object.keys(tables).reduce((acc, key) => {\n\t\t\tacc[key] = [];\n\t\t\treturn acc;\n\t\t}, {});\n\t\tconst { memoryAdapter } = await import(\"./adapters/memory-adapter/index.mjs\");\n\t\tadapter = memoryAdapter(memoryDB)(options);\n\t} else if (typeof options.database === \"function\") adapter = options.database(options);\n\telse adapter = await handleDirectDatabase(options);\n\tif (!adapter.transaction) {\n\t\tlogger.warn(\"Adapter does not correctly implement transaction function, patching it automatically. Please update your adapter implementation.\");\n\t\tadapter.transaction = async (cb) => {\n\t\t\treturn cb(adapter);\n\t\t};\n\t}\n\treturn adapter;\n}\n\n//#endregion\n//#region src/db/adapter-kysely.ts\nasync function getAdapter(options) {\n\treturn getBaseAdapter(options, async (opts) => {\n\t\tconst { createKyselyAdapter: createKyselyAdapter$1 } = await import(\"./adapters/kysely-adapter/index.mjs\");\n\t\tconst { kysely, databaseType, transaction } = await createKyselyAdapter$1(opts);\n\t\tif (!kysely) throw new BetterAuthError(\"Failed to initialize database adapter\");\n\t\tconst { kyselyAdapter } = await import(\"./adapters/kysely-adapter/index.mjs\");\n\t\treturn kyselyAdapter(kysely, {\n\t\t\ttype: databaseType || \"sqlite\",\n\t\t\tdebugLogs: opts.database && \"debugLogs\" in opts.database ? opts.database.debugLogs : false,\n\t\t\ttransaction\n\t\t})(opts);\n\t});\n}\n\n//#endregion\n//#region src/db/field.ts\nconst createFieldAttribute = (type, config) => {\n\treturn {\n\t\ttype,\n\t\t...config\n\t};\n};\n\n//#endregion\n//#region src/db/field-converter.ts\nfunction convertToDB(fields, values) {\n\tlet result = values.id ? { id: values.id } : {};\n\tfor (const key in fields) {\n\t\tconst field = fields[key];\n\t\tconst value = values[key];\n\t\tif (value === void 0) continue;\n\t\tresult[field.fieldName || key] = value;\n\t}\n\treturn result;\n}\nfunction convertFromDB(fields, values) {\n\tif (!values) return null;\n\tlet result = { id: values.id };\n\tfor (const [key, value] of Object.entries(fields)) result[key] = values[value.fieldName || key];\n\treturn result;\n}\n\n//#endregion\n//#region src/db/with-hooks.ts\nfunction getWithHooks(adapter, ctx) {\n\tconst hooks = ctx.hooks;\n\tasync function createWithHooks(data, model, customCreateFn) {\n\t\tconst context = await getCurrentAuthContext();\n\t\tlet actualData = data;\n\t\tfor (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.create?.before;\n\t\t\tif (toRun) {\n\t\t\t\tconst result = await toRun(actualData, context);\n\t\t\t\tif (result === false) return null;\n\t\t\t\tif (typeof result === \"object\" && \"data\" in result) actualData = {\n\t\t\t\t\t...actualData,\n\t\t\t\t\t...result.data\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tconst customCreated = customCreateFn ? await customCreateFn.fn(actualData) : null;\n\t\tconst created = !customCreateFn || customCreateFn.executeMainFn ? await (await getCurrentAdapter(adapter)).create({\n\t\t\tmodel,\n\t\t\tdata: actualData,\n\t\t\tforceAllowId: true\n\t\t}) : customCreated;\n\t\tfor (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.create?.after;\n\t\t\tif (toRun) await toRun(created, context);\n\t\t}\n\t\treturn created;\n\t}\n\tasync function updateWithHooks(data, where, model, customUpdateFn) {\n\t\tconst context = await getCurrentAuthContext();\n\t\tlet actualData = data;\n\t\tfor (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.update?.before;\n\t\t\tif (toRun) {\n\t\t\t\tconst result = await toRun(data, context);\n\t\t\t\tif (result === false) return null;\n\t\t\t\tif (typeof result === \"object\" && \"data\" in result) actualData = {\n\t\t\t\t\t...actualData,\n\t\t\t\t\t...result.data\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tconst customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n\t\tconst updated = !customUpdateFn || customUpdateFn.executeMainFn ? await (await getCurrentAdapter(adapter)).update({\n\t\t\tmodel,\n\t\t\tupdate: actualData,\n\t\t\twhere\n\t\t}) : customUpdated;\n\t\tfor (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.update?.after;\n\t\t\tif (toRun) await toRun(updated, context);\n\t\t}\n\t\treturn updated;\n\t}\n\tasync function updateManyWithHooks(data, where, model, customUpdateFn) {\n\t\tconst context = await getCurrentAuthContext();\n\t\tlet actualData = data;\n\t\tfor (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.update?.before;\n\t\t\tif (toRun) {\n\t\t\t\tconst result = await toRun(data, context);\n\t\t\t\tif (result === false) return null;\n\t\t\t\tif (typeof result === \"object\" && \"data\" in result) actualData = {\n\t\t\t\t\t...actualData,\n\t\t\t\t\t...result.data\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tconst customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n\t\tconst updated = !customUpdateFn || customUpdateFn.executeMainFn ? await (await getCurrentAdapter(adapter)).updateMany({\n\t\t\tmodel,\n\t\t\tupdate: actualData,\n\t\t\twhere\n\t\t}) : customUpdated;\n\t\tfor (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.update?.after;\n\t\t\tif (toRun) await toRun(updated, context);\n\t\t}\n\t\treturn updated;\n\t}\n\tasync function deleteWithHooks(where, model, customDeleteFn) {\n\t\tconst context = await getCurrentAuthContext();\n\t\tlet entityToDelete = null;\n\t\ttry {\n\t\t\tentityToDelete = (await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\tmodel,\n\t\t\t\twhere,\n\t\t\t\tlimit: 1\n\t\t\t}))[0] || null;\n\t\t} catch (error) {}\n\t\tif (entityToDelete) for (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.delete?.before;\n\t\t\tif (toRun) {\n\t\t\t\tif (await toRun(entityToDelete, context) === false) return null;\n\t\t\t}\n\t\t}\n\t\tconst customDeleted = customDeleteFn ? await customDeleteFn.fn(where) : null;\n\t\tconst deleted = !customDeleteFn || customDeleteFn.executeMainFn ? await (await getCurrentAdapter(adapter)).delete({\n\t\t\tmodel,\n\t\t\twhere\n\t\t}) : customDeleted;\n\t\tif (entityToDelete) for (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.delete?.after;\n\t\t\tif (toRun) await toRun(entityToDelete, context);\n\t\t}\n\t\treturn deleted;\n\t}\n\tasync function deleteManyWithHooks(where, model, customDeleteFn) {\n\t\tconst context = await getCurrentAuthContext();\n\t\tlet entitiesToDelete = [];\n\t\ttry {\n\t\t\tentitiesToDelete = await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\tmodel,\n\t\t\t\twhere\n\t\t\t});\n\t\t} catch (error) {}\n\t\tfor (const entity of entitiesToDelete) for (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.delete?.before;\n\t\t\tif (toRun) {\n\t\t\t\tif (await toRun(entity, context) === false) return null;\n\t\t\t}\n\t\t}\n\t\tconst customDeleted = customDeleteFn ? await customDeleteFn.fn(where) : null;\n\t\tconst deleted = !customDeleteFn || customDeleteFn.executeMainFn ? await (await getCurrentAdapter(adapter)).deleteMany({\n\t\t\tmodel,\n\t\t\twhere\n\t\t}) : customDeleted;\n\t\tfor (const entity of entitiesToDelete) for (const hook of hooks || []) {\n\t\t\tconst toRun = hook[model]?.delete?.after;\n\t\t\tif (toRun) await toRun(entity, context);\n\t\t}\n\t\treturn deleted;\n\t}\n\treturn {\n\t\tcreateWithHooks,\n\t\tupdateWithHooks,\n\t\tupdateManyWithHooks,\n\t\tdeleteWithHooks,\n\t\tdeleteManyWithHooks\n\t};\n}\n\n//#endregion\n//#region src/db/internal-adapter.ts\nconst createInternalAdapter = (adapter, ctx) => {\n\tconst logger$1 = ctx.logger;\n\tconst options = ctx.options;\n\tconst secondaryStorage = options.secondaryStorage;\n\tconst sessionExpiration = options.session?.expiresIn || 3600 * 24 * 7;\n\tconst { createWithHooks, updateWithHooks, updateManyWithHooks, deleteWithHooks, deleteManyWithHooks } = getWithHooks(adapter, ctx);\n\tasync function refreshUserSessions(user) {\n\t\tif (!secondaryStorage) return;\n\t\tconst listRaw = await secondaryStorage.get(`active-sessions-${user.id}`);\n\t\tif (!listRaw) return;\n\t\tconst now = Date.now();\n\t\tconst validSessions = (safeJSONParse(listRaw) || []).filter((s) => s.expiresAt > now);\n\t\tawait Promise.all(validSessions.map(async ({ token }) => {\n\t\t\tconst cached = await secondaryStorage.get(token);\n\t\t\tif (!cached) return;\n\t\t\tconst parsed = safeJSONParse(cached);\n\t\t\tif (!parsed) return;\n\t\t\tconst sessionTTL = Math.max(Math.floor(new Date(parsed.session.expiresAt).getTime() - now) / 1e3, 0);\n\t\t\tawait secondaryStorage.set(token, JSON.stringify({\n\t\t\t\tsession: parsed.session,\n\t\t\t\tuser\n\t\t\t}), Math.floor(sessionTTL));\n\t\t}));\n\t}\n\treturn {\n\t\tcreateOAuthUser: async (user, account) => {\n\t\t\treturn runWithTransaction(adapter, async () => {\n\t\t\t\tconst createdUser = await createWithHooks({\n\t\t\t\t\tcreatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\t\tupdatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\t\t...user\n\t\t\t\t}, \"user\", void 0);\n\t\t\t\treturn {\n\t\t\t\t\tuser: createdUser,\n\t\t\t\t\taccount: await createWithHooks({\n\t\t\t\t\t\t...account,\n\t\t\t\t\t\tuserId: createdUser.id,\n\t\t\t\t\t\tcreatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\t\t\tupdatedAt: /* @__PURE__ */ new Date()\n\t\t\t\t\t}, \"account\", void 0)\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tcreateUser: async (user) => {\n\t\t\treturn await createWithHooks({\n\t\t\t\tcreatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\tupdatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\t...user,\n\t\t\t\temail: user.email?.toLowerCase()\n\t\t\t}, \"user\", void 0);\n\t\t},\n\t\tcreateAccount: async (account) => {\n\t\t\treturn await createWithHooks({\n\t\t\t\tcreatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\tupdatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\t...account\n\t\t\t}, \"account\", void 0);\n\t\t},\n\t\tlistSessions: async (userId) => {\n\t\t\tif (secondaryStorage) {\n\t\t\t\tconst currentList = await secondaryStorage.get(`active-sessions-${userId}`);\n\t\t\t\tif (!currentList) return [];\n\t\t\t\tconst list = safeJSONParse(currentList) || [];\n\t\t\t\tconst now = Date.now();\n\t\t\t\tconst validSessions = list.filter((s) => s.expiresAt > now);\n\t\t\t\tconst sessions = [];\n\t\t\t\tfor (const session of validSessions) {\n\t\t\t\t\tconst sessionStringified = await secondaryStorage.get(session.token);\n\t\t\t\t\tif (sessionStringified) {\n\t\t\t\t\t\tconst s = safeJSONParse(sessionStringified);\n\t\t\t\t\t\tif (!s) return [];\n\t\t\t\t\t\tconst parsedSession = parseSessionOutput(ctx.options, {\n\t\t\t\t\t\t\t...s.session,\n\t\t\t\t\t\t\texpiresAt: new Date(s.session.expiresAt)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsessions.push(parsedSession);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn sessions;\n\t\t\t}\n\t\t\treturn await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\tmodel: \"session\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"userId\",\n\t\t\t\t\tvalue: userId\n\t\t\t\t}]\n\t\t\t});\n\t\t},\n\t\tlistUsers: async (limit, offset, sortBy, where) => {\n\t\t\treturn await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\tmodel: \"user\",\n\t\t\t\tlimit,\n\t\t\t\toffset,\n\t\t\t\tsortBy,\n\t\t\t\twhere\n\t\t\t});\n\t\t},\n\t\tcountTotalUsers: async (where) => {\n\t\t\tconst total = await (await getCurrentAdapter(adapter)).count({\n\t\t\t\tmodel: \"user\",\n\t\t\t\twhere\n\t\t\t});\n\t\t\tif (typeof total === \"string\") return parseInt(total);\n\t\t\treturn total;\n\t\t},\n\t\tdeleteUser: async (userId) => {\n\t\t\tif (secondaryStorage) await secondaryStorage.delete(`active-sessions-${userId}`);\n\t\t\tif (!secondaryStorage || options.session?.storeSessionInDatabase) await deleteManyWithHooks([{\n\t\t\t\tfield: \"userId\",\n\t\t\t\tvalue: userId\n\t\t\t}], \"session\", void 0);\n\t\t\tawait deleteManyWithHooks([{\n\t\t\t\tfield: \"userId\",\n\t\t\t\tvalue: userId\n\t\t\t}], \"account\", void 0);\n\t\t\tawait deleteWithHooks([{\n\t\t\t\tfield: \"id\",\n\t\t\t\tvalue: userId\n\t\t\t}], \"user\", void 0);\n\t\t},\n\t\tcreateSession: async (userId, dontRememberMe, override, overrideAll) => {\n\t\t\tconst ctx$1 = await getCurrentAuthContext().catch(() => null);\n\t\t\tconst headers = ctx$1?.headers || ctx$1?.request?.headers;\n\t\t\tconst { id: _, ...rest } = override || {};\n\t\t\tconst defaultAdditionalFields = parseSessionInput(ctx$1?.context.options ?? options, {});\n\t\t\tconst data = {\n\t\t\t\tipAddress: ctx$1?.request || ctx$1?.headers ? getIp(ctx$1?.request || ctx$1?.headers, ctx$1?.context.options) || \"\" : \"\",\n\t\t\t\tuserAgent: headers?.get(\"user-agent\") || \"\",\n\t\t\t\t...rest,\n\t\t\t\texpiresAt: dontRememberMe ? getDate(3600 * 24, \"sec\") : getDate(sessionExpiration, \"sec\"),\n\t\t\t\tuserId,\n\t\t\t\ttoken: generateId(32),\n\t\t\t\tcreatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\tupdatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\t...defaultAdditionalFields,\n\t\t\t\t...overrideAll ? rest : {}\n\t\t\t};\n\t\t\treturn await createWithHooks(data, \"session\", secondaryStorage ? {\n\t\t\t\tfn: async (sessionData) => {\n\t\t\t\t\t/**\n\t\t\t\t\t* store the session token for the user\n\t\t\t\t\t* so we can retrieve it later for listing sessions\n\t\t\t\t\t*/\n\t\t\t\t\tconst currentList = await secondaryStorage.get(`active-sessions-${userId}`);\n\t\t\t\t\tlet list = [];\n\t\t\t\t\tconst now = Date.now();\n\t\t\t\t\tif (currentList) {\n\t\t\t\t\t\tlist = safeJSONParse(currentList) || [];\n\t\t\t\t\t\tlist = list.filter((session) => session.expiresAt > now);\n\t\t\t\t\t}\n\t\t\t\t\tconst sorted = list.sort((a, b) => a.expiresAt - b.expiresAt);\n\t\t\t\t\tlet furthestSessionExp = sorted.at(-1)?.expiresAt;\n\t\t\t\t\tsorted.push({\n\t\t\t\t\t\ttoken: data.token,\n\t\t\t\t\t\texpiresAt: data.expiresAt.getTime()\n\t\t\t\t\t});\n\t\t\t\t\tif (!furthestSessionExp || furthestSessionExp < data.expiresAt.getTime()) furthestSessionExp = data.expiresAt.getTime();\n\t\t\t\t\tconst furthestSessionTTL = Math.max(Math.floor((furthestSessionExp - now) / 1e3), 0);\n\t\t\t\t\tif (furthestSessionTTL > 0) await secondaryStorage.set(`active-sessions-${userId}`, JSON.stringify(sorted), furthestSessionTTL);\n\t\t\t\t\tconst user = await adapter.findOne({\n\t\t\t\t\t\tmodel: \"user\",\n\t\t\t\t\t\twhere: [{\n\t\t\t\t\t\t\tfield: \"id\",\n\t\t\t\t\t\t\tvalue: userId\n\t\t\t\t\t\t}]\n\t\t\t\t\t});\n\t\t\t\t\tconst sessionTTL = Math.max(Math.floor((data.expiresAt.getTime() - now) / 1e3), 0);\n\t\t\t\t\tif (sessionTTL > 0) await secondaryStorage.set(data.token, JSON.stringify({\n\t\t\t\t\t\tsession: sessionData,\n\t\t\t\t\t\tuser\n\t\t\t\t\t}), sessionTTL);\n\t\t\t\t\treturn sessionData;\n\t\t\t\t},\n\t\t\t\texecuteMainFn: options.session?.storeSessionInDatabase\n\t\t\t} : void 0);\n\t\t},\n\t\tfindSession: async (token) => {\n\t\t\tif (secondaryStorage) {\n\t\t\t\tconst sessionStringified = await secondaryStorage.get(token);\n\t\t\t\tif (!sessionStringified && !options.session?.storeSessionInDatabase) return null;\n\t\t\t\tif (sessionStringified) {\n\t\t\t\t\tconst s = safeJSONParse(sessionStringified);\n\t\t\t\t\tif (!s) return null;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tsession: parseSessionOutput(ctx.options, {\n\t\t\t\t\t\t\t...s.session,\n\t\t\t\t\t\t\texpiresAt: new Date(s.session.expiresAt),\n\t\t\t\t\t\t\tcreatedAt: new Date(s.session.createdAt),\n\t\t\t\t\t\t\tupdatedAt: new Date(s.session.updatedAt)\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tuser: parseUserOutput(ctx.options, {\n\t\t\t\t\t\t\t...s.user,\n\t\t\t\t\t\t\tcreatedAt: new Date(s.user.createdAt),\n\t\t\t\t\t\t\tupdatedAt: new Date(s.user.updatedAt)\n\t\t\t\t\t\t})\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst result = await (await getCurrentAdapter(adapter)).findOne({\n\t\t\t\tmodel: \"session\",\n\t\t\t\twhere: [{\n\t\t\t\t\tvalue: token,\n\t\t\t\t\tfield: \"token\"\n\t\t\t\t}],\n\t\t\t\tjoin: { user: true }\n\t\t\t});\n\t\t\tif (!result) return null;\n\t\t\tconst { user, ...session } = result;\n\t\t\tif (!user) return null;\n\t\t\treturn {\n\t\t\t\tsession: parseSessionOutput(ctx.options, session),\n\t\t\t\tuser: parseUserOutput(ctx.options, user)\n\t\t\t};\n\t\t},\n\t\tfindSessions: async (sessionTokens) => {\n\t\t\tif (secondaryStorage) {\n\t\t\t\tconst sessions$1 = [];\n\t\t\t\tfor (const sessionToken of sessionTokens) {\n\t\t\t\t\tconst sessionStringified = await secondaryStorage.get(sessionToken);\n\t\t\t\t\tif (sessionStringified) {\n\t\t\t\t\t\tconst s = safeJSONParse(sessionStringified);\n\t\t\t\t\t\tif (!s) return [];\n\t\t\t\t\t\tconst session = {\n\t\t\t\t\t\t\tsession: {\n\t\t\t\t\t\t\t\t...s.session,\n\t\t\t\t\t\t\t\texpiresAt: new Date(s.session.expiresAt)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\t\t...s.user,\n\t\t\t\t\t\t\t\tcreatedAt: new Date(s.user.createdAt),\n\t\t\t\t\t\t\t\tupdatedAt: new Date(s.user.updatedAt)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tsessions$1.push(session);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn sessions$1;\n\t\t\t}\n\t\t\tconst sessions = await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\tmodel: \"session\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"token\",\n\t\t\t\t\tvalue: sessionTokens,\n\t\t\t\t\toperator: \"in\"\n\t\t\t\t}],\n\t\t\t\tjoin: { user: true }\n\t\t\t});\n\t\t\tif (!sessions.length) return [];\n\t\t\tif (sessions.some((session) => !session.user)) return [];\n\t\t\treturn sessions.map((_session) => {\n\t\t\t\tconst { user, ...session } = _session;\n\t\t\t\treturn {\n\t\t\t\t\tsession,\n\t\t\t\t\tuser\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tupdateSession: async (sessionToken, session) => {\n\t\t\treturn await updateWithHooks(session, [{\n\t\t\t\tfield: \"token\",\n\t\t\t\tvalue: sessionToken\n\t\t\t}], \"session\", secondaryStorage ? {\n\t\t\t\tasync fn(data) {\n\t\t\t\t\tconst currentSession = await secondaryStorage.get(sessionToken);\n\t\t\t\t\tlet updatedSession = null;\n\t\t\t\t\tif (currentSession) {\n\t\t\t\t\t\tconst parsedSession = safeJSONParse(currentSession);\n\t\t\t\t\t\tif (!parsedSession) return null;\n\t\t\t\t\t\tupdatedSession = {\n\t\t\t\t\t\t\t...parsedSession.session,\n\t\t\t\t\t\t\t...data\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn updatedSession;\n\t\t\t\t\t} else return null;\n\t\t\t\t},\n\t\t\t\texecuteMainFn: options.session?.storeSessionInDatabase\n\t\t\t} : void 0);\n\t\t},\n\t\tdeleteSession: async (token) => {\n\t\t\tif (secondaryStorage) {\n\t\t\t\tconst data = await secondaryStorage.get(token);\n\t\t\t\tif (data) {\n\t\t\t\t\tconst { session } = safeJSONParse(data) ?? {};\n\t\t\t\t\tif (!session) {\n\t\t\t\t\t\tlogger$1.error(\"Session not found in secondary storage\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst userId = session.userId;\n\t\t\t\t\tconst currentList = await secondaryStorage.get(`active-sessions-${userId}`);\n\t\t\t\t\tif (currentList) {\n\t\t\t\t\t\tlet list = safeJSONParse(currentList) || [];\n\t\t\t\t\t\tconst now = Date.now();\n\t\t\t\t\t\tconst filtered = list.filter((session$1) => session$1.expiresAt > now && session$1.token !== token);\n\t\t\t\t\t\tconst furthestSessionExp = filtered.sort((a, b) => a.expiresAt - b.expiresAt).at(-1)?.expiresAt;\n\t\t\t\t\t\tif (filtered.length > 0 && furthestSessionExp && furthestSessionExp > Date.now()) await secondaryStorage.set(`active-sessions-${userId}`, JSON.stringify(filtered), Math.floor((furthestSessionExp - now) / 1e3));\n\t\t\t\t\t\telse await secondaryStorage.delete(`active-sessions-${userId}`);\n\t\t\t\t\t} else logger$1.error(\"Active sessions list not found in secondary storage\");\n\t\t\t\t}\n\t\t\t\tawait secondaryStorage.delete(token);\n\t\t\t\tif (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) return;\n\t\t\t}\n\t\t\tawait (await getCurrentAdapter(adapter)).delete({\n\t\t\t\tmodel: \"session\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"token\",\n\t\t\t\t\tvalue: token\n\t\t\t\t}]\n\t\t\t});\n\t\t},\n\t\tdeleteAccounts: async (userId) => {\n\t\t\tawait deleteManyWithHooks([{\n\t\t\t\tfield: \"userId\",\n\t\t\t\tvalue: userId\n\t\t\t}], \"account\", void 0);\n\t\t},\n\t\tdeleteAccount: async (accountId) => {\n\t\t\tawait deleteWithHooks([{\n\t\t\t\tfield: \"id\",\n\t\t\t\tvalue: accountId\n\t\t\t}], \"account\", void 0);\n\t\t},\n\t\tdeleteSessions: async (userIdOrSessionTokens) => {\n\t\t\tif (secondaryStorage) {\n\t\t\t\tif (typeof userIdOrSessionTokens === \"string\") {\n\t\t\t\t\tconst activeSession = await secondaryStorage.get(`active-sessions-${userIdOrSessionTokens}`);\n\t\t\t\t\tconst sessions = activeSession ? safeJSONParse(activeSession) : [];\n\t\t\t\t\tif (!sessions) return;\n\t\t\t\t\tfor (const session of sessions) await secondaryStorage.delete(session.token);\n\t\t\t\t} else for (const sessionToken of userIdOrSessionTokens) if (await secondaryStorage.get(sessionToken)) await secondaryStorage.delete(sessionToken);\n\t\t\t\tif (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) return;\n\t\t\t}\n\t\t\tawait deleteManyWithHooks([{\n\t\t\t\tfield: Array.isArray(userIdOrSessionTokens) ? \"token\" : \"userId\",\n\t\t\t\tvalue: userIdOrSessionTokens,\n\t\t\t\toperator: Array.isArray(userIdOrSessionTokens) ? \"in\" : void 0\n\t\t\t}], \"session\", void 0);\n\t\t},\n\t\tfindOAuthUser: async (email, accountId, providerId) => {\n\t\t\tconst account = await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\tmodel: \"account\",\n\t\t\t\twhere: [{\n\t\t\t\t\tvalue: accountId,\n\t\t\t\t\tfield: \"accountId\"\n\t\t\t\t}],\n\t\t\t\tjoin: { user: true }\n\t\t\t}).then((accounts) => {\n\t\t\t\treturn accounts.find((a) => a.providerId === providerId);\n\t\t\t});\n\t\t\tif (account) if (account.user) return {\n\t\t\t\tuser: account.user,\n\t\t\t\taccounts: [account]\n\t\t\t};\n\t\t\telse {\n\t\t\t\tconst user = await (await getCurrentAdapter(adapter)).findOne({\n\t\t\t\t\tmodel: \"user\",\n\t\t\t\t\twhere: [{\n\t\t\t\t\t\tvalue: email.toLowerCase(),\n\t\t\t\t\t\tfield: \"email\"\n\t\t\t\t\t}]\n\t\t\t\t});\n\t\t\t\tif (user) return {\n\t\t\t\t\tuser,\n\t\t\t\t\taccounts: [account]\n\t\t\t\t};\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconst user = await (await getCurrentAdapter(adapter)).findOne({\n\t\t\t\t\tmodel: \"user\",\n\t\t\t\t\twhere: [{\n\t\t\t\t\t\tvalue: email.toLowerCase(),\n\t\t\t\t\t\tfield: \"email\"\n\t\t\t\t\t}]\n\t\t\t\t});\n\t\t\t\tif (user) return {\n\t\t\t\t\tuser,\n\t\t\t\t\taccounts: await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\t\t\tmodel: \"account\",\n\t\t\t\t\t\twhere: [{\n\t\t\t\t\t\t\tvalue: user.id,\n\t\t\t\t\t\t\tfield: \"userId\"\n\t\t\t\t\t\t}]\n\t\t\t\t\t}) || []\n\t\t\t\t};\n\t\t\t\telse return null;\n\t\t\t}\n\t\t},\n\t\tfindUserByEmail: async (email, options$1) => {\n\t\t\tconst result = await (await getCurrentAdapter(adapter)).findOne({\n\t\t\t\tmodel: \"user\",\n\t\t\t\twhere: [{\n\t\t\t\t\tvalue: email.toLowerCase(),\n\t\t\t\t\tfield: \"email\"\n\t\t\t\t}],\n\t\t\t\tjoin: { ...options$1?.includeAccounts ? { account: true } : {} }\n\t\t\t});\n\t\t\tif (!result) return null;\n\t\t\tconst { account: accounts, ...user } = result;\n\t\t\treturn {\n\t\t\t\tuser,\n\t\t\t\taccounts: accounts ?? []\n\t\t\t};\n\t\t},\n\t\tfindUserById: async (userId) => {\n\t\t\tif (!userId) return null;\n\t\t\treturn await (await getCurrentAdapter(adapter)).findOne({\n\t\t\t\tmodel: \"user\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"id\",\n\t\t\t\t\tvalue: userId\n\t\t\t\t}]\n\t\t\t});\n\t\t},\n\t\tlinkAccount: async (account) => {\n\t\t\treturn await createWithHooks({\n\t\t\t\tcreatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\tupdatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\t...account\n\t\t\t}, \"account\", void 0);\n\t\t},\n\t\tupdateUser: async (userId, data) => {\n\t\t\tconst user = await updateWithHooks(data, [{\n\t\t\t\tfield: \"id\",\n\t\t\t\tvalue: userId\n\t\t\t}], \"user\", void 0);\n\t\t\tawait refreshUserSessions(user);\n\t\t\tawait refreshUserSessions(user);\n\t\t\treturn user;\n\t\t},\n\t\tupdateUserByEmail: async (email, data) => {\n\t\t\tconst user = await updateWithHooks(data, [{\n\t\t\t\tfield: \"email\",\n\t\t\t\tvalue: email.toLowerCase()\n\t\t\t}], \"user\", void 0);\n\t\t\tawait refreshUserSessions(user);\n\t\t\tawait refreshUserSessions(user);\n\t\t\treturn user;\n\t\t},\n\t\tupdatePassword: async (userId, password) => {\n\t\t\tawait updateManyWithHooks({ password }, [{\n\t\t\t\tfield: \"userId\",\n\t\t\t\tvalue: userId\n\t\t\t}, {\n\t\t\t\tfield: \"providerId\",\n\t\t\t\tvalue: \"credential\"\n\t\t\t}], \"account\", void 0);\n\t\t},\n\t\tfindAccounts: async (userId) => {\n\t\t\treturn await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\tmodel: \"account\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"userId\",\n\t\t\t\t\tvalue: userId\n\t\t\t\t}]\n\t\t\t});\n\t\t},\n\t\tfindAccount: async (accountId) => {\n\t\t\treturn await (await getCurrentAdapter(adapter)).findOne({\n\t\t\t\tmodel: \"account\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"accountId\",\n\t\t\t\t\tvalue: accountId\n\t\t\t\t}]\n\t\t\t});\n\t\t},\n\t\tfindAccountByProviderId: async (accountId, providerId) => {\n\t\t\treturn await (await getCurrentAdapter(adapter)).findOne({\n\t\t\t\tmodel: \"account\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"accountId\",\n\t\t\t\t\tvalue: accountId\n\t\t\t\t}, {\n\t\t\t\t\tfield: \"providerId\",\n\t\t\t\t\tvalue: providerId\n\t\t\t\t}]\n\t\t\t});\n\t\t},\n\t\tfindAccountByUserId: async (userId) => {\n\t\t\treturn await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\tmodel: \"account\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"userId\",\n\t\t\t\t\tvalue: userId\n\t\t\t\t}]\n\t\t\t});\n\t\t},\n\t\tupdateAccount: async (id, data) => {\n\t\t\treturn await updateWithHooks(data, [{\n\t\t\t\tfield: \"id\",\n\t\t\t\tvalue: id\n\t\t\t}], \"account\", void 0);\n\t\t},\n\t\tcreateVerificationValue: async (data) => {\n\t\t\treturn await createWithHooks({\n\t\t\t\tcreatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\tupdatedAt: /* @__PURE__ */ new Date(),\n\t\t\t\t...data\n\t\t\t}, \"verification\", void 0);\n\t\t},\n\t\tfindVerificationValue: async (identifier) => {\n\t\t\tconst verification = await (await getCurrentAdapter(adapter)).findMany({\n\t\t\t\tmodel: \"verification\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"identifier\",\n\t\t\t\t\tvalue: identifier\n\t\t\t\t}],\n\t\t\t\tsortBy: {\n\t\t\t\t\tfield: \"createdAt\",\n\t\t\t\t\tdirection: \"desc\"\n\t\t\t\t},\n\t\t\t\tlimit: 1\n\t\t\t});\n\t\t\tif (!options.verification?.disableCleanup) await (await getCurrentAdapter(adapter)).deleteMany({\n\t\t\t\tmodel: \"verification\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"expiresAt\",\n\t\t\t\t\tvalue: /* @__PURE__ */ new Date(),\n\t\t\t\t\toperator: \"lt\"\n\t\t\t\t}]\n\t\t\t});\n\t\t\treturn verification[0];\n\t\t},\n\t\tdeleteVerificationValue: async (id) => {\n\t\t\tawait (await getCurrentAdapter(adapter)).delete({\n\t\t\t\tmodel: \"verification\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"id\",\n\t\t\t\t\tvalue: id\n\t\t\t\t}]\n\t\t\t});\n\t\t},\n\t\tdeleteVerificationByIdentifier: async (identifier) => {\n\t\t\tawait (await getCurrentAdapter(adapter)).delete({\n\t\t\t\tmodel: \"verification\",\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"identifier\",\n\t\t\t\t\tvalue: identifier\n\t\t\t\t}]\n\t\t\t});\n\t\t},\n\t\tupdateVerificationValue: async (id, data) => {\n\t\t\treturn await updateWithHooks(data, [{\n\t\t\t\tfield: \"id\",\n\t\t\t\tvalue: id\n\t\t\t}], \"verification\", void 0);\n\t\t}\n\t};\n};\n\n//#endregion\n//#region src/db/to-zod.ts\nfunction toZodSchema({ fields, isClientSide }) {\n\tconst zodFields = Object.keys(fields).reduce((acc, key) => {\n\t\tconst field = fields[key];\n\t\tif (!field) return acc;\n\t\tif (isClientSide && field.input === false) return acc;\n\t\tlet schema;\n\t\tif (field.type === \"json\") schema = z.json ? z.json() : z.any();\n\t\telse if (field.type === \"string[]\" || field.type === \"number[]\") schema = z.array(field.type === \"string[]\" ? z.string() : z.number());\n\t\telse if (Array.isArray(field.type)) schema = z.any();\n\t\telse schema = z[field.type]();\n\t\tif (field?.required === false) schema = schema.optional();\n\t\tif (field?.returned === false) return acc;\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[key]: schema\n\t\t};\n\t}, {});\n\treturn z.object(zodFields);\n}\n\n//#endregion\n//#region src/db/get-schema.ts\nfunction getSchema(config) {\n\tconst tables = getAuthTables(config);\n\tlet schema = {};\n\tfor (const key in tables) {\n\t\tconst table = tables[key];\n\t\tconst fields = table.fields;\n\t\tlet actualFields = {};\n\t\tObject.entries(fields).forEach(([key$1, field]) => {\n\t\t\tactualFields[field.fieldName || key$1] = field;\n\t\t\tif (field.references) {\n\t\t\t\tconst refTable = tables[field.references.model];\n\t\t\t\tif (refTable) actualFields[field.fieldName || key$1].references = {\n\t\t\t\t\t...field.references,\n\t\t\t\t\tmodel: refTable.modelName,\n\t\t\t\t\tfield: field.references.field\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t\tif (schema[table.modelName]) {\n\t\t\tschema[table.modelName].fields = {\n\t\t\t\t...schema[table.modelName].fields,\n\t\t\t\t...actualFields\n\t\t\t};\n\t\t\tcontinue;\n\t\t}\n\t\tschema[table.modelName] = {\n\t\t\tfields: actualFields,\n\t\t\torder: table.order || Infinity\n\t\t};\n\t}\n\treturn schema;\n}\n\n//#endregion\n//#region src/db/get-migration.ts\nconst map = {\n\tpostgres: {\n\t\tstring: [\n\t\t\t\"character varying\",\n\t\t\t\"varchar\",\n\t\t\t\"text\",\n\t\t\t\"uuid\"\n\t\t],\n\t\tnumber: [\n\t\t\t\"int4\",\n\t\t\t\"integer\",\n\t\t\t\"bigint\",\n\t\t\t\"smallint\",\n\t\t\t\"numeric\",\n\t\t\t\"real\",\n\t\t\t\"double precision\"\n\t\t],\n\t\tboolean: [\"bool\", \"boolean\"],\n\t\tdate: [\n\t\t\t\"timestamptz\",\n\t\t\t\"timestamp\",\n\t\t\t\"date\"\n\t\t],\n\t\tjson: [\"json\", \"jsonb\"]\n\t},\n\tmysql: {\n\t\tstring: [\n\t\t\t\"varchar\",\n\t\t\t\"text\",\n\t\t\t\"uuid\"\n\t\t],\n\t\tnumber: [\n\t\t\t\"integer\",\n\t\t\t\"int\",\n\t\t\t\"bigint\",\n\t\t\t\"smallint\",\n\t\t\t\"decimal\",\n\t\t\t\"float\",\n\t\t\t\"double\"\n\t\t],\n\t\tboolean: [\"boolean\", \"tinyint\"],\n\t\tdate: [\n\t\t\t\"timestamp\",\n\t\t\t\"datetime\",\n\t\t\t\"date\"\n\t\t],\n\t\tjson: [\"json\"]\n\t},\n\tsqlite: {\n\t\tstring: [\"TEXT\"],\n\t\tnumber: [\"INTEGER\", \"REAL\"],\n\t\tboolean: [\"INTEGER\", \"BOOLEAN\"],\n\t\tdate: [\"DATE\", \"INTEGER\"],\n\t\tjson: [\"TEXT\"]\n\t},\n\tmssql: {\n\t\tstring: [\n\t\t\t\"varchar\",\n\t\t\t\"nvarchar\",\n\t\t\t\"uniqueidentifier\"\n\t\t],\n\t\tnumber: [\n\t\t\t\"int\",\n\t\t\t\"bigint\",\n\t\t\t\"smallint\",\n\t\t\t\"decimal\",\n\t\t\t\"float\",\n\t\t\t\"double\"\n\t\t],\n\t\tboolean: [\"bit\", \"smallint\"],\n\t\tdate: [\n\t\t\t\"datetime2\",\n\t\t\t\"date\",\n\t\t\t\"datetime\"\n\t\t],\n\t\tjson: [\"varchar\", \"nvarchar\"]\n\t}\n};\nfunction matchType(columnDataType, fieldType, dbType) {\n\tfunction normalize(type) {\n\t\treturn type.toLowerCase().split(\"(\")[0].trim();\n\t}\n\tif (fieldType === \"string[]\" || fieldType === \"number[]\") return columnDataType.toLowerCase().includes(\"json\");\n\tconst types = map[dbType];\n\treturn (Array.isArray(fieldType) ? types[\"string\"].map((t) => t.toLowerCase()) : types[fieldType].map((t) => t.toLowerCase())).includes(normalize(columnDataType));\n}\n/**\n* Get the current PostgreSQL schema (search_path) for the database connection\n* Returns the first schema in the search_path, defaulting to 'public' if not found\n*/\nasync function getPostgresSchema(db) {\n\ttry {\n\t\tconst result = await sql`SHOW search_path`.execute(db);\n\t\tif (result.rows[0]?.search_path) return result.rows[0].search_path.split(\",\").map((s) => s.trim()).map((s) => s.replace(/^[\"']|[\"']$/g, \"\")).filter((s) => !s.startsWith(\"$\"))[0] || \"public\";\n\t} catch (error) {}\n\treturn \"public\";\n}\nasync function getMigrations(config) {\n\tconst betterAuthSchema = getSchema(config);\n\tconst logger$1 = createLogger(config.logger);\n\tlet { kysely: db, databaseType: dbType } = await createKyselyAdapter(config);\n\tif (!dbType) {\n\t\tlogger$1.warn(\"Could not determine database type, defaulting to sqlite. Please provide a type in the database options to avoid this.\");\n\t\tdbType = \"sqlite\";\n\t}\n\tif (!db) {\n\t\tlogger$1.error(\"Only kysely adapter is supported for migrations. You can use `generate` command to generate the schema, if you're using a different adapter.\");\n\t\tprocess.exit(1);\n\t}\n\tlet currentSchema = \"public\";\n\tif (dbType === \"postgres\") {\n\t\tcurrentSchema = await getPostgresSchema(db);\n\t\tlogger$1.debug(`PostgreSQL migration: Using schema '${currentSchema}' (from search_path)`);\n\t\ttry {\n\t\t\tif (!(await sql`\n\t\t\t\tSELECT schema_name \n\t\t\t\tFROM information_schema.schemata \n\t\t\t\tWHERE schema_name = ${currentSchema}\n\t\t\t`.execute(db)).rows[0]) logger$1.warn(`Schema '${currentSchema}' does not exist. Tables will be inspected from available schemas. Consider creating the schema first or checking your database configuration.`);\n\t\t} catch (error) {\n\t\t\tlogger$1.debug(`Could not verify schema existence: ${error instanceof Error ? error.message : String(error)}`);\n\t\t}\n\t}\n\tconst allTableMetadata = await db.introspection.getTables();\n\tlet tableMetadata = allTableMetadata;\n\tif (dbType === \"postgres\") try {\n\t\tconst tablesInSchema = await sql`\n\t\t\t\tSELECT table_name \n\t\t\t\tFROM information_schema.tables \n\t\t\t\tWHERE table_schema = ${currentSchema}\n\t\t\t\tAND table_type = 'BASE TABLE'\n\t\t\t`.execute(db);\n\t\tconst tableNamesInSchema = new Set(tablesInSchema.rows.map((row) => row.table_name));\n\t\ttableMetadata = allTableMetadata.filter((table) => table.schema === currentSchema && tableNamesInSchema.has(table.name));\n\t\tlogger$1.debug(`Found ${tableMetadata.length} table(s) in schema '${currentSchema}': ${tableMetadata.map((t) => t.name).join(\", \") || \"(none)\"}`);\n\t} catch (error) {\n\t\tlogger$1.warn(`Could not filter tables by schema. Using all discovered tables. Error: ${error instanceof Error ? error.message : String(error)}`);\n\t}\n\tconst toBeCreated = [];\n\tconst toBeAdded = [];\n\tfor (const [key, value] of Object.entries(betterAuthSchema)) {\n\t\tconst table = tableMetadata.find((t) => t.name === key);\n\t\tif (!table) {\n\t\t\tconst tIndex = toBeCreated.findIndex((t) => t.table === key);\n\t\t\tconst tableData = {\n\t\t\t\ttable: key,\n\t\t\t\tfields: value.fields,\n\t\t\t\torder: value.order || Infinity\n\t\t\t};\n\t\t\tconst insertIndex = toBeCreated.findIndex((t) => (t.order || Infinity) > tableData.order);\n\t\t\tif (insertIndex === -1) if (tIndex === -1) toBeCreated.push(tableData);\n\t\t\telse toBeCreated[tIndex].fields = {\n\t\t\t\t...toBeCreated[tIndex].fields,\n\t\t\t\t...value.fields\n\t\t\t};\n\t\t\telse toBeCreated.splice(insertIndex, 0, tableData);\n\t\t\tcontinue;\n\t\t}\n\t\tlet toBeAddedFields = {};\n\t\tfor (const [fieldName, field] of Object.entries(value.fields)) {\n\t\t\tconst column = table.columns.find((c) => c.name === fieldName);\n\t\t\tif (!column) {\n\t\t\t\ttoBeAddedFields[fieldName] = field;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (matchType(column.dataType, field.type, dbType)) continue;\n\t\t\telse logger$1.warn(`Field ${fieldName} in table ${key} has a different type in the database. Expected ${field.type} but got ${column.dataType}.`);\n\t\t}\n\t\tif (Object.keys(toBeAddedFields).length > 0) toBeAdded.push({\n\t\t\ttable: key,\n\t\t\tfields: toBeAddedFields,\n\t\t\torder: value.order || Infinity\n\t\t});\n\t}\n\tconst migrations = [];\n\tconst useUUIDs = config.advanced?.database?.generateId === \"uuid\";\n\tconst useNumberId = config.advanced?.database?.useNumberId || config.advanced?.database?.generateId === \"serial\";\n\tfunction getType(field, fieldName) {\n\t\tconst type = field.type;\n\t\tconst typeMap = {\n\t\t\tstring: {\n\t\t\t\tsqlite: \"text\",\n\t\t\t\tpostgres: \"text\",\n\t\t\t\tmysql: field.unique ? \"varchar(255)\" : field.references ? \"varchar(36)\" : field.sortable ? \"varchar(255)\" : field.index ? \"varchar(255)\" : \"text\",\n\t\t\t\tmssql: field.unique || field.sortable ? \"varchar(255)\" : field.references ? \"varchar(36)\" : \"varchar(8000)\"\n\t\t\t},\n\t\t\tboolean: {\n\t\t\t\tsqlite: \"integer\",\n\t\t\t\tpostgres: \"boolean\",\n\t\t\t\tmysql: \"boolean\",\n\t\t\t\tmssql: \"smallint\"\n\t\t\t},\n\t\t\tnumber: {\n\t\t\t\tsqlite: field.bigint ? \"bigint\" : \"integer\",\n\t\t\t\tpostgres: field.bigint ? \"bigint\" : \"integer\",\n\t\t\t\tmysql: field.bigint ? \"bigint\" : \"integer\",\n\t\t\t\tmssql: field.bigint ? \"bigint\" : \"integer\"\n\t\t\t},\n\t\t\tdate: {\n\t\t\t\tsqlite: \"date\",\n\t\t\t\tpostgres: \"timestamptz\",\n\t\t\t\tmysql: \"timestamp(3)\",\n\t\t\t\tmssql: sql`datetime2(3)`\n\t\t\t},\n\t\t\tjson: {\n\t\t\t\tsqlite: \"text\",\n\t\t\t\tpostgres: \"jsonb\",\n\t\t\t\tmysql: \"json\",\n\t\t\t\tmssql: \"varchar(8000)\"\n\t\t\t},\n\t\t\tid: {\n\t\t\t\tpostgres: useNumberId ? sql`integer GENERATED BY DEFAULT AS IDENTITY` : useUUIDs ? \"uuid\" : \"text\",\n\t\t\t\tmysql: useNumberId ? \"integer\" : useUUIDs ? \"varchar(36)\" : \"varchar(36)\",\n\t\t\t\tmssql: useNumberId ? \"integer\" : useUUIDs ? \"varchar(36)\" : \"varchar(36)\",\n\t\t\t\tsqlite: useNumberId ? \"integer\" : \"text\"\n\t\t\t},\n\t\t\tforeignKeyId: {\n\t\t\t\tpostgres: useNumberId ? \"integer\" : useUUIDs ? \"uuid\" : \"text\",\n\t\t\t\tmysql: useNumberId ? \"integer\" : useUUIDs ? \"varchar(36)\" : \"varchar(36)\",\n\t\t\t\tmssql: useNumberId ? \"integer\" : useUUIDs ? \"varchar(36)\" : \"varchar(36)\",\n\t\t\t\tsqlite: useNumberId ? \"integer\" : \"text\"\n\t\t\t}\n\t\t};\n\t\tif (fieldName === \"id\" || field.references?.field === \"id\") {\n\t\t\tif (fieldName === \"id\") return typeMap.id[dbType];\n\t\t\treturn typeMap.foreignKeyId[dbType];\n\t\t}\n\t\tif (dbType === \"sqlite\" && (type === \"string[]\" || type === \"number[]\")) return \"text\";\n\t\tif (type === \"string[]\" || type === \"number[]\") return \"jsonb\";\n\t\tif (Array.isArray(type)) return \"text\";\n\t\tif (!(type in typeMap)) throw new Error(`Unsupported field type '${String(type)}' for field '${fieldName}'. Allowed types are: string, number, boolean, date, string[], number[]. If you need to store structured data, store it as a JSON string (type: \"string\") or split it into primitive fields. See https://better-auth.com/docs/advanced/schema#additional-fields`);\n\t\treturn typeMap[type][dbType || \"sqlite\"];\n\t}\n\tconst getModelName = initGetModelName({\n\t\tschema: getAuthTables(config),\n\t\tusePlural: false\n\t});\n\tconst getFieldName = initGetFieldName({\n\t\tschema: getAuthTables(config),\n\t\tusePlural: false\n\t});\n\tfunction getReferencePath(model, field) {\n\t\ttry {\n\t\t\treturn `${getModelName(model)}.${getFieldName({\n\t\t\t\tmodel,\n\t\t\t\tfield\n\t\t\t})}`;\n\t\t} catch {\n\t\t\treturn `${model}.${field}`;\n\t\t}\n\t}\n\tif (toBeAdded.length) for (const table of toBeAdded) for (const [fieldName, field] of Object.entries(table.fields)) {\n\t\tconst type = getType(field, fieldName);\n\t\tlet builder = db.schema.alterTable(table.table);\n\t\tif (field.index) {\n\t\t\tconst index = db.schema.alterTable(table.table).addIndex(`${table.table}_${fieldName}_idx`);\n\t\t\tmigrations.push(index);\n\t\t}\n\t\tlet built = builder.addColumn(fieldName, type, (col) => {\n\t\t\tcol = field.required !== false ? col.notNull() : col;\n\t\t\tif (field.references) col = col.references(getReferencePath(field.references.model, field.references.field)).onDelete(field.references.onDelete || \"cascade\");\n\t\t\tif (field.unique) col = col.unique();\n\t\t\tif (field.type === \"date\" && typeof field.defaultValue === \"function\" && (dbType === \"postgres\" || dbType === \"mysql\" || dbType === \"mssql\")) if (dbType === \"mysql\") col = col.defaultTo(sql`CURRENT_TIMESTAMP(3)`);\n\t\t\telse col = col.defaultTo(sql`CURRENT_TIMESTAMP`);\n\t\t\treturn col;\n\t\t});\n\t\tmigrations.push(built);\n\t}\n\tlet toBeIndexed = [];\n\tif (config.advanced?.database?.useNumberId) logger$1.warn(\"`useNumberId` is deprecated. Please use `generateId` with `serial` instead.\");\n\tif (toBeCreated.length) for (const table of toBeCreated) {\n\t\tconst idType = getType({ type: useNumberId ? \"number\" : \"string\" }, \"id\");\n\t\tlet dbT = db.schema.createTable(table.table).addColumn(\"id\", idType, (col) => {\n\t\t\tif (useNumberId) {\n\t\t\t\tif (dbType === \"postgres\") return col.primaryKey().notNull();\n\t\t\t\telse if (dbType === \"sqlite\") return col.primaryKey().notNull();\n\t\t\t\telse if (dbType === \"mssql\") return col.identity().primaryKey().notNull();\n\t\t\t\treturn col.autoIncrement().primaryKey().notNull();\n\t\t\t}\n\t\t\tif (useUUIDs) {\n\t\t\t\tif (dbType === \"postgres\") return col.primaryKey().defaultTo(sql`pg_catalog.gen_random_uuid()`).notNull();\n\t\t\t\treturn col.primaryKey().notNull();\n\t\t\t}\n\t\t\treturn col.primaryKey().notNull();\n\t\t});\n\t\tfor (const [fieldName, field] of Object.entries(table.fields)) {\n\t\t\tconst type = getType(field, fieldName);\n\t\t\tdbT = dbT.addColumn(fieldName, type, (col) => {\n\t\t\t\tcol = field.required !== false ? col.notNull() : col;\n\t\t\t\tif (field.references) col = col.references(getReferencePath(field.references.model, field.references.field)).onDelete(field.references.onDelete || \"cascade\");\n\t\t\t\tif (field.unique) col = col.unique();\n\t\t\t\tif (field.type === \"date\" && typeof field.defaultValue === \"function\" && (dbType === \"postgres\" || dbType === \"mysql\" || dbType === \"mssql\")) if (dbType === \"mysql\") col = col.defaultTo(sql`CURRENT_TIMESTAMP(3)`);\n\t\t\t\telse col = col.defaultTo(sql`CURRENT_TIMESTAMP`);\n\t\t\t\treturn col;\n\t\t\t});\n\t\t\tif (field.index) {\n\t\t\t\tlet builder = db.schema.createIndex(`${table.table}_${fieldName}_${field.unique ? \"uidx\" : \"idx\"}`).on(table.table).columns([fieldName]);\n\t\t\t\ttoBeIndexed.push(field.unique ? builder.unique() : builder);\n\t\t\t}\n\t\t}\n\t\tmigrations.push(dbT);\n\t}\n\tif (toBeIndexed.length) for (const index of toBeIndexed) migrations.push(index);\n\tasync function runMigrations() {\n\t\tfor (const migration of migrations) await migration.execute();\n\t}\n\tasync function compileMigrations() {\n\t\treturn migrations.map((m) => m.compile().sql).join(\";\\n\\n\") + \";\";\n\t}\n\treturn {\n\t\ttoBeCreated,\n\t\ttoBeAdded,\n\t\trunMigrations,\n\t\tcompileMigrations\n\t};\n}\n\n//#endregion\nexport { createInternalAdapter as a, convertToDB as c, getBaseAdapter as d, toZodSchema as i, createFieldAttribute as l, matchType as n, getWithHooks as o, getSchema as r, convertFromDB as s, getMigrations as t, getAdapter as u };"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2381, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/misc-BwNc0MKr.mjs"],"sourcesContent":["//#region src/utils/misc.ts\nfunction capitalizeFirstLetter(str) {\n\treturn str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n//#endregion\nexport { capitalizeFirstLetter as t };"],"names":[],"mappings":"AAAA,2BAA2B;;;;;AAC3B,SAAS,sBAAsB,GAAG;IACjC,OAAO,IAAI,MAAM,CAAC,GAAG,WAAW,KAAK,IAAI,KAAK,CAAC;AAChD","ignoreList":[0]}},
    {"offset": {"line": 2394, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/url-CB8xCwz-.mjs"],"sourcesContent":["import { env } from \"@better-auth/core/env\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\n\n//#region src/utils/url.ts\nfunction checkHasPath(url) {\n\ttry {\n\t\treturn (new URL(url).pathname.replace(/\\/+$/, \"\") || \"/\") !== \"/\";\n\t} catch (error) {\n\t\tthrow new BetterAuthError(`Invalid base URL: ${url}. Please provide a valid base URL.`);\n\t}\n}\nfunction assertHasProtocol(url) {\n\ttry {\n\t\tconst parsedUrl = new URL(url);\n\t\tif (parsedUrl.protocol !== \"http:\" && parsedUrl.protocol !== \"https:\") throw new BetterAuthError(`Invalid base URL: ${url}. URL must include 'http://' or 'https://'`);\n\t} catch (error) {\n\t\tif (error instanceof BetterAuthError) throw error;\n\t\tthrow new BetterAuthError(`Invalid base URL: ${url}. Please provide a valid base URL.`, String(error));\n\t}\n}\nfunction withPath(url, path = \"/api/auth\") {\n\tassertHasProtocol(url);\n\tif (checkHasPath(url)) return url;\n\tconst trimmedUrl = url.replace(/\\/+$/, \"\");\n\tif (!path || path === \"/\") return trimmedUrl;\n\tpath = path.startsWith(\"/\") ? path : `/${path}`;\n\treturn `${trimmedUrl}${path}`;\n}\nfunction getBaseURL(url, path, request, loadEnv, trustedProxyHeaders) {\n\tif (url) return withPath(url, path);\n\tif (loadEnv !== false) {\n\t\tconst fromEnv = env.BETTER_AUTH_URL || env.NEXT_PUBLIC_BETTER_AUTH_URL || env.PUBLIC_BETTER_AUTH_URL || env.NUXT_PUBLIC_BETTER_AUTH_URL || env.NUXT_PUBLIC_AUTH_URL || (env.BASE_URL !== \"/\" ? env.BASE_URL : void 0);\n\t\tif (fromEnv) return withPath(fromEnv, path);\n\t}\n\tconst fromRequest = request?.headers.get(\"x-forwarded-host\");\n\tconst fromRequestProto = request?.headers.get(\"x-forwarded-proto\");\n\tif (fromRequest && fromRequestProto && trustedProxyHeaders) return withPath(`${fromRequestProto}://${fromRequest}`, path);\n\tif (request) {\n\t\tconst url$1 = getOrigin(request.url);\n\t\tif (!url$1) throw new BetterAuthError(\"Could not get origin from request. Please provide a valid base URL.\");\n\t\treturn withPath(url$1, path);\n\t}\n\tif (typeof window !== \"undefined\" && window.location) return withPath(window.location.origin, path);\n}\nfunction getOrigin(url) {\n\ttry {\n\t\tconst parsedUrl = new URL(url);\n\t\treturn parsedUrl.origin === \"null\" ? null : parsedUrl.origin;\n\t} catch (error) {\n\t\treturn null;\n\t}\n}\nfunction getProtocol(url) {\n\ttry {\n\t\treturn new URL(url).protocol;\n\t} catch (error) {\n\t\treturn null;\n\t}\n}\nfunction getHost(url) {\n\ttry {\n\t\treturn new URL(url).host;\n\t} catch (error) {\n\t\treturn null;\n\t}\n}\n\n//#endregion\nexport { getProtocol as i, getHost as n, getOrigin as r, getBaseURL as t };"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AACA;AAAA;;;AAEA,0BAA0B;AAC1B,SAAS,aAAa,GAAG;IACxB,IAAI;QACH,OAAO,CAAC,IAAI,IAAI,KAAK,QAAQ,CAAC,OAAO,CAAC,QAAQ,OAAO,GAAG,MAAM;IAC/D,EAAE,OAAO,OAAO;QACf,MAAM,IAAI,iOAAe,CAAC,CAAC,kBAAkB,EAAE,IAAI,kCAAkC,CAAC;IACvF;AACD;AACA,SAAS,kBAAkB,GAAG;IAC7B,IAAI;QACH,MAAM,YAAY,IAAI,IAAI;QAC1B,IAAI,UAAU,QAAQ,KAAK,WAAW,UAAU,QAAQ,KAAK,UAAU,MAAM,IAAI,iOAAe,CAAC,CAAC,kBAAkB,EAAE,IAAI,0CAA0C,CAAC;IACtK,EAAE,OAAO,OAAO;QACf,IAAI,iBAAiB,iOAAe,EAAE,MAAM;QAC5C,MAAM,IAAI,iOAAe,CAAC,CAAC,kBAAkB,EAAE,IAAI,kCAAkC,CAAC,EAAE,OAAO;IAChG;AACD;AACA,SAAS,SAAS,GAAG,EAAE,OAAO,WAAW;IACxC,kBAAkB;IAClB,IAAI,aAAa,MAAM,OAAO;IAC9B,MAAM,aAAa,IAAI,OAAO,CAAC,QAAQ;IACvC,IAAI,CAAC,QAAQ,SAAS,KAAK,OAAO;IAClC,OAAO,KAAK,UAAU,CAAC,OAAO,OAAO,CAAC,CAAC,EAAE,MAAM;IAC/C,OAAO,GAAG,aAAa,MAAM;AAC9B;AACA,SAAS,WAAW,GAAG,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,mBAAmB;IACnE,IAAI,KAAK,OAAO,SAAS,KAAK;IAC9B,IAAI,YAAY,OAAO;QACtB,MAAM,UAAU,uMAAG,CAAC,eAAe,IAAI,uMAAG,CAAC,2BAA2B,IAAI,uMAAG,CAAC,sBAAsB,IAAI,uMAAG,CAAC,2BAA2B,IAAI,uMAAG,CAAC,oBAAoB,IAAI,CAAC,uMAAG,CAAC,QAAQ,KAAK,MAAM,uMAAG,CAAC,QAAQ,GAAG,KAAK,CAAC;QACpN,IAAI,SAAS,OAAO,SAAS,SAAS;IACvC;IACA,MAAM,cAAc,SAAS,QAAQ,IAAI;IACzC,MAAM,mBAAmB,SAAS,QAAQ,IAAI;IAC9C,IAAI,eAAe,oBAAoB,qBAAqB,OAAO,SAAS,GAAG,iBAAiB,GAAG,EAAE,aAAa,EAAE;IACpH,IAAI,SAAS;QACZ,MAAM,QAAQ,UAAU,QAAQ,GAAG;QACnC,IAAI,CAAC,OAAO,MAAM,IAAI,iOAAe,CAAC;QACtC,OAAO,SAAS,OAAO;IACxB;IACA;;AACD;AACA,SAAS,UAAU,GAAG;IACrB,IAAI;QACH,MAAM,YAAY,IAAI,IAAI;QAC1B,OAAO,UAAU,MAAM,KAAK,SAAS,OAAO,UAAU,MAAM;IAC7D,EAAE,OAAO,OAAO;QACf,OAAO;IACR;AACD;AACA,SAAS,YAAY,GAAG;IACvB,IAAI;QACH,OAAO,IAAI,IAAI,KAAK,QAAQ;IAC7B,EAAE,OAAO,OAAO;QACf,OAAO;IACR;AACD;AACA,SAAS,QAAQ,GAAG;IACnB,IAAI;QACH,OAAO,IAAI,IAAI,KAAK,IAAI;IACzB,EAAE,OAAO,OAAO;QACf,OAAO;IACR;AACD","ignoreList":[0]}},
    {"offset": {"line": 2479, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/cookies-D72PbWdz.mjs"],"sourcesContent":["import { c as symmetricEncodeJWT, l as verifyJWT, o as signJWT, s as symmetricDecodeJWT } from \"./crypto-CFUhAR9W.mjs\";\nimport { l as parseUserOutput, u as getDate } from \"./schema-Bb7wzeK_.mjs\";\nimport { t as safeJSONParse } from \"./json-CnHxKYpj.mjs\";\nimport { t as getBaseURL } from \"./url-CB8xCwz-.mjs\";\nimport { env, isProduction } from \"@better-auth/core/env\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\nimport * as z from \"zod\";\nimport { base64Url } from \"@better-auth/utils/base64\";\nimport { binary } from \"@better-auth/utils/binary\";\nimport { createHMAC } from \"@better-auth/utils/hmac\";\nimport { ms } from \"ms\";\n\n//#region src/cookies/session-store.ts\nconst ALLOWED_COOKIE_SIZE = 4096;\nconst ESTIMATED_EMPTY_COOKIE_SIZE = 200;\nconst CHUNK_SIZE = ALLOWED_COOKIE_SIZE - ESTIMATED_EMPTY_COOKIE_SIZE;\n/**\n* Parse cookies from the request headers\n*/\nfunction parseCookiesFromContext(ctx) {\n\tconst cookieHeader = ctx.headers?.get(\"cookie\");\n\tif (!cookieHeader) return {};\n\tconst cookies = {};\n\tconst pairs = cookieHeader.split(\"; \");\n\tfor (const pair of pairs) {\n\t\tconst [name, ...valueParts] = pair.split(\"=\");\n\t\tif (name && valueParts.length > 0) cookies[name] = valueParts.join(\"=\");\n\t}\n\treturn cookies;\n}\n/**\n* Extract the chunk index from a cookie name\n*/\nfunction getChunkIndex(cookieName) {\n\tconst parts = cookieName.split(\".\");\n\tconst lastPart = parts[parts.length - 1];\n\tconst index = parseInt(lastPart || \"0\", 10);\n\treturn isNaN(index) ? 0 : index;\n}\n/**\n* Read all existing chunks from cookies\n*/\nfunction readExistingChunks(cookieName, ctx) {\n\tconst chunks = {};\n\tconst cookies = parseCookiesFromContext(ctx);\n\tfor (const [name, value] of Object.entries(cookies)) if (name.startsWith(cookieName)) chunks[name] = value;\n\treturn chunks;\n}\n/**\n* Get the full session data by joining all chunks\n*/\nfunction joinChunks(chunks) {\n\treturn Object.keys(chunks).sort((a, b) => {\n\t\treturn getChunkIndex(a) - getChunkIndex(b);\n\t}).map((key) => chunks[key]).join(\"\");\n}\n/**\n* Split a cookie value into chunks if needed\n*/\nfunction chunkCookie(storeName, cookie, chunks, logger$1) {\n\tconst chunkCount = Math.ceil(cookie.value.length / CHUNK_SIZE);\n\tif (chunkCount === 1) {\n\t\tchunks[cookie.name] = cookie.value;\n\t\treturn [cookie];\n\t}\n\tconst cookies = [];\n\tfor (let i = 0; i < chunkCount; i++) {\n\t\tconst name = `${cookie.name}.${i}`;\n\t\tconst start = i * CHUNK_SIZE;\n\t\tconst value = cookie.value.substring(start, start + CHUNK_SIZE);\n\t\tcookies.push({\n\t\t\t...cookie,\n\t\t\tname,\n\t\t\tvalue\n\t\t});\n\t\tchunks[name] = value;\n\t}\n\tlogger$1.debug(`CHUNKING_${storeName.toUpperCase()}_COOKIE`, {\n\t\tmessage: `${storeName} cookie exceeds allowed ${ALLOWED_COOKIE_SIZE} bytes.`,\n\t\temptyCookieSize: ESTIMATED_EMPTY_COOKIE_SIZE,\n\t\tvalueSize: cookie.value.length,\n\t\tchunkCount,\n\t\tchunks: cookies.map((c) => c.value.length + ESTIMATED_EMPTY_COOKIE_SIZE)\n\t});\n\treturn cookies;\n}\n/**\n* Get all cookies that should be cleaned (removed)\n*/\nfunction getCleanCookies(chunks, cookieOptions) {\n\tconst cleanedChunks = {};\n\tfor (const name in chunks) cleanedChunks[name] = {\n\t\tname,\n\t\tvalue: \"\",\n\t\toptions: {\n\t\t\t...cookieOptions,\n\t\t\tmaxAge: 0\n\t\t}\n\t};\n\treturn cleanedChunks;\n}\n/**\n* Create a session store for handling cookie chunking.\n* When session data exceeds 4KB, it automatically splits it into multiple cookies.\n*\n* Based on next-auth's SessionStore implementation.\n* @see https://github.com/nextauthjs/next-auth/blob/27b2519b84b8eb9cf053775dea29d577d2aa0098/packages/next-auth/src/core/lib/cookie.ts\n*/\nconst storeFactory = (storeName) => (cookieName, cookieOptions, ctx) => {\n\tconst chunks = readExistingChunks(cookieName, ctx);\n\tconst logger$1 = ctx.context.logger;\n\treturn {\n\t\tgetValue() {\n\t\t\treturn joinChunks(chunks);\n\t\t},\n\t\thasChunks() {\n\t\t\treturn Object.keys(chunks).length > 0;\n\t\t},\n\t\tchunk(value, options) {\n\t\t\tconst cleanedChunks = getCleanCookies(chunks, cookieOptions);\n\t\t\tfor (const name in chunks) delete chunks[name];\n\t\t\tconst cookies = cleanedChunks;\n\t\t\tconst chunked = chunkCookie(storeName, {\n\t\t\t\tname: cookieName,\n\t\t\t\tvalue,\n\t\t\t\toptions: {\n\t\t\t\t\t...cookieOptions,\n\t\t\t\t\t...options\n\t\t\t\t}\n\t\t\t}, chunks, logger$1);\n\t\t\tfor (const chunk of chunked) cookies[chunk.name] = chunk;\n\t\t\treturn Object.values(cookies);\n\t\t},\n\t\tclean() {\n\t\t\tconst cleanedChunks = getCleanCookies(chunks, cookieOptions);\n\t\t\tfor (const name in chunks) delete chunks[name];\n\t\t\treturn Object.values(cleanedChunks);\n\t\t},\n\t\tsetCookies(cookies) {\n\t\t\tfor (const cookie of cookies) ctx.setCookie(cookie.name, cookie.value, cookie.options);\n\t\t}\n\t};\n};\nconst createSessionStore = storeFactory(\"Session\");\nconst createAccountStore = storeFactory(\"Account\");\nfunction getChunkedCookie(ctx, cookieName) {\n\tconst value = ctx.getCookie(cookieName);\n\tif (value) return value;\n\tconst chunks = [];\n\tconst cookieHeader = ctx.headers?.get(\"cookie\");\n\tif (!cookieHeader) return null;\n\tconst cookies = {};\n\tconst pairs = cookieHeader.split(\"; \");\n\tfor (const pair of pairs) {\n\t\tconst [name, ...valueParts] = pair.split(\"=\");\n\t\tif (name && valueParts.length > 0) cookies[name] = valueParts.join(\"=\");\n\t}\n\tfor (const [name, val] of Object.entries(cookies)) if (name.startsWith(cookieName + \".\")) {\n\t\tconst indexStr = name.split(\".\").at(-1);\n\t\tconst index = parseInt(indexStr || \"0\", 10);\n\t\tif (!isNaN(index)) chunks.push({\n\t\t\tindex,\n\t\t\tvalue: val\n\t\t});\n\t}\n\tif (chunks.length > 0) {\n\t\tchunks.sort((a, b) => a.index - b.index);\n\t\treturn chunks.map((c) => c.value).join(\"\");\n\t}\n\treturn null;\n}\nasync function setAccountCookie(c, accountData) {\n\tconst accountDataCookie = c.context.authCookies.accountData;\n\tconst options = {\n\t\tmaxAge: 300,\n\t\t...accountDataCookie.options\n\t};\n\tconst data = await symmetricEncodeJWT(accountData, c.context.secret, \"better-auth-account\", options.maxAge);\n\tif (data.length > ALLOWED_COOKIE_SIZE) {\n\t\tconst accountStore = createAccountStore(accountDataCookie.name, options, c);\n\t\tconst cookies = accountStore.chunk(data, options);\n\t\taccountStore.setCookies(cookies);\n\t} else {\n\t\tconst accountStore = createAccountStore(accountDataCookie.name, options, c);\n\t\tif (accountStore.hasChunks()) {\n\t\t\tconst cleanCookies = accountStore.clean();\n\t\t\taccountStore.setCookies(cleanCookies);\n\t\t}\n\t\tc.setCookie(accountDataCookie.name, data, options);\n\t}\n}\nasync function getAccountCookie(c) {\n\tconst accountCookie = getChunkedCookie(c, c.context.authCookies.accountData.name);\n\tif (accountCookie) {\n\t\tconst accountData = safeJSONParse(await symmetricDecodeJWT(accountCookie, c.context.secret, \"better-auth-account\"));\n\t\tif (accountData) return accountData;\n\t}\n\treturn null;\n}\nconst getSessionQuerySchema = z.optional(z.object({\n\tdisableCookieCache: z.coerce.boolean().meta({ description: \"Disable cookie cache and fetch session from database\" }).optional(),\n\tdisableRefresh: z.coerce.boolean().meta({ description: \"Disable session refresh. Useful for checking session status, without updating the session\" }).optional()\n}));\n\n//#endregion\n//#region src/cookies/cookie-utils.ts\nfunction parseSetCookieHeader(setCookie) {\n\tconst cookies = /* @__PURE__ */ new Map();\n\tsetCookie.split(\", \").forEach((cookieString) => {\n\t\tconst [nameValue, ...attributes] = cookieString.split(\";\").map((part) => part.trim());\n\t\tconst [name, ...valueParts] = (nameValue || \"\").split(\"=\");\n\t\tconst value = valueParts.join(\"=\");\n\t\tif (!name || value === void 0) return;\n\t\tconst attrObj = { value };\n\t\tattributes.forEach((attribute) => {\n\t\t\tconst [attrName, ...attrValueParts] = attribute.split(\"=\");\n\t\t\tconst attrValue = attrValueParts.join(\"=\");\n\t\t\tconst normalizedAttrName = attrName.trim().toLowerCase();\n\t\t\tswitch (normalizedAttrName) {\n\t\t\t\tcase \"max-age\":\n\t\t\t\t\tattrObj[\"max-age\"] = attrValue ? parseInt(attrValue.trim(), 10) : void 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"expires\":\n\t\t\t\t\tattrObj.expires = attrValue ? new Date(attrValue.trim()) : void 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"domain\":\n\t\t\t\t\tattrObj.domain = attrValue ? attrValue.trim() : void 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"path\":\n\t\t\t\t\tattrObj.path = attrValue ? attrValue.trim() : void 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"secure\":\n\t\t\t\t\tattrObj.secure = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"httponly\":\n\t\t\t\t\tattrObj.httponly = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"samesite\":\n\t\t\t\t\tattrObj.samesite = attrValue ? attrValue.trim().toLowerCase() : void 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tattrObj[normalizedAttrName] = attrValue ? attrValue.trim() : true;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t\tcookies.set(name, attrObj);\n\t});\n\treturn cookies;\n}\nfunction setCookieToHeader(headers) {\n\treturn (context) => {\n\t\tconst setCookieHeader = context.response.headers.get(\"set-cookie\");\n\t\tif (!setCookieHeader) return;\n\t\tconst cookieMap = /* @__PURE__ */ new Map();\n\t\t(headers.get(\"cookie\") || \"\").split(\";\").forEach((cookie) => {\n\t\t\tconst [name, ...rest] = cookie.trim().split(\"=\");\n\t\t\tif (name && rest.length > 0) cookieMap.set(name, rest.join(\"=\"));\n\t\t});\n\t\tsetCookieHeader.split(\",\").forEach((header) => {\n\t\t\tparseSetCookieHeader(header).forEach((value, name) => {\n\t\t\t\tcookieMap.set(name, value.value);\n\t\t\t});\n\t\t});\n\t\tconst updatedCookies = Array.from(cookieMap.entries()).map(([name, value]) => `${name}=${value}`).join(\"; \");\n\t\theaders.set(\"cookie\", updatedCookies);\n\t};\n}\n\n//#endregion\n//#region src/cookies/index.ts\nfunction createCookieGetter(options) {\n\tconst secureCookiePrefix = (options.advanced?.useSecureCookies !== void 0 ? options.advanced?.useSecureCookies : options.baseURL !== void 0 ? options.baseURL.startsWith(\"https://\") ? true : false : isProduction) ? \"__Secure-\" : \"\";\n\tconst crossSubdomainEnabled = !!options.advanced?.crossSubDomainCookies?.enabled;\n\tconst domain = crossSubdomainEnabled ? options.advanced?.crossSubDomainCookies?.domain || (options.baseURL ? new URL(options.baseURL).hostname : void 0) : void 0;\n\tif (crossSubdomainEnabled && !domain) throw new BetterAuthError(\"baseURL is required when crossSubdomainCookies are enabled\");\n\tfunction createCookie(cookieName, overrideAttributes = {}) {\n\t\tconst prefix = options.advanced?.cookiePrefix || \"better-auth\";\n\t\tconst name = options.advanced?.cookies?.[cookieName]?.name || `${prefix}.${cookieName}`;\n\t\tconst attributes = options.advanced?.cookies?.[cookieName]?.attributes;\n\t\treturn {\n\t\t\tname: `${secureCookiePrefix}${name}`,\n\t\t\tattributes: {\n\t\t\t\tsecure: !!secureCookiePrefix,\n\t\t\t\tsameSite: \"lax\",\n\t\t\t\tpath: \"/\",\n\t\t\t\thttpOnly: true,\n\t\t\t\t...crossSubdomainEnabled ? { domain } : {},\n\t\t\t\t...options.advanced?.defaultCookieAttributes,\n\t\t\t\t...overrideAttributes,\n\t\t\t\t...attributes\n\t\t\t}\n\t\t};\n\t}\n\treturn createCookie;\n}\nfunction getCookies(options) {\n\tconst createCookie = createCookieGetter(options);\n\tconst sessionToken = createCookie(\"session_token\", { maxAge: options.session?.expiresIn || ms(\"7d\") / 1e3 });\n\tconst sessionData = createCookie(\"session_data\", { maxAge: options.session?.cookieCache?.maxAge || 300 });\n\tconst accountData = createCookie(\"account_data\", { maxAge: options.session?.cookieCache?.maxAge || 300 });\n\tconst dontRememberToken = createCookie(\"dont_remember\");\n\treturn {\n\t\tsessionToken: {\n\t\t\tname: sessionToken.name,\n\t\t\toptions: sessionToken.attributes\n\t\t},\n\t\tsessionData: {\n\t\t\tname: sessionData.name,\n\t\t\toptions: sessionData.attributes\n\t\t},\n\t\tdontRememberToken: {\n\t\t\tname: dontRememberToken.name,\n\t\t\toptions: dontRememberToken.attributes\n\t\t},\n\t\taccountData: {\n\t\t\tname: accountData.name,\n\t\t\toptions: accountData.attributes\n\t\t}\n\t};\n}\nasync function setCookieCache(ctx, session, dontRememberMe) {\n\tif (ctx.context.options.session?.cookieCache?.enabled) {\n\t\tconst filteredSession = Object.entries(session.session).reduce((acc, [key, value]) => {\n\t\t\tconst fieldConfig = ctx.context.options.session?.additionalFields?.[key];\n\t\t\tif (!fieldConfig || fieldConfig.returned !== false) acc[key] = value;\n\t\t\treturn acc;\n\t\t}, {});\n\t\tconst filteredUser = parseUserOutput(ctx.context.options, session.user);\n\t\tconst versionConfig = ctx.context.options.session?.cookieCache?.version;\n\t\tlet version = \"1\";\n\t\tif (versionConfig) {\n\t\t\tif (typeof versionConfig === \"string\") version = versionConfig;\n\t\t\telse if (typeof versionConfig === \"function\") {\n\t\t\t\tconst result = versionConfig(session.session, session.user);\n\t\t\t\tversion = result instanceof Promise ? await result : result;\n\t\t\t}\n\t\t}\n\t\tconst sessionData = {\n\t\t\tsession: filteredSession,\n\t\t\tuser: filteredUser,\n\t\t\tupdatedAt: Date.now(),\n\t\t\tversion\n\t\t};\n\t\tconst options = {\n\t\t\t...ctx.context.authCookies.sessionData.options,\n\t\t\tmaxAge: dontRememberMe ? void 0 : ctx.context.authCookies.sessionData.options.maxAge\n\t\t};\n\t\tconst expiresAtDate = getDate(options.maxAge || 60, \"sec\").getTime();\n\t\tconst strategy = ctx.context.options.session?.cookieCache?.strategy || \"compact\";\n\t\tlet data;\n\t\tif (strategy === \"jwe\") data = await symmetricEncodeJWT(sessionData, ctx.context.secret, \"better-auth-session\", options.maxAge || 300);\n\t\telse if (strategy === \"jwt\") data = await signJWT(sessionData, ctx.context.secret, options.maxAge || 300);\n\t\telse data = base64Url.encode(JSON.stringify({\n\t\t\tsession: sessionData,\n\t\t\texpiresAt: expiresAtDate,\n\t\t\tsignature: await createHMAC(\"SHA-256\", \"base64urlnopad\").sign(ctx.context.secret, JSON.stringify({\n\t\t\t\t...sessionData,\n\t\t\t\texpiresAt: expiresAtDate\n\t\t\t}))\n\t\t}), { padding: false });\n\t\tif (data.length > 4093) {\n\t\t\tconst sessionStore = createSessionStore(ctx.context.authCookies.sessionData.name, options, ctx);\n\t\t\tconst cookies = sessionStore.chunk(data, options);\n\t\t\tsessionStore.setCookies(cookies);\n\t\t} else {\n\t\t\tconst sessionStore = createSessionStore(ctx.context.authCookies.sessionData.name, options, ctx);\n\t\t\tif (sessionStore.hasChunks()) {\n\t\t\t\tconst cleanCookies = sessionStore.clean();\n\t\t\t\tsessionStore.setCookies(cleanCookies);\n\t\t\t}\n\t\t\tctx.setCookie(ctx.context.authCookies.sessionData.name, data, options);\n\t\t}\n\t}\n}\nasync function setSessionCookie(ctx, session, dontRememberMe, overrides) {\n\tconst dontRememberMeCookie = await ctx.getSignedCookie(ctx.context.authCookies.dontRememberToken.name, ctx.context.secret);\n\tdontRememberMe = dontRememberMe !== void 0 ? dontRememberMe : !!dontRememberMeCookie;\n\tconst options = ctx.context.authCookies.sessionToken.options;\n\tconst maxAge = dontRememberMe ? void 0 : ctx.context.sessionConfig.expiresIn;\n\tawait ctx.setSignedCookie(ctx.context.authCookies.sessionToken.name, session.session.token, ctx.context.secret, {\n\t\t...options,\n\t\tmaxAge,\n\t\t...overrides\n\t});\n\tif (dontRememberMe) await ctx.setSignedCookie(ctx.context.authCookies.dontRememberToken.name, \"true\", ctx.context.secret, ctx.context.authCookies.dontRememberToken.options);\n\tawait setCookieCache(ctx, session, dontRememberMe);\n\tctx.context.setNewSession(session);\n\t/**\n\t* If secondary storage is enabled, store the session data in the secondary storage\n\t* This is useful if the session got updated and we want to update the session data in the\n\t* secondary storage\n\t*/\n\tif (ctx.context.options.secondaryStorage) await ctx.context.secondaryStorage?.set(session.session.token, JSON.stringify({\n\t\tuser: session.user,\n\t\tsession: session.session\n\t}), Math.floor((new Date(session.session.expiresAt).getTime() - Date.now()) / 1e3));\n}\nfunction deleteSessionCookie(ctx, skipDontRememberMe) {\n\tctx.setCookie(ctx.context.authCookies.sessionToken.name, \"\", {\n\t\t...ctx.context.authCookies.sessionToken.options,\n\t\tmaxAge: 0\n\t});\n\tconst sessionStore = createSessionStore(ctx.context.authCookies.sessionData.name, ctx.context.authCookies.sessionData.options, ctx);\n\tconst cleanCookies = sessionStore.clean();\n\tsessionStore.setCookies(cleanCookies);\n\tif (!skipDontRememberMe) ctx.setCookie(ctx.context.authCookies.dontRememberToken.name, \"\", {\n\t\t...ctx.context.authCookies.dontRememberToken.options,\n\t\tmaxAge: 0\n\t});\n}\nfunction parseCookies(cookieHeader) {\n\tconst cookies = cookieHeader.split(\"; \");\n\tconst cookieMap = /* @__PURE__ */ new Map();\n\tcookies.forEach((cookie) => {\n\t\tconst [name, value] = cookie.split(\"=\");\n\t\tcookieMap.set(name, value);\n\t});\n\treturn cookieMap;\n}\nconst getSessionCookie = (request, config) => {\n\tif (config?.cookiePrefix) if (config.cookieName) config.cookiePrefix = `${config.cookiePrefix}-`;\n\telse config.cookiePrefix = `${config.cookiePrefix}.`;\n\tconst headers = \"headers\" in request ? request.headers : request;\n\tconst req = request instanceof Request ? request : void 0;\n\tgetBaseURL(req?.url, config?.path, req);\n\tconst cookies = headers.get(\"cookie\");\n\tif (!cookies) return null;\n\tconst { cookieName = \"session_token\", cookiePrefix = \"better-auth.\" } = config || {};\n\tconst name = `${cookiePrefix}${cookieName}`;\n\tconst secureCookieName = `__Secure-${name}`;\n\tconst parsedCookie = parseCookies(cookies);\n\tconst sessionToken = parsedCookie.get(name) || parsedCookie.get(secureCookieName);\n\tif (sessionToken) return sessionToken;\n\treturn null;\n};\nconst getCookieCache = async (request, config) => {\n\tconst cookies = (request instanceof Headers ? request : request.headers).get(\"cookie\");\n\tif (!cookies) return null;\n\tconst { cookieName = \"session_data\", cookiePrefix = \"better-auth\" } = config || {};\n\tconst name = config?.isSecure !== void 0 ? config.isSecure ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}` : isProduction ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}`;\n\tconst parsedCookie = parseCookies(cookies);\n\tlet sessionData = parsedCookie.get(name);\n\tif (!sessionData) {\n\t\tconst chunks = [];\n\t\tfor (const [cookieName$1, value] of parsedCookie.entries()) if (cookieName$1.startsWith(name + \".\")) {\n\t\t\tconst parts = cookieName$1.split(\".\");\n\t\t\tconst indexStr = parts[parts.length - 1];\n\t\t\tconst index = parseInt(indexStr || \"0\", 10);\n\t\t\tif (!isNaN(index)) chunks.push({\n\t\t\t\tindex,\n\t\t\t\tvalue\n\t\t\t});\n\t\t}\n\t\tif (chunks.length > 0) {\n\t\t\tchunks.sort((a, b) => a.index - b.index);\n\t\t\tsessionData = chunks.map((c) => c.value).join(\"\");\n\t\t}\n\t}\n\tif (sessionData) {\n\t\tconst secret = config?.secret || env.BETTER_AUTH_SECRET;\n\t\tif (!secret) throw new BetterAuthError(\"getCookieCache requires a secret to be provided. Either pass it as an option or set the BETTER_AUTH_SECRET environment variable\");\n\t\tconst strategy = config?.strategy || \"compact\";\n\t\tif (strategy === \"jwe\") {\n\t\t\tconst payload = await symmetricDecodeJWT(sessionData, secret, \"better-auth-session\");\n\t\t\tif (payload && payload.session && payload.user) {\n\t\t\t\tif (config?.version) {\n\t\t\t\t\tconst cookieVersion = payload.version || \"1\";\n\t\t\t\t\tlet expectedVersion = \"1\";\n\t\t\t\t\tif (typeof config.version === \"string\") expectedVersion = config.version;\n\t\t\t\t\telse if (typeof config.version === \"function\") {\n\t\t\t\t\t\tconst result = config.version(payload.session, payload.user);\n\t\t\t\t\t\texpectedVersion = result instanceof Promise ? await result : result;\n\t\t\t\t\t}\n\t\t\t\t\tif (cookieVersion !== expectedVersion) return null;\n\t\t\t\t}\n\t\t\t\treturn payload;\n\t\t\t}\n\t\t\treturn null;\n\t\t} else if (strategy === \"jwt\") {\n\t\t\tconst payload = await verifyJWT(sessionData, secret);\n\t\t\tif (payload && payload.session && payload.user) {\n\t\t\t\tif (config?.version) {\n\t\t\t\t\tconst cookieVersion = payload.version || \"1\";\n\t\t\t\t\tlet expectedVersion = \"1\";\n\t\t\t\t\tif (typeof config.version === \"string\") expectedVersion = config.version;\n\t\t\t\t\telse if (typeof config.version === \"function\") {\n\t\t\t\t\t\tconst result = config.version(payload.session, payload.user);\n\t\t\t\t\t\texpectedVersion = result instanceof Promise ? await result : result;\n\t\t\t\t\t}\n\t\t\t\t\tif (cookieVersion !== expectedVersion) return null;\n\t\t\t\t}\n\t\t\t\treturn payload;\n\t\t\t}\n\t\t\treturn null;\n\t\t} else {\n\t\t\tconst sessionDataPayload = safeJSONParse(binary.decode(base64Url.decode(sessionData)));\n\t\t\tif (!sessionDataPayload) return null;\n\t\t\tif (!await createHMAC(\"SHA-256\", \"base64urlnopad\").verify(secret, JSON.stringify({\n\t\t\t\t...sessionDataPayload.session,\n\t\t\t\texpiresAt: sessionDataPayload.expiresAt\n\t\t\t}), sessionDataPayload.signature)) return null;\n\t\t\tif (config?.version && sessionDataPayload.session) {\n\t\t\t\tconst cookieVersion = sessionDataPayload.session.version || \"1\";\n\t\t\t\tlet expectedVersion = \"1\";\n\t\t\t\tif (typeof config.version === \"string\") expectedVersion = config.version;\n\t\t\t\telse if (typeof config.version === \"function\") {\n\t\t\t\t\tconst result = config.version(sessionDataPayload.session.session, sessionDataPayload.session.user);\n\t\t\t\t\texpectedVersion = result instanceof Promise ? await result : result;\n\t\t\t\t}\n\t\t\t\tif (cookieVersion !== expectedVersion) return null;\n\t\t\t}\n\t\t\treturn sessionDataPayload.session;\n\t\t}\n\t}\n\treturn null;\n};\n\n//#endregion\nexport { getSessionCookie as a, setSessionCookie as c, createSessionStore as d, getAccountCookie as f, setAccountCookie as h, getCookies as i, parseSetCookieHeader as l, getSessionQuerySchema as m, deleteSessionCookie as n, parseCookies as o, getChunkedCookie as p, getCookieCache as r, setCookieCache as s, createCookieGetter as t, setCookieToHeader as u };"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AAEA,sCAAsC;AACtC,MAAM,sBAAsB;AAC5B,MAAM,8BAA8B;AACpC,MAAM,aAAa,sBAAsB;AACzC;;AAEA,GACA,SAAS,wBAAwB,GAAG;IACnC,MAAM,eAAe,IAAI,OAAO,EAAE,IAAI;IACtC,IAAI,CAAC,cAAc,OAAO,CAAC;IAC3B,MAAM,UAAU,CAAC;IACjB,MAAM,QAAQ,aAAa,KAAK,CAAC;IACjC,KAAK,MAAM,QAAQ,MAAO;QACzB,MAAM,CAAC,MAAM,GAAG,WAAW,GAAG,KAAK,KAAK,CAAC;QACzC,IAAI,QAAQ,WAAW,MAAM,GAAG,GAAG,OAAO,CAAC,KAAK,GAAG,WAAW,IAAI,CAAC;IACpE;IACA,OAAO;AACR;AACA;;AAEA,GACA,SAAS,cAAc,UAAU;IAChC,MAAM,QAAQ,WAAW,KAAK,CAAC;IAC/B,MAAM,WAAW,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE;IACxC,MAAM,QAAQ,SAAS,YAAY,KAAK;IACxC,OAAO,MAAM,SAAS,IAAI;AAC3B;AACA;;AAEA,GACA,SAAS,mBAAmB,UAAU,EAAE,GAAG;IAC1C,MAAM,SAAS,CAAC;IAChB,MAAM,UAAU,wBAAwB;IACxC,KAAK,MAAM,CAAC,MAAM,MAAM,IAAI,OAAO,OAAO,CAAC,SAAU,IAAI,KAAK,UAAU,CAAC,aAAa,MAAM,CAAC,KAAK,GAAG;IACrG,OAAO;AACR;AACA;;AAEA,GACA,SAAS,WAAW,MAAM;IACzB,OAAO,OAAO,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC,GAAG;QACnC,OAAO,cAAc,KAAK,cAAc;IACzC,GAAG,GAAG,CAAC,CAAC,MAAQ,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC;AACnC;AACA;;AAEA,GACA,SAAS,YAAY,SAAS,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ;IACvD,MAAM,aAAa,KAAK,IAAI,CAAC,OAAO,KAAK,CAAC,MAAM,GAAG;IACnD,IAAI,eAAe,GAAG;QACrB,MAAM,CAAC,OAAO,IAAI,CAAC,GAAG,OAAO,KAAK;QAClC,OAAO;YAAC;SAAO;IAChB;IACA,MAAM,UAAU,EAAE;IAClB,IAAK,IAAI,IAAI,GAAG,IAAI,YAAY,IAAK;QACpC,MAAM,OAAO,GAAG,OAAO,IAAI,CAAC,CAAC,EAAE,GAAG;QAClC,MAAM,QAAQ,IAAI;QAClB,MAAM,QAAQ,OAAO,KAAK,CAAC,SAAS,CAAC,OAAO,QAAQ;QACpD,QAAQ,IAAI,CAAC;YACZ,GAAG,MAAM;YACT;YACA;QACD;QACA,MAAM,CAAC,KAAK,GAAG;IAChB;IACA,SAAS,KAAK,CAAC,CAAC,SAAS,EAAE,UAAU,WAAW,GAAG,OAAO,CAAC,EAAE;QAC5D,SAAS,GAAG,UAAU,wBAAwB,EAAE,oBAAoB,OAAO,CAAC;QAC5E,iBAAiB;QACjB,WAAW,OAAO,KAAK,CAAC,MAAM;QAC9B;QACA,QAAQ,QAAQ,GAAG,CAAC,CAAC,IAAM,EAAE,KAAK,CAAC,MAAM,GAAG;IAC7C;IACA,OAAO;AACR;AACA;;AAEA,GACA,SAAS,gBAAgB,MAAM,EAAE,aAAa;IAC7C,MAAM,gBAAgB,CAAC;IACvB,IAAK,MAAM,QAAQ,OAAQ,aAAa,CAAC,KAAK,GAAG;QAChD;QACA,OAAO;QACP,SAAS;YACR,GAAG,aAAa;YAChB,QAAQ;QACT;IACD;IACA,OAAO;AACR;AACA;;;;;;AAMA,GACA,MAAM,eAAe,CAAC,YAAc,CAAC,YAAY,eAAe;QAC/D,MAAM,SAAS,mBAAmB,YAAY;QAC9C,MAAM,WAAW,IAAI,OAAO,CAAC,MAAM;QACnC,OAAO;YACN;gBACC,OAAO,WAAW;YACnB;YACA;gBACC,OAAO,OAAO,IAAI,CAAC,QAAQ,MAAM,GAAG;YACrC;YACA,OAAM,KAAK,EAAE,OAAO;gBACnB,MAAM,gBAAgB,gBAAgB,QAAQ;gBAC9C,IAAK,MAAM,QAAQ,OAAQ,OAAO,MAAM,CAAC,KAAK;gBAC9C,MAAM,UAAU;gBAChB,MAAM,UAAU,YAAY,WAAW;oBACtC,MAAM;oBACN;oBACA,SAAS;wBACR,GAAG,aAAa;wBAChB,GAAG,OAAO;oBACX;gBACD,GAAG,QAAQ;gBACX,KAAK,MAAM,SAAS,QAAS,OAAO,CAAC,MAAM,IAAI,CAAC,GAAG;gBACnD,OAAO,OAAO,MAAM,CAAC;YACtB;YACA;gBACC,MAAM,gBAAgB,gBAAgB,QAAQ;gBAC9C,IAAK,MAAM,QAAQ,OAAQ,OAAO,MAAM,CAAC,KAAK;gBAC9C,OAAO,OAAO,MAAM,CAAC;YACtB;YACA,YAAW,OAAO;gBACjB,KAAK,MAAM,UAAU,QAAS,IAAI,SAAS,CAAC,OAAO,IAAI,EAAE,OAAO,KAAK,EAAE,OAAO,OAAO;YACtF;QACD;IACD;AACA,MAAM,qBAAqB,aAAa;AACxC,MAAM,qBAAqB,aAAa;AACxC,SAAS,iBAAiB,GAAG,EAAE,UAAU;IACxC,MAAM,QAAQ,IAAI,SAAS,CAAC;IAC5B,IAAI,OAAO,OAAO;IAClB,MAAM,SAAS,EAAE;IACjB,MAAM,eAAe,IAAI,OAAO,EAAE,IAAI;IACtC,IAAI,CAAC,cAAc,OAAO;IAC1B,MAAM,UAAU,CAAC;IACjB,MAAM,QAAQ,aAAa,KAAK,CAAC;IACjC,KAAK,MAAM,QAAQ,MAAO;QACzB,MAAM,CAAC,MAAM,GAAG,WAAW,GAAG,KAAK,KAAK,CAAC;QACzC,IAAI,QAAQ,WAAW,MAAM,GAAG,GAAG,OAAO,CAAC,KAAK,GAAG,WAAW,IAAI,CAAC;IACpE;IACA,KAAK,MAAM,CAAC,MAAM,IAAI,IAAI,OAAO,OAAO,CAAC,SAAU,IAAI,KAAK,UAAU,CAAC,aAAa,MAAM;QACzF,MAAM,WAAW,KAAK,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;QACrC,MAAM,QAAQ,SAAS,YAAY,KAAK;QACxC,IAAI,CAAC,MAAM,QAAQ,OAAO,IAAI,CAAC;YAC9B;YACA,OAAO;QACR;IACD;IACA,IAAI,OAAO,MAAM,GAAG,GAAG;QACtB,OAAO,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,KAAK,GAAG,EAAE,KAAK;QACvC,OAAO,OAAO,GAAG,CAAC,CAAC,IAAM,EAAE,KAAK,EAAE,IAAI,CAAC;IACxC;IACA,OAAO;AACR;AACA,eAAe,iBAAiB,CAAC,EAAE,WAAW;IAC7C,MAAM,oBAAoB,EAAE,OAAO,CAAC,WAAW,CAAC,WAAW;IAC3D,MAAM,UAAU;QACf,QAAQ;QACR,GAAG,kBAAkB,OAAO;IAC7B;IACA,MAAM,OAAO,MAAM,IAAA,kKAAkB,EAAC,aAAa,EAAE,OAAO,CAAC,MAAM,EAAE,uBAAuB,QAAQ,MAAM;IAC1G,IAAI,KAAK,MAAM,GAAG,qBAAqB;QACtC,MAAM,eAAe,mBAAmB,kBAAkB,IAAI,EAAE,SAAS;QACzE,MAAM,UAAU,aAAa,KAAK,CAAC,MAAM;QACzC,aAAa,UAAU,CAAC;IACzB,OAAO;QACN,MAAM,eAAe,mBAAmB,kBAAkB,IAAI,EAAE,SAAS;QACzE,IAAI,aAAa,SAAS,IAAI;YAC7B,MAAM,eAAe,aAAa,KAAK;YACvC,aAAa,UAAU,CAAC;QACzB;QACA,EAAE,SAAS,CAAC,kBAAkB,IAAI,EAAE,MAAM;IAC3C;AACD;AACA,eAAe,iBAAiB,CAAC;IAChC,MAAM,gBAAgB,iBAAiB,GAAG,EAAE,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI;IAChF,IAAI,eAAe;QAClB,MAAM,cAAc,IAAA,gKAAa,EAAC,MAAM,IAAA,kKAAkB,EAAC,eAAe,EAAE,OAAO,CAAC,MAAM,EAAE;QAC5F,IAAI,aAAa,OAAO;IACzB;IACA,OAAO;AACR;AACA,MAAM,wBAAwB,2JAAU,CAAC,yJAAQ,CAAC;IACjD,oBAAoB,0JAAQ,CAAC,OAAO,GAAG,IAAI,CAAC;QAAE,aAAa;IAAuD,GAAG,QAAQ;IAC7H,gBAAgB,0JAAQ,CAAC,OAAO,GAAG,IAAI,CAAC;QAAE,aAAa;IAA4F,GAAG,QAAQ;AAC/J;AAEA,YAAY;AACZ,qCAAqC;AACrC,SAAS,qBAAqB,SAAS;IACtC,MAAM,UAAU,aAAa,GAAG,IAAI;IACpC,UAAU,KAAK,CAAC,MAAM,OAAO,CAAC,CAAC;QAC9B,MAAM,CAAC,WAAW,GAAG,WAAW,GAAG,aAAa,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,OAAS,KAAK,IAAI;QAClF,MAAM,CAAC,MAAM,GAAG,WAAW,GAAG,CAAC,aAAa,EAAE,EAAE,KAAK,CAAC;QACtD,MAAM,QAAQ,WAAW,IAAI,CAAC;QAC9B,IAAI,CAAC,QAAQ,UAAU,KAAK,GAAG;QAC/B,MAAM,UAAU;YAAE;QAAM;QACxB,WAAW,OAAO,CAAC,CAAC;YACnB,MAAM,CAAC,UAAU,GAAG,eAAe,GAAG,UAAU,KAAK,CAAC;YACtD,MAAM,YAAY,eAAe,IAAI,CAAC;YACtC,MAAM,qBAAqB,SAAS,IAAI,GAAG,WAAW;YACtD,OAAQ;gBACP,KAAK;oBACJ,OAAO,CAAC,UAAU,GAAG,YAAY,SAAS,UAAU,IAAI,IAAI,MAAM,KAAK;oBACvE;gBACD,KAAK;oBACJ,QAAQ,OAAO,GAAG,YAAY,IAAI,KAAK,UAAU,IAAI,MAAM,KAAK;oBAChE;gBACD,KAAK;oBACJ,QAAQ,MAAM,GAAG,YAAY,UAAU,IAAI,KAAK,KAAK;oBACrD;gBACD,KAAK;oBACJ,QAAQ,IAAI,GAAG,YAAY,UAAU,IAAI,KAAK,KAAK;oBACnD;gBACD,KAAK;oBACJ,QAAQ,MAAM,GAAG;oBACjB;gBACD,KAAK;oBACJ,QAAQ,QAAQ,GAAG;oBACnB;gBACD,KAAK;oBACJ,QAAQ,QAAQ,GAAG,YAAY,UAAU,IAAI,GAAG,WAAW,KAAK,KAAK;oBACrE;gBACD;oBACC,OAAO,CAAC,mBAAmB,GAAG,YAAY,UAAU,IAAI,KAAK;oBAC7D;YACF;QACD;QACA,QAAQ,GAAG,CAAC,MAAM;IACnB;IACA,OAAO;AACR;AACA,SAAS,kBAAkB,OAAO;IACjC,OAAO,CAAC;QACP,MAAM,kBAAkB,QAAQ,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC;QACrD,IAAI,CAAC,iBAAiB;QACtB,MAAM,YAAY,aAAa,GAAG,IAAI;QACtC,CAAC,QAAQ,GAAG,CAAC,aAAa,EAAE,EAAE,KAAK,CAAC,KAAK,OAAO,CAAC,CAAC;YACjD,MAAM,CAAC,MAAM,GAAG,KAAK,GAAG,OAAO,IAAI,GAAG,KAAK,CAAC;YAC5C,IAAI,QAAQ,KAAK,MAAM,GAAG,GAAG,UAAU,GAAG,CAAC,MAAM,KAAK,IAAI,CAAC;QAC5D;QACA,gBAAgB,KAAK,CAAC,KAAK,OAAO,CAAC,CAAC;YACnC,qBAAqB,QAAQ,OAAO,CAAC,CAAC,OAAO;gBAC5C,UAAU,GAAG,CAAC,MAAM,MAAM,KAAK;YAChC;QACD;QACA,MAAM,iBAAiB,MAAM,IAAI,CAAC,UAAU,OAAO,IAAI,GAAG,CAAC,CAAC,CAAC,MAAM,MAAM,GAAK,GAAG,KAAK,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC;QACvG,QAAQ,GAAG,CAAC,UAAU;IACvB;AACD;AAEA,YAAY;AACZ,8BAA8B;AAC9B,SAAS,mBAAmB,OAAO;IAClC,MAAM,qBAAqB,CAAC,QAAQ,QAAQ,EAAE,qBAAqB,KAAK,IAAI,QAAQ,QAAQ,EAAE,mBAAmB,QAAQ,OAAO,KAAK,KAAK,IAAI,QAAQ,OAAO,CAAC,UAAU,CAAC,cAAc,OAAO,QAAQ,yNAAY,IAAI,cAAc;IACpO,MAAM,wBAAwB,CAAC,CAAC,QAAQ,QAAQ,EAAE,uBAAuB;IACzE,MAAM,SAAS,wBAAwB,QAAQ,QAAQ,EAAE,uBAAuB,UAAU,CAAC,QAAQ,OAAO,GAAG,IAAI,IAAI,QAAQ,OAAO,EAAE,QAAQ,GAAG,KAAK,CAAC,IAAI,KAAK;IAChK,IAAI,yBAAyB,CAAC,QAAQ,MAAM,IAAI,iOAAe,CAAC;IAChE,SAAS,aAAa,UAAU,EAAE,qBAAqB,CAAC,CAAC;QACxD,MAAM,SAAS,QAAQ,QAAQ,EAAE,gBAAgB;QACjD,MAAM,OAAO,QAAQ,QAAQ,EAAE,SAAS,CAAC,WAAW,EAAE,QAAQ,GAAG,OAAO,CAAC,EAAE,YAAY;QACvF,MAAM,aAAa,QAAQ,QAAQ,EAAE,SAAS,CAAC,WAAW,EAAE;QAC5D,OAAO;YACN,MAAM,GAAG,qBAAqB,MAAM;YACpC,YAAY;gBACX,QAAQ,CAAC,CAAC;gBACV,UAAU;gBACV,MAAM;gBACN,UAAU;gBACV,GAAG,wBAAwB;oBAAE;gBAAO,IAAI,CAAC,CAAC;gBAC1C,GAAG,QAAQ,QAAQ,EAAE,uBAAuB;gBAC5C,GAAG,kBAAkB;gBACrB,GAAG,UAAU;YACd;QACD;IACD;IACA,OAAO;AACR;AACA,SAAS,WAAW,OAAO;IAC1B,MAAM,eAAe,mBAAmB;IACxC,MAAM,eAAe,aAAa,iBAAiB;QAAE,QAAQ,QAAQ,OAAO,EAAE,aAAa,IAAA,2KAAE,EAAC,QAAQ;IAAI;IAC1G,MAAM,cAAc,aAAa,gBAAgB;QAAE,QAAQ,QAAQ,OAAO,EAAE,aAAa,UAAU;IAAI;IACvG,MAAM,cAAc,aAAa,gBAAgB;QAAE,QAAQ,QAAQ,OAAO,EAAE,aAAa,UAAU;IAAI;IACvG,MAAM,oBAAoB,aAAa;IACvC,OAAO;QACN,cAAc;YACb,MAAM,aAAa,IAAI;YACvB,SAAS,aAAa,UAAU;QACjC;QACA,aAAa;YACZ,MAAM,YAAY,IAAI;YACtB,SAAS,YAAY,UAAU;QAChC;QACA,mBAAmB;YAClB,MAAM,kBAAkB,IAAI;YAC5B,SAAS,kBAAkB,UAAU;QACtC;QACA,aAAa;YACZ,MAAM,YAAY,IAAI;YACtB,SAAS,YAAY,UAAU;QAChC;IACD;AACD;AACA,eAAe,eAAe,GAAG,EAAE,OAAO,EAAE,cAAc;IACzD,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,aAAa,SAAS;QACtD,MAAM,kBAAkB,OAAO,OAAO,CAAC,QAAQ,OAAO,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,MAAM;YAChF,MAAM,cAAc,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,kBAAkB,CAAC,IAAI;YACxE,IAAI,CAAC,eAAe,YAAY,QAAQ,KAAK,OAAO,GAAG,CAAC,IAAI,GAAG;YAC/D,OAAO;QACR,GAAG,CAAC;QACJ,MAAM,eAAe,IAAA,kKAAe,EAAC,IAAI,OAAO,CAAC,OAAO,EAAE,QAAQ,IAAI;QACtE,MAAM,gBAAgB,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,aAAa;QAChE,IAAI,UAAU;QACd,IAAI,eAAe;YAClB,IAAI,OAAO,kBAAkB,UAAU,UAAU;iBAC5C,IAAI,OAAO,kBAAkB,YAAY;gBAC7C,MAAM,SAAS,cAAc,QAAQ,OAAO,EAAE,QAAQ,IAAI;gBAC1D,UAAU,kBAAkB,UAAU,MAAM,SAAS;YACtD;QACD;QACA,MAAM,cAAc;YACnB,SAAS;YACT,MAAM;YACN,WAAW,KAAK,GAAG;YACnB;QACD;QACA,MAAM,UAAU;YACf,GAAG,IAAI,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,OAAO;YAC9C,QAAQ,iBAAiB,KAAK,IAAI,IAAI,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,MAAM;QACrF;QACA,MAAM,gBAAgB,IAAA,kKAAO,EAAC,QAAQ,MAAM,IAAI,IAAI,OAAO,OAAO;QAClE,MAAM,WAAW,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,aAAa,YAAY;QACvE,IAAI;QACJ,IAAI,aAAa,OAAO,OAAO,MAAM,IAAA,kKAAkB,EAAC,aAAa,IAAI,OAAO,CAAC,MAAM,EAAE,uBAAuB,QAAQ,MAAM,IAAI;aAC7H,IAAI,aAAa,OAAO,OAAO,MAAM,IAAA,kKAAO,EAAC,aAAa,IAAI,OAAO,CAAC,MAAM,EAAE,QAAQ,MAAM,IAAI;aAChG,OAAO,yKAAS,CAAC,MAAM,CAAC,KAAK,SAAS,CAAC;YAC3C,SAAS;YACT,WAAW;YACX,WAAW,MAAM,IAAA,wKAAU,EAAC,WAAW,kBAAkB,IAAI,CAAC,IAAI,OAAO,CAAC,MAAM,EAAE,KAAK,SAAS,CAAC;gBAChG,GAAG,WAAW;gBACd,WAAW;YACZ;QACD,IAAI;YAAE,SAAS;QAAM;QACrB,IAAI,KAAK,MAAM,GAAG,MAAM;YACvB,MAAM,eAAe,mBAAmB,IAAI,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS;YAC3F,MAAM,UAAU,aAAa,KAAK,CAAC,MAAM;YACzC,aAAa,UAAU,CAAC;QACzB,OAAO;YACN,MAAM,eAAe,mBAAmB,IAAI,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS;YAC3F,IAAI,aAAa,SAAS,IAAI;gBAC7B,MAAM,eAAe,aAAa,KAAK;gBACvC,aAAa,UAAU,CAAC;YACzB;YACA,IAAI,SAAS,CAAC,IAAI,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,MAAM;QAC/D;IACD;AACD;AACA,eAAe,iBAAiB,GAAG,EAAE,OAAO,EAAE,cAAc,EAAE,SAAS;IACtE,MAAM,uBAAuB,MAAM,IAAI,eAAe,CAAC,IAAI,OAAO,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,OAAO,CAAC,MAAM;IACzH,iBAAiB,mBAAmB,KAAK,IAAI,iBAAiB,CAAC,CAAC;IAChE,MAAM,UAAU,IAAI,OAAO,CAAC,WAAW,CAAC,YAAY,CAAC,OAAO;IAC5D,MAAM,SAAS,iBAAiB,KAAK,IAAI,IAAI,OAAO,CAAC,aAAa,CAAC,SAAS;IAC5E,MAAM,IAAI,eAAe,CAAC,IAAI,OAAO,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,OAAO,CAAC,KAAK,EAAE,IAAI,OAAO,CAAC,MAAM,EAAE;QAC/G,GAAG,OAAO;QACV;QACA,GAAG,SAAS;IACb;IACA,IAAI,gBAAgB,MAAM,IAAI,eAAe,CAAC,IAAI,OAAO,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,EAAE,QAAQ,IAAI,OAAO,CAAC,MAAM,EAAE,IAAI,OAAO,CAAC,WAAW,CAAC,iBAAiB,CAAC,OAAO;IAC3K,MAAM,eAAe,KAAK,SAAS;IACnC,IAAI,OAAO,CAAC,aAAa,CAAC;IAC1B;;;;CAIA,GACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,EAAE,MAAM,IAAI,OAAO,CAAC,gBAAgB,EAAE,IAAI,QAAQ,OAAO,CAAC,KAAK,EAAE,KAAK,SAAS,CAAC;QACvH,MAAM,QAAQ,IAAI;QAClB,SAAS,QAAQ,OAAO;IACzB,IAAI,KAAK,KAAK,CAAC,CAAC,IAAI,KAAK,QAAQ,OAAO,CAAC,SAAS,EAAE,OAAO,KAAK,KAAK,GAAG,EAAE,IAAI;AAC/E;AACA,SAAS,oBAAoB,GAAG,EAAE,kBAAkB;IACnD,IAAI,SAAS,CAAC,IAAI,OAAO,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI;QAC5D,GAAG,IAAI,OAAO,CAAC,WAAW,CAAC,YAAY,CAAC,OAAO;QAC/C,QAAQ;IACT;IACA,MAAM,eAAe,mBAAmB,IAAI,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,OAAO,EAAE;IAC/H,MAAM,eAAe,aAAa,KAAK;IACvC,aAAa,UAAU,CAAC;IACxB,IAAI,CAAC,oBAAoB,IAAI,SAAS,CAAC,IAAI,OAAO,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI;QAC1F,GAAG,IAAI,OAAO,CAAC,WAAW,CAAC,iBAAiB,CAAC,OAAO;QACpD,QAAQ;IACT;AACD;AACA,SAAS,aAAa,YAAY;IACjC,MAAM,UAAU,aAAa,KAAK,CAAC;IACnC,MAAM,YAAY,aAAa,GAAG,IAAI;IACtC,QAAQ,OAAO,CAAC,CAAC;QAChB,MAAM,CAAC,MAAM,MAAM,GAAG,OAAO,KAAK,CAAC;QACnC,UAAU,GAAG,CAAC,MAAM;IACrB;IACA,OAAO;AACR;AACA,MAAM,mBAAmB,CAAC,SAAS;IAClC,IAAI,QAAQ,cAAc,IAAI,OAAO,UAAU,EAAE,OAAO,YAAY,GAAG,GAAG,OAAO,YAAY,CAAC,CAAC,CAAC;SAC3F,OAAO,YAAY,GAAG,GAAG,OAAO,YAAY,CAAC,CAAC,CAAC;IACpD,MAAM,UAAU,aAAa,UAAU,QAAQ,OAAO,GAAG;IACzD,MAAM,MAAM,mBAAmB,UAAU,UAAU,KAAK;IACxD,IAAA,gKAAU,EAAC,KAAK,KAAK,QAAQ,MAAM;IACnC,MAAM,UAAU,QAAQ,GAAG,CAAC;IAC5B,IAAI,CAAC,SAAS,OAAO;IACrB,MAAM,EAAE,aAAa,eAAe,EAAE,eAAe,cAAc,EAAE,GAAG,UAAU,CAAC;IACnF,MAAM,OAAO,GAAG,eAAe,YAAY;IAC3C,MAAM,mBAAmB,CAAC,SAAS,EAAE,MAAM;IAC3C,MAAM,eAAe,aAAa;IAClC,MAAM,eAAe,aAAa,GAAG,CAAC,SAAS,aAAa,GAAG,CAAC;IAChE,IAAI,cAAc,OAAO;IACzB,OAAO;AACR;AACA,MAAM,iBAAiB,OAAO,SAAS;IACtC,MAAM,UAAU,CAAC,mBAAmB,UAAU,UAAU,QAAQ,OAAO,EAAE,GAAG,CAAC;IAC7E,IAAI,CAAC,SAAS,OAAO;IACrB,MAAM,EAAE,aAAa,cAAc,EAAE,eAAe,aAAa,EAAE,GAAG,UAAU,CAAC;IACjF,MAAM,OAAO,QAAQ,aAAa,KAAK,IAAI,OAAO,QAAQ,GAAG,CAAC,SAAS,EAAE,aAAa,CAAC,EAAE,YAAY,GAAG,GAAG,aAAa,CAAC,EAAE,YAAY,GAAG,yNAAY,GAAG,CAAC,SAAS,EAAE,aAAa,CAAC,EAAE,YAAY,GAAG,GAAG,aAAa,CAAC,EAAE,YAAY;IACnO,MAAM,eAAe,aAAa;IAClC,IAAI,cAAc,aAAa,GAAG,CAAC;IACnC,IAAI,CAAC,aAAa;QACjB,MAAM,SAAS,EAAE;QACjB,KAAK,MAAM,CAAC,cAAc,MAAM,IAAI,aAAa,OAAO,GAAI,IAAI,aAAa,UAAU,CAAC,OAAO,MAAM;YACpG,MAAM,QAAQ,aAAa,KAAK,CAAC;YACjC,MAAM,WAAW,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE;YACxC,MAAM,QAAQ,SAAS,YAAY,KAAK;YACxC,IAAI,CAAC,MAAM,QAAQ,OAAO,IAAI,CAAC;gBAC9B;gBACA;YACD;QACD;QACA,IAAI,OAAO,MAAM,GAAG,GAAG;YACtB,OAAO,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,KAAK,GAAG,EAAE,KAAK;YACvC,cAAc,OAAO,GAAG,CAAC,CAAC,IAAM,EAAE,KAAK,EAAE,IAAI,CAAC;QAC/C;IACD;IACA,IAAI,aAAa;QAChB,MAAM,SAAS,QAAQ,UAAU,uMAAG,CAAC,kBAAkB;QACvD,IAAI,CAAC,QAAQ,MAAM,IAAI,iOAAe,CAAC;QACvC,MAAM,WAAW,QAAQ,YAAY;QACrC,IAAI,aAAa,OAAO;YACvB,MAAM,UAAU,MAAM,IAAA,kKAAkB,EAAC,aAAa,QAAQ;YAC9D,IAAI,WAAW,QAAQ,OAAO,IAAI,QAAQ,IAAI,EAAE;gBAC/C,IAAI,QAAQ,SAAS;oBACpB,MAAM,gBAAgB,QAAQ,OAAO,IAAI;oBACzC,IAAI,kBAAkB;oBACtB,IAAI,OAAO,OAAO,OAAO,KAAK,UAAU,kBAAkB,OAAO,OAAO;yBACnE,IAAI,OAAO,OAAO,OAAO,KAAK,YAAY;wBAC9C,MAAM,SAAS,OAAO,OAAO,CAAC,QAAQ,OAAO,EAAE,QAAQ,IAAI;wBAC3D,kBAAkB,kBAAkB,UAAU,MAAM,SAAS;oBAC9D;oBACA,IAAI,kBAAkB,iBAAiB,OAAO;gBAC/C;gBACA,OAAO;YACR;YACA,OAAO;QACR,OAAO,IAAI,aAAa,OAAO;YAC9B,MAAM,UAAU,MAAM,IAAA,kKAAS,EAAC,aAAa;YAC7C,IAAI,WAAW,QAAQ,OAAO,IAAI,QAAQ,IAAI,EAAE;gBAC/C,IAAI,QAAQ,SAAS;oBACpB,MAAM,gBAAgB,QAAQ,OAAO,IAAI;oBACzC,IAAI,kBAAkB;oBACtB,IAAI,OAAO,OAAO,OAAO,KAAK,UAAU,kBAAkB,OAAO,OAAO;yBACnE,IAAI,OAAO,OAAO,OAAO,KAAK,YAAY;wBAC9C,MAAM,SAAS,OAAO,OAAO,CAAC,QAAQ,OAAO,EAAE,QAAQ,IAAI;wBAC3D,kBAAkB,kBAAkB,UAAU,MAAM,SAAS;oBAC9D;oBACA,IAAI,kBAAkB,iBAAiB,OAAO;gBAC/C;gBACA,OAAO;YACR;YACA,OAAO;QACR,OAAO;YACN,MAAM,qBAAqB,IAAA,gKAAa,EAAC,sKAAM,CAAC,MAAM,CAAC,yKAAS,CAAC,MAAM,CAAC;YACxE,IAAI,CAAC,oBAAoB,OAAO;YAChC,IAAI,CAAC,MAAM,IAAA,wKAAU,EAAC,WAAW,kBAAkB,MAAM,CAAC,QAAQ,KAAK,SAAS,CAAC;gBAChF,GAAG,mBAAmB,OAAO;gBAC7B,WAAW,mBAAmB,SAAS;YACxC,IAAI,mBAAmB,SAAS,GAAG,OAAO;YAC1C,IAAI,QAAQ,WAAW,mBAAmB,OAAO,EAAE;gBAClD,MAAM,gBAAgB,mBAAmB,OAAO,CAAC,OAAO,IAAI;gBAC5D,IAAI,kBAAkB;gBACtB,IAAI,OAAO,OAAO,OAAO,KAAK,UAAU,kBAAkB,OAAO,OAAO;qBACnE,IAAI,OAAO,OAAO,OAAO,KAAK,YAAY;oBAC9C,MAAM,SAAS,OAAO,OAAO,CAAC,mBAAmB,OAAO,CAAC,OAAO,EAAE,mBAAmB,OAAO,CAAC,IAAI;oBACjG,kBAAkB,kBAAkB,UAAU,MAAM,SAAS;gBAC9D;gBACA,IAAI,kBAAkB,iBAAiB,OAAO;YAC/C;YACA,OAAO,mBAAmB,OAAO;QAClC;IACD;IACA,OAAO;AACR","ignoreList":[0]}},
    {"offset": {"line": 3054, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/session-AaRl3_x-.mjs"],"sourcesContent":["import { l as verifyJWT, s as symmetricDecodeJWT } from \"./crypto-CFUhAR9W.mjs\";\nimport { l as parseUserOutput, s as parseSessionOutput, u as getDate } from \"./schema-Bb7wzeK_.mjs\";\nimport { t as safeJSONParse } from \"./json-CnHxKYpj.mjs\";\nimport { c as setSessionCookie, m as getSessionQuerySchema, n as deleteSessionCookie, p as getChunkedCookie, s as setCookieCache } from \"./cookies-D72PbWdz.mjs\";\nimport { BASE_ERROR_CODES } from \"@better-auth/core/error\";\nimport { APIError } from \"better-call\";\nimport * as z from \"zod\";\nimport { createAuthEndpoint, createAuthMiddleware } from \"@better-auth/core/api\";\nimport { base64Url } from \"@better-auth/utils/base64\";\nimport { binary } from \"@better-auth/utils/binary\";\nimport { createHMAC } from \"@better-auth/utils/hmac\";\n\n//#region src/api/routes/session.ts\nconst getSession = () => createAuthEndpoint(\"/get-session\", {\n\tmethod: \"GET\",\n\toperationId: \"getSession\",\n\tquery: getSessionQuerySchema,\n\trequireHeaders: true,\n\tmetadata: { openapi: {\n\t\toperationId: \"getSession\",\n\t\tdescription: \"Get the current session\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\tsession: { $ref: \"#/components/schemas/Session\" },\n\t\t\t\t\tuser: { $ref: \"#/components/schemas/User\" }\n\t\t\t\t},\n\t\t\t\trequired: [\"session\", \"user\"]\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\ttry {\n\t\tconst sessionCookieToken = await ctx.getSignedCookie(ctx.context.authCookies.sessionToken.name, ctx.context.secret);\n\t\tif (!sessionCookieToken) return null;\n\t\tconst sessionDataCookie = getChunkedCookie(ctx, ctx.context.authCookies.sessionData.name);\n\t\tlet sessionDataPayload = null;\n\t\tif (sessionDataCookie) {\n\t\t\tconst strategy = ctx.context.options.session?.cookieCache?.strategy || \"compact\";\n\t\t\tif (strategy === \"jwe\") {\n\t\t\t\tconst payload = await symmetricDecodeJWT(sessionDataCookie, ctx.context.secret, \"better-auth-session\");\n\t\t\t\tif (payload && payload.session && payload.user) sessionDataPayload = {\n\t\t\t\t\tsession: {\n\t\t\t\t\t\tsession: payload.session,\n\t\t\t\t\t\tuser: payload.user,\n\t\t\t\t\t\tupdatedAt: payload.updatedAt,\n\t\t\t\t\t\tversion: payload.version\n\t\t\t\t\t},\n\t\t\t\t\texpiresAt: payload.exp ? payload.exp * 1e3 : Date.now()\n\t\t\t\t};\n\t\t\t\telse {\n\t\t\t\t\tconst dataCookie = ctx.context.authCookies.sessionData.name;\n\t\t\t\t\tctx.setCookie(dataCookie, \"\", { maxAge: 0 });\n\t\t\t\t\treturn ctx.json(null);\n\t\t\t\t}\n\t\t\t} else if (strategy === \"jwt\") {\n\t\t\t\tconst payload = await verifyJWT(sessionDataCookie, ctx.context.secret);\n\t\t\t\tif (payload && payload.session && payload.user) sessionDataPayload = {\n\t\t\t\t\tsession: {\n\t\t\t\t\t\tsession: payload.session,\n\t\t\t\t\t\tuser: payload.user,\n\t\t\t\t\t\tupdatedAt: payload.updatedAt,\n\t\t\t\t\t\tversion: payload.version\n\t\t\t\t\t},\n\t\t\t\t\texpiresAt: payload.exp ? payload.exp * 1e3 : Date.now()\n\t\t\t\t};\n\t\t\t\telse {\n\t\t\t\t\tconst dataCookie = ctx.context.authCookies.sessionData.name;\n\t\t\t\t\tctx.setCookie(dataCookie, \"\", { maxAge: 0 });\n\t\t\t\t\treturn ctx.json(null);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst parsed = safeJSONParse(binary.decode(base64Url.decode(sessionDataCookie)));\n\t\t\t\tif (parsed) if (await createHMAC(\"SHA-256\", \"base64urlnopad\").verify(ctx.context.secret, JSON.stringify({\n\t\t\t\t\t...parsed.session,\n\t\t\t\t\texpiresAt: parsed.expiresAt\n\t\t\t\t}), parsed.signature)) sessionDataPayload = parsed;\n\t\t\t\telse {\n\t\t\t\t\tconst dataCookie = ctx.context.authCookies.sessionData.name;\n\t\t\t\t\tctx.setCookie(dataCookie, \"\", { maxAge: 0 });\n\t\t\t\t\treturn ctx.json(null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst dontRememberMe = await ctx.getSignedCookie(ctx.context.authCookies.dontRememberToken.name, ctx.context.secret);\n\t\t/**\n\t\t* If session data is present in the cookie, check if it should be used or refreshed\n\t\t*/\n\t\tif (sessionDataPayload?.session && ctx.context.options.session?.cookieCache?.enabled && !ctx.query?.disableCookieCache) {\n\t\t\tconst session$1 = sessionDataPayload.session;\n\t\t\tconst versionConfig = ctx.context.options.session?.cookieCache?.version;\n\t\t\tlet expectedVersion = \"1\";\n\t\t\tif (versionConfig) {\n\t\t\t\tif (typeof versionConfig === \"string\") expectedVersion = versionConfig;\n\t\t\t\telse if (typeof versionConfig === \"function\") {\n\t\t\t\t\tconst result = versionConfig(session$1.session, session$1.user);\n\t\t\t\t\texpectedVersion = result instanceof Promise ? await result : result;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ((session$1.version || \"1\") !== expectedVersion) {\n\t\t\t\tconst dataCookie = ctx.context.authCookies.sessionData.name;\n\t\t\t\tctx.setCookie(dataCookie, \"\", { maxAge: 0 });\n\t\t\t} else if (sessionDataPayload.expiresAt < Date.now() || session$1.session.expiresAt < /* @__PURE__ */ new Date()) {\n\t\t\t\tconst dataCookie = ctx.context.authCookies.sessionData.name;\n\t\t\t\tctx.setCookie(dataCookie, \"\", { maxAge: 0 });\n\t\t\t} else {\n\t\t\t\tconst cookieRefreshCache = ctx.context.sessionConfig.cookieRefreshCache;\n\t\t\t\tif (cookieRefreshCache === false) {\n\t\t\t\t\tctx.context.session = session$1;\n\t\t\t\t\treturn ctx.json({\n\t\t\t\t\t\tsession: session$1.session,\n\t\t\t\t\t\tuser: session$1.user\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (sessionDataPayload.expiresAt - Date.now() < cookieRefreshCache.updateAge * 1e3) {\n\t\t\t\t\tconst newExpiresAt = getDate(ctx.context.options.session?.cookieCache?.maxAge || 300, \"sec\");\n\t\t\t\t\tconst refreshedSession = {\n\t\t\t\t\t\tsession: {\n\t\t\t\t\t\t\t...session$1.session,\n\t\t\t\t\t\t\texpiresAt: newExpiresAt\n\t\t\t\t\t\t},\n\t\t\t\t\t\tuser: session$1.user,\n\t\t\t\t\t\tupdatedAt: Date.now()\n\t\t\t\t\t};\n\t\t\t\t\tawait setCookieCache(ctx, refreshedSession, false);\n\t\t\t\t\tconst parsedRefreshedSession = parseSessionOutput(ctx.context.options, {\n\t\t\t\t\t\t...refreshedSession.session,\n\t\t\t\t\t\texpiresAt: new Date(refreshedSession.session.expiresAt),\n\t\t\t\t\t\tcreatedAt: new Date(refreshedSession.session.createdAt),\n\t\t\t\t\t\tupdatedAt: new Date(refreshedSession.session.updatedAt)\n\t\t\t\t\t});\n\t\t\t\t\tconst parsedRefreshedUser = parseUserOutput(ctx.context.options, {\n\t\t\t\t\t\t...refreshedSession.user,\n\t\t\t\t\t\tcreatedAt: new Date(refreshedSession.user.createdAt),\n\t\t\t\t\t\tupdatedAt: new Date(refreshedSession.user.updatedAt)\n\t\t\t\t\t});\n\t\t\t\t\tctx.context.session = {\n\t\t\t\t\t\tsession: parsedRefreshedSession,\n\t\t\t\t\t\tuser: parsedRefreshedUser\n\t\t\t\t\t};\n\t\t\t\t\treturn ctx.json({\n\t\t\t\t\t\tsession: parsedRefreshedSession,\n\t\t\t\t\t\tuser: parsedRefreshedUser\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tconst parsedSession = parseSessionOutput(ctx.context.options, {\n\t\t\t\t\t...session$1.session,\n\t\t\t\t\texpiresAt: new Date(session$1.session.expiresAt),\n\t\t\t\t\tcreatedAt: new Date(session$1.session.createdAt),\n\t\t\t\t\tupdatedAt: new Date(session$1.session.updatedAt)\n\t\t\t\t});\n\t\t\t\tconst parsedUser = parseUserOutput(ctx.context.options, {\n\t\t\t\t\t...session$1.user,\n\t\t\t\t\tcreatedAt: new Date(session$1.user.createdAt),\n\t\t\t\t\tupdatedAt: new Date(session$1.user.updatedAt)\n\t\t\t\t});\n\t\t\t\tctx.context.session = {\n\t\t\t\t\tsession: parsedSession,\n\t\t\t\t\tuser: parsedUser\n\t\t\t\t};\n\t\t\t\treturn ctx.json({\n\t\t\t\t\tsession: parsedSession,\n\t\t\t\t\tuser: parsedUser\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tconst session = await ctx.context.internalAdapter.findSession(sessionCookieToken);\n\t\tctx.context.session = session;\n\t\tif (!session || session.session.expiresAt < /* @__PURE__ */ new Date()) {\n\t\t\tdeleteSessionCookie(ctx);\n\t\t\tif (session)\n /**\n\t\t\t* if session expired clean up the session\n\t\t\t*/\n\t\t\tawait ctx.context.internalAdapter.deleteSession(session.session.token);\n\t\t\treturn ctx.json(null);\n\t\t}\n\t\t/**\n\t\t* We don't need to update the session if the user doesn't want to be remembered\n\t\t* or if the session refresh is disabled\n\t\t*/\n\t\tif (dontRememberMe || ctx.query?.disableRefresh) {\n\t\t\tconst parsedSession = parseSessionOutput(ctx.context.options, session.session);\n\t\t\tconst parsedUser = parseUserOutput(ctx.context.options, session.user);\n\t\t\treturn ctx.json({\n\t\t\t\tsession: parsedSession,\n\t\t\t\tuser: parsedUser\n\t\t\t});\n\t\t}\n\t\tconst expiresIn = ctx.context.sessionConfig.expiresIn;\n\t\tconst updateAge = ctx.context.sessionConfig.updateAge;\n\t\tif (session.session.expiresAt.valueOf() - expiresIn * 1e3 + updateAge * 1e3 <= Date.now() && (!ctx.query?.disableRefresh || !ctx.context.options.session?.disableSessionRefresh)) {\n\t\t\tconst updatedSession = await ctx.context.internalAdapter.updateSession(session.session.token, {\n\t\t\t\texpiresAt: getDate(ctx.context.sessionConfig.expiresIn, \"sec\"),\n\t\t\t\tupdatedAt: /* @__PURE__ */ new Date()\n\t\t\t});\n\t\t\tif (!updatedSession) {\n\t\t\t\t/**\n\t\t\t\t* Handle case where session update fails (e.g., concurrent deletion)\n\t\t\t\t*/\n\t\t\t\tdeleteSessionCookie(ctx);\n\t\t\t\treturn ctx.json(null, { status: 401 });\n\t\t\t}\n\t\t\tconst maxAge = (updatedSession.expiresAt.valueOf() - Date.now()) / 1e3;\n\t\t\tawait setSessionCookie(ctx, {\n\t\t\t\tsession: updatedSession,\n\t\t\t\tuser: session.user\n\t\t\t}, false, { maxAge });\n\t\t\tconst parsedUpdatedSession = parseSessionOutput(ctx.context.options, updatedSession);\n\t\t\tconst parsedUser = parseUserOutput(ctx.context.options, session.user);\n\t\t\treturn ctx.json({\n\t\t\t\tsession: parsedUpdatedSession,\n\t\t\t\tuser: parsedUser\n\t\t\t});\n\t\t}\n\t\tawait setCookieCache(ctx, session, !!dontRememberMe);\n\t\treturn ctx.json(session);\n\t} catch (error) {\n\t\tctx.context.logger.error(\"INTERNAL_SERVER_ERROR\", error);\n\t\tthrow new APIError(\"INTERNAL_SERVER_ERROR\", { message: BASE_ERROR_CODES.FAILED_TO_GET_SESSION });\n\t}\n});\nconst getSessionFromCtx = async (ctx, config) => {\n\tif (ctx.context.session) return ctx.context.session;\n\tconst session = await getSession()({\n\t\t...ctx,\n\t\tasResponse: false,\n\t\theaders: ctx.headers,\n\t\treturnHeaders: false,\n\t\treturnStatus: false,\n\t\tquery: {\n\t\t\t...config,\n\t\t\t...ctx.query\n\t\t}\n\t}).catch((e) => {\n\t\treturn null;\n\t});\n\tctx.context.session = session;\n\treturn session;\n};\n/**\n* The middleware forces the endpoint to require a valid session.\n*/\nconst sessionMiddleware = createAuthMiddleware(async (ctx) => {\n\tconst session = await getSessionFromCtx(ctx);\n\tif (!session?.session) throw new APIError(\"UNAUTHORIZED\");\n\treturn { session };\n});\n/**\n* This middleware forces the endpoint to require a valid session and ignores cookie cache.\n* This should be used for sensitive operations like password changes, account deletion, etc.\n* to ensure that revoked sessions cannot be used even if they're still cached in cookies.\n*/\nconst sensitiveSessionMiddleware = createAuthMiddleware(async (ctx) => {\n\tconst session = await getSessionFromCtx(ctx, { disableCookieCache: true });\n\tif (!session?.session) throw new APIError(\"UNAUTHORIZED\");\n\treturn { session };\n});\n/**\n* This middleware allows you to call the endpoint on the client if session is valid.\n* However, if called on the server, no session is required.\n*/\nconst requestOnlySessionMiddleware = createAuthMiddleware(async (ctx) => {\n\tconst session = await getSessionFromCtx(ctx);\n\tif (!session?.session && (ctx.request || ctx.headers)) throw new APIError(\"UNAUTHORIZED\");\n\treturn { session };\n});\n/**\n* This middleware forces the endpoint to require a valid session,\n* as well as making sure the session is fresh before proceeding.\n*\n* Session freshness check will be skipped if the session config's freshAge\n* is set to 0\n*/\nconst freshSessionMiddleware = createAuthMiddleware(async (ctx) => {\n\tconst session = await getSessionFromCtx(ctx);\n\tif (!session?.session) throw new APIError(\"UNAUTHORIZED\");\n\tif (ctx.context.sessionConfig.freshAge === 0) return { session };\n\tconst freshAge = ctx.context.sessionConfig.freshAge;\n\tconst lastUpdated = new Date(session.session.updatedAt || session.session.createdAt).getTime();\n\tif (!(Date.now() - lastUpdated < freshAge * 1e3)) throw new APIError(\"FORBIDDEN\", { message: \"Session is not fresh\" });\n\treturn { session };\n});\n/**\n* user active sessions list\n*/\nconst listSessions = () => createAuthEndpoint(\"/list-sessions\", {\n\tmethod: \"GET\",\n\toperationId: \"listUserSessions\",\n\tuse: [sessionMiddleware],\n\trequireHeaders: true,\n\tmetadata: { openapi: {\n\t\toperationId: \"listUserSessions\",\n\t\tdescription: \"List all active sessions for the user\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"array\",\n\t\t\t\titems: { $ref: \"#/components/schemas/Session\" }\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\ttry {\n\t\tconst activeSessions = (await ctx.context.internalAdapter.listSessions(ctx.context.session.user.id)).filter((session) => {\n\t\t\treturn session.expiresAt > /* @__PURE__ */ new Date();\n\t\t});\n\t\treturn ctx.json(activeSessions);\n\t} catch (e) {\n\t\tctx.context.logger.error(e);\n\t\tthrow ctx.error(\"INTERNAL_SERVER_ERROR\");\n\t}\n});\n/**\n* revoke a single session\n*/\nconst revokeSession = createAuthEndpoint(\"/revoke-session\", {\n\tmethod: \"POST\",\n\tbody: z.object({ token: z.string().meta({ description: \"The token to revoke\" }) }),\n\tuse: [sensitiveSessionMiddleware],\n\trequireHeaders: true,\n\tmetadata: { openapi: {\n\t\tdescription: \"Revoke a single session\",\n\t\trequestBody: { content: { \"application/json\": { schema: {\n\t\t\ttype: \"object\",\n\t\t\tproperties: { token: {\n\t\t\t\ttype: \"string\",\n\t\t\t\tdescription: \"The token to revoke\"\n\t\t\t} },\n\t\t\trequired: [\"token\"]\n\t\t} } } },\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: { status: {\n\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\tdescription: \"Indicates if the session was revoked successfully\"\n\t\t\t\t} },\n\t\t\t\trequired: [\"status\"]\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tconst token = ctx.body.token;\n\tif ((await ctx.context.internalAdapter.findSession(token))?.session.userId === ctx.context.session.user.id) try {\n\t\tawait ctx.context.internalAdapter.deleteSession(token);\n\t} catch (error) {\n\t\tctx.context.logger.error(error && typeof error === \"object\" && \"name\" in error ? error.name : \"\", error);\n\t\tthrow new APIError(\"INTERNAL_SERVER_ERROR\");\n\t}\n\treturn ctx.json({ status: true });\n});\n/**\n* revoke all user sessions\n*/\nconst revokeSessions = createAuthEndpoint(\"/revoke-sessions\", {\n\tmethod: \"POST\",\n\tuse: [sensitiveSessionMiddleware],\n\trequireHeaders: true,\n\tmetadata: { openapi: {\n\t\tdescription: \"Revoke all sessions for the user\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: { status: {\n\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\tdescription: \"Indicates if all sessions were revoked successfully\"\n\t\t\t\t} },\n\t\t\t\trequired: [\"status\"]\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\ttry {\n\t\tawait ctx.context.internalAdapter.deleteSessions(ctx.context.session.user.id);\n\t} catch (error) {\n\t\tctx.context.logger.error(error && typeof error === \"object\" && \"name\" in error ? error.name : \"\", error);\n\t\tthrow new APIError(\"INTERNAL_SERVER_ERROR\");\n\t}\n\treturn ctx.json({ status: true });\n});\nconst revokeOtherSessions = createAuthEndpoint(\"/revoke-other-sessions\", {\n\tmethod: \"POST\",\n\trequireHeaders: true,\n\tuse: [sensitiveSessionMiddleware],\n\tmetadata: { openapi: {\n\t\tdescription: \"Revoke all other sessions for the user except the current one\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: { status: {\n\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\tdescription: \"Indicates if all other sessions were revoked successfully\"\n\t\t\t\t} },\n\t\t\t\trequired: [\"status\"]\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tconst session = ctx.context.session;\n\tif (!session.user) throw new APIError(\"UNAUTHORIZED\");\n\tconst otherSessions = (await ctx.context.internalAdapter.listSessions(session.user.id)).filter((session$1) => {\n\t\treturn session$1.expiresAt > /* @__PURE__ */ new Date();\n\t}).filter((session$1) => session$1.token !== ctx.context.session.session.token);\n\tawait Promise.all(otherSessions.map((session$1) => ctx.context.internalAdapter.deleteSession(session$1.token)));\n\treturn ctx.json({ status: true });\n});\n\n//#endregion\nexport { requestOnlySessionMiddleware as a, revokeSessions as c, listSessions as i, sensitiveSessionMiddleware as l, getSession as n, revokeOtherSessions as o, getSessionFromCtx as r, revokeSession as s, freshSessionMiddleware as t, sessionMiddleware as u };"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 3611, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/api-CkmycQ2x.mjs"],"sourcesContent":["import { i as parseState, n as HIDE_METADATA, r as generateState, t as generateId } from \"./utils-db7gNqd-.mjs\";\nimport { n as symmetricEncrypt, o as signJWT, r as generateRandomString, t as symmetricDecrypt } from \"./crypto-CFUhAR9W.mjs\";\nimport { c as parseUserInput, l as parseUserOutput, u as getDate } from \"./schema-Bb7wzeK_.mjs\";\nimport { t as getIp } from \"./get-request-ip-D6st-mto.mjs\";\nimport { t as safeJSONParse } from \"./json-CnHxKYpj.mjs\";\nimport { i as getProtocol, n as getHost, r as getOrigin } from \"./url-CB8xCwz-.mjs\";\nimport { c as setSessionCookie, f as getAccountCookie, h as setAccountCookie, n as deleteSessionCookie } from \"./cookies-D72PbWdz.mjs\";\nimport { c as revokeSessions, i as listSessions, l as sensitiveSessionMiddleware, n as getSession, o as revokeOtherSessions, r as getSessionFromCtx, s as revokeSession, t as freshSessionMiddleware, u as sessionMiddleware } from \"./session-AaRl3_x-.mjs\";\nimport { hasRequestState, runWithEndpointContext, runWithRequestState, runWithTransaction } from \"@better-auth/core/context\";\nimport { isDevelopment, isProduction, logger, shouldPublishLog } from \"@better-auth/core/env\";\nimport { BASE_ERROR_CODES } from \"@better-auth/core/error\";\nimport { APIError, APIError as APIError$1, createRouter, toResponse } from \"better-call\";\nimport * as z from \"zod\";\nimport { jwtVerify } from \"jose\";\nimport { SocialProviderListEnum } from \"@better-auth/core/social-providers\";\nimport { createDefu } from \"defu\";\nimport { createAuthEndpoint, createAuthEndpoint as createAuthEndpoint$1, createAuthMiddleware, createAuthMiddleware as createAuthMiddleware$1, optionsMiddleware } from \"@better-auth/core/api\";\nimport { JWTExpired } from \"jose/errors\";\n\n//#region src/utils/wildcard.ts\n/**\n* Escapes a character if it has a special meaning in regular expressions\n* and returns the character as is if it doesn't\n*/\nfunction escapeRegExpChar(char) {\n\tif (char === \"-\" || char === \"^\" || char === \"$\" || char === \"+\" || char === \".\" || char === \"(\" || char === \")\" || char === \"|\" || char === \"[\" || char === \"]\" || char === \"{\" || char === \"}\" || char === \"*\" || char === \"?\" || char === \"\\\\\") return `\\\\${char}`;\n\telse return char;\n}\n/**\n* Escapes all characters in a given string that have a special meaning in regular expressions\n*/\nfunction escapeRegExpString(str) {\n\tlet result = \"\";\n\tfor (let i = 0; i < str.length; i++) result += escapeRegExpChar(str[i]);\n\treturn result;\n}\n/**\n* Transforms one or more glob patterns into a RegExp pattern\n*/\nfunction transform(pattern, separator = true) {\n\tif (Array.isArray(pattern)) return `(?:${pattern.map((p) => `^${transform(p, separator)}$`).join(\"|\")})`;\n\tlet separatorSplitter = \"\";\n\tlet separatorMatcher = \"\";\n\tlet wildcard = \".\";\n\tif (separator === true) {\n\t\tseparatorSplitter = \"/\";\n\t\tseparatorMatcher = \"[/\\\\\\\\]\";\n\t\twildcard = \"[^/\\\\\\\\]\";\n\t} else if (separator) {\n\t\tseparatorSplitter = separator;\n\t\tseparatorMatcher = escapeRegExpString(separatorSplitter);\n\t\tif (separatorMatcher.length > 1) {\n\t\t\tseparatorMatcher = `(?:${separatorMatcher})`;\n\t\t\twildcard = `((?!${separatorMatcher}).)`;\n\t\t} else wildcard = `[^${separatorMatcher}]`;\n\t}\n\tlet requiredSeparator = separator ? `${separatorMatcher}+?` : \"\";\n\tlet optionalSeparator = separator ? `${separatorMatcher}*?` : \"\";\n\tlet segments = separator ? pattern.split(separatorSplitter) : [pattern];\n\tlet result = \"\";\n\tfor (let s = 0; s < segments.length; s++) {\n\t\tlet segment = segments[s];\n\t\tlet nextSegment = segments[s + 1];\n\t\tlet currentSeparator = \"\";\n\t\tif (!segment && s > 0) continue;\n\t\tif (separator) if (s === segments.length - 1) currentSeparator = optionalSeparator;\n\t\telse if (nextSegment !== \"**\") currentSeparator = requiredSeparator;\n\t\telse currentSeparator = \"\";\n\t\tif (separator && segment === \"**\") {\n\t\t\tif (currentSeparator) {\n\t\t\t\tresult += s === 0 ? \"\" : currentSeparator;\n\t\t\t\tresult += `(?:${wildcard}*?${currentSeparator})*?`;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tfor (let c = 0; c < segment.length; c++) {\n\t\t\tlet char = segment[c];\n\t\t\tif (char === \"\\\\\") {\n\t\t\t\tif (c < segment.length - 1) {\n\t\t\t\t\tresult += escapeRegExpChar(segment[c + 1]);\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t} else if (char === \"?\") result += wildcard;\n\t\t\telse if (char === \"*\") result += `${wildcard}*?`;\n\t\t\telse result += escapeRegExpChar(char);\n\t\t}\n\t\tresult += currentSeparator;\n\t}\n\treturn result;\n}\nfunction isMatch(regexp, sample) {\n\tif (typeof sample !== \"string\") throw new TypeError(`Sample must be a string, but ${typeof sample} given`);\n\treturn regexp.test(sample);\n}\n/**\n* Compiles one or more glob patterns into a RegExp and returns an isMatch function.\n* The isMatch function takes a sample string as its only argument and returns `true`\n* if the string matches the pattern(s).\n*\n* ```js\n* wildcardMatch('src/*.js')('src/index.js') //=> true\n* ```\n*\n* ```js\n* const isMatch = wildcardMatch('*.example.com', '.')\n* isMatch('foo.example.com') //=> true\n* isMatch('foo.bar.com') //=> false\n* ```\n*/\nfunction wildcardMatch(pattern, options) {\n\tif (typeof pattern !== \"string\" && !Array.isArray(pattern)) throw new TypeError(`The first argument must be a single pattern string or an array of patterns, but ${typeof pattern} given`);\n\tif (typeof options === \"string\" || typeof options === \"boolean\") options = { separator: options };\n\tif (arguments.length === 2 && !(typeof options === \"undefined\" || typeof options === \"object\" && options !== null && !Array.isArray(options))) throw new TypeError(`The second argument must be an options object or a string/boolean separator, but ${typeof options} given`);\n\toptions = options || {};\n\tif (options.separator === \"\\\\\") throw new Error(\"\\\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead\");\n\tlet regexpPattern = transform(pattern, options.separator);\n\tlet regexp = new RegExp(`^${regexpPattern}$`, options.flags);\n\tlet fn = isMatch.bind(null, regexp);\n\tfn.options = options;\n\tfn.pattern = pattern;\n\tfn.regexp = regexp;\n\treturn fn;\n}\n\n//#endregion\n//#region src/api/middlewares/origin-check.ts\n/**\n* A middleware to validate callbackURL and origin against\n* trustedOrigins.\n*/\nconst originCheckMiddleware = createAuthMiddleware(async (ctx) => {\n\tif (ctx.request?.method === \"GET\" || ctx.request?.method === \"OPTIONS\" || ctx.request?.method === \"HEAD\" || !ctx.request) return;\n\tconst headers = ctx.request?.headers;\n\tconst request = ctx.request;\n\tconst { body, query, context } = ctx;\n\tconst originHeader = headers?.get(\"origin\") || headers?.get(\"referer\") || \"\";\n\tconst callbackURL = body?.callbackURL || query?.callbackURL;\n\tconst redirectURL = body?.redirectTo;\n\tconst errorCallbackURL = body?.errorCallbackURL;\n\tconst newUserCallbackURL = body?.newUserCallbackURL;\n\tconst trustedOrigins = Array.isArray(context.options.trustedOrigins) ? context.trustedOrigins : [...context.trustedOrigins, ...await context.options.trustedOrigins?.(request) || []];\n\tconst useCookies = headers?.has(\"cookie\");\n\tconst matchesPattern = (url, pattern) => {\n\t\tif (url.startsWith(\"/\")) return false;\n\t\tif (pattern.includes(\"*\")) {\n\t\t\tif (pattern.includes(\"://\")) return wildcardMatch(pattern)(getOrigin(url) || url);\n\t\t\tconst host = getHost(url);\n\t\t\tif (!host) return false;\n\t\t\treturn wildcardMatch(pattern)(host);\n\t\t}\n\t\tconst protocol = getProtocol(url);\n\t\treturn protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === getOrigin(url) : url.startsWith(pattern);\n\t};\n\tconst validateURL = (url, label) => {\n\t\tif (!url) return;\n\t\tif (!trustedOrigins.some((origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && /^\\/(?!\\/|\\\\|%2f|%5c)[\\w\\-.\\+/@]*(?:\\?[\\w\\-.\\+/=&%@]*)?$/.test(url))) {\n\t\t\tctx.context.logger.error(`Invalid ${label}: ${url}`);\n\t\t\tctx.context.logger.info(`If it's a valid URL, please add ${url} to trustedOrigins in your auth config\\n`, `Current list of trustedOrigins: ${trustedOrigins}`);\n\t\t\tthrow new APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n\t\t}\n\t};\n\tif (useCookies && !ctx.context.skipCSRFCheck && !ctx.context.skipOriginCheck) {\n\t\tif (!originHeader || originHeader === \"null\") throw new APIError(\"FORBIDDEN\", { message: \"Missing or null Origin\" });\n\t\tvalidateURL(originHeader, \"origin\");\n\t}\n\tcallbackURL && validateURL(callbackURL, \"callbackURL\");\n\tredirectURL && validateURL(redirectURL, \"redirectURL\");\n\terrorCallbackURL && validateURL(errorCallbackURL, \"errorCallbackURL\");\n\tnewUserCallbackURL && validateURL(newUserCallbackURL, \"newUserCallbackURL\");\n});\nconst originCheck = (getValue) => createAuthMiddleware(async (ctx) => {\n\tif (!ctx.request) return;\n\tconst { context } = ctx;\n\tconst callbackURL = getValue(ctx);\n\tconst trustedOrigins = Array.isArray(context.options.trustedOrigins) ? context.trustedOrigins : [...context.trustedOrigins, ...await context.options.trustedOrigins?.(ctx.request) || []];\n\tconst matchesPattern = (url, pattern) => {\n\t\tif (url.startsWith(\"/\")) return false;\n\t\tif (pattern.includes(\"*\")) {\n\t\t\tif (pattern.includes(\"://\")) return wildcardMatch(pattern)(getOrigin(url) || url);\n\t\t\tconst host = getHost(url);\n\t\t\tif (!host) return false;\n\t\t\treturn wildcardMatch(pattern)(host);\n\t\t}\n\t\tconst protocol = getProtocol(url);\n\t\treturn protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === getOrigin(url) : url.startsWith(pattern);\n\t};\n\tconst validateURL = (url, label) => {\n\t\tif (!url) return;\n\t\tif (!trustedOrigins.some((origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && /^\\/(?!\\/|\\\\|%2f|%5c)[\\w\\-.\\+/@]*(?:\\?[\\w\\-.\\+/=&%@]*)?$/.test(url))) {\n\t\t\tctx.context.logger.error(`Invalid ${label}: ${url}`);\n\t\t\tctx.context.logger.info(`If it's a valid URL, please add ${url} to trustedOrigins in your auth config\\n`, `Current list of trustedOrigins: ${trustedOrigins}`);\n\t\t\tthrow new APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n\t\t}\n\t};\n\tconst callbacks = Array.isArray(callbackURL) ? callbackURL : [callbackURL];\n\tfor (const url of callbacks) validateURL(url, \"callbackURL\");\n});\n\n//#endregion\n//#region src/api/rate-limiter/index.ts\nfunction shouldRateLimit(max, window, rateLimitData) {\n\tconst now = Date.now();\n\tconst windowInMs = window * 1e3;\n\treturn now - rateLimitData.lastRequest < windowInMs && rateLimitData.count >= max;\n}\nfunction rateLimitResponse(retryAfter) {\n\treturn new Response(JSON.stringify({ message: \"Too many requests. Please try again later.\" }), {\n\t\tstatus: 429,\n\t\tstatusText: \"Too Many Requests\",\n\t\theaders: { \"X-Retry-After\": retryAfter.toString() }\n\t});\n}\nfunction getRetryAfter(lastRequest, window) {\n\tconst now = Date.now();\n\tconst windowInMs = window * 1e3;\n\treturn Math.ceil((lastRequest + windowInMs - now) / 1e3);\n}\nfunction createDBStorage(ctx) {\n\tconst model = \"rateLimit\";\n\tconst db = ctx.adapter;\n\treturn {\n\t\tget: async (key) => {\n\t\t\tconst data = (await db.findMany({\n\t\t\t\tmodel,\n\t\t\t\twhere: [{\n\t\t\t\t\tfield: \"key\",\n\t\t\t\t\tvalue: key\n\t\t\t\t}]\n\t\t\t}))[0];\n\t\t\tif (typeof data?.lastRequest === \"bigint\") data.lastRequest = Number(data.lastRequest);\n\t\t\treturn data;\n\t\t},\n\t\tset: async (key, value, _update) => {\n\t\t\ttry {\n\t\t\t\tif (_update) await db.updateMany({\n\t\t\t\t\tmodel,\n\t\t\t\t\twhere: [{\n\t\t\t\t\t\tfield: \"key\",\n\t\t\t\t\t\tvalue: key\n\t\t\t\t\t}],\n\t\t\t\t\tupdate: {\n\t\t\t\t\t\tcount: value.count,\n\t\t\t\t\t\tlastRequest: value.lastRequest\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\telse await db.create({\n\t\t\t\t\tmodel,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tkey,\n\t\t\t\t\t\tcount: value.count,\n\t\t\t\t\t\tlastRequest: value.lastRequest\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\tctx.logger.error(\"Error setting rate limit\", e);\n\t\t\t}\n\t\t}\n\t};\n}\nconst memory = /* @__PURE__ */ new Map();\nfunction getRateLimitStorage(ctx, rateLimitSettings) {\n\tif (ctx.options.rateLimit?.customStorage) return ctx.options.rateLimit.customStorage;\n\tconst storage = ctx.rateLimit.storage;\n\tif (storage === \"secondary-storage\") return {\n\t\tget: async (key) => {\n\t\t\tconst data = await ctx.options.secondaryStorage?.get(key);\n\t\t\treturn data ? safeJSONParse(data) : void 0;\n\t\t},\n\t\tset: async (key, value, _update) => {\n\t\t\tconst ttl = rateLimitSettings?.window ?? ctx.options.rateLimit?.window ?? 10;\n\t\t\tawait ctx.options.secondaryStorage?.set?.(key, JSON.stringify(value), ttl);\n\t\t}\n\t};\n\telse if (storage === \"memory\") return {\n\t\tasync get(key) {\n\t\t\treturn memory.get(key);\n\t\t},\n\t\tasync set(key, value, _update) {\n\t\t\tmemory.set(key, value);\n\t\t}\n\t};\n\treturn createDBStorage(ctx);\n}\nasync function onRequestRateLimit(req, ctx) {\n\tif (!ctx.rateLimit.enabled) return;\n\tconst path = new URL(req.url).pathname.replace(ctx.options.basePath || \"/api/auth\", \"\");\n\tlet window = ctx.rateLimit.window;\n\tlet max = ctx.rateLimit.max;\n\tconst ip = getIp(req, ctx.options);\n\tif (!ip) return;\n\tconst key = ip + path;\n\tconst specialRule = getDefaultSpecialRules().find((rule) => rule.pathMatcher(path));\n\tif (specialRule) {\n\t\twindow = specialRule.window;\n\t\tmax = specialRule.max;\n\t}\n\tfor (const plugin of ctx.options.plugins || []) if (plugin.rateLimit) {\n\t\tconst matchedRule = plugin.rateLimit.find((rule) => rule.pathMatcher(path));\n\t\tif (matchedRule) {\n\t\t\twindow = matchedRule.window;\n\t\t\tmax = matchedRule.max;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (ctx.rateLimit.customRules) {\n\t\tconst _path = Object.keys(ctx.rateLimit.customRules).find((p) => {\n\t\t\tif (p.includes(\"*\")) return wildcardMatch(p)(path);\n\t\t\treturn p === path;\n\t\t});\n\t\tif (_path) {\n\t\t\tconst customRule = ctx.rateLimit.customRules[_path];\n\t\t\tconst resolved = typeof customRule === \"function\" ? await customRule(req) : customRule;\n\t\t\tif (resolved) {\n\t\t\t\twindow = resolved.window;\n\t\t\t\tmax = resolved.max;\n\t\t\t}\n\t\t\tif (resolved === false) return;\n\t\t}\n\t}\n\tconst storage = getRateLimitStorage(ctx, { window });\n\tconst data = await storage.get(key);\n\tconst now = Date.now();\n\tif (!data) await storage.set(key, {\n\t\tkey,\n\t\tcount: 1,\n\t\tlastRequest: now\n\t});\n\telse {\n\t\tconst timeSinceLastRequest = now - data.lastRequest;\n\t\tif (shouldRateLimit(max, window, data)) return rateLimitResponse(getRetryAfter(data.lastRequest, window));\n\t\telse if (timeSinceLastRequest > window * 1e3) await storage.set(key, {\n\t\t\t...data,\n\t\t\tcount: 1,\n\t\t\tlastRequest: now\n\t\t}, true);\n\t\telse await storage.set(key, {\n\t\t\t...data,\n\t\t\tcount: data.count + 1,\n\t\t\tlastRequest: now\n\t\t}, true);\n\t}\n}\nfunction getDefaultSpecialRules() {\n\treturn [{\n\t\tpathMatcher(path) {\n\t\t\treturn path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path.startsWith(\"/change-password\") || path.startsWith(\"/change-email\");\n\t\t},\n\t\twindow: 10,\n\t\tmax: 3\n\t}];\n}\n\n//#endregion\n//#region src/oauth2/utils.ts\nfunction decryptOAuthToken(token, ctx) {\n\tif (!token) return token;\n\tif (ctx.options.account?.encryptOAuthTokens) return symmetricDecrypt({\n\t\tkey: ctx.secret,\n\t\tdata: token\n\t});\n\treturn token;\n}\nfunction setTokenUtil(token, ctx) {\n\tif (ctx.options.account?.encryptOAuthTokens && token) return symmetricEncrypt({\n\t\tkey: ctx.secret,\n\t\tdata: token\n\t});\n\treturn token;\n}\n\n//#endregion\n//#region src/api/routes/account.ts\nconst listUserAccounts = createAuthEndpoint(\"/list-accounts\", {\n\tmethod: \"GET\",\n\tuse: [sessionMiddleware],\n\tmetadata: { openapi: {\n\t\toperationId: \"listUserAccounts\",\n\t\tdescription: \"List all accounts linked to the user\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"array\",\n\t\t\t\titems: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tid: { type: \"string\" },\n\t\t\t\t\t\tproviderId: { type: \"string\" },\n\t\t\t\t\t\tcreatedAt: {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tformat: \"date-time\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tupdatedAt: {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tformat: \"date-time\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\taccountId: { type: \"string\" },\n\t\t\t\t\t\tuserId: { type: \"string\" },\n\t\t\t\t\t\tscopes: {\n\t\t\t\t\t\t\ttype: \"array\",\n\t\t\t\t\t\t\titems: { type: \"string\" }\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\trequired: [\n\t\t\t\t\t\t\"id\",\n\t\t\t\t\t\t\"providerId\",\n\t\t\t\t\t\t\"createdAt\",\n\t\t\t\t\t\t\"updatedAt\",\n\t\t\t\t\t\t\"accountId\",\n\t\t\t\t\t\t\"userId\",\n\t\t\t\t\t\t\"scopes\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (c) => {\n\tconst session = c.context.session;\n\tconst accounts = await c.context.internalAdapter.findAccounts(session.user.id);\n\treturn c.json(accounts.map((a) => ({\n\t\tid: a.id,\n\t\tproviderId: a.providerId,\n\t\tcreatedAt: a.createdAt,\n\t\tupdatedAt: a.updatedAt,\n\t\taccountId: a.accountId,\n\t\tuserId: a.userId,\n\t\tscopes: a.scope?.split(\",\") || []\n\t})));\n});\nconst linkSocialAccount = createAuthEndpoint(\"/link-social\", {\n\tmethod: \"POST\",\n\trequireHeaders: true,\n\tbody: z.object({\n\t\tcallbackURL: z.string().meta({ description: \"The URL to redirect to after the user has signed in\" }).optional(),\n\t\tprovider: SocialProviderListEnum,\n\t\tidToken: z.object({\n\t\t\ttoken: z.string(),\n\t\t\tnonce: z.string().optional(),\n\t\t\taccessToken: z.string().optional(),\n\t\t\trefreshToken: z.string().optional(),\n\t\t\tscopes: z.array(z.string()).optional()\n\t\t}).optional(),\n\t\trequestSignUp: z.boolean().optional(),\n\t\tscopes: z.array(z.string()).meta({ description: \"Additional scopes to request from the provider\" }).optional(),\n\t\terrorCallbackURL: z.string().meta({ description: \"The URL to redirect to if there is an error during the link process\" }).optional(),\n\t\tdisableRedirect: z.boolean().meta({ description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\" }).optional(),\n\t\tadditionalData: z.record(z.string(), z.any()).optional()\n\t}),\n\tuse: [sessionMiddleware],\n\tmetadata: { openapi: {\n\t\tdescription: \"Link a social account to the user\",\n\t\toperationId: \"linkSocialAccount\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\turl: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tdescription: \"The authorization URL to redirect the user to\"\n\t\t\t\t\t},\n\t\t\t\t\tredirect: {\n\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\tdescription: \"Indicates if the user should be redirected to the authorization URL\"\n\t\t\t\t\t},\n\t\t\t\t\tstatus: { type: \"boolean\" }\n\t\t\t\t},\n\t\t\t\trequired: [\"redirect\"]\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (c) => {\n\tconst session = c.context.session;\n\tconst provider = c.context.socialProviders.find((p) => p.id === c.body.provider);\n\tif (!provider) {\n\t\tc.context.logger.error(\"Provider not found. Make sure to add the provider in your auth config\", { provider: c.body.provider });\n\t\tthrow new APIError(\"NOT_FOUND\", { message: BASE_ERROR_CODES.PROVIDER_NOT_FOUND });\n\t}\n\tif (c.body.idToken) {\n\t\tif (!provider.verifyIdToken) {\n\t\t\tc.context.logger.error(\"Provider does not support id token verification\", { provider: c.body.provider });\n\t\t\tthrow new APIError(\"NOT_FOUND\", { message: BASE_ERROR_CODES.ID_TOKEN_NOT_SUPPORTED });\n\t\t}\n\t\tconst { token, nonce } = c.body.idToken;\n\t\tif (!await provider.verifyIdToken(token, nonce)) {\n\t\t\tc.context.logger.error(\"Invalid id token\", { provider: c.body.provider });\n\t\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.INVALID_TOKEN });\n\t\t}\n\t\tconst linkingUserInfo = await provider.getUserInfo({\n\t\t\tidToken: token,\n\t\t\taccessToken: c.body.idToken.accessToken,\n\t\t\trefreshToken: c.body.idToken.refreshToken\n\t\t});\n\t\tif (!linkingUserInfo || !linkingUserInfo?.user) {\n\t\t\tc.context.logger.error(\"Failed to get user info\", { provider: c.body.provider });\n\t\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO });\n\t\t}\n\t\tconst linkingUserId = String(linkingUserInfo.user.id);\n\t\tif (!linkingUserInfo.user.email) {\n\t\t\tc.context.logger.error(\"User email not found\", { provider: c.body.provider });\n\t\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.USER_EMAIL_NOT_FOUND });\n\t\t}\n\t\tif ((await c.context.internalAdapter.findAccounts(session.user.id)).find((a) => a.providerId === provider.id && a.accountId === linkingUserId)) return c.json({\n\t\t\turl: \"\",\n\t\t\tstatus: true,\n\t\t\tredirect: false\n\t\t});\n\t\tif (!(c.context.options.account?.accountLinking?.trustedProviders)?.includes(provider.id) && !linkingUserInfo.user.emailVerified || c.context.options.account?.accountLinking?.enabled === false) throw new APIError(\"UNAUTHORIZED\", { message: \"Account not linked - linking not allowed\" });\n\t\tif (linkingUserInfo.user.email !== session.user.email && c.context.options.account?.accountLinking?.allowDifferentEmails !== true) throw new APIError(\"UNAUTHORIZED\", { message: \"Account not linked - different emails not allowed\" });\n\t\ttry {\n\t\t\tawait c.context.internalAdapter.createAccount({\n\t\t\t\tuserId: session.user.id,\n\t\t\t\tproviderId: provider.id,\n\t\t\t\taccountId: linkingUserId,\n\t\t\t\taccessToken: c.body.idToken.accessToken,\n\t\t\t\tidToken: token,\n\t\t\t\trefreshToken: c.body.idToken.refreshToken,\n\t\t\t\tscope: c.body.idToken.scopes?.join(\",\")\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tthrow new APIError(\"EXPECTATION_FAILED\", { message: \"Account not linked - unable to create account\" });\n\t\t}\n\t\tif (c.context.options.account?.accountLinking?.updateUserInfoOnLink === true) try {\n\t\t\tawait c.context.internalAdapter.updateUser(session.user.id, {\n\t\t\t\tname: linkingUserInfo.user?.name,\n\t\t\t\timage: linkingUserInfo.user?.image\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.warn(\"Could not update user - \" + e.toString());\n\t\t}\n\t\treturn c.json({\n\t\t\turl: \"\",\n\t\t\tstatus: true,\n\t\t\tredirect: false\n\t\t});\n\t}\n\tconst state = await generateState(c, {\n\t\tuserId: session.user.id,\n\t\temail: session.user.email\n\t}, c.body.additionalData);\n\tconst url = await provider.createAuthorizationURL({\n\t\tstate: state.state,\n\t\tcodeVerifier: state.codeVerifier,\n\t\tredirectURI: `${c.context.baseURL}/callback/${provider.id}`,\n\t\tscopes: c.body.scopes\n\t});\n\treturn c.json({\n\t\turl: url.toString(),\n\t\tredirect: !c.body.disableRedirect\n\t});\n});\nconst unlinkAccount = createAuthEndpoint(\"/unlink-account\", {\n\tmethod: \"POST\",\n\tbody: z.object({\n\t\tproviderId: z.string(),\n\t\taccountId: z.string().optional()\n\t}),\n\tuse: [freshSessionMiddleware],\n\tmetadata: { openapi: {\n\t\tdescription: \"Unlink an account\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: { status: { type: \"boolean\" } }\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tconst { providerId, accountId } = ctx.body;\n\tconst accounts = await ctx.context.internalAdapter.findAccounts(ctx.context.session.user.id);\n\tif (accounts.length === 1 && !ctx.context.options.account?.accountLinking?.allowUnlinkingAll) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.FAILED_TO_UNLINK_LAST_ACCOUNT });\n\tconst accountExist = accounts.find((account) => accountId ? account.accountId === accountId && account.providerId === providerId : account.providerId === providerId);\n\tif (!accountExist) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.ACCOUNT_NOT_FOUND });\n\tawait ctx.context.internalAdapter.deleteAccount(accountExist.id);\n\treturn ctx.json({ status: true });\n});\nconst getAccessToken = createAuthEndpoint(\"/get-access-token\", {\n\tmethod: \"POST\",\n\tbody: z.object({\n\t\tproviderId: z.string().meta({ description: \"The provider ID for the OAuth provider\" }),\n\t\taccountId: z.string().meta({ description: \"The account ID associated with the refresh token\" }).optional(),\n\t\tuserId: z.string().meta({ description: \"The user ID associated with the account\" }).optional()\n\t}),\n\tmetadata: { openapi: {\n\t\tdescription: \"Get a valid access token, doing a refresh if needed\",\n\t\tresponses: {\n\t\t\t200: {\n\t\t\t\tdescription: \"A Valid access token\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\ttokenType: { type: \"string\" },\n\t\t\t\t\t\tidToken: { type: \"string\" },\n\t\t\t\t\t\taccessToken: { type: \"string\" },\n\t\t\t\t\t\trefreshToken: { type: \"string\" },\n\t\t\t\t\t\taccessTokenExpiresAt: {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tformat: \"date-time\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\trefreshTokenExpiresAt: {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tformat: \"date-time\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} } }\n\t\t\t},\n\t\t\t400: { description: \"Invalid refresh token or provider configuration\" }\n\t\t}\n\t} }\n}, async (ctx) => {\n\tconst { providerId, accountId, userId } = ctx.body || {};\n\tconst req = ctx.request;\n\tconst session = await getSessionFromCtx(ctx);\n\tif (req && !session) throw ctx.error(\"UNAUTHORIZED\");\n\tlet resolvedUserId = session?.user?.id || userId;\n\tif (!resolvedUserId) throw ctx.error(\"UNAUTHORIZED\");\n\tif (!ctx.context.socialProviders.find((p) => p.id === providerId)) throw new APIError(\"BAD_REQUEST\", { message: `Provider ${providerId} is not supported.` });\n\tconst accountData = await getAccountCookie(ctx);\n\tlet account = void 0;\n\tif (accountData && providerId === accountData.providerId && (!accountId || accountData.id === accountId)) account = accountData;\n\telse account = (await ctx.context.internalAdapter.findAccounts(resolvedUserId)).find((acc) => accountId ? acc.id === accountId && acc.providerId === providerId : acc.providerId === providerId);\n\tif (!account) throw new APIError(\"BAD_REQUEST\", { message: \"Account not found\" });\n\tconst provider = ctx.context.socialProviders.find((p) => p.id === providerId);\n\tif (!provider) throw new APIError(\"BAD_REQUEST\", { message: `Provider ${providerId} not found.` });\n\ttry {\n\t\tlet newTokens = null;\n\t\tconst accessTokenExpired = account.accessTokenExpiresAt && new Date(account.accessTokenExpiresAt).getTime() - Date.now() < 5e3;\n\t\tif (account.refreshToken && accessTokenExpired && provider.refreshAccessToken) {\n\t\t\tconst refreshToken$1 = await decryptOAuthToken(account.refreshToken, ctx.context);\n\t\t\tnewTokens = await provider.refreshAccessToken(refreshToken$1);\n\t\t\tconst updatedAccount = await ctx.context.internalAdapter.updateAccount(account.id, {\n\t\t\t\taccessToken: await setTokenUtil(newTokens.accessToken, ctx.context),\n\t\t\t\taccessTokenExpiresAt: newTokens.accessTokenExpiresAt,\n\t\t\t\trefreshToken: await setTokenUtil(newTokens.refreshToken, ctx.context),\n\t\t\t\trefreshTokenExpiresAt: newTokens.refreshTokenExpiresAt\n\t\t\t});\n\t\t\tif (ctx.context.options.account?.storeAccountCookie && updatedAccount) await setAccountCookie(ctx, updatedAccount);\n\t\t}\n\t\tconst tokens = {\n\t\t\taccessToken: newTokens?.accessToken ?? await decryptOAuthToken(account.accessToken ?? \"\", ctx.context),\n\t\t\taccessTokenExpiresAt: newTokens?.accessTokenExpiresAt ?? account.accessTokenExpiresAt ?? void 0,\n\t\t\tscopes: account.scope?.split(\",\") ?? [],\n\t\t\tidToken: newTokens?.idToken ?? account.idToken ?? void 0\n\t\t};\n\t\treturn ctx.json(tokens);\n\t} catch (error$1) {\n\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\tmessage: \"Failed to get a valid access token\",\n\t\t\tcause: error$1\n\t\t});\n\t}\n});\nconst refreshToken = createAuthEndpoint(\"/refresh-token\", {\n\tmethod: \"POST\",\n\tbody: z.object({\n\t\tproviderId: z.string().meta({ description: \"The provider ID for the OAuth provider\" }),\n\t\taccountId: z.string().meta({ description: \"The account ID associated with the refresh token\" }).optional(),\n\t\tuserId: z.string().meta({ description: \"The user ID associated with the account\" }).optional()\n\t}),\n\tmetadata: { openapi: {\n\t\tdescription: \"Refresh the access token using a refresh token\",\n\t\tresponses: {\n\t\t\t200: {\n\t\t\t\tdescription: \"Access token refreshed successfully\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\ttokenType: { type: \"string\" },\n\t\t\t\t\t\tidToken: { type: \"string\" },\n\t\t\t\t\t\taccessToken: { type: \"string\" },\n\t\t\t\t\t\trefreshToken: { type: \"string\" },\n\t\t\t\t\t\taccessTokenExpiresAt: {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tformat: \"date-time\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\trefreshTokenExpiresAt: {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tformat: \"date-time\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} } }\n\t\t\t},\n\t\t\t400: { description: \"Invalid refresh token or provider configuration\" }\n\t\t}\n\t} }\n}, async (ctx) => {\n\tconst { providerId, accountId, userId } = ctx.body;\n\tconst req = ctx.request;\n\tconst session = await getSessionFromCtx(ctx);\n\tif (req && !session) throw ctx.error(\"UNAUTHORIZED\");\n\tlet resolvedUserId = session?.user?.id || userId;\n\tif (!resolvedUserId) throw new APIError(\"BAD_REQUEST\", { message: `Either userId or session is required` });\n\tconst provider = ctx.context.socialProviders.find((p) => p.id === providerId);\n\tif (!provider) throw new APIError(\"BAD_REQUEST\", { message: `Provider ${providerId} not found.` });\n\tif (!provider.refreshAccessToken) throw new APIError(\"BAD_REQUEST\", { message: `Provider ${providerId} does not support token refreshing.` });\n\tlet account = void 0;\n\tconst accountData = await getAccountCookie(ctx);\n\tif (accountData && (!providerId || providerId === accountData?.providerId)) account = accountData;\n\telse account = (await ctx.context.internalAdapter.findAccounts(resolvedUserId)).find((acc) => accountId ? acc.id === accountId && acc.providerId === providerId : acc.providerId === providerId);\n\tif (!account) throw new APIError(\"BAD_REQUEST\", { message: \"Account not found\" });\n\tlet refreshToken$1 = void 0;\n\tif (accountData && providerId === accountData.providerId) refreshToken$1 = accountData.refreshToken ?? void 0;\n\telse refreshToken$1 = account.refreshToken ?? void 0;\n\tif (!refreshToken$1) throw new APIError(\"BAD_REQUEST\", { message: \"Refresh token not found\" });\n\ttry {\n\t\tconst decryptedRefreshToken = await decryptOAuthToken(refreshToken$1, ctx.context);\n\t\tconst tokens = await provider.refreshAccessToken(decryptedRefreshToken);\n\t\tif (account.id) {\n\t\t\tconst updateData = {\n\t\t\t\t...account || {},\n\t\t\t\taccessToken: await setTokenUtil(tokens.accessToken, ctx.context),\n\t\t\t\trefreshToken: await setTokenUtil(tokens.refreshToken, ctx.context),\n\t\t\t\taccessTokenExpiresAt: tokens.accessTokenExpiresAt,\n\t\t\t\trefreshTokenExpiresAt: tokens.refreshTokenExpiresAt,\n\t\t\t\tscope: tokens.scopes?.join(\",\") || account.scope,\n\t\t\t\tidToken: tokens.idToken || account.idToken\n\t\t\t};\n\t\t\tawait ctx.context.internalAdapter.updateAccount(account.id, updateData);\n\t\t}\n\t\tif (accountData && providerId === accountData.providerId && ctx.context.options.account?.storeAccountCookie) await setAccountCookie(ctx, {\n\t\t\t...accountData,\n\t\t\taccessToken: await setTokenUtil(tokens.accessToken, ctx.context),\n\t\t\trefreshToken: await setTokenUtil(tokens.refreshToken, ctx.context),\n\t\t\taccessTokenExpiresAt: tokens.accessTokenExpiresAt,\n\t\t\trefreshTokenExpiresAt: tokens.refreshTokenExpiresAt,\n\t\t\tscope: tokens.scopes?.join(\",\") || accountData.scope,\n\t\t\tidToken: tokens.idToken || accountData.idToken\n\t\t});\n\t\treturn ctx.json({\n\t\t\taccessToken: tokens.accessToken,\n\t\t\trefreshToken: tokens.refreshToken,\n\t\t\taccessTokenExpiresAt: tokens.accessTokenExpiresAt,\n\t\t\trefreshTokenExpiresAt: tokens.refreshTokenExpiresAt,\n\t\t\tscope: tokens.scopes?.join(\",\") || account.scope,\n\t\t\tidToken: tokens.idToken || account.idToken,\n\t\t\tproviderId: account.providerId,\n\t\t\taccountId: account.accountId\n\t\t});\n\t} catch (error$1) {\n\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\tmessage: \"Failed to refresh access token\",\n\t\t\tcause: error$1\n\t\t});\n\t}\n});\nconst accountInfoQuerySchema = z.optional(z.object({ accountId: z.string().meta({ description: \"The provider given account id for which to get the account info\" }).optional() }));\nconst accountInfo = createAuthEndpoint(\"/account-info\", {\n\tmethod: \"GET\",\n\tuse: [sessionMiddleware],\n\tmetadata: { openapi: {\n\t\tdescription: \"Get the account info provided by the provider\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\tuser: {\n\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\tid: { type: \"string\" },\n\t\t\t\t\t\t\tname: { type: \"string\" },\n\t\t\t\t\t\t\temail: { type: \"string\" },\n\t\t\t\t\t\t\timage: { type: \"string\" },\n\t\t\t\t\t\t\temailVerified: { type: \"boolean\" }\n\t\t\t\t\t\t},\n\t\t\t\t\t\trequired: [\"id\", \"emailVerified\"]\n\t\t\t\t\t},\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\tproperties: {},\n\t\t\t\t\t\tadditionalProperties: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trequired: [\"user\", \"data\"],\n\t\t\t\tadditionalProperties: false\n\t\t\t} } }\n\t\t} }\n\t} },\n\tquery: accountInfoQuerySchema\n}, async (ctx) => {\n\tconst providedAccountId = ctx.query?.accountId;\n\tlet account = void 0;\n\tif (!providedAccountId) {\n\t\tif (ctx.context.options.account?.storeAccountCookie) {\n\t\t\tconst accountData = await getAccountCookie(ctx);\n\t\t\tif (accountData) account = accountData;\n\t\t}\n\t} else {\n\t\tconst accountData = await ctx.context.internalAdapter.findAccount(providedAccountId);\n\t\tif (accountData) account = accountData;\n\t}\n\tif (!account || account.userId !== ctx.context.session.user.id) throw new APIError(\"BAD_REQUEST\", { message: \"Account not found\" });\n\tconst provider = ctx.context.socialProviders.find((p) => p.id === account.providerId);\n\tif (!provider) throw new APIError(\"INTERNAL_SERVER_ERROR\", { message: `Provider account provider is ${account.providerId} but it is not configured` });\n\tconst tokens = await getAccessToken({\n\t\t...ctx,\n\t\tmethod: \"POST\",\n\t\tbody: {\n\t\t\taccountId: account.id,\n\t\t\tproviderId: account.providerId\n\t\t},\n\t\treturnHeaders: false,\n\t\treturnStatus: false\n\t});\n\tif (!tokens.accessToken) throw new APIError(\"BAD_REQUEST\", { message: \"Access token not found\" });\n\tconst info = await provider.getUserInfo({\n\t\t...tokens,\n\t\taccessToken: tokens.accessToken\n\t});\n\treturn ctx.json(info);\n});\n\n//#endregion\n//#region src/oauth2/link-account.ts\nasync function handleOAuthUserInfo(c, { userInfo, account, callbackURL, disableSignUp, overrideUserInfo }) {\n\tconst dbUser = await c.context.internalAdapter.findOAuthUser(userInfo.email.toLowerCase(), account.accountId, account.providerId).catch((e) => {\n\t\tlogger.error(\"Better auth was unable to query your database.\\nError: \", e);\n\t\tconst errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n\t\tthrow c.redirect(`${errorURL}?error=internal_server_error`);\n\t});\n\tlet user = dbUser?.user;\n\tlet isRegister = !user;\n\tif (dbUser) {\n\t\tconst hasBeenLinked = dbUser.accounts.find((a) => a.providerId === account.providerId && a.accountId === account.accountId);\n\t\tif (!hasBeenLinked) {\n\t\t\tif (!(c.context.options.account?.accountLinking?.trustedProviders)?.includes(account.providerId) && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n\t\t\t\tif (isDevelopment()) logger.warn(`User already exist but account isn't linked to ${account.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`);\n\t\t\t\treturn {\n\t\t\t\t\terror: \"account not linked\",\n\t\t\t\t\tdata: null\n\t\t\t\t};\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tawait c.context.internalAdapter.linkAccount({\n\t\t\t\t\tproviderId: account.providerId,\n\t\t\t\t\taccountId: userInfo.id.toString(),\n\t\t\t\t\tuserId: dbUser.user.id,\n\t\t\t\t\taccessToken: await setTokenUtil(account.accessToken, c.context),\n\t\t\t\t\trefreshToken: await setTokenUtil(account.refreshToken, c.context),\n\t\t\t\t\tidToken: account.idToken,\n\t\t\t\t\taccessTokenExpiresAt: account.accessTokenExpiresAt,\n\t\t\t\t\trefreshTokenExpiresAt: account.refreshTokenExpiresAt,\n\t\t\t\t\tscope: account.scope\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\tlogger.error(\"Unable to link account\", e);\n\t\t\t\treturn {\n\t\t\t\t\terror: \"unable to link account\",\n\t\t\t\t\tdata: null\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (userInfo.emailVerified && !dbUser.user.emailVerified && userInfo.email.toLowerCase() === dbUser.user.email) await c.context.internalAdapter.updateUser(dbUser.user.id, { emailVerified: true });\n\t\t} else {\n\t\t\tif (c.context.options.account?.updateAccountOnSignIn !== false) {\n\t\t\t\tconst updateData = Object.fromEntries(Object.entries({\n\t\t\t\t\tidToken: account.idToken,\n\t\t\t\t\taccessToken: await setTokenUtil(account.accessToken, c.context),\n\t\t\t\t\trefreshToken: await setTokenUtil(account.refreshToken, c.context),\n\t\t\t\t\taccessTokenExpiresAt: account.accessTokenExpiresAt,\n\t\t\t\t\trefreshTokenExpiresAt: account.refreshTokenExpiresAt,\n\t\t\t\t\tscope: account.scope\n\t\t\t\t}).filter(([_, value]) => value !== void 0));\n\t\t\t\tif (c.context.options.account?.storeAccountCookie) await setAccountCookie(c, updateData);\n\t\t\t\tif (Object.keys(updateData).length > 0) await c.context.internalAdapter.updateAccount(hasBeenLinked.id, updateData);\n\t\t\t}\n\t\t\tif (userInfo.emailVerified && !dbUser.user.emailVerified && userInfo.email.toLowerCase() === dbUser.user.email) await c.context.internalAdapter.updateUser(dbUser.user.id, { emailVerified: true });\n\t\t}\n\t\tif (overrideUserInfo) {\n\t\t\tconst { id: _, ...restUserInfo } = userInfo;\n\t\t\tuser = await c.context.internalAdapter.updateUser(dbUser.user.id, {\n\t\t\t\t...restUserInfo,\n\t\t\t\temail: userInfo.email.toLowerCase(),\n\t\t\t\temailVerified: userInfo.email.toLowerCase() === dbUser.user.email ? dbUser.user.emailVerified || userInfo.emailVerified : userInfo.emailVerified\n\t\t\t});\n\t\t}\n\t} else {\n\t\tif (disableSignUp) return {\n\t\t\terror: \"signup disabled\",\n\t\t\tdata: null,\n\t\t\tisRegister: false\n\t\t};\n\t\ttry {\n\t\t\tconst { id: _, ...restUserInfo } = userInfo;\n\t\t\tconst accountData = {\n\t\t\t\taccessToken: await setTokenUtil(account.accessToken, c.context),\n\t\t\t\trefreshToken: await setTokenUtil(account.refreshToken, c.context),\n\t\t\t\tidToken: account.idToken,\n\t\t\t\taccessTokenExpiresAt: account.accessTokenExpiresAt,\n\t\t\t\trefreshTokenExpiresAt: account.refreshTokenExpiresAt,\n\t\t\t\tscope: account.scope,\n\t\t\t\tproviderId: account.providerId,\n\t\t\t\taccountId: userInfo.id.toString()\n\t\t\t};\n\t\t\tconst { user: createdUser, account: createdAccount } = await c.context.internalAdapter.createOAuthUser({\n\t\t\t\t...restUserInfo,\n\t\t\t\temail: userInfo.email.toLowerCase()\n\t\t\t}, accountData);\n\t\t\tuser = createdUser;\n\t\t\tif (c.context.options.account?.storeAccountCookie) await setAccountCookie(c, createdAccount);\n\t\t\tif (!userInfo.emailVerified && user && c.context.options.emailVerification?.sendOnSignUp) {\n\t\t\t\tconst token = await createEmailVerificationToken(c.context.secret, user.email, void 0, c.context.options.emailVerification?.expiresIn);\n\t\t\t\tconst url = `${c.context.baseURL}/verify-email?token=${token}&callbackURL=${callbackURL}`;\n\t\t\t\tawait c.context.options.emailVerification?.sendVerificationEmail?.({\n\t\t\t\t\tuser,\n\t\t\t\t\turl,\n\t\t\t\t\ttoken\n\t\t\t\t}, c.request);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tlogger.error(e);\n\t\t\tif (e instanceof APIError$1) return {\n\t\t\t\terror: e.message,\n\t\t\t\tdata: null,\n\t\t\t\tisRegister: false\n\t\t\t};\n\t\t\treturn {\n\t\t\t\terror: \"unable to create user\",\n\t\t\t\tdata: null,\n\t\t\t\tisRegister: false\n\t\t\t};\n\t\t}\n\t}\n\tif (!user) return {\n\t\terror: \"unable to create user\",\n\t\tdata: null,\n\t\tisRegister: false\n\t};\n\tconst session = await c.context.internalAdapter.createSession(user.id);\n\tif (!session) return {\n\t\terror: \"unable to create session\",\n\t\tdata: null,\n\t\tisRegister: false\n\t};\n\treturn {\n\t\tdata: {\n\t\t\tsession,\n\t\t\tuser\n\t\t},\n\t\terror: null,\n\t\tisRegister\n\t};\n}\n\n//#endregion\n//#region src/api/routes/callback.ts\nconst schema = z.object({\n\tcode: z.string().optional(),\n\terror: z.string().optional(),\n\tdevice_id: z.string().optional(),\n\terror_description: z.string().optional(),\n\tstate: z.string().optional(),\n\tuser: z.string().optional()\n});\nconst callbackOAuth = createAuthEndpoint(\"/callback/:id\", {\n\tmethod: [\"GET\", \"POST\"],\n\toperationId: \"handleOAuthCallback\",\n\tbody: schema.optional(),\n\tquery: schema.optional(),\n\tmetadata: {\n\t\t...HIDE_METADATA,\n\t\tallowedMediaTypes: [\"application/x-www-form-urlencoded\", \"application/json\"]\n\t}\n}, async (c) => {\n\tlet queryOrBody;\n\tconst defaultErrorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n\tif (c.method === \"POST\") {\n\t\tconst postData = c.body ? schema.parse(c.body) : {};\n\t\tconst queryData = c.query ? schema.parse(c.query) : {};\n\t\tconst mergedData = schema.parse({\n\t\t\t...postData,\n\t\t\t...queryData\n\t\t});\n\t\tconst params = new URLSearchParams();\n\t\tfor (const [key, value] of Object.entries(mergedData)) if (value !== void 0 && value !== null) params.set(key, String(value));\n\t\tconst redirectURL = `${c.context.baseURL}/callback/${c.params.id}?${params.toString()}`;\n\t\tthrow c.redirect(redirectURL);\n\t}\n\ttry {\n\t\tif (c.method === \"GET\") queryOrBody = schema.parse(c.query);\n\t\telse if (c.method === \"POST\") queryOrBody = schema.parse(c.body);\n\t\telse throw new Error(\"Unsupported method\");\n\t} catch (e) {\n\t\tc.context.logger.error(\"INVALID_CALLBACK_REQUEST\", e);\n\t\tthrow c.redirect(`${defaultErrorURL}?error=invalid_callback_request`);\n\t}\n\tconst { code, error: error$1, state, error_description, device_id } = queryOrBody;\n\tif (!state) {\n\t\tc.context.logger.error(\"State not found\", error$1);\n\t\tconst url = `${defaultErrorURL}${defaultErrorURL.includes(\"?\") ? \"&\" : \"?\"}state=state_not_found`;\n\t\tthrow c.redirect(url);\n\t}\n\tconst { codeVerifier, callbackURL, link, errorURL, newUserURL, requestSignUp } = await parseState(c);\n\tfunction redirectOnError(error$2, description) {\n\t\tconst baseURL = errorURL ?? defaultErrorURL;\n\t\tconst params = new URLSearchParams({ error: error$2 });\n\t\tif (description) params.set(\"error_description\", description);\n\t\tconst url = `${baseURL}${baseURL.includes(\"?\") ? \"&\" : \"?\"}${params.toString()}`;\n\t\tthrow c.redirect(url);\n\t}\n\tif (error$1) redirectOnError(error$1, error_description);\n\tif (!code) {\n\t\tc.context.logger.error(\"Code not found\");\n\t\tthrow redirectOnError(\"no_code\");\n\t}\n\tconst provider = c.context.socialProviders.find((p) => p.id === c.params.id);\n\tif (!provider) {\n\t\tc.context.logger.error(\"Oauth provider with id\", c.params.id, \"not found\");\n\t\tthrow redirectOnError(\"oauth_provider_not_found\");\n\t}\n\tlet tokens;\n\ttry {\n\t\ttokens = await provider.validateAuthorizationCode({\n\t\t\tcode,\n\t\t\tcodeVerifier,\n\t\t\tdeviceId: device_id,\n\t\t\tredirectURI: `${c.context.baseURL}/callback/${provider.id}`\n\t\t});\n\t} catch (e) {\n\t\tc.context.logger.error(\"\", e);\n\t\tthrow redirectOnError(\"invalid_code\");\n\t}\n\tconst userInfo = await provider.getUserInfo({\n\t\t...tokens,\n\t\tuser: c.body?.user ? safeJSONParse(c.body.user) : void 0\n\t}).then((res) => res?.user);\n\tif (!userInfo) {\n\t\tc.context.logger.error(\"Unable to get user info\");\n\t\treturn redirectOnError(\"unable_to_get_user_info\");\n\t}\n\tif (!callbackURL) {\n\t\tc.context.logger.error(\"No callback URL found\");\n\t\tthrow redirectOnError(\"no_callback_url\");\n\t}\n\tif (link) {\n\t\tif (!(c.context.options.account?.accountLinking?.trustedProviders)?.includes(provider.id) && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n\t\t\tc.context.logger.error(\"Unable to link account - untrusted provider\");\n\t\t\treturn redirectOnError(\"unable_to_link_account\");\n\t\t}\n\t\tif (userInfo.email !== link.email && c.context.options.account?.accountLinking?.allowDifferentEmails !== true) return redirectOnError(\"email_doesn't_match\");\n\t\tconst existingAccount = await c.context.internalAdapter.findAccount(String(userInfo.id));\n\t\tif (existingAccount) {\n\t\t\tif (existingAccount.userId.toString() !== link.userId.toString()) return redirectOnError(\"account_already_linked_to_different_user\");\n\t\t\tconst updateData = Object.fromEntries(Object.entries({\n\t\t\t\taccessToken: await setTokenUtil(tokens.accessToken, c.context),\n\t\t\t\trefreshToken: await setTokenUtil(tokens.refreshToken, c.context),\n\t\t\t\tidToken: tokens.idToken,\n\t\t\t\taccessTokenExpiresAt: tokens.accessTokenExpiresAt,\n\t\t\t\trefreshTokenExpiresAt: tokens.refreshTokenExpiresAt,\n\t\t\t\tscope: tokens.scopes?.join(\",\")\n\t\t\t}).filter(([_, value]) => value !== void 0));\n\t\t\tawait c.context.internalAdapter.updateAccount(existingAccount.id, updateData);\n\t\t} else if (!await c.context.internalAdapter.createAccount({\n\t\t\tuserId: link.userId,\n\t\t\tproviderId: provider.id,\n\t\t\taccountId: String(userInfo.id),\n\t\t\t...tokens,\n\t\t\taccessToken: await setTokenUtil(tokens.accessToken, c.context),\n\t\t\trefreshToken: await setTokenUtil(tokens.refreshToken, c.context),\n\t\t\tscope: tokens.scopes?.join(\",\")\n\t\t})) return redirectOnError(\"unable_to_link_account\");\n\t\tlet toRedirectTo$1;\n\t\ttry {\n\t\t\ttoRedirectTo$1 = callbackURL.toString();\n\t\t} catch {\n\t\t\ttoRedirectTo$1 = callbackURL;\n\t\t}\n\t\tthrow c.redirect(toRedirectTo$1);\n\t}\n\tif (!userInfo.email) {\n\t\tc.context.logger.error(\"Provider did not return email. This could be due to misconfiguration in the provider settings.\");\n\t\treturn redirectOnError(\"email_not_found\");\n\t}\n\tconst accountData = {\n\t\tproviderId: provider.id,\n\t\taccountId: String(userInfo.id),\n\t\t...tokens,\n\t\tscope: tokens.scopes?.join(\",\")\n\t};\n\tconst result = await handleOAuthUserInfo(c, {\n\t\tuserInfo: {\n\t\t\t...userInfo,\n\t\t\tid: String(userInfo.id),\n\t\t\temail: userInfo.email,\n\t\t\tname: userInfo.name || userInfo.email\n\t\t},\n\t\taccount: accountData,\n\t\tcallbackURL,\n\t\tdisableSignUp: provider.disableImplicitSignUp && !requestSignUp || provider.options?.disableSignUp,\n\t\toverrideUserInfo: provider.options?.overrideUserInfoOnSignIn\n\t});\n\tif (result.error) {\n\t\tc.context.logger.error(result.error.split(\" \").join(\"_\"));\n\t\treturn redirectOnError(result.error.split(\" \").join(\"_\"));\n\t}\n\tconst { session, user } = result.data;\n\tawait setSessionCookie(c, {\n\t\tsession,\n\t\tuser\n\t});\n\tlet toRedirectTo;\n\ttry {\n\t\ttoRedirectTo = (result.isRegister ? newUserURL || callbackURL : callbackURL).toString();\n\t} catch {\n\t\ttoRedirectTo = result.isRegister ? newUserURL || callbackURL : callbackURL;\n\t}\n\tthrow c.redirect(toRedirectTo);\n});\n\n//#endregion\n//#region src/api/routes/email-verification.ts\nasync function createEmailVerificationToken(secret, email, updateTo, expiresIn = 3600, extraPayload) {\n\treturn await signJWT({\n\t\temail: email.toLowerCase(),\n\t\tupdateTo,\n\t\t...extraPayload\n\t}, secret, expiresIn);\n}\n/**\n* A function to send a verification email to the user\n*/\nasync function sendVerificationEmailFn(ctx, user) {\n\tif (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n\t\tctx.context.logger.error(\"Verification email isn't enabled.\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: \"Verification email isn't enabled\" });\n\t}\n\tconst token = await createEmailVerificationToken(ctx.context.secret, user.email, void 0, ctx.context.options.emailVerification?.expiresIn);\n\tconst callbackURL = ctx.body.callbackURL ? encodeURIComponent(ctx.body.callbackURL) : encodeURIComponent(\"/\");\n\tconst url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${callbackURL}`;\n\tawait ctx.context.options.emailVerification.sendVerificationEmail({\n\t\tuser,\n\t\turl,\n\t\ttoken\n\t}, ctx.request);\n}\nconst sendVerificationEmail = createAuthEndpoint(\"/send-verification-email\", {\n\tmethod: \"POST\",\n\toperationId: \"sendVerificationEmail\",\n\tbody: z.object({\n\t\temail: z.email().meta({ description: \"The email to send the verification email to\" }),\n\t\tcallbackURL: z.string().meta({ description: \"The URL to use for email verification callback\" }).optional()\n\t}),\n\tmetadata: { openapi: {\n\t\toperationId: \"sendVerificationEmail\",\n\t\tdescription: \"Send a verification email to the user\",\n\t\trequestBody: { content: { \"application/json\": { schema: {\n\t\t\ttype: \"object\",\n\t\t\tproperties: {\n\t\t\t\temail: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\tdescription: \"The email to send the verification email to\",\n\t\t\t\t\texample: \"user@example.com\"\n\t\t\t\t},\n\t\t\t\tcallbackURL: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\tdescription: \"The URL to use for email verification callback\",\n\t\t\t\t\texample: \"https://example.com/callback\",\n\t\t\t\t\tnullable: true\n\t\t\t\t}\n\t\t\t},\n\t\t\trequired: [\"email\"]\n\t\t} } } },\n\t\tresponses: {\n\t\t\t\"200\": {\n\t\t\t\tdescription: \"Success\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tproperties: { status: {\n\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\tdescription: \"Indicates if the email was sent successfully\",\n\t\t\t\t\t\texample: true\n\t\t\t\t\t} }\n\t\t\t\t} } }\n\t\t\t},\n\t\t\t\"400\": {\n\t\t\t\tdescription: \"Bad Request\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tproperties: { message: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tdescription: \"Error message\",\n\t\t\t\t\t\texample: \"Verification email isn't enabled\"\n\t\t\t\t\t} }\n\t\t\t\t} } }\n\t\t\t}\n\t\t}\n\t} }\n}, async (ctx) => {\n\tif (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n\t\tctx.context.logger.error(\"Verification email isn't enabled.\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: \"Verification email isn't enabled\" });\n\t}\n\tconst { email } = ctx.body;\n\tconst session = await getSessionFromCtx(ctx);\n\tif (!session) {\n\t\tconst user = await ctx.context.internalAdapter.findUserByEmail(email);\n\t\tif (!user) {\n\t\t\tawait createEmailVerificationToken(ctx.context.secret, email, void 0, ctx.context.options.emailVerification?.expiresIn);\n\t\t\treturn ctx.json({ status: true });\n\t\t}\n\t\tawait sendVerificationEmailFn(ctx, user.user);\n\t\treturn ctx.json({ status: true });\n\t}\n\tif (session?.user.emailVerified) throw new APIError(\"BAD_REQUEST\", { message: \"You can only send a verification email to an unverified email\" });\n\tif (session?.user.email !== email) throw new APIError(\"BAD_REQUEST\", { message: \"You can only send a verification email to your own email\" });\n\tawait sendVerificationEmailFn(ctx, session.user);\n\treturn ctx.json({ status: true });\n});\nconst verifyEmail = createAuthEndpoint(\"/verify-email\", {\n\tmethod: \"GET\",\n\toperationId: \"verifyEmail\",\n\tquery: z.object({\n\t\ttoken: z.string().meta({ description: \"The token to verify the email\" }),\n\t\tcallbackURL: z.string().meta({ description: \"The URL to redirect to after email verification\" }).optional()\n\t}),\n\tuse: [originCheck((ctx) => ctx.query.callbackURL)],\n\tmetadata: { openapi: {\n\t\tdescription: \"Verify the email of the user\",\n\t\tparameters: [{\n\t\t\tname: \"token\",\n\t\t\tin: \"query\",\n\t\t\tdescription: \"The token to verify the email\",\n\t\t\trequired: true,\n\t\t\tschema: { type: \"string\" }\n\t\t}, {\n\t\t\tname: \"callbackURL\",\n\t\t\tin: \"query\",\n\t\t\tdescription: \"The URL to redirect to after email verification\",\n\t\t\trequired: false,\n\t\t\tschema: { type: \"string\" }\n\t\t}],\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\tuser: {\n\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t$ref: \"#/components/schemas/User\"\n\t\t\t\t\t},\n\t\t\t\t\tstatus: {\n\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\tdescription: \"Indicates if the email was verified successfully\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trequired: [\"user\", \"status\"]\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tfunction redirectOnError(error$1) {\n\t\tif (ctx.query.callbackURL) {\n\t\t\tif (ctx.query.callbackURL.includes(\"?\")) throw ctx.redirect(`${ctx.query.callbackURL}&error=${error$1}`);\n\t\t\tthrow ctx.redirect(`${ctx.query.callbackURL}?error=${error$1}`);\n\t\t}\n\t\tthrow new APIError(\"UNAUTHORIZED\", { message: error$1 });\n\t}\n\tconst { token } = ctx.query;\n\tlet jwt;\n\ttry {\n\t\tjwt = await jwtVerify(token, new TextEncoder().encode(ctx.context.secret), { algorithms: [\"HS256\"] });\n\t} catch (e) {\n\t\tif (e instanceof JWTExpired) return redirectOnError(\"token_expired\");\n\t\treturn redirectOnError(\"invalid_token\");\n\t}\n\tconst parsed = z.object({\n\t\temail: z.email(),\n\t\tupdateTo: z.string().optional(),\n\t\trequestType: z.string().optional()\n\t}).parse(jwt.payload);\n\tconst user = await ctx.context.internalAdapter.findUserByEmail(parsed.email);\n\tif (!user) return redirectOnError(\"user_not_found\");\n\tif (parsed.updateTo) {\n\t\tlet session = await getSessionFromCtx(ctx);\n\t\tif (session && session.user.email !== parsed.email) return redirectOnError(\"unauthorized\");\n\t\tif (parsed.requestType === \"change-email-confirmation\") {\n\t\t\tconst newToken$1 = await createEmailVerificationToken(ctx.context.secret, parsed.email, parsed.updateTo, ctx.context.options.emailVerification?.expiresIn, { requestType: \"change-email-verification\" });\n\t\t\tconst updateCallbackURL$1 = ctx.query.callbackURL ? encodeURIComponent(ctx.query.callbackURL) : encodeURIComponent(\"/\");\n\t\t\tconst url = `${ctx.context.baseURL}/verify-email?token=${newToken$1}&callbackURL=${updateCallbackURL$1}`;\n\t\t\tawait ctx.context.options.emailVerification?.sendVerificationEmail?.({\n\t\t\t\tuser: {\n\t\t\t\t\t...user.user,\n\t\t\t\t\temail: parsed.updateTo\n\t\t\t\t},\n\t\t\t\turl,\n\t\t\t\ttoken: newToken$1\n\t\t\t}, ctx.request);\n\t\t\tif (ctx.query.callbackURL) throw ctx.redirect(ctx.query.callbackURL);\n\t\t\treturn ctx.json({ status: true });\n\t\t}\n\t\tif (!session) {\n\t\t\tconst newSession = await ctx.context.internalAdapter.createSession(user.user.id);\n\t\t\tif (!newSession) throw new APIError(\"INTERNAL_SERVER_ERROR\", { message: \"Failed to create session\" });\n\t\t\tsession = {\n\t\t\t\tsession: newSession,\n\t\t\t\tuser: user.user\n\t\t\t};\n\t\t}\n\t\tif (parsed.requestType === \"change-email-verification\") {\n\t\t\tconst updatedUser$2 = await ctx.context.internalAdapter.updateUserByEmail(parsed.email, {\n\t\t\t\temail: parsed.updateTo,\n\t\t\t\temailVerified: true\n\t\t\t});\n\t\t\tawait setSessionCookie(ctx, {\n\t\t\t\tsession: session.session,\n\t\t\t\tuser: {\n\t\t\t\t\t...session.user,\n\t\t\t\t\temail: parsed.updateTo,\n\t\t\t\t\temailVerified: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (ctx.query.callbackURL) throw ctx.redirect(ctx.query.callbackURL);\n\t\t\treturn ctx.json({\n\t\t\t\tstatus: true,\n\t\t\t\tuser: updatedUser$2\n\t\t\t});\n\t\t}\n\t\tconst updatedUser$1 = await ctx.context.internalAdapter.updateUserByEmail(parsed.email, {\n\t\t\temail: parsed.updateTo,\n\t\t\temailVerified: false\n\t\t});\n\t\tconst newToken = await createEmailVerificationToken(ctx.context.secret, parsed.updateTo);\n\t\tconst updateCallbackURL = ctx.query.callbackURL ? encodeURIComponent(ctx.query.callbackURL) : encodeURIComponent(\"/\");\n\t\tawait ctx.context.options.emailVerification?.sendVerificationEmail?.({\n\t\t\tuser: updatedUser$1,\n\t\t\turl: `${ctx.context.baseURL}/verify-email?token=${newToken}&callbackURL=${updateCallbackURL}`,\n\t\t\ttoken: newToken\n\t\t}, ctx.request);\n\t\tawait setSessionCookie(ctx, {\n\t\t\tsession: session.session,\n\t\t\tuser: {\n\t\t\t\t...session.user,\n\t\t\t\temail: parsed.updateTo,\n\t\t\t\temailVerified: false\n\t\t\t}\n\t\t});\n\t\tif (ctx.query.callbackURL) throw ctx.redirect(ctx.query.callbackURL);\n\t\treturn ctx.json({\n\t\t\tstatus: true,\n\t\t\tuser: {\n\t\t\t\tid: updatedUser$1.id,\n\t\t\t\temail: updatedUser$1.email,\n\t\t\t\tname: updatedUser$1.name,\n\t\t\t\timage: updatedUser$1.image,\n\t\t\t\temailVerified: updatedUser$1.emailVerified,\n\t\t\t\tcreatedAt: updatedUser$1.createdAt,\n\t\t\t\tupdatedAt: updatedUser$1.updatedAt\n\t\t\t}\n\t\t});\n\t}\n\tif (user.user.emailVerified) {\n\t\tif (ctx.query.callbackURL) throw ctx.redirect(ctx.query.callbackURL);\n\t\treturn ctx.json({\n\t\t\tstatus: true,\n\t\t\tuser: null\n\t\t});\n\t}\n\tif (ctx.context.options.emailVerification?.onEmailVerification) await ctx.context.options.emailVerification.onEmailVerification(user.user, ctx.request);\n\tconst updatedUser = await ctx.context.internalAdapter.updateUserByEmail(parsed.email, { emailVerified: true });\n\tif (ctx.context.options.emailVerification?.afterEmailVerification) await ctx.context.options.emailVerification.afterEmailVerification(updatedUser, ctx.request);\n\tif (ctx.context.options.emailVerification?.autoSignInAfterVerification) {\n\t\tconst currentSession = await getSessionFromCtx(ctx);\n\t\tif (!currentSession || currentSession.user.email !== parsed.email) {\n\t\t\tconst session = await ctx.context.internalAdapter.createSession(user.user.id);\n\t\t\tif (!session) throw new APIError(\"INTERNAL_SERVER_ERROR\", { message: \"Failed to create session\" });\n\t\t\tawait setSessionCookie(ctx, {\n\t\t\t\tsession,\n\t\t\t\tuser: {\n\t\t\t\t\t...user.user,\n\t\t\t\t\temailVerified: true\n\t\t\t\t}\n\t\t\t});\n\t\t} else await setSessionCookie(ctx, {\n\t\t\tsession: currentSession.session,\n\t\t\tuser: {\n\t\t\t\t...currentSession.user,\n\t\t\t\temailVerified: true\n\t\t\t}\n\t\t});\n\t}\n\tif (ctx.query.callbackURL) throw ctx.redirect(ctx.query.callbackURL);\n\treturn ctx.json({\n\t\tstatus: true,\n\t\tuser: null\n\t});\n});\n\n//#endregion\n//#region src/api/routes/error.ts\nfunction sanitize(input) {\n\treturn input.replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#39;\").replace(/&(?!amp;|lt;|gt;|quot;|#39;|#x[0-9a-fA-F]+;|#[0-9]+;)/g, \"&amp;\");\n}\nconst html = (options, code = \"Unknown\", description = null) => {\n\tconst custom = options.onAPIError?.customizeDefaultErrorPage;\n\treturn `<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>Error</title>\n    <style>\n      * {\n        box-sizing: border-box;\n      }\n      body {\n        font-family: ${custom?.font?.defaultFamily || \"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif\"};\n        background: ${custom?.colors?.background || \"var(--background)\"};\n        color: var(--foreground);\n        margin: 0;\n      }\n      :root,\n      :host {\n        --spacing: 0.25rem;\n        --container-md: 28rem;\n        --text-sm: ${custom?.size?.textSm || \"0.875rem\"};\n        --text-sm--line-height: calc(1.25 / 0.875);\n        --text-2xl: ${custom?.size?.text2xl || \"1.5rem\"};\n        --text-2xl--line-height: calc(2 / 1.5);\n        --text-4xl: ${custom?.size?.text4xl || \"2.25rem\"};\n        --text-4xl--line-height: calc(2.5 / 2.25);\n        --text-6xl: ${custom?.size?.text6xl || \"3rem\"};\n        --text-6xl--line-height: 1;\n        --font-weight-medium: 500;\n        --font-weight-semibold: 600;\n        --font-weight-bold: 700;\n        --default-transition-duration: 150ms;\n        --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n        --radius: ${custom?.size?.radiusSm || \"0.625rem\"};\n        --default-mono-font-family: ${custom?.font?.monoFamily || \"var(--font-geist-mono)\"};\n        --primary: ${custom?.colors?.primary || \"black\"};\n        --primary-foreground: ${custom?.colors?.primaryForeground || \"white\"};\n        --background: ${custom?.colors?.background || \"white\"};\n        --foreground: ${custom?.colors?.foreground || \"oklch(0.271 0 0)\"};\n        --border: ${custom?.colors?.border || \"oklch(0.89 0 0)\"};\n        --destructive: ${custom?.colors?.destructive || \"oklch(0.55 0.15 25.723)\"};\n        --muted-foreground: ${custom?.colors?.mutedForeground || \"oklch(0.545 0 0)\"};\n        --corner-border: ${custom?.colors?.cornerBorder || \"#404040\"};\n      }\n\n      button, .btn {\n        cursor: pointer;\n        background: none;\n        border: none;\n        color: inherit;\n        font: inherit;\n        transition: all var(--default-transition-duration)\n          var(--default-transition-timing-function);\n      }\n      button:hover, .btn:hover {\n        opacity: 0.8;\n      }\n\n      @media (prefers-color-scheme: dark) {\n        :root,\n        :host {\n          --primary: ${custom?.colors?.primary || \"white\"};\n          --primary-foreground: ${custom?.colors?.primaryForeground || \"black\"};\n          --background: ${custom?.colors?.background || \"oklch(0.15 0 0)\"};\n          --foreground: ${custom?.colors?.foreground || \"oklch(0.98 0 0)\"};\n          --border: ${custom?.colors?.border || \"oklch(0.27 0 0)\"};\n          --destructive: ${custom?.colors?.destructive || \"oklch(0.65 0.15 25.723)\"};\n          --muted-foreground: ${custom?.colors?.mutedForeground || \"oklch(0.65 0 0)\"};\n          --corner-border: ${custom?.colors?.cornerBorder || \"#a0a0a0\"};\n        }\n      }\n      @media (max-width: 640px) {\n        :root, :host {\n          --text-6xl: 2.5rem;\n          --text-2xl: 1.25rem;\n          --text-sm: 0.8125rem;\n        }\n      }\n      @media (max-width: 480px) {\n        :root, :host {\n          --text-6xl: 2rem;\n          --text-2xl: 1.125rem;\n        }\n      }\n    </style>\n  </head>\n  <body style=\"width: 100vw; min-height: 100vh; overflow-x: hidden; overflow-y: auto;\">\n    <div\n        style=\"\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            gap: 1.5rem;\n            position: relative;\n            width: 100%;\n            min-height: 100vh;\n            padding: 1rem;\n        \"\n        >\n${custom?.disableBackgroundGrid ? \"\" : `\n      <div\n        style=\"\n          position: absolute;\n          inset: 0;\n          background-image: linear-gradient(to right, ${custom?.colors?.gridColor || \"var(--border)\"} 1px, transparent 1px),\n            linear-gradient(to bottom, ${custom?.colors?.gridColor || \"var(--border)\"} 1px, transparent 1px);\n          background-size: 40px 40px;\n          opacity: 0.6;\n          pointer-events: none;\n          width: 100vw;\n          height: 100vh;\n        \"\n      ></div>\n      <div\n        style=\"\n          position: absolute;\n          inset: 0;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          background: ${custom?.colors?.background || \"var(--background)\"};\n          mask-image: radial-gradient(ellipse at center, transparent 20%, black);\n          -webkit-mask-image: radial-gradient(ellipse at center, transparent 20%, black);\n          pointer-events: none;\n        \"\n      ></div>\n`}\n\n<div\n  style=\"\n    position: relative;\n    z-index: 10;\n    border: 2px solid var(--border);\n    background: ${custom?.colors?.cardBackground || \"var(--background)\"};\n    padding: 1.5rem;\n    max-width: 42rem;\n    width: 100%;\n  \"\n>\n    ${custom?.disableCornerDecorations ? \"\" : `\n        <!-- Corner decorations -->\n        <div\n          style=\"\n            position: absolute;\n            top: -2px;\n            left: -2px;\n            width: 2rem;\n            height: 2rem;\n            border-top: 4px solid var(--corner-border);\n            border-left: 4px solid var(--corner-border);\n          \"\n        ></div>\n        <div\n          style=\"\n            position: absolute;\n            top: -2px;\n            right: -2px;\n            width: 2rem;\n            height: 2rem;\n            border-top: 4px solid var(--corner-border);\n            border-right: 4px solid var(--corner-border);\n          \"\n        ></div>\n  \n        <div\n          style=\"\n            position: absolute;\n            bottom: -2px;\n            left: -2px;\n            width: 2rem;\n            height: 2rem;\n            border-bottom: 4px solid var(--corner-border);\n            border-left: 4px solid var(--corner-border);\n          \"\n        ></div>\n        <div\n          style=\"\n            position: absolute;\n            bottom: -2px;\n            right: -2px;\n            width: 2rem;\n            height: 2rem;\n            border-bottom: 4px solid var(--corner-border);\n            border-right: 4px solid var(--corner-border);\n          \"\n        ></div>`}\n\n        <div style=\"text-align: center; margin-bottom: 1.5rem;\">\n          <div style=\"margin-bottom: 1.5rem;\">\n            <div\n              style=\"\n                display: inline-block;\n                border: 2px solid ${custom?.disableTitleBorder ? \"transparent\" : custom?.colors?.titleBorder || \"var(--destructive)\"};\n                padding: 0.375rem 1rem;\n              \"\n            >\n              <h1\n                style=\"\n                  font-size: var(--text-6xl);\n                  font-weight: var(--font-weight-semibold);\n                  color: ${custom?.colors?.titleColor || \"var(--foreground)\"};\n                  letter-spacing: -0.02em;\n                  margin: 0;\n                \"\n              >\n                ERROR\n              </h1>\n            </div>\n            <div\n              style=\"\n                height: 2px;\n                background-color: var(--border);\n                width: calc(100% + 3rem);\n                margin-left: -1.5rem;\n                margin-top: 1.5rem;\n              \"\n            ></div>\n          </div>\n\n          <h2\n            style=\"\n              font-size: var(--text-2xl);\n              font-weight: var(--font-weight-semibold);\n              color: var(--foreground);\n              margin: 0 0 1rem;\n            \"\n          >\n            Something went wrong\n          </h2>\n\n          <div\n            style=\"\n                display: inline-flex;\n                align-items: center;\n                gap: 0.5rem;\n                border: 2px solid var(--border);\n                background-color: var(--muted);\n                padding: 0.375rem 0.75rem;\n                margin: 0 0 1rem;\n                flex-wrap: wrap;\n                justify-content: center;\n            \"\n            >\n            <span\n                style=\"\n                font-size: 0.75rem;\n                color: var(--muted-foreground);\n                font-weight: var(--font-weight-semibold);\n                \"\n            >\n                CODE:\n            </span>\n            <span\n                style=\"\n                font-size: var(--text-sm);\n                font-family: var(--default-mono-font-family, monospace);\n                color: var(--foreground);\n                word-break: break-all;\n                \"\n            >\n                ${sanitize(code)}\n            </span>\n            </div>\n\n          <p\n            style=\"\n              color: var(--muted-foreground);\n              max-width: 28rem;\n              margin: 0 auto;\n              font-size: var(--text-sm);\n              line-height: 1.5;\n              text-wrap: pretty;\n            \"\n          >\n            ${!description ? `We encountered an unexpected error. Please try again or return to the home page. If you're a developer, you can find more information about the error <a href='https://better-auth.com/docs/errors/${encodeURIComponent(code)}' target='_blank' rel=\"noopener noreferrer\" style='color: var(--foreground); text-decoration: underline;'>here</a>.` : description}\n          </p>\n        </div>\n\n        <div\n          style=\"\n            display: flex;\n            gap: 0.75rem;\n            margin-top: 1.5rem;\n            justify-content: center;\n            flex-wrap: wrap;\n          \"\n        >\n          <a\n            href=\"/\"\n            style=\"\n              text-decoration: none;\n            \"\n          >\n            <div\n              style=\"\n                border: 2px solid var(--border);\n                background: var(--primary);\n                color: var(--primary-foreground);\n                padding: 0.5rem 1rem;\n                border-radius: 0;\n                white-space: nowrap;\n              \"\n              class=\"btn\"\n            >\n              Go Home\n            </div>\n          </a>\n          <a\n            href=\"https://better-auth.com/docs/errors/${encodeURIComponent(code)}?askai=${encodeURIComponent(`What does the error code ${code} mean?`)}\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            style=\"\n              text-decoration: none;\n            \"\n          >\n            <div\n              style=\"\n                border: 2px solid var(--border);\n                background: transparent;\n                color: var(--foreground);\n                padding: 0.5rem 1rem;\n                border-radius: 0;\n                white-space: nowrap;\n              \"\n              class=\"btn\"\n            >\n              Ask AI\n            </div>\n          </a>\n        </div>\n      </div>\n    </div>\n  </body>\n</html>`;\n};\nconst error = createAuthEndpoint(\"/error\", {\n\tmethod: \"GET\",\n\tmetadata: {\n\t\t...HIDE_METADATA,\n\t\topenapi: {\n\t\t\tdescription: \"Displays an error page\",\n\t\t\tresponses: { \"200\": {\n\t\t\t\tdescription: \"Success\",\n\t\t\t\tcontent: { \"text/html\": { schema: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\tdescription: \"The HTML content of the error page\"\n\t\t\t\t} } }\n\t\t\t} }\n\t\t}\n\t}\n}, async (c) => {\n\tconst url = new URL(c.request?.url || \"\");\n\tconst unsanitizedCode = url.searchParams.get(\"error\") || \"UNKNOWN\";\n\tconst unsanitizedDescription = url.searchParams.get(\"error_description\") || null;\n\tconst safeCode = /^[\\'A-Za-z0-9_-]+$/.test(unsanitizedCode || \"\") ? unsanitizedCode : \"UNKNOWN\";\n\tconst safeDescription = unsanitizedDescription ? sanitize(unsanitizedDescription) : null;\n\tconst queryParams = new URLSearchParams();\n\tqueryParams.set(\"error\", safeCode);\n\tif (unsanitizedDescription) queryParams.set(\"error_description\", unsanitizedDescription);\n\tconst options = c.context.options;\n\tconst errorURL = options.onAPIError?.errorURL;\n\tif (errorURL) return new Response(null, {\n\t\tstatus: 302,\n\t\theaders: { Location: `${errorURL}${errorURL.includes(\"?\") ? \"&\" : \"?\"}${queryParams.toString()}` }\n\t});\n\tif (isProduction && !options.onAPIError?.customizeDefaultErrorPage) return new Response(null, {\n\t\tstatus: 302,\n\t\theaders: { Location: `/?${queryParams.toString()}` }\n\t});\n\treturn new Response(html(c.context.options, safeCode, safeDescription), { headers: { \"Content-Type\": \"text/html\" } });\n});\n\n//#endregion\n//#region src/api/routes/ok.ts\nconst ok = createAuthEndpoint(\"/ok\", {\n\tmethod: \"GET\",\n\tmetadata: {\n\t\t...HIDE_METADATA,\n\t\topenapi: {\n\t\t\tdescription: \"Check if the API is working\",\n\t\t\tresponses: { \"200\": {\n\t\t\t\tdescription: \"API is working\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tproperties: { ok: {\n\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\tdescription: \"Indicates if the API is working\"\n\t\t\t\t\t} },\n\t\t\t\t\trequired: [\"ok\"]\n\t\t\t\t} } }\n\t\t\t} }\n\t\t}\n\t}\n}, async (ctx) => {\n\treturn ctx.json({ ok: true });\n});\n\n//#endregion\n//#region src/api/routes/reset-password.ts\nfunction redirectError(ctx, callbackURL, query) {\n\tconst url = callbackURL ? new URL(callbackURL, ctx.baseURL) : new URL(`${ctx.baseURL}/error`);\n\tif (query) Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n\treturn url.href;\n}\nfunction redirectCallback(ctx, callbackURL, query) {\n\tconst url = new URL(callbackURL, ctx.baseURL);\n\tif (query) Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n\treturn url.href;\n}\nconst requestPasswordReset = createAuthEndpoint(\"/request-password-reset\", {\n\tmethod: \"POST\",\n\tbody: z.object({\n\t\temail: z.email().meta({ description: \"The email address of the user to send a password reset email to\" }),\n\t\tredirectTo: z.string().meta({ description: \"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN\" }).optional()\n\t}),\n\tmetadata: { openapi: {\n\t\toperationId: \"requestPasswordReset\",\n\t\tdescription: \"Send a password reset email to the user\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\tstatus: { type: \"boolean\" },\n\t\t\t\t\tmessage: { type: \"string\" }\n\t\t\t\t}\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tif (!ctx.context.options.emailAndPassword?.sendResetPassword) {\n\t\tctx.context.logger.error(\"Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: \"Reset password isn't enabled\" });\n\t}\n\tconst { email, redirectTo } = ctx.body;\n\tconst user = await ctx.context.internalAdapter.findUserByEmail(email, { includeAccounts: true });\n\tif (!user) {\n\t\t/**\n\t\t* We simulate the verification token generation and the database lookup\n\t\t* to mitigate timing attacks.\n\t\t*/\n\t\tgenerateId(24);\n\t\tawait ctx.context.internalAdapter.findVerificationValue(\"dummy-verification-token\");\n\t\tctx.context.logger.error(\"Reset Password: User not found\", { email });\n\t\treturn ctx.json({\n\t\t\tstatus: true,\n\t\t\tmessage: \"If this email exists in our system, check your email for the reset link\"\n\t\t});\n\t}\n\tconst expiresAt = getDate(ctx.context.options.emailAndPassword.resetPasswordTokenExpiresIn || 3600 * 1, \"sec\");\n\tconst verificationToken = generateId(24);\n\tawait ctx.context.internalAdapter.createVerificationValue({\n\t\tvalue: user.user.id,\n\t\tidentifier: `reset-password:${verificationToken}`,\n\t\texpiresAt\n\t});\n\tconst callbackURL = redirectTo ? encodeURIComponent(redirectTo) : \"\";\n\tconst url = `${ctx.context.baseURL}/reset-password/${verificationToken}?callbackURL=${callbackURL}`;\n\tawait ctx.context.options.emailAndPassword.sendResetPassword({\n\t\tuser: user.user,\n\t\turl,\n\t\ttoken: verificationToken\n\t}, ctx.request).catch((e) => {\n\t\tctx.context.logger.error(\"Failed to send reset password email\", e);\n\t});\n\treturn ctx.json({\n\t\tstatus: true,\n\t\tmessage: \"If this email exists in our system, check your email for the reset link\"\n\t});\n});\nconst requestPasswordResetCallback = createAuthEndpoint(\"/reset-password/:token\", {\n\tmethod: \"GET\",\n\toperationId: \"forgetPasswordCallback\",\n\tquery: z.object({ callbackURL: z.string().meta({ description: \"The URL to redirect the user to reset their password\" }) }),\n\tuse: [originCheck((ctx) => ctx.query.callbackURL)],\n\tmetadata: { openapi: {\n\t\toperationId: \"resetPasswordCallback\",\n\t\tdescription: \"Redirects the user to the callback URL with the token\",\n\t\tparameters: [{\n\t\t\tname: \"token\",\n\t\t\tin: \"path\",\n\t\t\trequired: true,\n\t\t\tdescription: \"The token to reset the password\",\n\t\t\tschema: { type: \"string\" }\n\t\t}, {\n\t\t\tname: \"callbackURL\",\n\t\t\tin: \"query\",\n\t\t\trequired: true,\n\t\t\tdescription: \"The URL to redirect the user to reset their password\",\n\t\t\tschema: { type: \"string\" }\n\t\t}],\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: { token: { type: \"string\" } }\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tconst { token } = ctx.params;\n\tconst { callbackURL } = ctx.query;\n\tif (!token || !callbackURL) throw ctx.redirect(redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" }));\n\tconst verification = await ctx.context.internalAdapter.findVerificationValue(`reset-password:${token}`);\n\tif (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) throw ctx.redirect(redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" }));\n\tthrow ctx.redirect(redirectCallback(ctx.context, callbackURL, { token }));\n});\nconst resetPassword = createAuthEndpoint(\"/reset-password\", {\n\tmethod: \"POST\",\n\toperationId: \"resetPassword\",\n\tquery: z.object({ token: z.string().optional() }).optional(),\n\tbody: z.object({\n\t\tnewPassword: z.string().meta({ description: \"The new password to set\" }),\n\t\ttoken: z.string().meta({ description: \"The token to reset the password\" }).optional()\n\t}),\n\tmetadata: { openapi: {\n\t\toperationId: \"resetPassword\",\n\t\tdescription: \"Reset the password for a user\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: { status: { type: \"boolean\" } }\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tconst token = ctx.body.token || ctx.query?.token;\n\tif (!token) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.INVALID_TOKEN });\n\tconst { newPassword } = ctx.body;\n\tconst minLength = ctx.context.password?.config.minPasswordLength;\n\tconst maxLength = ctx.context.password?.config.maxPasswordLength;\n\tif (newPassword.length < minLength) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT });\n\tif (newPassword.length > maxLength) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.PASSWORD_TOO_LONG });\n\tconst id = `reset-password:${token}`;\n\tconst verification = await ctx.context.internalAdapter.findVerificationValue(id);\n\tif (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.INVALID_TOKEN });\n\tconst userId = verification.value;\n\tconst hashedPassword = await ctx.context.password.hash(newPassword);\n\tif (!(await ctx.context.internalAdapter.findAccounts(userId)).find((ac) => ac.providerId === \"credential\")) await ctx.context.internalAdapter.createAccount({\n\t\tuserId,\n\t\tproviderId: \"credential\",\n\t\tpassword: hashedPassword,\n\t\taccountId: userId\n\t});\n\telse await ctx.context.internalAdapter.updatePassword(userId, hashedPassword);\n\tawait ctx.context.internalAdapter.deleteVerificationValue(verification.id);\n\tif (ctx.context.options.emailAndPassword?.onPasswordReset) {\n\t\tconst user = await ctx.context.internalAdapter.findUserById(userId);\n\t\tif (user) await ctx.context.options.emailAndPassword.onPasswordReset({ user }, ctx.request);\n\t}\n\tif (ctx.context.options.emailAndPassword?.revokeSessionsOnPasswordReset) await ctx.context.internalAdapter.deleteSessions(userId);\n\treturn ctx.json({ status: true });\n});\n\n//#endregion\n//#region src/api/routes/sign-in.ts\nconst socialSignInBodySchema = z.object({\n\tcallbackURL: z.string().meta({ description: \"Callback URL to redirect to after the user has signed in\" }).optional(),\n\tnewUserCallbackURL: z.string().optional(),\n\terrorCallbackURL: z.string().meta({ description: \"Callback URL to redirect to if an error happens\" }).optional(),\n\tprovider: SocialProviderListEnum,\n\tdisableRedirect: z.boolean().meta({ description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\" }).optional(),\n\tidToken: z.optional(z.object({\n\t\ttoken: z.string().meta({ description: \"ID token from the provider\" }),\n\t\tnonce: z.string().meta({ description: \"Nonce used to generate the token\" }).optional(),\n\t\taccessToken: z.string().meta({ description: \"Access token from the provider\" }).optional(),\n\t\trefreshToken: z.string().meta({ description: \"Refresh token from the provider\" }).optional(),\n\t\texpiresAt: z.number().meta({ description: \"Expiry date of the token\" }).optional()\n\t})),\n\tscopes: z.array(z.string()).meta({ description: \"Array of scopes to request from the provider. This will override the default scopes passed.\" }).optional(),\n\trequestSignUp: z.boolean().meta({ description: \"Explicitly request sign-up. Useful when disableImplicitSignUp is true for this provider\" }).optional(),\n\tloginHint: z.string().meta({ description: \"The login hint to use for the authorization code request\" }).optional(),\n\tadditionalData: z.record(z.string(), z.any()).optional().meta({ description: \"Additional data to be passed through the OAuth flow\" })\n});\nconst signInSocial = () => createAuthEndpoint(\"/sign-in/social\", {\n\tmethod: \"POST\",\n\toperationId: \"socialSignIn\",\n\tbody: socialSignInBodySchema,\n\tmetadata: {\n\t\t$Infer: {\n\t\t\tbody: {},\n\t\t\treturned: {}\n\t\t},\n\t\topenapi: {\n\t\t\tdescription: \"Sign in with a social provider\",\n\t\t\toperationId: \"socialSignIn\",\n\t\t\tresponses: { \"200\": {\n\t\t\t\tdescription: \"Success - Returns either session details or redirect URL\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tdescription: \"Session response when idToken is provided\",\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\ttoken: { type: \"string\" },\n\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\turl: { type: \"string\" },\n\t\t\t\t\t\tredirect: {\n\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\tenum: [false]\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\trequired: [\n\t\t\t\t\t\t\"redirect\",\n\t\t\t\t\t\t\"token\",\n\t\t\t\t\t\t\"user\"\n\t\t\t\t\t]\n\t\t\t\t} } }\n\t\t\t} }\n\t\t}\n\t}\n}, async (c) => {\n\tconst provider = c.context.socialProviders.find((p) => p.id === c.body.provider);\n\tif (!provider) {\n\t\tc.context.logger.error(\"Provider not found. Make sure to add the provider in your auth config\", { provider: c.body.provider });\n\t\tthrow new APIError(\"NOT_FOUND\", { message: BASE_ERROR_CODES.PROVIDER_NOT_FOUND });\n\t}\n\tif (c.body.idToken) {\n\t\tif (!provider.verifyIdToken) {\n\t\t\tc.context.logger.error(\"Provider does not support id token verification\", { provider: c.body.provider });\n\t\t\tthrow new APIError(\"NOT_FOUND\", { message: BASE_ERROR_CODES.ID_TOKEN_NOT_SUPPORTED });\n\t\t}\n\t\tconst { token, nonce } = c.body.idToken;\n\t\tif (!await provider.verifyIdToken(token, nonce)) {\n\t\t\tc.context.logger.error(\"Invalid id token\", { provider: c.body.provider });\n\t\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.INVALID_TOKEN });\n\t\t}\n\t\tconst userInfo = await provider.getUserInfo({\n\t\t\tidToken: token,\n\t\t\taccessToken: c.body.idToken.accessToken,\n\t\t\trefreshToken: c.body.idToken.refreshToken\n\t\t});\n\t\tif (!userInfo || !userInfo?.user) {\n\t\t\tc.context.logger.error(\"Failed to get user info\", { provider: c.body.provider });\n\t\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO });\n\t\t}\n\t\tif (!userInfo.user.email) {\n\t\t\tc.context.logger.error(\"User email not found\", { provider: c.body.provider });\n\t\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.USER_EMAIL_NOT_FOUND });\n\t\t}\n\t\tconst data = await handleOAuthUserInfo(c, {\n\t\t\tuserInfo: {\n\t\t\t\t...userInfo.user,\n\t\t\t\temail: userInfo.user.email,\n\t\t\t\tid: String(userInfo.user.id),\n\t\t\t\tname: userInfo.user.name || \"\",\n\t\t\t\timage: userInfo.user.image,\n\t\t\t\temailVerified: userInfo.user.emailVerified || false\n\t\t\t},\n\t\t\taccount: {\n\t\t\t\tproviderId: provider.id,\n\t\t\t\taccountId: String(userInfo.user.id),\n\t\t\t\taccessToken: c.body.idToken.accessToken\n\t\t\t},\n\t\t\tcallbackURL: c.body.callbackURL,\n\t\t\tdisableSignUp: provider.disableImplicitSignUp && !c.body.requestSignUp || provider.disableSignUp\n\t\t});\n\t\tif (data.error) throw new APIError(\"UNAUTHORIZED\", { message: data.error });\n\t\tawait setSessionCookie(c, data.data);\n\t\treturn c.json({\n\t\t\tredirect: false,\n\t\t\ttoken: data.data.session.token,\n\t\t\turl: void 0,\n\t\t\tuser: parseUserOutput(c.context.options, data.data.user)\n\t\t});\n\t}\n\tconst { codeVerifier, state } = await generateState(c, void 0, c.body.additionalData);\n\tconst url = await provider.createAuthorizationURL({\n\t\tstate,\n\t\tcodeVerifier,\n\t\tredirectURI: `${c.context.baseURL}/callback/${provider.id}`,\n\t\tscopes: c.body.scopes,\n\t\tloginHint: c.body.loginHint\n\t});\n\treturn c.json({\n\t\turl: url.toString(),\n\t\tredirect: !c.body.disableRedirect\n\t});\n});\nconst signInEmail = () => createAuthEndpoint(\"/sign-in/email\", {\n\tmethod: \"POST\",\n\toperationId: \"signInEmail\",\n\tbody: z.object({\n\t\temail: z.string().meta({ description: \"Email of the user\" }),\n\t\tpassword: z.string().meta({ description: \"Password of the user\" }),\n\t\tcallbackURL: z.string().meta({ description: \"Callback URL to use as a redirect for email verification\" }).optional(),\n\t\trememberMe: z.boolean().meta({ description: \"If this is false, the session will not be remembered. Default is `true`.\" }).default(true).optional()\n\t}),\n\tmetadata: {\n\t\t$Infer: {\n\t\t\tbody: {},\n\t\t\treturned: {}\n\t\t},\n\t\topenapi: {\n\t\t\toperationId: \"signInEmail\",\n\t\t\tdescription: \"Sign in with email and password\",\n\t\t\tresponses: { \"200\": {\n\t\t\t\tdescription: \"Success - Returns either session details or redirect URL\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tdescription: \"Session response when idToken is provided\",\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tredirect: {\n\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\tenum: [false]\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttoken: {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tdescription: \"Session token\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\turl: {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tnullable: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\"\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\trequired: [\n\t\t\t\t\t\t\"redirect\",\n\t\t\t\t\t\t\"token\",\n\t\t\t\t\t\t\"user\"\n\t\t\t\t\t]\n\t\t\t\t} } }\n\t\t\t} }\n\t\t}\n\t}\n}, async (ctx) => {\n\tif (!ctx.context.options?.emailAndPassword?.enabled) {\n\t\tctx.context.logger.error(\"Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: \"Email and password is not enabled\" });\n\t}\n\tconst { email, password } = ctx.body;\n\tif (!z.email().safeParse(email).success) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.INVALID_EMAIL });\n\tconst user = await ctx.context.internalAdapter.findUserByEmail(email, { includeAccounts: true });\n\tif (!user) {\n\t\tawait ctx.context.password.hash(password);\n\t\tctx.context.logger.error(\"User not found\", { email });\n\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD });\n\t}\n\tconst credentialAccount = user.accounts.find((a) => a.providerId === \"credential\");\n\tif (!credentialAccount) {\n\t\tawait ctx.context.password.hash(password);\n\t\tctx.context.logger.error(\"Credential account not found\", { email });\n\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD });\n\t}\n\tconst currentPassword = credentialAccount?.password;\n\tif (!currentPassword) {\n\t\tawait ctx.context.password.hash(password);\n\t\tctx.context.logger.error(\"Password not found\", { email });\n\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD });\n\t}\n\tif (!await ctx.context.password.verify({\n\t\thash: currentPassword,\n\t\tpassword\n\t})) {\n\t\tctx.context.logger.error(\"Invalid password\");\n\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.INVALID_EMAIL_OR_PASSWORD });\n\t}\n\tif (ctx.context.options?.emailAndPassword?.requireEmailVerification && !user.user.emailVerified) {\n\t\tif (!ctx.context.options?.emailVerification?.sendVerificationEmail) throw new APIError(\"FORBIDDEN\", { message: BASE_ERROR_CODES.EMAIL_NOT_VERIFIED });\n\t\tif (ctx.context.options?.emailVerification?.sendOnSignIn) {\n\t\t\tconst token = await createEmailVerificationToken(ctx.context.secret, user.user.email, void 0, ctx.context.options.emailVerification?.expiresIn);\n\t\t\tconst callbackURL = ctx.body.callbackURL ? encodeURIComponent(ctx.body.callbackURL) : encodeURIComponent(\"/\");\n\t\t\tconst url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${callbackURL}`;\n\t\t\tawait ctx.context.options.emailVerification.sendVerificationEmail({\n\t\t\t\tuser: user.user,\n\t\t\t\turl,\n\t\t\t\ttoken\n\t\t\t}, ctx.request);\n\t\t}\n\t\tthrow new APIError(\"FORBIDDEN\", { message: BASE_ERROR_CODES.EMAIL_NOT_VERIFIED });\n\t}\n\tconst session = await ctx.context.internalAdapter.createSession(user.user.id, ctx.body.rememberMe === false);\n\tif (!session) {\n\t\tctx.context.logger.error(\"Failed to create session\");\n\t\tthrow new APIError(\"UNAUTHORIZED\", { message: BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION });\n\t}\n\tawait setSessionCookie(ctx, {\n\t\tsession,\n\t\tuser: user.user\n\t}, ctx.body.rememberMe === false);\n\treturn ctx.json({\n\t\tredirect: !!ctx.body.callbackURL,\n\t\ttoken: session.token,\n\t\turl: ctx.body.callbackURL,\n\t\tuser: parseUserOutput(ctx.context.options, user.user)\n\t});\n});\n\n//#endregion\n//#region src/api/routes/sign-out.ts\nconst signOut = createAuthEndpoint(\"/sign-out\", {\n\tmethod: \"POST\",\n\toperationId: \"signOut\",\n\trequireHeaders: true,\n\tmetadata: { openapi: {\n\t\toperationId: \"signOut\",\n\t\tdescription: \"Sign out the current user\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Success\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: { success: { type: \"boolean\" } }\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tconst sessionCookieToken = await ctx.getSignedCookie(ctx.context.authCookies.sessionToken.name, ctx.context.secret);\n\tif (sessionCookieToken) try {\n\t\tawait ctx.context.internalAdapter.deleteSession(sessionCookieToken);\n\t} catch (e) {\n\t\tctx.context.logger.error(\"Failed to delete session from database\", e);\n\t}\n\tdeleteSessionCookie(ctx);\n\treturn ctx.json({ success: true });\n});\n\n//#endregion\n//#region src/api/routes/sign-up.ts\nconst signUpEmail = () => createAuthEndpoint(\"/sign-up/email\", {\n\tmethod: \"POST\",\n\toperationId: \"signUpWithEmailAndPassword\",\n\tbody: z.record(z.string(), z.any()),\n\tmetadata: {\n\t\t$Infer: {\n\t\t\tbody: {},\n\t\t\treturned: {}\n\t\t},\n\t\topenapi: {\n\t\t\toperationId: \"signUpWithEmailAndPassword\",\n\t\t\tdescription: \"Sign up a user using email and password\",\n\t\t\trequestBody: { content: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\tname: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tdescription: \"The name of the user\"\n\t\t\t\t\t},\n\t\t\t\t\temail: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tdescription: \"The email of the user\"\n\t\t\t\t\t},\n\t\t\t\t\tpassword: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tdescription: \"The password of the user\"\n\t\t\t\t\t},\n\t\t\t\t\timage: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tdescription: \"The profile image URL of the user\"\n\t\t\t\t\t},\n\t\t\t\t\tcallbackURL: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tdescription: \"The URL to use for email verification callback\"\n\t\t\t\t\t},\n\t\t\t\t\trememberMe: {\n\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\tdescription: \"If this is false, the session will not be remembered. Default is `true`.\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trequired: [\n\t\t\t\t\t\"name\",\n\t\t\t\t\t\"email\",\n\t\t\t\t\t\"password\"\n\t\t\t\t]\n\t\t\t} } } },\n\t\t\tresponses: {\n\t\t\t\t\"200\": {\n\t\t\t\t\tdescription: \"Successfully created user\",\n\t\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\ttoken: {\n\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\tnullable: true,\n\t\t\t\t\t\t\t\tdescription: \"Authentication token for the session\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\tid: {\n\t\t\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\t\t\tdescription: \"The unique identifier of the user\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\temail: {\n\t\t\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\t\t\tformat: \"email\",\n\t\t\t\t\t\t\t\t\t\tdescription: \"The email address of the user\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tname: {\n\t\t\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\t\t\tdescription: \"The name of the user\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\timage: {\n\t\t\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\t\t\tformat: \"uri\",\n\t\t\t\t\t\t\t\t\t\tnullable: true,\n\t\t\t\t\t\t\t\t\t\tdescription: \"The profile image URL of the user\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\temailVerified: {\n\t\t\t\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\t\t\t\tdescription: \"Whether the email has been verified\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tcreatedAt: {\n\t\t\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\t\t\tformat: \"date-time\",\n\t\t\t\t\t\t\t\t\t\tdescription: \"When the user was created\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tupdatedAt: {\n\t\t\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\t\t\tformat: \"date-time\",\n\t\t\t\t\t\t\t\t\t\tdescription: \"When the user was last updated\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\trequired: [\n\t\t\t\t\t\t\t\t\t\"id\",\n\t\t\t\t\t\t\t\t\t\"email\",\n\t\t\t\t\t\t\t\t\t\"name\",\n\t\t\t\t\t\t\t\t\t\"emailVerified\",\n\t\t\t\t\t\t\t\t\t\"createdAt\",\n\t\t\t\t\t\t\t\t\t\"updatedAt\"\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\trequired: [\"user\"]\n\t\t\t\t\t} } }\n\t\t\t\t},\n\t\t\t\t\"422\": {\n\t\t\t\t\tdescription: \"Unprocessable Entity. User already exists or failed to create user.\",\n\t\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\tproperties: { message: { type: \"string\" } }\n\t\t\t\t\t} } }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}, async (ctx) => {\n\treturn runWithTransaction(ctx.context.adapter, async () => {\n\t\tif (!ctx.context.options.emailAndPassword?.enabled || ctx.context.options.emailAndPassword?.disableSignUp) throw new APIError(\"BAD_REQUEST\", { message: \"Email and password sign up is not enabled\" });\n\t\tconst body = ctx.body;\n\t\tconst { name, email, password, image, callbackURL, rememberMe, ...rest } = body;\n\t\tif (!z.email().safeParse(email).success) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.INVALID_EMAIL });\n\t\tconst minPasswordLength = ctx.context.password.config.minPasswordLength;\n\t\tif (password.length < minPasswordLength) {\n\t\t\tctx.context.logger.error(\"Password is too short\");\n\t\t\tthrow new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT });\n\t\t}\n\t\tconst maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n\t\tif (password.length > maxPasswordLength) {\n\t\t\tctx.context.logger.error(\"Password is too long\");\n\t\t\tthrow new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.PASSWORD_TOO_LONG });\n\t\t}\n\t\tif ((await ctx.context.internalAdapter.findUserByEmail(email))?.user) {\n\t\t\tctx.context.logger.info(`Sign-up attempt for existing email: ${email}`);\n\t\t\tthrow new APIError(\"UNPROCESSABLE_ENTITY\", { message: BASE_ERROR_CODES.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL });\n\t\t}\n\t\t/**\n\t\t* Hash the password\n\t\t*\n\t\t* This is done prior to creating the user\n\t\t* to ensure that any plugin that\n\t\t* may break the hashing should break\n\t\t* before the user is created.\n\t\t*/\n\t\tconst hash = await ctx.context.password.hash(password);\n\t\tlet createdUser;\n\t\ttry {\n\t\t\tconst data = parseUserInput(ctx.context.options, rest, \"create\");\n\t\t\tcreatedUser = await ctx.context.internalAdapter.createUser({\n\t\t\t\temail: email.toLowerCase(),\n\t\t\t\tname,\n\t\t\t\timage,\n\t\t\t\t...data,\n\t\t\t\temailVerified: false\n\t\t\t});\n\t\t\tif (!createdUser) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.FAILED_TO_CREATE_USER });\n\t\t} catch (e) {\n\t\t\tif (isDevelopment()) ctx.context.logger.error(\"Failed to create user\", e);\n\t\t\tif (e instanceof APIError) throw e;\n\t\t\tctx.context.logger?.error(\"Failed to create user\", e);\n\t\t\tthrow new APIError(\"UNPROCESSABLE_ENTITY\", {\n\t\t\t\tmessage: BASE_ERROR_CODES.FAILED_TO_CREATE_USER,\n\t\t\t\tdetails: e\n\t\t\t});\n\t\t}\n\t\tif (!createdUser) throw new APIError(\"UNPROCESSABLE_ENTITY\", { message: BASE_ERROR_CODES.FAILED_TO_CREATE_USER });\n\t\tawait ctx.context.internalAdapter.linkAccount({\n\t\t\tuserId: createdUser.id,\n\t\t\tproviderId: \"credential\",\n\t\t\taccountId: createdUser.id,\n\t\t\tpassword: hash\n\t\t});\n\t\tif (ctx.context.options.emailVerification?.sendOnSignUp || ctx.context.options.emailAndPassword.requireEmailVerification) {\n\t\t\tconst token = await createEmailVerificationToken(ctx.context.secret, createdUser.email, void 0, ctx.context.options.emailVerification?.expiresIn);\n\t\t\tconst callbackURL$1 = body.callbackURL ? encodeURIComponent(body.callbackURL) : encodeURIComponent(\"/\");\n\t\t\tconst url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${callbackURL$1}`;\n\t\t\tconst args = ctx.request ? [{\n\t\t\t\tuser: createdUser,\n\t\t\t\turl,\n\t\t\t\ttoken\n\t\t\t}, ctx.request] : [{\n\t\t\t\tuser: createdUser,\n\t\t\t\turl,\n\t\t\t\ttoken\n\t\t\t}];\n\t\t\tawait ctx.context.options.emailVerification?.sendVerificationEmail?.(...args);\n\t\t}\n\t\tif (ctx.context.options.emailAndPassword.autoSignIn === false || ctx.context.options.emailAndPassword.requireEmailVerification) return ctx.json({\n\t\t\ttoken: null,\n\t\t\tuser: parseUserOutput(ctx.context.options, createdUser)\n\t\t});\n\t\tconst session = await ctx.context.internalAdapter.createSession(createdUser.id, rememberMe === false);\n\t\tif (!session) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.FAILED_TO_CREATE_SESSION });\n\t\tawait setSessionCookie(ctx, {\n\t\t\tsession,\n\t\t\tuser: createdUser\n\t\t}, rememberMe === false);\n\t\treturn ctx.json({\n\t\t\ttoken: session.token,\n\t\t\tuser: parseUserOutput(ctx.context.options, createdUser)\n\t\t});\n\t});\n});\n\n//#endregion\n//#region src/api/routes/update-user.ts\nconst updateUser = () => createAuthEndpoint(\"/update-user\", {\n\tmethod: \"POST\",\n\toperationId: \"updateUser\",\n\tbody: z.record(z.string().meta({ description: \"Field name must be a string\" }), z.any()),\n\tuse: [sessionMiddleware],\n\tmetadata: {\n\t\t$Infer: { body: {} },\n\t\topenapi: {\n\t\t\toperationId: \"updateUser\",\n\t\t\tdescription: \"Update the current user\",\n\t\t\trequestBody: { content: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\tname: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tdescription: \"The name of the user\"\n\t\t\t\t\t},\n\t\t\t\t\timage: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tdescription: \"The image of the user\",\n\t\t\t\t\t\tnullable: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} } } },\n\t\t\tresponses: { \"200\": {\n\t\t\t\tdescription: \"Success\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tproperties: { user: {\n\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t$ref: \"#/components/schemas/User\"\n\t\t\t\t\t} }\n\t\t\t\t} } }\n\t\t\t} }\n\t\t}\n\t}\n}, async (ctx) => {\n\tconst body = ctx.body;\n\tif (body.email) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.EMAIL_CAN_NOT_BE_UPDATED });\n\tconst { name, image, ...rest } = body;\n\tconst session = ctx.context.session;\n\tconst additionalFields = parseUserInput(ctx.context.options, rest, \"update\");\n\tif (image === void 0 && name === void 0 && Object.keys(additionalFields).length === 0) throw new APIError(\"BAD_REQUEST\", { message: \"No fields to update\" });\n\tconst user = await ctx.context.internalAdapter.updateUser(session.user.id, {\n\t\tname,\n\t\timage,\n\t\t...additionalFields\n\t});\n\t/**\n\t* Update the session cookie with the new user data\n\t*/\n\tawait setSessionCookie(ctx, {\n\t\tsession: session.session,\n\t\tuser\n\t});\n\treturn ctx.json({ status: true });\n});\nconst changePassword = createAuthEndpoint(\"/change-password\", {\n\tmethod: \"POST\",\n\toperationId: \"changePassword\",\n\tbody: z.object({\n\t\tnewPassword: z.string().meta({ description: \"The new password to set\" }),\n\t\tcurrentPassword: z.string().meta({ description: \"The current password is required\" }),\n\t\trevokeOtherSessions: z.boolean().meta({ description: \"Must be a boolean value\" }).optional()\n\t}),\n\tuse: [sensitiveSessionMiddleware],\n\tmetadata: { openapi: {\n\t\toperationId: \"changePassword\",\n\t\tdescription: \"Change the password of the user\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"Password successfully changed\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\ttoken: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tnullable: true,\n\t\t\t\t\t\tdescription: \"New session token if other sessions were revoked\"\n\t\t\t\t\t},\n\t\t\t\t\tuser: {\n\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\tid: {\n\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\tdescription: \"The unique identifier of the user\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\temail: {\n\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\tformat: \"email\",\n\t\t\t\t\t\t\t\tdescription: \"The email address of the user\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tname: {\n\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\tdescription: \"The name of the user\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\timage: {\n\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\tformat: \"uri\",\n\t\t\t\t\t\t\t\tnullable: true,\n\t\t\t\t\t\t\t\tdescription: \"The profile image URL of the user\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\temailVerified: {\n\t\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\t\tdescription: \"Whether the email has been verified\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcreatedAt: {\n\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\tformat: \"date-time\",\n\t\t\t\t\t\t\t\tdescription: \"When the user was created\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tupdatedAt: {\n\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\tformat: \"date-time\",\n\t\t\t\t\t\t\t\tdescription: \"When the user was last updated\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\trequired: [\n\t\t\t\t\t\t\t\"id\",\n\t\t\t\t\t\t\t\"email\",\n\t\t\t\t\t\t\t\"name\",\n\t\t\t\t\t\t\t\"emailVerified\",\n\t\t\t\t\t\t\t\"createdAt\",\n\t\t\t\t\t\t\t\"updatedAt\"\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trequired: [\"user\"]\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tconst { newPassword, currentPassword, revokeOtherSessions: revokeOtherSessions$1 } = ctx.body;\n\tconst session = ctx.context.session;\n\tconst minPasswordLength = ctx.context.password.config.minPasswordLength;\n\tif (newPassword.length < minPasswordLength) {\n\t\tctx.context.logger.error(\"Password is too short\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT });\n\t}\n\tconst maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n\tif (newPassword.length > maxPasswordLength) {\n\t\tctx.context.logger.error(\"Password is too long\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.PASSWORD_TOO_LONG });\n\t}\n\tconst account = (await ctx.context.internalAdapter.findAccounts(session.user.id)).find((account$1) => account$1.providerId === \"credential\" && account$1.password);\n\tif (!account || !account.password) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND });\n\tconst passwordHash = await ctx.context.password.hash(newPassword);\n\tif (!await ctx.context.password.verify({\n\t\thash: account.password,\n\t\tpassword: currentPassword\n\t})) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.INVALID_PASSWORD });\n\tawait ctx.context.internalAdapter.updateAccount(account.id, { password: passwordHash });\n\tlet token = null;\n\tif (revokeOtherSessions$1) {\n\t\tawait ctx.context.internalAdapter.deleteSessions(session.user.id);\n\t\tconst newSession = await ctx.context.internalAdapter.createSession(session.user.id);\n\t\tif (!newSession) throw new APIError(\"INTERNAL_SERVER_ERROR\", { message: BASE_ERROR_CODES.FAILED_TO_GET_SESSION });\n\t\tawait setSessionCookie(ctx, {\n\t\t\tsession: newSession,\n\t\t\tuser: session.user\n\t\t});\n\t\ttoken = newSession.token;\n\t}\n\treturn ctx.json({\n\t\ttoken,\n\t\tuser: {\n\t\t\tid: session.user.id,\n\t\t\temail: session.user.email,\n\t\t\tname: session.user.name,\n\t\t\timage: session.user.image,\n\t\t\temailVerified: session.user.emailVerified,\n\t\t\tcreatedAt: session.user.createdAt,\n\t\t\tupdatedAt: session.user.updatedAt\n\t\t}\n\t});\n});\nconst setPassword = createAuthEndpoint(\"/set-password\", {\n\tmethod: \"POST\",\n\tbody: z.object({ newPassword: z.string().meta({ description: \"The new password to set is required\" }) }),\n\tmetadata: { SERVER_ONLY: true },\n\tuse: [sensitiveSessionMiddleware]\n}, async (ctx) => {\n\tconst { newPassword } = ctx.body;\n\tconst session = ctx.context.session;\n\tconst minPasswordLength = ctx.context.password.config.minPasswordLength;\n\tif (newPassword.length < minPasswordLength) {\n\t\tctx.context.logger.error(\"Password is too short\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.PASSWORD_TOO_SHORT });\n\t}\n\tconst maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n\tif (newPassword.length > maxPasswordLength) {\n\t\tctx.context.logger.error(\"Password is too long\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.PASSWORD_TOO_LONG });\n\t}\n\tconst account = (await ctx.context.internalAdapter.findAccounts(session.user.id)).find((account$1) => account$1.providerId === \"credential\" && account$1.password);\n\tconst passwordHash = await ctx.context.password.hash(newPassword);\n\tif (!account) {\n\t\tawait ctx.context.internalAdapter.linkAccount({\n\t\t\tuserId: session.user.id,\n\t\t\tproviderId: \"credential\",\n\t\t\taccountId: session.user.id,\n\t\t\tpassword: passwordHash\n\t\t});\n\t\treturn ctx.json({ status: true });\n\t}\n\tthrow new APIError(\"BAD_REQUEST\", { message: \"user already has a password\" });\n});\nconst deleteUser = createAuthEndpoint(\"/delete-user\", {\n\tmethod: \"POST\",\n\tuse: [sensitiveSessionMiddleware],\n\tbody: z.object({\n\t\tcallbackURL: z.string().meta({ description: \"The callback URL to redirect to after the user is deleted\" }).optional(),\n\t\tpassword: z.string().meta({ description: \"The password of the user is required to delete the user\" }).optional(),\n\t\ttoken: z.string().meta({ description: \"The token to delete the user is required\" }).optional()\n\t}),\n\tmetadata: { openapi: {\n\t\toperationId: \"deleteUser\",\n\t\tdescription: \"Delete the user\",\n\t\trequestBody: { content: { \"application/json\": { schema: {\n\t\t\ttype: \"object\",\n\t\t\tproperties: {\n\t\t\t\tcallbackURL: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\tdescription: \"The callback URL to redirect to after the user is deleted\"\n\t\t\t\t},\n\t\t\t\tpassword: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\tdescription: \"The user's password. Required if session is not fresh\"\n\t\t\t\t},\n\t\t\t\ttoken: {\n\t\t\t\t\ttype: \"string\",\n\t\t\t\t\tdescription: \"The deletion verification token\"\n\t\t\t\t}\n\t\t\t}\n\t\t} } } },\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"User deletion processed successfully\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\tsuccess: {\n\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\tdescription: \"Indicates if the operation was successful\"\n\t\t\t\t\t},\n\t\t\t\t\tmessage: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tenum: [\"User deleted\", \"Verification email sent\"],\n\t\t\t\t\t\tdescription: \"Status message of the deletion process\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trequired: [\"success\", \"message\"]\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tif (!ctx.context.options.user?.deleteUser?.enabled) {\n\t\tctx.context.logger.error(\"Delete user is disabled. Enable it in the options\");\n\t\tthrow new APIError(\"NOT_FOUND\");\n\t}\n\tconst session = ctx.context.session;\n\tif (ctx.body.password) {\n\t\tconst account = (await ctx.context.internalAdapter.findAccounts(session.user.id)).find((account$1) => account$1.providerId === \"credential\" && account$1.password);\n\t\tif (!account || !account.password) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.CREDENTIAL_ACCOUNT_NOT_FOUND });\n\t\tif (!await ctx.context.password.verify({\n\t\t\thash: account.password,\n\t\t\tpassword: ctx.body.password\n\t\t})) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.INVALID_PASSWORD });\n\t}\n\tif (ctx.body.token) {\n\t\tawait deleteUserCallback({\n\t\t\t...ctx,\n\t\t\tquery: { token: ctx.body.token }\n\t\t});\n\t\treturn ctx.json({\n\t\t\tsuccess: true,\n\t\t\tmessage: \"User deleted\"\n\t\t});\n\t}\n\tif (ctx.context.options.user.deleteUser?.sendDeleteAccountVerification) {\n\t\tconst token = generateRandomString(32, \"0-9\", \"a-z\");\n\t\tawait ctx.context.internalAdapter.createVerificationValue({\n\t\t\tvalue: session.user.id,\n\t\t\tidentifier: `delete-account-${token}`,\n\t\t\texpiresAt: new Date(Date.now() + (ctx.context.options.user.deleteUser?.deleteTokenExpiresIn || 3600 * 24) * 1e3)\n\t\t});\n\t\tconst url = `${ctx.context.baseURL}/delete-user/callback?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n\t\tawait ctx.context.options.user.deleteUser.sendDeleteAccountVerification({\n\t\t\tuser: session.user,\n\t\t\turl,\n\t\t\ttoken\n\t\t}, ctx.request);\n\t\treturn ctx.json({\n\t\t\tsuccess: true,\n\t\t\tmessage: \"Verification email sent\"\n\t\t});\n\t}\n\tif (!ctx.body.password && ctx.context.sessionConfig.freshAge !== 0) {\n\t\tconst currentAge = new Date(session.session.createdAt).getTime();\n\t\tconst freshAge = ctx.context.sessionConfig.freshAge * 1e3;\n\t\tif (Date.now() - currentAge > freshAge * 1e3) throw new APIError(\"BAD_REQUEST\", { message: BASE_ERROR_CODES.SESSION_EXPIRED });\n\t}\n\tconst beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n\tif (beforeDelete) await beforeDelete(session.user, ctx.request);\n\tawait ctx.context.internalAdapter.deleteUser(session.user.id);\n\tawait ctx.context.internalAdapter.deleteSessions(session.user.id);\n\tdeleteSessionCookie(ctx);\n\tconst afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n\tif (afterDelete) await afterDelete(session.user, ctx.request);\n\treturn ctx.json({\n\t\tsuccess: true,\n\t\tmessage: \"User deleted\"\n\t});\n});\nconst deleteUserCallback = createAuthEndpoint(\"/delete-user/callback\", {\n\tmethod: \"GET\",\n\tquery: z.object({\n\t\ttoken: z.string().meta({ description: \"The token to verify the deletion request\" }),\n\t\tcallbackURL: z.string().meta({ description: \"The URL to redirect to after deletion\" }).optional()\n\t}),\n\tuse: [originCheck((ctx) => ctx.query.callbackURL)],\n\tmetadata: { openapi: {\n\t\tdescription: \"Callback to complete user deletion with verification token\",\n\t\tresponses: { \"200\": {\n\t\t\tdescription: \"User successfully deleted\",\n\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\ttype: \"object\",\n\t\t\t\tproperties: {\n\t\t\t\t\tsuccess: {\n\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\tdescription: \"Indicates if the deletion was successful\"\n\t\t\t\t\t},\n\t\t\t\t\tmessage: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tenum: [\"User deleted\"],\n\t\t\t\t\t\tdescription: \"Confirmation message\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trequired: [\"success\", \"message\"]\n\t\t\t} } }\n\t\t} }\n\t} }\n}, async (ctx) => {\n\tif (!ctx.context.options.user?.deleteUser?.enabled) {\n\t\tctx.context.logger.error(\"Delete user is disabled. Enable it in the options\");\n\t\tthrow new APIError(\"NOT_FOUND\");\n\t}\n\tconst session = await getSessionFromCtx(ctx);\n\tif (!session) throw new APIError(\"NOT_FOUND\", { message: BASE_ERROR_CODES.FAILED_TO_GET_USER_INFO });\n\tconst token = await ctx.context.internalAdapter.findVerificationValue(`delete-account-${ctx.query.token}`);\n\tif (!token || token.expiresAt < /* @__PURE__ */ new Date()) throw new APIError(\"NOT_FOUND\", { message: BASE_ERROR_CODES.INVALID_TOKEN });\n\tif (token.value !== session.user.id) throw new APIError(\"NOT_FOUND\", { message: BASE_ERROR_CODES.INVALID_TOKEN });\n\tconst beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n\tif (beforeDelete) await beforeDelete(session.user, ctx.request);\n\tawait ctx.context.internalAdapter.deleteUser(session.user.id);\n\tawait ctx.context.internalAdapter.deleteSessions(session.user.id);\n\tawait ctx.context.internalAdapter.deleteAccounts(session.user.id);\n\tawait ctx.context.internalAdapter.deleteVerificationValue(token.id);\n\tdeleteSessionCookie(ctx);\n\tconst afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n\tif (afterDelete) await afterDelete(session.user, ctx.request);\n\tif (ctx.query.callbackURL) throw ctx.redirect(ctx.query.callbackURL || \"/\");\n\treturn ctx.json({\n\t\tsuccess: true,\n\t\tmessage: \"User deleted\"\n\t});\n});\nconst changeEmail = createAuthEndpoint(\"/change-email\", {\n\tmethod: \"POST\",\n\tbody: z.object({\n\t\tnewEmail: z.email().meta({ description: \"The new email address to set must be a valid email address\" }),\n\t\tcallbackURL: z.string().meta({ description: \"The URL to redirect to after email verification\" }).optional()\n\t}),\n\tuse: [sensitiveSessionMiddleware],\n\tmetadata: { openapi: {\n\t\toperationId: \"changeEmail\",\n\t\tresponses: {\n\t\t\t\"200\": {\n\t\t\t\tdescription: \"Email change request processed successfully\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstatus: {\n\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\tdescription: \"Indicates if the request was successful\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmessage: {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tenum: [\"Email updated\", \"Verification email sent\"],\n\t\t\t\t\t\t\tdescription: \"Status message of the email change process\",\n\t\t\t\t\t\t\tnullable: true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\trequired: [\"status\"]\n\t\t\t\t} } }\n\t\t\t},\n\t\t\t\"422\": {\n\t\t\t\tdescription: \"Unprocessable Entity. Email already exists\",\n\t\t\t\tcontent: { \"application/json\": { schema: {\n\t\t\t\t\ttype: \"object\",\n\t\t\t\t\tproperties: { message: { type: \"string\" } }\n\t\t\t\t} } }\n\t\t\t}\n\t\t}\n\t} }\n}, async (ctx) => {\n\tif (!ctx.context.options.user?.changeEmail?.enabled) {\n\t\tctx.context.logger.error(\"Change email is disabled.\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: \"Change email is disabled\" });\n\t}\n\tconst newEmail = ctx.body.newEmail.toLowerCase();\n\tif (newEmail === ctx.context.session.user.email) {\n\t\tctx.context.logger.error(\"Email is the same\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: \"Email is the same\" });\n\t}\n\tif (await ctx.context.internalAdapter.findUserByEmail(newEmail)) {\n\t\tctx.context.logger.error(\"Email already exists\");\n\t\tthrow new APIError(\"UNPROCESSABLE_ENTITY\", { message: BASE_ERROR_CODES.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL });\n\t}\n\t/**\n\t* If the email is not verified, we can update the email if the option is enabled\n\t*/\n\tif (ctx.context.session.user.emailVerified !== true && ctx.context.options.user.changeEmail.updateEmailWithoutVerification) {\n\t\tawait ctx.context.internalAdapter.updateUserByEmail(ctx.context.session.user.email, { email: newEmail });\n\t\tawait setSessionCookie(ctx, {\n\t\t\tsession: ctx.context.session.session,\n\t\t\tuser: {\n\t\t\t\t...ctx.context.session.user,\n\t\t\t\temail: newEmail\n\t\t\t}\n\t\t});\n\t\tif (ctx.context.options.emailVerification?.sendVerificationEmail) {\n\t\t\tconst token$1 = await createEmailVerificationToken(ctx.context.secret, newEmail, void 0, ctx.context.options.emailVerification?.expiresIn);\n\t\t\tconst url$1 = `${ctx.context.baseURL}/verify-email?token=${token$1}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n\t\t\tawait ctx.context.options.emailVerification.sendVerificationEmail({\n\t\t\t\tuser: {\n\t\t\t\t\t...ctx.context.session.user,\n\t\t\t\t\temail: newEmail\n\t\t\t\t},\n\t\t\t\turl: url$1,\n\t\t\t\ttoken: token$1\n\t\t\t}, ctx.request);\n\t\t}\n\t\treturn ctx.json({ status: true });\n\t}\n\tif (ctx.context.session.user.emailVerified && (ctx.context.options.user.changeEmail.sendChangeEmailConfirmation || ctx.context.options.user.changeEmail.sendChangeEmailVerification)) {\n\t\tconst token$1 = await createEmailVerificationToken(ctx.context.secret, ctx.context.session.user.email, newEmail, ctx.context.options.emailVerification?.expiresIn, { requestType: \"change-email-confirmation\" });\n\t\tconst url$1 = `${ctx.context.baseURL}/verify-email?token=${token$1}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n\t\tconst sendFn = ctx.context.options.user.changeEmail.sendChangeEmailConfirmation || ctx.context.options.user.changeEmail.sendChangeEmailVerification;\n\t\tif (sendFn) await sendFn({\n\t\t\tuser: ctx.context.session.user,\n\t\t\tnewEmail,\n\t\t\turl: url$1,\n\t\t\ttoken: token$1\n\t\t}, ctx.request);\n\t\treturn ctx.json({ status: true });\n\t}\n\tif (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n\t\tctx.context.logger.error(\"Verification email isn't enabled.\");\n\t\tthrow new APIError(\"BAD_REQUEST\", { message: \"Verification email isn't enabled\" });\n\t}\n\tconst token = await createEmailVerificationToken(ctx.context.secret, ctx.context.session.user.email, newEmail, ctx.context.options.emailVerification?.expiresIn, { requestType: \"change-email-verification\" });\n\tconst url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n\tawait ctx.context.options.emailVerification.sendVerificationEmail({\n\t\tuser: {\n\t\t\t...ctx.context.session.user,\n\t\t\temail: newEmail\n\t\t},\n\t\turl,\n\t\ttoken\n\t}, ctx.request);\n\treturn ctx.json({ status: true });\n});\n\n//#endregion\n//#region src/api/to-auth-endpoints.ts\nconst defuReplaceArrays = createDefu((obj, key, value) => {\n\tif (Array.isArray(obj[key]) && Array.isArray(value)) {\n\t\tobj[key] = value;\n\t\treturn true;\n\t}\n});\nfunction toAuthEndpoints(endpoints, ctx) {\n\tconst api = {};\n\tfor (const [key, endpoint] of Object.entries(endpoints)) {\n\t\tapi[key] = async (context) => {\n\t\t\tconst run = async () => {\n\t\t\t\tconst authContext = await ctx;\n\t\t\t\tlet internalContext = {\n\t\t\t\t\t...context,\n\t\t\t\t\tcontext: {\n\t\t\t\t\t\t...authContext,\n\t\t\t\t\t\treturned: void 0,\n\t\t\t\t\t\tresponseHeaders: void 0,\n\t\t\t\t\t\tsession: null\n\t\t\t\t\t},\n\t\t\t\t\tpath: endpoint.path,\n\t\t\t\t\theaders: context?.headers ? new Headers(context?.headers) : void 0\n\t\t\t\t};\n\t\t\t\treturn runWithEndpointContext(internalContext, async () => {\n\t\t\t\t\tconst { beforeHooks, afterHooks } = getHooks(authContext);\n\t\t\t\t\tconst before = await runBeforeHooks(internalContext, beforeHooks);\n\t\t\t\t\t/**\n\t\t\t\t\t* If `before.context` is returned, it should\n\t\t\t\t\t* get merged with the original context\n\t\t\t\t\t*/\n\t\t\t\t\tif (\"context\" in before && before.context && typeof before.context === \"object\") {\n\t\t\t\t\t\tconst { headers, ...rest } = before.context;\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t* Headers should be merged differently\n\t\t\t\t\t\t* so the hook doesn't override the whole\n\t\t\t\t\t\t* header\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tif (headers) headers.forEach((value, key$1) => {\n\t\t\t\t\t\t\tinternalContext.headers.set(key$1, value);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tinternalContext = defuReplaceArrays(rest, internalContext);\n\t\t\t\t\t} else if (before) return context?.asResponse ? toResponse(before, { headers: context?.headers }) : context?.returnHeaders ? {\n\t\t\t\t\t\theaders: context?.headers,\n\t\t\t\t\t\tresponse: before\n\t\t\t\t\t} : before;\n\t\t\t\t\tinternalContext.asResponse = false;\n\t\t\t\t\tinternalContext.returnHeaders = true;\n\t\t\t\t\tinternalContext.returnStatus = true;\n\t\t\t\t\tconst result = await runWithEndpointContext(internalContext, () => endpoint(internalContext)).catch((e) => {\n\t\t\t\t\t\tif (e instanceof APIError)\n /**\n\t\t\t\t\t\t* API Errors from response are caught\n\t\t\t\t\t\t* and returned to hooks\n\t\t\t\t\t\t*/\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tresponse: e,\n\t\t\t\t\t\t\tstatus: e.statusCode,\n\t\t\t\t\t\t\theaders: e.headers ? new Headers(e.headers) : null\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t});\n\t\t\t\t\tif (result && result instanceof Response) return result;\n\t\t\t\t\tinternalContext.context.returned = result.response;\n\t\t\t\t\tinternalContext.context.responseHeaders = result.headers;\n\t\t\t\t\tconst after = await runAfterHooks(internalContext, afterHooks);\n\t\t\t\t\tif (after.response) result.response = after.response;\n\t\t\t\t\tif (result.response instanceof APIError && shouldPublishLog(authContext.logger.level, \"debug\")) result.response.stack = result.response.errorStack;\n\t\t\t\t\tif (result.response instanceof APIError && !context?.asResponse) throw result.response;\n\t\t\t\t\treturn context?.asResponse ? toResponse(result.response, {\n\t\t\t\t\t\theaders: result.headers,\n\t\t\t\t\t\tstatus: result.status\n\t\t\t\t\t}) : context?.returnHeaders ? context?.returnStatus ? {\n\t\t\t\t\t\theaders: result.headers,\n\t\t\t\t\t\tresponse: result.response,\n\t\t\t\t\t\tstatus: result.status\n\t\t\t\t\t} : {\n\t\t\t\t\t\theaders: result.headers,\n\t\t\t\t\t\tresponse: result.response\n\t\t\t\t\t} : context?.returnStatus ? {\n\t\t\t\t\t\tresponse: result.response,\n\t\t\t\t\t\tstatus: result.status\n\t\t\t\t\t} : result.response;\n\t\t\t\t});\n\t\t\t};\n\t\t\tif (await hasRequestState()) return run();\n\t\t\telse return runWithRequestState(/* @__PURE__ */ new WeakMap(), run);\n\t\t};\n\t\tapi[key].path = endpoint.path;\n\t\tapi[key].options = endpoint.options;\n\t}\n\treturn api;\n}\nasync function runBeforeHooks(context, hooks) {\n\tlet modifiedContext = {};\n\tfor (const hook of hooks) if (hook.matcher(context)) {\n\t\tconst result = await hook.handler({\n\t\t\t...context,\n\t\t\treturnHeaders: false\n\t\t}).catch((e) => {\n\t\t\tif (e instanceof APIError && shouldPublishLog(context.context.logger.level, \"debug\")) e.stack = e.errorStack;\n\t\t\tthrow e;\n\t\t});\n\t\tif (result && typeof result === \"object\") {\n\t\t\tif (\"context\" in result && typeof result.context === \"object\") {\n\t\t\t\tconst { headers, ...rest } = result.context;\n\t\t\t\tif (headers instanceof Headers) if (modifiedContext.headers) headers.forEach((value, key) => {\n\t\t\t\t\tmodifiedContext.headers?.set(key, value);\n\t\t\t\t});\n\t\t\t\telse modifiedContext.headers = headers;\n\t\t\t\tmodifiedContext = defuReplaceArrays(rest, modifiedContext);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n\treturn { context: modifiedContext };\n}\nasync function runAfterHooks(context, hooks) {\n\tfor (const hook of hooks) if (hook.matcher(context)) {\n\t\tconst result = await hook.handler(context).catch((e) => {\n\t\t\tif (e instanceof APIError) {\n\t\t\t\tif (shouldPublishLog(context.context.logger.level, \"debug\")) e.stack = e.errorStack;\n\t\t\t\treturn {\n\t\t\t\t\tresponse: e,\n\t\t\t\t\theaders: e.headers ? new Headers(e.headers) : null\n\t\t\t\t};\n\t\t\t}\n\t\t\tthrow e;\n\t\t});\n\t\tif (result.headers) result.headers.forEach((value, key) => {\n\t\t\tif (!context.context.responseHeaders) context.context.responseHeaders = new Headers({ [key]: value });\n\t\t\telse if (key.toLowerCase() === \"set-cookie\") context.context.responseHeaders.append(key, value);\n\t\t\telse context.context.responseHeaders.set(key, value);\n\t\t});\n\t\tif (result.response) context.context.returned = result.response;\n\t}\n\treturn {\n\t\tresponse: context.context.returned,\n\t\theaders: context.context.responseHeaders\n\t};\n}\nfunction getHooks(authContext) {\n\tconst plugins = authContext.options.plugins || [];\n\tconst beforeHooks = [];\n\tconst afterHooks = [];\n\tif (authContext.options.hooks?.before) beforeHooks.push({\n\t\tmatcher: () => true,\n\t\thandler: authContext.options.hooks.before\n\t});\n\tif (authContext.options.hooks?.after) afterHooks.push({\n\t\tmatcher: () => true,\n\t\thandler: authContext.options.hooks.after\n\t});\n\tconst pluginBeforeHooks = plugins.map((plugin) => {\n\t\tif (plugin.hooks?.before) return plugin.hooks.before;\n\t}).filter((plugin) => plugin !== void 0).flat();\n\tconst pluginAfterHooks = plugins.map((plugin) => {\n\t\tif (plugin.hooks?.after) return plugin.hooks.after;\n\t}).filter((plugin) => plugin !== void 0).flat();\n\t/**\n\t* Add plugin added hooks at last\n\t*/\n\tif (pluginBeforeHooks.length) beforeHooks.push(...pluginBeforeHooks);\n\tif (pluginAfterHooks.length) afterHooks.push(...pluginAfterHooks);\n\treturn {\n\t\tbeforeHooks,\n\t\tafterHooks\n\t};\n}\n\n//#endregion\n//#region src/api/index.ts\nfunction checkEndpointConflicts(options, logger$1) {\n\tconst endpointRegistry = /* @__PURE__ */ new Map();\n\toptions.plugins?.forEach((plugin) => {\n\t\tif (plugin.endpoints) {\n\t\t\tfor (const [key, endpoint] of Object.entries(plugin.endpoints)) if (endpoint && \"path\" in endpoint) {\n\t\t\t\tconst path = endpoint.path;\n\t\t\t\tlet methods = [];\n\t\t\t\tif (endpoint.options && \"method\" in endpoint.options) {\n\t\t\t\t\tif (Array.isArray(endpoint.options.method)) methods = endpoint.options.method;\n\t\t\t\t\telse if (typeof endpoint.options.method === \"string\") methods = [endpoint.options.method];\n\t\t\t\t}\n\t\t\t\tif (methods.length === 0) methods = [\"*\"];\n\t\t\t\tif (!endpointRegistry.has(path)) endpointRegistry.set(path, []);\n\t\t\t\tendpointRegistry.get(path).push({\n\t\t\t\t\tpluginId: plugin.id,\n\t\t\t\t\tendpointKey: key,\n\t\t\t\t\tmethods\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\tconst conflicts = [];\n\tfor (const [path, entries] of endpointRegistry.entries()) if (entries.length > 1) {\n\t\tconst methodMap = /* @__PURE__ */ new Map();\n\t\tlet hasConflict = false;\n\t\tfor (const entry of entries) for (const method of entry.methods) {\n\t\t\tif (!methodMap.has(method)) methodMap.set(method, []);\n\t\t\tmethodMap.get(method).push(entry.pluginId);\n\t\t\tif (methodMap.get(method).length > 1) hasConflict = true;\n\t\t\tif (method === \"*\" && entries.length > 1) hasConflict = true;\n\t\t\telse if (method !== \"*\" && methodMap.has(\"*\")) hasConflict = true;\n\t\t}\n\t\tif (hasConflict) {\n\t\t\tconst uniquePlugins = [...new Set(entries.map((e) => e.pluginId))];\n\t\t\tconst conflictingMethods = [];\n\t\t\tfor (const [method, plugins] of methodMap.entries()) if (plugins.length > 1 || method === \"*\" && entries.length > 1 || method !== \"*\" && methodMap.has(\"*\")) conflictingMethods.push(method);\n\t\t\tconflicts.push({\n\t\t\t\tpath,\n\t\t\t\tplugins: uniquePlugins,\n\t\t\t\tconflictingMethods\n\t\t\t});\n\t\t}\n\t}\n\tif (conflicts.length > 0) {\n\t\tconst conflictMessages = conflicts.map((conflict) => `  - \"${conflict.path}\" [${conflict.conflictingMethods.join(\", \")}] used by plugins: ${conflict.plugins.join(\", \")}`).join(\"\\n\");\n\t\tlogger$1.error(`Endpoint path conflicts detected! Multiple plugins are trying to use the same endpoint paths with conflicting HTTP methods:\n${conflictMessages}\n\nTo resolve this, you can:\n\t1. Use only one of the conflicting plugins\n\t2. Configure the plugins to use different paths (if supported)\n\t3. Ensure plugins use different HTTP methods for the same path\n`);\n\t}\n}\nfunction getEndpoints(ctx, options) {\n\tconst pluginEndpoints = options.plugins?.reduce((acc, plugin) => {\n\t\treturn {\n\t\t\t...acc,\n\t\t\t...plugin.endpoints\n\t\t};\n\t}, {}) ?? {};\n\tconst middlewares = options.plugins?.map((plugin) => plugin.middlewares?.map((m) => {\n\t\tconst middleware = (async (context) => {\n\t\t\tconst authContext = await ctx;\n\t\t\treturn m.middleware({\n\t\t\t\t...context,\n\t\t\t\tcontext: {\n\t\t\t\t\t...authContext,\n\t\t\t\t\t...context.context\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tmiddleware.options = m.middleware.options;\n\t\treturn {\n\t\t\tpath: m.path,\n\t\t\tmiddleware\n\t\t};\n\t})).filter((plugin) => plugin !== void 0).flat() || [];\n\treturn {\n\t\tapi: toAuthEndpoints({\n\t\t\tsignInSocial: signInSocial(),\n\t\t\tcallbackOAuth,\n\t\t\tgetSession: getSession(),\n\t\t\tsignOut,\n\t\t\tsignUpEmail: signUpEmail(),\n\t\t\tsignInEmail: signInEmail(),\n\t\t\tresetPassword,\n\t\t\tverifyEmail,\n\t\t\tsendVerificationEmail,\n\t\t\tchangeEmail,\n\t\t\tchangePassword,\n\t\t\tsetPassword,\n\t\t\tupdateUser: updateUser(),\n\t\t\tdeleteUser,\n\t\t\trequestPasswordReset,\n\t\t\trequestPasswordResetCallback,\n\t\t\tlistSessions: listSessions(),\n\t\t\trevokeSession,\n\t\t\trevokeSessions,\n\t\t\trevokeOtherSessions,\n\t\t\tlinkSocialAccount,\n\t\t\tlistUserAccounts,\n\t\t\tdeleteUserCallback,\n\t\t\tunlinkAccount,\n\t\t\trefreshToken,\n\t\t\tgetAccessToken,\n\t\t\taccountInfo,\n\t\t\t...pluginEndpoints,\n\t\t\tok,\n\t\t\terror\n\t\t}, ctx),\n\t\tmiddlewares\n\t};\n}\nconst router = (ctx, options) => {\n\tconst { api, middlewares } = getEndpoints(ctx, options);\n\tconst basePath = new URL(ctx.baseURL).pathname;\n\treturn createRouter(api, {\n\t\trouterContext: ctx,\n\t\topenapi: { disabled: true },\n\t\tbasePath,\n\t\trouterMiddleware: [{\n\t\t\tpath: \"/**\",\n\t\t\tmiddleware: originCheckMiddleware\n\t\t}, ...middlewares],\n\t\tallowedMediaTypes: [\"application/json\"],\n\t\tasync onRequest(req) {\n\t\t\tconst disabledPaths = ctx.options.disabledPaths || [];\n\t\t\tconst path = new URL(req.url).pathname.replace(basePath, \"\");\n\t\t\tif (disabledPaths.includes(path)) return new Response(\"Not Found\", { status: 404 });\n\t\t\tfor (const plugin of ctx.options.plugins || []) if (plugin.onRequest) {\n\t\t\t\tconst response = await plugin.onRequest(req, ctx);\n\t\t\t\tif (response && \"response\" in response) return response.response;\n\t\t\t\tif (response && \"request\" in response) {\n\t\t\t\t\tconst rateLimitResponse$1 = await onRequestRateLimit(response.request, ctx);\n\t\t\t\t\tif (rateLimitResponse$1) return rateLimitResponse$1;\n\t\t\t\t\treturn response.request;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn onRequestRateLimit(req, ctx);\n\t\t},\n\t\tasync onResponse(res) {\n\t\t\tfor (const plugin of ctx.options.plugins || []) if (plugin.onResponse) {\n\t\t\t\tconst response = await plugin.onResponse(res, ctx);\n\t\t\t\tif (response) return response.response;\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\t\tonError(e) {\n\t\t\tif (e instanceof APIError && e.status === \"FOUND\") return;\n\t\t\tif (options.onAPIError?.throw) throw e;\n\t\t\tif (options.onAPIError?.onError) {\n\t\t\t\toptions.onAPIError.onError(e, ctx);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst optLogLevel = options.logger?.level;\n\t\t\tconst log = optLogLevel === \"error\" || optLogLevel === \"warn\" || optLogLevel === \"debug\" ? logger : void 0;\n\t\t\tif (options.logger?.disabled !== true) {\n\t\t\t\tif (e && typeof e === \"object\" && \"message\" in e && typeof e.message === \"string\") {\n\t\t\t\t\tif (e.message.includes(\"no column\") || e.message.includes(\"column\") || e.message.includes(\"relation\") || e.message.includes(\"table\") || e.message.includes(\"does not exist\")) {\n\t\t\t\t\t\tctx.logger?.error(e.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (e instanceof APIError) {\n\t\t\t\t\tif (e.status === \"INTERNAL_SERVER_ERROR\") ctx.logger.error(e.status, e);\n\t\t\t\t\tlog?.error(e.message);\n\t\t\t\t} else ctx.logger?.error(e && typeof e === \"object\" && \"name\" in e ? e.name : \"\", e);\n\t\t\t}\n\t\t}\n\t});\n};\n\n//#endregion\nexport { getAccessToken as A, createEmailVerificationToken as C, callbackOAuth as D, verifyEmail as E, decryptOAuthToken as F, setTokenUtil as I, originCheck as L, listUserAccounts as M, refreshToken as N, handleOAuthUserInfo as O, unlinkAccount as P, originCheckMiddleware as R, error as S, sendVerificationEmailFn as T, signInSocial as _, getEndpoints as a, resetPassword as b, changeEmail as c, deleteUserCallback as d, setPassword as f, signInEmail as g, signOut as h, createAuthMiddleware$1 as i, linkSocialAccount as j, accountInfo as k, changePassword as l, signUpEmail as m, checkEndpointConflicts as n, optionsMiddleware as o, updateUser as p, createAuthEndpoint$1 as r, router as s, APIError$1 as t, deleteUser as u, requestPasswordReset as v, sendVerificationEmail as w, ok as x, requestPasswordResetCallback as y };"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AAEA,+BAA+B;AAC/B;;;AAGA,GACA,SAAS,iBAAiB,IAAI;IAC7B,IAAI,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,OAAO,SAAS,MAAM,OAAO,CAAC,EAAE,EAAE,MAAM;SAChQ,OAAO;AACb;AACA;;AAEA,GACA,SAAS,mBAAmB,GAAG;IAC9B,IAAI,SAAS;IACb,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,MAAM,EAAE,IAAK,UAAU,iBAAiB,GAAG,CAAC,EAAE;IACtE,OAAO;AACR;AACA;;AAEA,GACA,SAAS,UAAU,OAAO,EAAE,YAAY,IAAI;IAC3C,IAAI,MAAM,OAAO,CAAC,UAAU,OAAO,CAAC,GAAG,EAAE,QAAQ,GAAG,CAAC,CAAC,IAAM,CAAC,CAAC,EAAE,UAAU,GAAG,WAAW,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IACxG,IAAI,oBAAoB;IACxB,IAAI,mBAAmB;IACvB,IAAI,WAAW;IACf,IAAI,cAAc,MAAM;QACvB,oBAAoB;QACpB,mBAAmB;QACnB,WAAW;IACZ,OAAO,IAAI,WAAW;QACrB,oBAAoB;QACpB,mBAAmB,mBAAmB;QACtC,IAAI,iBAAiB,MAAM,GAAG,GAAG;YAChC,mBAAmB,CAAC,GAAG,EAAE,iBAAiB,CAAC,CAAC;YAC5C,WAAW,CAAC,IAAI,EAAE,iBAAiB,GAAG,CAAC;QACxC,OAAO,WAAW,CAAC,EAAE,EAAE,iBAAiB,CAAC,CAAC;IAC3C;IACA,IAAI,oBAAoB,YAAY,GAAG,iBAAiB,EAAE,CAAC,GAAG;IAC9D,IAAI,oBAAoB,YAAY,GAAG,iBAAiB,EAAE,CAAC,GAAG;IAC9D,IAAI,WAAW,YAAY,QAAQ,KAAK,CAAC,qBAAqB;QAAC;KAAQ;IACvE,IAAI,SAAS;IACb,IAAK,IAAI,IAAI,GAAG,IAAI,SAAS,MAAM,EAAE,IAAK;QACzC,IAAI,UAAU,QAAQ,CAAC,EAAE;QACzB,IAAI,cAAc,QAAQ,CAAC,IAAI,EAAE;QACjC,IAAI,mBAAmB;QACvB,IAAI,CAAC,WAAW,IAAI,GAAG;QACvB,IAAI,WAAW,IAAI,MAAM,SAAS,MAAM,GAAG,GAAG,mBAAmB;aAC5D,IAAI,gBAAgB,MAAM,mBAAmB;aAC7C,mBAAmB;QACxB,IAAI,aAAa,YAAY,MAAM;YAClC,IAAI,kBAAkB;gBACrB,UAAU,MAAM,IAAI,KAAK;gBACzB,UAAU,CAAC,GAAG,EAAE,SAAS,EAAE,EAAE,iBAAiB,GAAG,CAAC;YACnD;YACA;QACD;QACA,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,MAAM,EAAE,IAAK;YACxC,IAAI,OAAO,OAAO,CAAC,EAAE;YACrB,IAAI,SAAS,MAAM;gBAClB,IAAI,IAAI,QAAQ,MAAM,GAAG,GAAG;oBAC3B,UAAU,iBAAiB,OAAO,CAAC,IAAI,EAAE;oBACzC;gBACD;YACD,OAAO,IAAI,SAAS,KAAK,UAAU;iBAC9B,IAAI,SAAS,KAAK,UAAU,GAAG,SAAS,EAAE,CAAC;iBAC3C,UAAU,iBAAiB;QACjC;QACA,UAAU;IACX;IACA,OAAO;AACR;AACA,SAAS,QAAQ,MAAM,EAAE,MAAM;IAC9B,IAAI,OAAO,WAAW,UAAU,MAAM,IAAI,UAAU,CAAC,6BAA6B,EAAE,OAAO,OAAO,MAAM,CAAC;IACzG,OAAO,OAAO,IAAI,CAAC;AACpB;AACA;;;;;;;;;;;;;;AAcA,GACA,SAAS,cAAc,OAAO,EAAE,OAAO;IACtC,IAAI,OAAO,YAAY,YAAY,CAAC,MAAM,OAAO,CAAC,UAAU,MAAM,IAAI,UAAU,CAAC,gFAAgF,EAAE,OAAO,QAAQ,MAAM,CAAC;IACzL,IAAI,OAAO,YAAY,YAAY,OAAO,YAAY,WAAW,UAAU;QAAE,WAAW;IAAQ;IAChG,IAAI,UAAU,MAAM,KAAK,KAAK,CAAC,CAAC,OAAO,YAAY,eAAe,OAAO,YAAY,YAAY,YAAY,QAAQ,CAAC,MAAM,OAAO,CAAC,QAAQ,GAAG,MAAM,IAAI,UAAU,CAAC,iFAAiF,EAAE,OAAO,QAAQ,MAAM,CAAC;IAC7Q,UAAU,WAAW,CAAC;IACtB,IAAI,QAAQ,SAAS,KAAK,MAAM,MAAM,IAAI,MAAM;IAChD,IAAI,gBAAgB,UAAU,SAAS,QAAQ,SAAS;IACxD,IAAI,SAAS,IAAI,OAAO,CAAC,CAAC,EAAE,cAAc,CAAC,CAAC,EAAE,QAAQ,KAAK;IAC3D,IAAI,KAAK,QAAQ,IAAI,CAAC,MAAM;IAC5B,GAAG,OAAO,GAAG;IACb,GAAG,OAAO,GAAG;IACb,GAAG,MAAM,GAAG;IACZ,OAAO;AACR;AAEA,YAAY;AACZ,6CAA6C;AAC7C;;;AAGA,GACA,MAAM,wBAAwB,IAAA,yLAAoB,EAAC,OAAO;IACzD,IAAI,IAAI,OAAO,EAAE,WAAW,SAAS,IAAI,OAAO,EAAE,WAAW,aAAa,IAAI,OAAO,EAAE,WAAW,UAAU,CAAC,IAAI,OAAO,EAAE;IAC1H,MAAM,UAAU,IAAI,OAAO,EAAE;IAC7B,MAAM,UAAU,IAAI,OAAO;IAC3B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG;IACjC,MAAM,eAAe,SAAS,IAAI,aAAa,SAAS,IAAI,cAAc;IAC1E,MAAM,cAAc,MAAM,eAAe,OAAO;IAChD,MAAM,cAAc,MAAM;IAC1B,MAAM,mBAAmB,MAAM;IAC/B,MAAM,qBAAqB,MAAM;IACjC,MAAM,iBAAiB,MAAM,OAAO,CAAC,QAAQ,OAAO,CAAC,cAAc,IAAI,QAAQ,cAAc,GAAG;WAAI,QAAQ,cAAc;WAAK,MAAM,QAAQ,OAAO,CAAC,cAAc,GAAG,YAAY,EAAE;KAAC;IACrL,MAAM,aAAa,SAAS,IAAI;IAChC,MAAM,iBAAiB,CAAC,KAAK;QAC5B,IAAI,IAAI,UAAU,CAAC,MAAM,OAAO;QAChC,IAAI,QAAQ,QAAQ,CAAC,MAAM;YAC1B,IAAI,QAAQ,QAAQ,CAAC,QAAQ,OAAO,cAAc,SAAS,IAAA,gKAAS,EAAC,QAAQ;YAC7E,MAAM,OAAO,IAAA,gKAAO,EAAC;YACrB,IAAI,CAAC,MAAM,OAAO;YAClB,OAAO,cAAc,SAAS;QAC/B;QACA,MAAM,WAAW,IAAA,gKAAW,EAAC;QAC7B,OAAO,aAAa,WAAW,aAAa,YAAY,CAAC,WAAW,YAAY,IAAA,gKAAS,EAAC,OAAO,IAAI,UAAU,CAAC;IACjH;IACA,MAAM,cAAc,CAAC,KAAK;QACzB,IAAI,CAAC,KAAK;QACV,IAAI,CAAC,eAAe,IAAI,CAAC,CAAC,SAAW,eAAe,KAAK,WAAW,KAAK,WAAW,QAAQ,UAAU,YAAY,0DAA0D,IAAI,CAAC,OAAO;YACvL,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,QAAQ,EAAE,MAAM,EAAE,EAAE,KAAK;YACnD,IAAI,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,gCAAgC,EAAE,IAAI,wCAAwC,CAAC,EAAE,CAAC,gCAAgC,EAAE,gBAAgB;YAC7J,MAAM,IAAI,2JAAQ,CAAC,aAAa;gBAAE,SAAS,CAAC,QAAQ,EAAE,OAAO;YAAC;QAC/D;IACD;IACA,IAAI,cAAc,CAAC,IAAI,OAAO,CAAC,aAAa,IAAI,CAAC,IAAI,OAAO,CAAC,eAAe,EAAE;QAC7E,IAAI,CAAC,gBAAgB,iBAAiB,QAAQ,MAAM,IAAI,2JAAQ,CAAC,aAAa;YAAE,SAAS;QAAyB;QAClH,YAAY,cAAc;IAC3B;IACA,eAAe,YAAY,aAAa;IACxC,eAAe,YAAY,aAAa;IACxC,oBAAoB,YAAY,kBAAkB;IAClD,sBAAsB,YAAY,oBAAoB;AACvD;AACA,MAAM,cAAc,CAAC,WAAa,IAAA,yLAAoB,EAAC,OAAO;QAC7D,IAAI,CAAC,IAAI,OAAO,EAAE;QAClB,MAAM,EAAE,OAAO,EAAE,GAAG;QACpB,MAAM,cAAc,SAAS;QAC7B,MAAM,iBAAiB,MAAM,OAAO,CAAC,QAAQ,OAAO,CAAC,cAAc,IAAI,QAAQ,cAAc,GAAG;eAAI,QAAQ,cAAc;eAAK,MAAM,QAAQ,OAAO,CAAC,cAAc,GAAG,IAAI,OAAO,KAAK,EAAE;SAAC;QACzL,MAAM,iBAAiB,CAAC,KAAK;YAC5B,IAAI,IAAI,UAAU,CAAC,MAAM,OAAO;YAChC,IAAI,QAAQ,QAAQ,CAAC,MAAM;gBAC1B,IAAI,QAAQ,QAAQ,CAAC,QAAQ,OAAO,cAAc,SAAS,IAAA,gKAAS,EAAC,QAAQ;gBAC7E,MAAM,OAAO,IAAA,gKAAO,EAAC;gBACrB,IAAI,CAAC,MAAM,OAAO;gBAClB,OAAO,cAAc,SAAS;YAC/B;YACA,MAAM,WAAW,IAAA,gKAAW,EAAC;YAC7B,OAAO,aAAa,WAAW,aAAa,YAAY,CAAC,WAAW,YAAY,IAAA,gKAAS,EAAC,OAAO,IAAI,UAAU,CAAC;QACjH;QACA,MAAM,cAAc,CAAC,KAAK;YACzB,IAAI,CAAC,KAAK;YACV,IAAI,CAAC,eAAe,IAAI,CAAC,CAAC,SAAW,eAAe,KAAK,WAAW,KAAK,WAAW,QAAQ,UAAU,YAAY,0DAA0D,IAAI,CAAC,OAAO;gBACvL,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,QAAQ,EAAE,MAAM,EAAE,EAAE,KAAK;gBACnD,IAAI,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,gCAAgC,EAAE,IAAI,wCAAwC,CAAC,EAAE,CAAC,gCAAgC,EAAE,gBAAgB;gBAC7J,MAAM,IAAI,2JAAQ,CAAC,aAAa;oBAAE,SAAS,CAAC,QAAQ,EAAE,OAAO;gBAAC;YAC/D;QACD;QACA,MAAM,YAAY,MAAM,OAAO,CAAC,eAAe,cAAc;YAAC;SAAY;QAC1E,KAAK,MAAM,OAAO,UAAW,YAAY,KAAK;IAC/C;AAEA,YAAY;AACZ,uCAAuC;AACvC,SAAS,gBAAgB,GAAG,EAAE,MAAM,EAAE,aAAa;IAClD,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,aAAa,SAAS;IAC5B,OAAO,MAAM,cAAc,WAAW,GAAG,cAAc,cAAc,KAAK,IAAI;AAC/E;AACA,SAAS,kBAAkB,UAAU;IACpC,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;QAAE,SAAS;IAA6C,IAAI;QAC9F,QAAQ;QACR,YAAY;QACZ,SAAS;YAAE,iBAAiB,WAAW,QAAQ;QAAG;IACnD;AACD;AACA,SAAS,cAAc,WAAW,EAAE,MAAM;IACzC,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,aAAa,SAAS;IAC5B,OAAO,KAAK,IAAI,CAAC,CAAC,cAAc,aAAa,GAAG,IAAI;AACrD;AACA,SAAS,gBAAgB,GAAG;IAC3B,MAAM,QAAQ;IACd,MAAM,KAAK,IAAI,OAAO;IACtB,OAAO;QACN,KAAK,OAAO;YACX,MAAM,OAAO,CAAC,MAAM,GAAG,QAAQ,CAAC;gBAC/B;gBACA,OAAO;oBAAC;wBACP,OAAO;wBACP,OAAO;oBACR;iBAAE;YACH,EAAE,CAAC,CAAC,EAAE;YACN,IAAI,OAAO,MAAM,gBAAgB,UAAU,KAAK,WAAW,GAAG,OAAO,KAAK,WAAW;YACrF,OAAO;QACR;QACA,KAAK,OAAO,KAAK,OAAO;YACvB,IAAI;gBACH,IAAI,SAAS,MAAM,GAAG,UAAU,CAAC;oBAChC;oBACA,OAAO;wBAAC;4BACP,OAAO;4BACP,OAAO;wBACR;qBAAE;oBACF,QAAQ;wBACP,OAAO,MAAM,KAAK;wBAClB,aAAa,MAAM,WAAW;oBAC/B;gBACD;qBACK,MAAM,GAAG,MAAM,CAAC;oBACpB;oBACA,MAAM;wBACL;wBACA,OAAO,MAAM,KAAK;wBAClB,aAAa,MAAM,WAAW;oBAC/B;gBACD;YACD,EAAE,OAAO,GAAG;gBACX,IAAI,MAAM,CAAC,KAAK,CAAC,4BAA4B;YAC9C;QACD;IACD;AACD;AACA,MAAM,SAAS,aAAa,GAAG,IAAI;AACnC,SAAS,oBAAoB,GAAG,EAAE,iBAAiB;IAClD,IAAI,IAAI,OAAO,CAAC,SAAS,EAAE,eAAe,OAAO,IAAI,OAAO,CAAC,SAAS,CAAC,aAAa;IACpF,MAAM,UAAU,IAAI,SAAS,CAAC,OAAO;IACrC,IAAI,YAAY,qBAAqB,OAAO;QAC3C,KAAK,OAAO;YACX,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC,gBAAgB,EAAE,IAAI;YACrD,OAAO,OAAO,IAAA,gKAAa,EAAC,QAAQ,KAAK;QAC1C;QACA,KAAK,OAAO,KAAK,OAAO;YACvB,MAAM,MAAM,mBAAmB,UAAU,IAAI,OAAO,CAAC,SAAS,EAAE,UAAU;YAC1E,MAAM,IAAI,OAAO,CAAC,gBAAgB,EAAE,MAAM,KAAK,KAAK,SAAS,CAAC,QAAQ;QACvE;IACD;SACK,IAAI,YAAY,UAAU,OAAO;QACrC,MAAM,KAAI,GAAG;YACZ,OAAO,OAAO,GAAG,CAAC;QACnB;QACA,MAAM,KAAI,GAAG,EAAE,KAAK,EAAE,OAAO;YAC5B,OAAO,GAAG,CAAC,KAAK;QACjB;IACD;IACA,OAAO,gBAAgB;AACxB;AACA,eAAe,mBAAmB,GAAG,EAAE,GAAG;IACzC,IAAI,CAAC,IAAI,SAAS,CAAC,OAAO,EAAE;IAC5B,MAAM,OAAO,IAAI,IAAI,IAAI,GAAG,EAAE,QAAQ,CAAC,OAAO,CAAC,IAAI,OAAO,CAAC,QAAQ,IAAI,aAAa;IACpF,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM;IACjC,IAAI,MAAM,IAAI,SAAS,CAAC,GAAG;IAC3B,MAAM,KAAK,IAAA,mLAAK,EAAC,KAAK,IAAI,OAAO;IACjC,IAAI,CAAC,IAAI;IACT,MAAM,MAAM,KAAK;IACjB,MAAM,cAAc,yBAAyB,IAAI,CAAC,CAAC,OAAS,KAAK,WAAW,CAAC;IAC7E,IAAI,aAAa;QAChB,SAAS,YAAY,MAAM;QAC3B,MAAM,YAAY,GAAG;IACtB;IACA,KAAK,MAAM,UAAU,IAAI,OAAO,CAAC,OAAO,IAAI,EAAE,CAAE,IAAI,OAAO,SAAS,EAAE;QACrE,MAAM,cAAc,OAAO,SAAS,CAAC,IAAI,CAAC,CAAC,OAAS,KAAK,WAAW,CAAC;QACrE,IAAI,aAAa;YAChB,SAAS,YAAY,MAAM;YAC3B,MAAM,YAAY,GAAG;YACrB;QACD;IACD;IACA,IAAI,IAAI,SAAS,CAAC,WAAW,EAAE;QAC9B,MAAM,QAAQ,OAAO,IAAI,CAAC,IAAI,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;YAC1D,IAAI,EAAE,QAAQ,CAAC,MAAM,OAAO,cAAc,GAAG;YAC7C,OAAO,MAAM;QACd;QACA,IAAI,OAAO;YACV,MAAM,aAAa,IAAI,SAAS,CAAC,WAAW,CAAC,MAAM;YACnD,MAAM,WAAW,OAAO,eAAe,aAAa,MAAM,WAAW,OAAO;YAC5E,IAAI,UAAU;gBACb,SAAS,SAAS,MAAM;gBACxB,MAAM,SAAS,GAAG;YACnB;YACA,IAAI,aAAa,OAAO;QACzB;IACD;IACA,MAAM,UAAU,oBAAoB,KAAK;QAAE;IAAO;IAClD,MAAM,OAAO,MAAM,QAAQ,GAAG,CAAC;IAC/B,MAAM,MAAM,KAAK,GAAG;IACpB,IAAI,CAAC,MAAM,MAAM,QAAQ,GAAG,CAAC,KAAK;QACjC;QACA,OAAO;QACP,aAAa;IACd;SACK;QACJ,MAAM,uBAAuB,MAAM,KAAK,WAAW;QACnD,IAAI,gBAAgB,KAAK,QAAQ,OAAO,OAAO,kBAAkB,cAAc,KAAK,WAAW,EAAE;aAC5F,IAAI,uBAAuB,SAAS,KAAK,MAAM,QAAQ,GAAG,CAAC,KAAK;YACpE,GAAG,IAAI;YACP,OAAO;YACP,aAAa;QACd,GAAG;aACE,MAAM,QAAQ,GAAG,CAAC,KAAK;YAC3B,GAAG,IAAI;YACP,OAAO,KAAK,KAAK,GAAG;YACpB,aAAa;QACd,GAAG;IACJ;AACD;AACA,SAAS;IACR,OAAO;QAAC;YACP,aAAY,IAAI;gBACf,OAAO,KAAK,UAAU,CAAC,eAAe,KAAK,UAAU,CAAC,eAAe,KAAK,UAAU,CAAC,uBAAuB,KAAK,UAAU,CAAC;YAC7H;YACA,QAAQ;YACR,KAAK;QACN;KAAE;AACH;AAEA,YAAY;AACZ,6BAA6B;AAC7B,SAAS,kBAAkB,KAAK,EAAE,GAAG;IACpC,IAAI,CAAC,OAAO,OAAO;IACnB,IAAI,IAAI,OAAO,CAAC,OAAO,EAAE,oBAAoB,OAAO,IAAA,kKAAgB,EAAC;QACpE,KAAK,IAAI,MAAM;QACf,MAAM;IACP;IACA,OAAO;AACR;AACA,SAAS,aAAa,KAAK,EAAE,GAAG;IAC/B,IAAI,IAAI,OAAO,CAAC,OAAO,EAAE,sBAAsB,OAAO,OAAO,IAAA,kKAAgB,EAAC;QAC7E,KAAK,IAAI,MAAM;QACf,MAAM;IACP;IACA,OAAO;AACR;AAEA,YAAY;AACZ,mCAAmC;AACnC,MAAM,mBAAmB,IAAA,uLAAkB,EAAC,kBAAkB;IAC7D,QAAQ;IACR,KAAK;QAAC,oKAAiB;KAAC;IACxB,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,OAAO;oCACN,MAAM;oCACN,YAAY;wCACX,IAAI;4CAAE,MAAM;wCAAS;wCACrB,YAAY;4CAAE,MAAM;wCAAS;wCAC7B,WAAW;4CACV,MAAM;4CACN,QAAQ;wCACT;wCACA,WAAW;4CACV,MAAM;4CACN,QAAQ;wCACT;wCACA,WAAW;4CAAE,MAAM;wCAAS;wCAC5B,QAAQ;4CAAE,MAAM;wCAAS;wCACzB,QAAQ;4CACP,MAAM;4CACN,OAAO;gDAAE,MAAM;4CAAS;wCACzB;oCACD;oCACA,UAAU;wCACT;wCACA;wCACA;wCACA;wCACA;wCACA;wCACA;qCACA;gCACF;4BACD;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,MAAM,UAAU,EAAE,OAAO,CAAC,OAAO;IACjC,MAAM,WAAW,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,QAAQ,IAAI,CAAC,EAAE;IAC7E,OAAO,EAAE,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,IAAM,CAAC;YAClC,IAAI,EAAE,EAAE;YACR,YAAY,EAAE,UAAU;YACxB,WAAW,EAAE,SAAS;YACtB,WAAW,EAAE,SAAS;YACtB,WAAW,EAAE,SAAS;YACtB,QAAQ,EAAE,MAAM;YAChB,QAAQ,EAAE,KAAK,EAAE,MAAM,QAAQ,EAAE;QAClC,CAAC;AACF;AACA,MAAM,oBAAoB,IAAA,uLAAkB,EAAC,gBAAgB;IAC5D,QAAQ;IACR,gBAAgB;IAChB,MAAM,yJAAQ,CAAC;QACd,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAsD,GAAG,QAAQ;QAC7G,UAAU,2MAAsB;QAChC,SAAS,yJAAQ,CAAC;YACjB,OAAO,yJAAQ;YACf,OAAO,yJAAQ,GAAG,QAAQ;YAC1B,aAAa,yJAAQ,GAAG,QAAQ;YAChC,cAAc,yJAAQ,GAAG,QAAQ;YACjC,QAAQ,wJAAO,CAAC,yJAAQ,IAAI,QAAQ;QACrC,GAAG,QAAQ;QACX,eAAe,0JAAS,GAAG,QAAQ;QACnC,QAAQ,wJAAO,CAAC,yJAAQ,IAAI,IAAI,CAAC;YAAE,aAAa;QAAiD,GAAG,QAAQ;QAC5G,kBAAkB,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAsE,GAAG,QAAQ;QAClI,iBAAiB,0JAAS,GAAG,IAAI,CAAC;YAAE,aAAa;QAA8F,GAAG,QAAQ;QAC1J,gBAAgB,yJAAQ,CAAC,yJAAQ,IAAI,sJAAK,IAAI,QAAQ;IACvD;IACA,KAAK;QAAC,oKAAiB;KAAC;IACxB,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,KAAK;wCACJ,MAAM;wCACN,aAAa;oCACd;oCACA,UAAU;wCACT,MAAM;wCACN,aAAa;oCACd;oCACA,QAAQ;wCAAE,MAAM;oCAAU;gCAC3B;gCACA,UAAU;oCAAC;iCAAW;4BACvB;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,MAAM,UAAU,EAAE,OAAO,CAAC,OAAO;IACjC,MAAM,WAAW,EAAE,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,QAAQ;IAC/E,IAAI,CAAC,UAAU;QACd,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,yEAAyE;YAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;QAAC;QAC5H,MAAM,IAAI,2JAAQ,CAAC,aAAa;YAAE,SAAS,mOAAgB,CAAC,kBAAkB;QAAC;IAChF;IACA,IAAI,EAAE,IAAI,CAAC,OAAO,EAAE;QACnB,IAAI,CAAC,SAAS,aAAa,EAAE;YAC5B,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,mDAAmD;gBAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;YAAC;YACtG,MAAM,IAAI,2JAAQ,CAAC,aAAa;gBAAE,SAAS,mOAAgB,CAAC,sBAAsB;YAAC;QACpF;QACA,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,OAAO;QACvC,IAAI,CAAC,MAAM,SAAS,aAAa,CAAC,OAAO,QAAQ;YAChD,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,oBAAoB;gBAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;YAAC;YACvE,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;gBAAE,SAAS,mOAAgB,CAAC,aAAa;YAAC;QAC9E;QACA,MAAM,kBAAkB,MAAM,SAAS,WAAW,CAAC;YAClD,SAAS;YACT,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,WAAW;YACvC,cAAc,EAAE,IAAI,CAAC,OAAO,CAAC,YAAY;QAC1C;QACA,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,MAAM;YAC/C,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,2BAA2B;gBAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;YAAC;YAC9E,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;gBAAE,SAAS,mOAAgB,CAAC,uBAAuB;YAAC;QACxF;QACA,MAAM,gBAAgB,OAAO,gBAAgB,IAAI,CAAC,EAAE;QACpD,IAAI,CAAC,gBAAgB,IAAI,CAAC,KAAK,EAAE;YAChC,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,wBAAwB;gBAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;YAAC;YAC3E,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;gBAAE,SAAS,mOAAgB,CAAC,oBAAoB;YAAC;QACrF;QACA,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,QAAQ,IAAI,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK,SAAS,EAAE,IAAI,EAAE,SAAS,KAAK,gBAAgB,OAAO,EAAE,IAAI,CAAC;YAC7J,KAAK;YACL,QAAQ;YACR,UAAU;QACX;QACA,IAAI,CAAE,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,kBAAmB,SAAS,SAAS,EAAE,KAAK,CAAC,gBAAgB,IAAI,CAAC,aAAa,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,YAAY,OAAO,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;YAAE,SAAS;QAA2C;QAC3R,IAAI,gBAAgB,IAAI,CAAC,KAAK,KAAK,QAAQ,IAAI,CAAC,KAAK,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,yBAAyB,MAAM,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;YAAE,SAAS;QAAoD;QACrO,IAAI;YACH,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC;gBAC7C,QAAQ,QAAQ,IAAI,CAAC,EAAE;gBACvB,YAAY,SAAS,EAAE;gBACvB,WAAW;gBACX,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,WAAW;gBACvC,SAAS;gBACT,cAAc,EAAE,IAAI,CAAC,OAAO,CAAC,YAAY;gBACzC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK;YACpC;QACD,EAAE,OAAO,GAAG;YACX,MAAM,IAAI,2JAAQ,CAAC,sBAAsB;gBAAE,SAAS;YAAgD;QACrG;QACA,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,yBAAyB,MAAM,IAAI;YACjF,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,UAAU,CAAC,QAAQ,IAAI,CAAC,EAAE,EAAE;gBAC3D,MAAM,gBAAgB,IAAI,EAAE;gBAC5B,OAAO,gBAAgB,IAAI,EAAE;YAC9B;QACD,EAAE,OAAO,GAAG;YACX,QAAQ,IAAI,CAAC,6BAA6B,EAAE,QAAQ;QACrD;QACA,OAAO,EAAE,IAAI,CAAC;YACb,KAAK;YACL,QAAQ;YACR,UAAU;QACX;IACD;IACA,MAAM,QAAQ,MAAM,IAAA,kKAAa,EAAC,GAAG;QACpC,QAAQ,QAAQ,IAAI,CAAC,EAAE;QACvB,OAAO,QAAQ,IAAI,CAAC,KAAK;IAC1B,GAAG,EAAE,IAAI,CAAC,cAAc;IACxB,MAAM,MAAM,MAAM,SAAS,sBAAsB,CAAC;QACjD,OAAO,MAAM,KAAK;QAClB,cAAc,MAAM,YAAY;QAChC,aAAa,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;QAC3D,QAAQ,EAAE,IAAI,CAAC,MAAM;IACtB;IACA,OAAO,EAAE,IAAI,CAAC;QACb,KAAK,IAAI,QAAQ;QACjB,UAAU,CAAC,EAAE,IAAI,CAAC,eAAe;IAClC;AACD;AACA,MAAM,gBAAgB,IAAA,uLAAkB,EAAC,mBAAmB;IAC3D,QAAQ;IACR,MAAM,yJAAQ,CAAC;QACd,YAAY,yJAAQ;QACpB,WAAW,yJAAQ,GAAG,QAAQ;IAC/B;IACA,KAAK;QAAC,oKAAsB;KAAC;IAC7B,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCAAE,QAAQ;wCAAE,MAAM;oCAAU;gCAAE;4BAC3C;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,IAAI,IAAI;IAC1C,MAAM,WAAW,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;IAC3F,IAAI,SAAS,MAAM,KAAK,KAAK,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,mBAAmB,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,mOAAgB,CAAC,6BAA6B;IAAC;IAC1L,MAAM,eAAe,SAAS,IAAI,CAAC,CAAC,UAAY,YAAY,QAAQ,SAAS,KAAK,aAAa,QAAQ,UAAU,KAAK,aAAa,QAAQ,UAAU,KAAK;IAC1J,IAAI,CAAC,cAAc,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,mOAAgB,CAAC,iBAAiB;IAAC;IACnG,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,aAAa,EAAE;IAC/D,OAAO,IAAI,IAAI,CAAC;QAAE,QAAQ;IAAK;AAChC;AACA,MAAM,iBAAiB,IAAA,uLAAkB,EAAC,qBAAqB;IAC9D,QAAQ;IACR,MAAM,yJAAQ,CAAC;QACd,YAAY,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAyC;QACpF,WAAW,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAmD,GAAG,QAAQ;QACxG,QAAQ,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA0C,GAAG,QAAQ;IAC7F;IACA,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,WAAW;gBACV,KAAK;oBACJ,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,WAAW;wCAAE,MAAM;oCAAS;oCAC5B,SAAS;wCAAE,MAAM;oCAAS;oCAC1B,aAAa;wCAAE,MAAM;oCAAS;oCAC9B,cAAc;wCAAE,MAAM;oCAAS;oCAC/B,sBAAsB;wCACrB,MAAM;wCACN,QAAQ;oCACT;oCACA,uBAAuB;wCACtB,MAAM;wCACN,QAAQ;oCACT;gCACD;4BACD;wBAAE;oBAAE;gBACL;gBACA,KAAK;oBAAE,aAAa;gBAAkD;YACvE;QACD;IAAE;AACH,GAAG,OAAO;IACT,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG,IAAI,IAAI,IAAI,CAAC;IACvD,MAAM,MAAM,IAAI,OAAO;IACvB,MAAM,UAAU,MAAM,IAAA,oKAAiB,EAAC;IACxC,IAAI,OAAO,CAAC,SAAS,MAAM,IAAI,KAAK,CAAC;IACrC,IAAI,iBAAiB,SAAS,MAAM,MAAM;IAC1C,IAAI,CAAC,gBAAgB,MAAM,IAAI,KAAK,CAAC;IACrC,IAAI,CAAC,IAAI,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,aAAa,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,CAAC,SAAS,EAAE,WAAW,kBAAkB,CAAC;IAAC;IAC3J,MAAM,cAAc,MAAM,IAAA,mKAAgB,EAAC;IAC3C,IAAI,UAAU,KAAK;IACnB,IAAI,eAAe,eAAe,YAAY,UAAU,IAAI,CAAC,CAAC,aAAa,YAAY,EAAE,KAAK,SAAS,GAAG,UAAU;SAC/G,UAAU,CAAC,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC,MAAQ,YAAY,IAAI,EAAE,KAAK,aAAa,IAAI,UAAU,KAAK,aAAa,IAAI,UAAU,KAAK;IACrL,IAAI,CAAC,SAAS,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAAoB;IAC/E,MAAM,WAAW,IAAI,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAClE,IAAI,CAAC,UAAU,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,CAAC,SAAS,EAAE,WAAW,WAAW,CAAC;IAAC;IAChG,IAAI;QACH,IAAI,YAAY;QAChB,MAAM,qBAAqB,QAAQ,oBAAoB,IAAI,IAAI,KAAK,QAAQ,oBAAoB,EAAE,OAAO,KAAK,KAAK,GAAG,KAAK;QAC3H,IAAI,QAAQ,YAAY,IAAI,sBAAsB,SAAS,kBAAkB,EAAE;YAC9E,MAAM,iBAAiB,MAAM,kBAAkB,QAAQ,YAAY,EAAE,IAAI,OAAO;YAChF,YAAY,MAAM,SAAS,kBAAkB,CAAC;YAC9C,MAAM,iBAAiB,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,QAAQ,EAAE,EAAE;gBAClF,aAAa,MAAM,aAAa,UAAU,WAAW,EAAE,IAAI,OAAO;gBAClE,sBAAsB,UAAU,oBAAoB;gBACpD,cAAc,MAAM,aAAa,UAAU,YAAY,EAAE,IAAI,OAAO;gBACpE,uBAAuB,UAAU,qBAAqB;YACvD;YACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,sBAAsB,gBAAgB,MAAM,IAAA,mKAAgB,EAAC,KAAK;QACpG;QACA,MAAM,SAAS;YACd,aAAa,WAAW,eAAe,MAAM,kBAAkB,QAAQ,WAAW,IAAI,IAAI,IAAI,OAAO;YACrG,sBAAsB,WAAW,wBAAwB,QAAQ,oBAAoB,IAAI,KAAK;YAC9F,QAAQ,QAAQ,KAAK,EAAE,MAAM,QAAQ,EAAE;YACvC,SAAS,WAAW,WAAW,QAAQ,OAAO,IAAI,KAAK;QACxD;QACA,OAAO,IAAI,IAAI,CAAC;IACjB,EAAE,OAAO,SAAS;QACjB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YACjC,SAAS;YACT,OAAO;QACR;IACD;AACD;AACA,MAAM,eAAe,IAAA,uLAAkB,EAAC,kBAAkB;IACzD,QAAQ;IACR,MAAM,yJAAQ,CAAC;QACd,YAAY,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAyC;QACpF,WAAW,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAmD,GAAG,QAAQ;QACxG,QAAQ,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA0C,GAAG,QAAQ;IAC7F;IACA,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,WAAW;gBACV,KAAK;oBACJ,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,WAAW;wCAAE,MAAM;oCAAS;oCAC5B,SAAS;wCAAE,MAAM;oCAAS;oCAC1B,aAAa;wCAAE,MAAM;oCAAS;oCAC9B,cAAc;wCAAE,MAAM;oCAAS;oCAC/B,sBAAsB;wCACrB,MAAM;wCACN,QAAQ;oCACT;oCACA,uBAAuB;wCACtB,MAAM;wCACN,QAAQ;oCACT;gCACD;4BACD;wBAAE;oBAAE;gBACL;gBACA,KAAK;oBAAE,aAAa;gBAAkD;YACvE;QACD;IAAE;AACH,GAAG,OAAO;IACT,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG,IAAI,IAAI;IAClD,MAAM,MAAM,IAAI,OAAO;IACvB,MAAM,UAAU,MAAM,IAAA,oKAAiB,EAAC;IACxC,IAAI,OAAO,CAAC,SAAS,MAAM,IAAI,KAAK,CAAC;IACrC,IAAI,iBAAiB,SAAS,MAAM,MAAM;IAC1C,IAAI,CAAC,gBAAgB,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,CAAC,oCAAoC,CAAC;IAAC;IACzG,MAAM,WAAW,IAAI,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAClE,IAAI,CAAC,UAAU,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,CAAC,SAAS,EAAE,WAAW,WAAW,CAAC;IAAC;IAChG,IAAI,CAAC,SAAS,kBAAkB,EAAE,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,CAAC,SAAS,EAAE,WAAW,mCAAmC,CAAC;IAAC;IAC3I,IAAI,UAAU,KAAK;IACnB,MAAM,cAAc,MAAM,IAAA,mKAAgB,EAAC;IAC3C,IAAI,eAAe,CAAC,CAAC,cAAc,eAAe,aAAa,UAAU,GAAG,UAAU;SACjF,UAAU,CAAC,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC,MAAQ,YAAY,IAAI,EAAE,KAAK,aAAa,IAAI,UAAU,KAAK,aAAa,IAAI,UAAU,KAAK;IACrL,IAAI,CAAC,SAAS,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAAoB;IAC/E,IAAI,iBAAiB,KAAK;IAC1B,IAAI,eAAe,eAAe,YAAY,UAAU,EAAE,iBAAiB,YAAY,YAAY,IAAI,KAAK;SACvG,iBAAiB,QAAQ,YAAY,IAAI,KAAK;IACnD,IAAI,CAAC,gBAAgB,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAA0B;IAC5F,IAAI;QACH,MAAM,wBAAwB,MAAM,kBAAkB,gBAAgB,IAAI,OAAO;QACjF,MAAM,SAAS,MAAM,SAAS,kBAAkB,CAAC;QACjD,IAAI,QAAQ,EAAE,EAAE;YACf,MAAM,aAAa;gBAClB,GAAG,WAAW,CAAC,CAAC;gBAChB,aAAa,MAAM,aAAa,OAAO,WAAW,EAAE,IAAI,OAAO;gBAC/D,cAAc,MAAM,aAAa,OAAO,YAAY,EAAE,IAAI,OAAO;gBACjE,sBAAsB,OAAO,oBAAoB;gBACjD,uBAAuB,OAAO,qBAAqB;gBACnD,OAAO,OAAO,MAAM,EAAE,KAAK,QAAQ,QAAQ,KAAK;gBAChD,SAAS,OAAO,OAAO,IAAI,QAAQ,OAAO;YAC3C;YACA,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,QAAQ,EAAE,EAAE;QAC7D;QACA,IAAI,eAAe,eAAe,YAAY,UAAU,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,oBAAoB,MAAM,IAAA,mKAAgB,EAAC,KAAK;YACxI,GAAG,WAAW;YACd,aAAa,MAAM,aAAa,OAAO,WAAW,EAAE,IAAI,OAAO;YAC/D,cAAc,MAAM,aAAa,OAAO,YAAY,EAAE,IAAI,OAAO;YACjE,sBAAsB,OAAO,oBAAoB;YACjD,uBAAuB,OAAO,qBAAqB;YACnD,OAAO,OAAO,MAAM,EAAE,KAAK,QAAQ,YAAY,KAAK;YACpD,SAAS,OAAO,OAAO,IAAI,YAAY,OAAO;QAC/C;QACA,OAAO,IAAI,IAAI,CAAC;YACf,aAAa,OAAO,WAAW;YAC/B,cAAc,OAAO,YAAY;YACjC,sBAAsB,OAAO,oBAAoB;YACjD,uBAAuB,OAAO,qBAAqB;YACnD,OAAO,OAAO,MAAM,EAAE,KAAK,QAAQ,QAAQ,KAAK;YAChD,SAAS,OAAO,OAAO,IAAI,QAAQ,OAAO;YAC1C,YAAY,QAAQ,UAAU;YAC9B,WAAW,QAAQ,SAAS;QAC7B;IACD,EAAE,OAAO,SAAS;QACjB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YACjC,SAAS;YACT,OAAO;QACR;IACD;AACD;AACA,MAAM,yBAAyB,2JAAU,CAAC,yJAAQ,CAAC;IAAE,WAAW,yJAAQ,GAAG,IAAI,CAAC;QAAE,aAAa;IAAkE,GAAG,QAAQ;AAAG;AAC/K,MAAM,cAAc,IAAA,uLAAkB,EAAC,iBAAiB;IACvD,QAAQ;IACR,KAAK;QAAC,oKAAiB;KAAC;IACxB,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,MAAM;wCACL,MAAM;wCACN,YAAY;4CACX,IAAI;gDAAE,MAAM;4CAAS;4CACrB,MAAM;gDAAE,MAAM;4CAAS;4CACvB,OAAO;gDAAE,MAAM;4CAAS;4CACxB,OAAO;gDAAE,MAAM;4CAAS;4CACxB,eAAe;gDAAE,MAAM;4CAAU;wCAClC;wCACA,UAAU;4CAAC;4CAAM;yCAAgB;oCAClC;oCACA,MAAM;wCACL,MAAM;wCACN,YAAY,CAAC;wCACb,sBAAsB;oCACvB;gCACD;gCACA,UAAU;oCAAC;oCAAQ;iCAAO;gCAC1B,sBAAsB;4BACvB;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;IACF,OAAO;AACR,GAAG,OAAO;IACT,MAAM,oBAAoB,IAAI,KAAK,EAAE;IACrC,IAAI,UAAU,KAAK;IACnB,IAAI,CAAC,mBAAmB;QACvB,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,oBAAoB;YACpD,MAAM,cAAc,MAAM,IAAA,mKAAgB,EAAC;YAC3C,IAAI,aAAa,UAAU;QAC5B;IACD,OAAO;QACN,MAAM,cAAc,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,WAAW,CAAC;QAClE,IAAI,aAAa,UAAU;IAC5B;IACA,IAAI,CAAC,WAAW,QAAQ,MAAM,KAAK,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAAoB;IACjI,MAAM,WAAW,IAAI,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,QAAQ,UAAU;IACpF,IAAI,CAAC,UAAU,MAAM,IAAI,2JAAQ,CAAC,yBAAyB;QAAE,SAAS,CAAC,6BAA6B,EAAE,QAAQ,UAAU,CAAC,yBAAyB,CAAC;IAAC;IACpJ,MAAM,SAAS,MAAM,eAAe;QACnC,GAAG,GAAG;QACN,QAAQ;QACR,MAAM;YACL,WAAW,QAAQ,EAAE;YACrB,YAAY,QAAQ,UAAU;QAC/B;QACA,eAAe;QACf,cAAc;IACf;IACA,IAAI,CAAC,OAAO,WAAW,EAAE,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAAyB;IAC/F,MAAM,OAAO,MAAM,SAAS,WAAW,CAAC;QACvC,GAAG,MAAM;QACT,aAAa,OAAO,WAAW;IAChC;IACA,OAAO,IAAI,IAAI,CAAC;AACjB;AAEA,YAAY;AACZ,oCAAoC;AACpC,eAAe,oBAAoB,CAAC,EAAE,EAAE,QAAQ,EAAE,OAAO,EAAE,WAAW,EAAE,aAAa,EAAE,gBAAgB,EAAE;IACxG,MAAM,SAAS,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,SAAS,KAAK,CAAC,WAAW,IAAI,QAAQ,SAAS,EAAE,QAAQ,UAAU,EAAE,KAAK,CAAC,CAAC;QACxI,6MAAM,CAAC,KAAK,CAAC,2DAA2D;QACxE,MAAM,WAAW,EAAE,OAAO,CAAC,OAAO,CAAC,UAAU,EAAE,YAAY,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC;QACvF,MAAM,EAAE,QAAQ,CAAC,GAAG,SAAS,4BAA4B,CAAC;IAC3D;IACA,IAAI,OAAO,QAAQ;IACnB,IAAI,aAAa,CAAC;IAClB,IAAI,QAAQ;QACX,MAAM,gBAAgB,OAAO,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK,QAAQ,UAAU,IAAI,EAAE,SAAS,KAAK,QAAQ,SAAS;QAC1H,IAAI,CAAC,eAAe;YACnB,IAAI,CAAE,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,kBAAmB,SAAS,QAAQ,UAAU,KAAK,CAAC,SAAS,aAAa,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,YAAY,OAAO;gBAC5L,IAAI,IAAA,2NAAa,KAAI,6MAAM,CAAC,IAAI,CAAC,CAAC,+CAA+C,EAAE,QAAQ,UAAU,CAAC,2IAA2I,CAAC;gBAClP,OAAO;oBACN,OAAO;oBACP,MAAM;gBACP;YACD;YACA,IAAI;gBACH,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,WAAW,CAAC;oBAC3C,YAAY,QAAQ,UAAU;oBAC9B,WAAW,SAAS,EAAE,CAAC,QAAQ;oBAC/B,QAAQ,OAAO,IAAI,CAAC,EAAE;oBACtB,aAAa,MAAM,aAAa,QAAQ,WAAW,EAAE,EAAE,OAAO;oBAC9D,cAAc,MAAM,aAAa,QAAQ,YAAY,EAAE,EAAE,OAAO;oBAChE,SAAS,QAAQ,OAAO;oBACxB,sBAAsB,QAAQ,oBAAoB;oBAClD,uBAAuB,QAAQ,qBAAqB;oBACpD,OAAO,QAAQ,KAAK;gBACrB;YACD,EAAE,OAAO,GAAG;gBACX,6MAAM,CAAC,KAAK,CAAC,0BAA0B;gBACvC,OAAO;oBACN,OAAO;oBACP,MAAM;gBACP;YACD;YACA,IAAI,SAAS,aAAa,IAAI,CAAC,OAAO,IAAI,CAAC,aAAa,IAAI,SAAS,KAAK,CAAC,WAAW,OAAO,OAAO,IAAI,CAAC,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,UAAU,CAAC,OAAO,IAAI,CAAC,EAAE,EAAE;gBAAE,eAAe;YAAK;QAClM,OAAO;YACN,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,0BAA0B,OAAO;gBAC/D,MAAM,aAAa,OAAO,WAAW,CAAC,OAAO,OAAO,CAAC;oBACpD,SAAS,QAAQ,OAAO;oBACxB,aAAa,MAAM,aAAa,QAAQ,WAAW,EAAE,EAAE,OAAO;oBAC9D,cAAc,MAAM,aAAa,QAAQ,YAAY,EAAE,EAAE,OAAO;oBAChE,sBAAsB,QAAQ,oBAAoB;oBAClD,uBAAuB,QAAQ,qBAAqB;oBACpD,OAAO,QAAQ,KAAK;gBACrB,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,GAAK,UAAU,KAAK;gBACzC,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,oBAAoB,MAAM,IAAA,mKAAgB,EAAC,GAAG;gBAC7E,IAAI,OAAO,IAAI,CAAC,YAAY,MAAM,GAAG,GAAG,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,cAAc,EAAE,EAAE;YACzG;YACA,IAAI,SAAS,aAAa,IAAI,CAAC,OAAO,IAAI,CAAC,aAAa,IAAI,SAAS,KAAK,CAAC,WAAW,OAAO,OAAO,IAAI,CAAC,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,UAAU,CAAC,OAAO,IAAI,CAAC,EAAE,EAAE;gBAAE,eAAe;YAAK;QAClM;QACA,IAAI,kBAAkB;YACrB,MAAM,EAAE,IAAI,CAAC,EAAE,GAAG,cAAc,GAAG;YACnC,OAAO,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,UAAU,CAAC,OAAO,IAAI,CAAC,EAAE,EAAE;gBACjE,GAAG,YAAY;gBACf,OAAO,SAAS,KAAK,CAAC,WAAW;gBACjC,eAAe,SAAS,KAAK,CAAC,WAAW,OAAO,OAAO,IAAI,CAAC,KAAK,GAAG,OAAO,IAAI,CAAC,aAAa,IAAI,SAAS,aAAa,GAAG,SAAS,aAAa;YACjJ;QACD;IACD,OAAO;QACN,IAAI,eAAe,OAAO;YACzB,OAAO;YACP,MAAM;YACN,YAAY;QACb;QACA,IAAI;YACH,MAAM,EAAE,IAAI,CAAC,EAAE,GAAG,cAAc,GAAG;YACnC,MAAM,cAAc;gBACnB,aAAa,MAAM,aAAa,QAAQ,WAAW,EAAE,EAAE,OAAO;gBAC9D,cAAc,MAAM,aAAa,QAAQ,YAAY,EAAE,EAAE,OAAO;gBAChE,SAAS,QAAQ,OAAO;gBACxB,sBAAsB,QAAQ,oBAAoB;gBAClD,uBAAuB,QAAQ,qBAAqB;gBACpD,OAAO,QAAQ,KAAK;gBACpB,YAAY,QAAQ,UAAU;gBAC9B,WAAW,SAAS,EAAE,CAAC,QAAQ;YAChC;YACA,MAAM,EAAE,MAAM,WAAW,EAAE,SAAS,cAAc,EAAE,GAAG,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,eAAe,CAAC;gBACtG,GAAG,YAAY;gBACf,OAAO,SAAS,KAAK,CAAC,WAAW;YAClC,GAAG;YACH,OAAO;YACP,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,oBAAoB,MAAM,IAAA,mKAAgB,EAAC,GAAG;YAC7E,IAAI,CAAC,SAAS,aAAa,IAAI,QAAQ,EAAE,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,cAAc;gBACzF,MAAM,QAAQ,MAAM,6BAA6B,EAAE,OAAO,CAAC,MAAM,EAAE,KAAK,KAAK,EAAE,KAAK,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE;gBAC5H,MAAM,MAAM,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,oBAAoB,EAAE,MAAM,aAAa,EAAE,aAAa;gBACzF,MAAM,EAAE,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,wBAAwB;oBAClE;oBACA;oBACA;gBACD,GAAG,EAAE,OAAO;YACb;QACD,EAAE,OAAO,GAAG;YACX,6MAAM,CAAC,KAAK,CAAC;YACb,IAAI,aAAa,2JAAU,EAAE,OAAO;gBACnC,OAAO,EAAE,OAAO;gBAChB,MAAM;gBACN,YAAY;YACb;YACA,OAAO;gBACN,OAAO;gBACP,MAAM;gBACN,YAAY;YACb;QACD;IACD;IACA,IAAI,CAAC,MAAM,OAAO;QACjB,OAAO;QACP,MAAM;QACN,YAAY;IACb;IACA,MAAM,UAAU,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,KAAK,EAAE;IACrE,IAAI,CAAC,SAAS,OAAO;QACpB,OAAO;QACP,MAAM;QACN,YAAY;IACb;IACA,OAAO;QACN,MAAM;YACL;YACA;QACD;QACA,OAAO;QACP;IACD;AACD;AAEA,YAAY;AACZ,oCAAoC;AACpC,MAAM,SAAS,yJAAQ,CAAC;IACvB,MAAM,yJAAQ,GAAG,QAAQ;IACzB,OAAO,yJAAQ,GAAG,QAAQ;IAC1B,WAAW,yJAAQ,GAAG,QAAQ;IAC9B,mBAAmB,yJAAQ,GAAG,QAAQ;IACtC,OAAO,yJAAQ,GAAG,QAAQ;IAC1B,MAAM,yJAAQ,GAAG,QAAQ;AAC1B;AACA,MAAM,gBAAgB,IAAA,uLAAkB,EAAC,iBAAiB;IACzD,QAAQ;QAAC;QAAO;KAAO;IACvB,aAAa;IACb,MAAM,OAAO,QAAQ;IACrB,OAAO,OAAO,QAAQ;IACtB,UAAU;QACT,GAAG,kKAAa;QAChB,mBAAmB;YAAC;YAAqC;SAAmB;IAC7E;AACD,GAAG,OAAO;IACT,IAAI;IACJ,MAAM,kBAAkB,EAAE,OAAO,CAAC,OAAO,CAAC,UAAU,EAAE,YAAY,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC;IAC9F,IAAI,EAAE,MAAM,KAAK,QAAQ;QACxB,MAAM,WAAW,EAAE,IAAI,GAAG,OAAO,KAAK,CAAC,EAAE,IAAI,IAAI,CAAC;QAClD,MAAM,YAAY,EAAE,KAAK,GAAG,OAAO,KAAK,CAAC,EAAE,KAAK,IAAI,CAAC;QACrD,MAAM,aAAa,OAAO,KAAK,CAAC;YAC/B,GAAG,QAAQ;YACX,GAAG,SAAS;QACb;QACA,MAAM,SAAS,IAAI;QACnB,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,OAAO,CAAC,YAAa,IAAI,UAAU,KAAK,KAAK,UAAU,MAAM,OAAO,GAAG,CAAC,KAAK,OAAO;QACtH,MAAM,cAAc,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI;QACvF,MAAM,EAAE,QAAQ,CAAC;IAClB;IACA,IAAI;QACH,IAAI,EAAE,MAAM,KAAK,OAAO,cAAc,OAAO,KAAK,CAAC,EAAE,KAAK;aACrD,IAAI,EAAE,MAAM,KAAK,QAAQ,cAAc,OAAO,KAAK,CAAC,EAAE,IAAI;aAC1D,MAAM,IAAI,MAAM;IACtB,EAAE,OAAO,GAAG;QACX,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,4BAA4B;QACnD,MAAM,EAAE,QAAQ,CAAC,GAAG,gBAAgB,+BAA+B,CAAC;IACrE;IACA,MAAM,EAAE,IAAI,EAAE,OAAO,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,SAAS,EAAE,GAAG;IACtE,IAAI,CAAC,OAAO;QACX,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,mBAAmB;QAC1C,MAAM,MAAM,GAAG,kBAAkB,gBAAgB,QAAQ,CAAC,OAAO,MAAM,IAAI,qBAAqB,CAAC;QACjG,MAAM,EAAE,QAAQ,CAAC;IAClB;IACA,MAAM,EAAE,YAAY,EAAE,WAAW,EAAE,IAAI,EAAE,QAAQ,EAAE,UAAU,EAAE,aAAa,EAAE,GAAG,MAAM,IAAA,kKAAU,EAAC;IAClG,SAAS,gBAAgB,OAAO,EAAE,WAAW;QAC5C,MAAM,UAAU,YAAY;QAC5B,MAAM,SAAS,IAAI,gBAAgB;YAAE,OAAO;QAAQ;QACpD,IAAI,aAAa,OAAO,GAAG,CAAC,qBAAqB;QACjD,MAAM,MAAM,GAAG,UAAU,QAAQ,QAAQ,CAAC,OAAO,MAAM,MAAM,OAAO,QAAQ,IAAI;QAChF,MAAM,EAAE,QAAQ,CAAC;IAClB;IACA,IAAI,SAAS,gBAAgB,SAAS;IACtC,IAAI,CAAC,MAAM;QACV,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACvB,MAAM,gBAAgB;IACvB;IACA,MAAM,WAAW,EAAE,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,EAAE,MAAM,CAAC,EAAE;IAC3E,IAAI,CAAC,UAAU;QACd,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,0BAA0B,EAAE,MAAM,CAAC,EAAE,EAAE;QAC9D,MAAM,gBAAgB;IACvB;IACA,IAAI;IACJ,IAAI;QACH,SAAS,MAAM,SAAS,yBAAyB,CAAC;YACjD;YACA;YACA,UAAU;YACV,aAAa,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;QAC5D;IACD,EAAE,OAAO,GAAG;QACX,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI;QAC3B,MAAM,gBAAgB;IACvB;IACA,MAAM,WAAW,MAAM,SAAS,WAAW,CAAC;QAC3C,GAAG,MAAM;QACT,MAAM,EAAE,IAAI,EAAE,OAAO,IAAA,gKAAa,EAAC,EAAE,IAAI,CAAC,IAAI,IAAI,KAAK;IACxD,GAAG,IAAI,CAAC,CAAC,MAAQ,KAAK;IACtB,IAAI,CAAC,UAAU;QACd,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACvB,OAAO,gBAAgB;IACxB;IACA,IAAI,CAAC,aAAa;QACjB,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACvB,MAAM,gBAAgB;IACvB;IACA,IAAI,MAAM;QACT,IAAI,CAAE,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,kBAAmB,SAAS,SAAS,EAAE,KAAK,CAAC,SAAS,aAAa,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,YAAY,OAAO;YACrL,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;YACvB,OAAO,gBAAgB;QACxB;QACA,IAAI,SAAS,KAAK,KAAK,KAAK,KAAK,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,yBAAyB,MAAM,OAAO,gBAAgB;QACtI,MAAM,kBAAkB,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,WAAW,CAAC,OAAO,SAAS,EAAE;QACtF,IAAI,iBAAiB;YACpB,IAAI,gBAAgB,MAAM,CAAC,QAAQ,OAAO,KAAK,MAAM,CAAC,QAAQ,IAAI,OAAO,gBAAgB;YACzF,MAAM,aAAa,OAAO,WAAW,CAAC,OAAO,OAAO,CAAC;gBACpD,aAAa,MAAM,aAAa,OAAO,WAAW,EAAE,EAAE,OAAO;gBAC7D,cAAc,MAAM,aAAa,OAAO,YAAY,EAAE,EAAE,OAAO;gBAC/D,SAAS,OAAO,OAAO;gBACvB,sBAAsB,OAAO,oBAAoB;gBACjD,uBAAuB,OAAO,qBAAqB;gBACnD,OAAO,OAAO,MAAM,EAAE,KAAK;YAC5B,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,GAAK,UAAU,KAAK;YACzC,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,gBAAgB,EAAE,EAAE;QACnE,OAAO,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC;YACzD,QAAQ,KAAK,MAAM;YACnB,YAAY,SAAS,EAAE;YACvB,WAAW,OAAO,SAAS,EAAE;YAC7B,GAAG,MAAM;YACT,aAAa,MAAM,aAAa,OAAO,WAAW,EAAE,EAAE,OAAO;YAC7D,cAAc,MAAM,aAAa,OAAO,YAAY,EAAE,EAAE,OAAO;YAC/D,OAAO,OAAO,MAAM,EAAE,KAAK;QAC5B,IAAI,OAAO,gBAAgB;QAC3B,IAAI;QACJ,IAAI;YACH,iBAAiB,YAAY,QAAQ;QACtC,EAAE,OAAM;YACP,iBAAiB;QAClB;QACA,MAAM,EAAE,QAAQ,CAAC;IAClB;IACA,IAAI,CAAC,SAAS,KAAK,EAAE;QACpB,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACvB,OAAO,gBAAgB;IACxB;IACA,MAAM,cAAc;QACnB,YAAY,SAAS,EAAE;QACvB,WAAW,OAAO,SAAS,EAAE;QAC7B,GAAG,MAAM;QACT,OAAO,OAAO,MAAM,EAAE,KAAK;IAC5B;IACA,MAAM,SAAS,MAAM,oBAAoB,GAAG;QAC3C,UAAU;YACT,GAAG,QAAQ;YACX,IAAI,OAAO,SAAS,EAAE;YACtB,OAAO,SAAS,KAAK;YACrB,MAAM,SAAS,IAAI,IAAI,SAAS,KAAK;QACtC;QACA,SAAS;QACT;QACA,eAAe,SAAS,qBAAqB,IAAI,CAAC,iBAAiB,SAAS,OAAO,EAAE;QACrF,kBAAkB,SAAS,OAAO,EAAE;IACrC;IACA,IAAI,OAAO,KAAK,EAAE;QACjB,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,KAAK,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC;QACpD,OAAO,gBAAgB,OAAO,KAAK,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC;IACrD;IACA,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,OAAO,IAAI;IACrC,MAAM,IAAA,mKAAgB,EAAC,GAAG;QACzB;QACA;IACD;IACA,IAAI;IACJ,IAAI;QACH,eAAe,CAAC,OAAO,UAAU,GAAG,cAAc,cAAc,WAAW,EAAE,QAAQ;IACtF,EAAE,OAAM;QACP,eAAe,OAAO,UAAU,GAAG,cAAc,cAAc;IAChE;IACA,MAAM,EAAE,QAAQ,CAAC;AAClB;AAEA,YAAY;AACZ,8CAA8C;AAC9C,eAAe,6BAA6B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,YAAY,IAAI,EAAE,YAAY;IAClG,OAAO,MAAM,IAAA,kKAAO,EAAC;QACpB,OAAO,MAAM,WAAW;QACxB;QACA,GAAG,YAAY;IAChB,GAAG,QAAQ;AACZ;AACA;;AAEA,GACA,eAAe,wBAAwB,GAAG,EAAE,IAAI;IAC/C,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,uBAAuB;QAClE,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS;QAAmC;IACjF;IACA,MAAM,QAAQ,MAAM,6BAA6B,IAAI,OAAO,CAAC,MAAM,EAAE,KAAK,KAAK,EAAE,KAAK,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE;IAChI,MAAM,cAAc,IAAI,IAAI,CAAC,WAAW,GAAG,mBAAmB,IAAI,IAAI,CAAC,WAAW,IAAI,mBAAmB;IACzG,MAAM,MAAM,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,oBAAoB,EAAE,MAAM,aAAa,EAAE,aAAa;IAC3F,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,qBAAqB,CAAC;QACjE;QACA;QACA;IACD,GAAG,IAAI,OAAO;AACf;AACA,MAAM,wBAAwB,IAAA,uLAAkB,EAAC,4BAA4B;IAC5E,QAAQ;IACR,aAAa;IACb,MAAM,yJAAQ,CAAC;QACd,OAAO,wJAAO,GAAG,IAAI,CAAC;YAAE,aAAa;QAA8C;QACnF,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAiD,GAAG,QAAQ;IACzG;IACA,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,aAAa;YACb,aAAa;gBAAE,SAAS;oBAAE,oBAAoB;wBAAE,QAAQ;4BACvD,MAAM;4BACN,YAAY;gCACX,OAAO;oCACN,MAAM;oCACN,aAAa;oCACb,SAAS;gCACV;gCACA,aAAa;oCACZ,MAAM;oCACN,aAAa;oCACb,SAAS;oCACT,UAAU;gCACX;4BACD;4BACA,UAAU;gCAAC;6BAAQ;wBACpB;oBAAE;gBAAE;YAAE;YACN,WAAW;gBACV,OAAO;oBACN,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCAAE,QAAQ;wCACrB,MAAM;wCACN,aAAa;wCACb,SAAS;oCACV;gCAAE;4BACH;wBAAE;oBAAE;gBACL;gBACA,OAAO;oBACN,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCAAE,SAAS;wCACtB,MAAM;wCACN,aAAa;wCACb,SAAS;oCACV;gCAAE;4BACH;wBAAE;oBAAE;gBACL;YACD;QACD;IAAE;AACH,GAAG,OAAO;IACT,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,uBAAuB;QAClE,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS;QAAmC;IACjF;IACA,MAAM,EAAE,KAAK,EAAE,GAAG,IAAI,IAAI;IAC1B,MAAM,UAAU,MAAM,IAAA,oKAAiB,EAAC;IACxC,IAAI,CAAC,SAAS;QACb,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,CAAC;QAC/D,IAAI,CAAC,MAAM;YACV,MAAM,6BAA6B,IAAI,OAAO,CAAC,MAAM,EAAE,OAAO,KAAK,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE;YAC7G,OAAO,IAAI,IAAI,CAAC;gBAAE,QAAQ;YAAK;QAChC;QACA,MAAM,wBAAwB,KAAK,KAAK,IAAI;QAC5C,OAAO,IAAI,IAAI,CAAC;YAAE,QAAQ;QAAK;IAChC;IACA,IAAI,SAAS,KAAK,eAAe,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAAgE;IAC9I,IAAI,SAAS,KAAK,UAAU,OAAO,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAA2D;IAC3I,MAAM,wBAAwB,KAAK,QAAQ,IAAI;IAC/C,OAAO,IAAI,IAAI,CAAC;QAAE,QAAQ;IAAK;AAChC;AACA,MAAM,cAAc,IAAA,uLAAkB,EAAC,iBAAiB;IACvD,QAAQ;IACR,aAAa;IACb,OAAO,yJAAQ,CAAC;QACf,OAAO,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAgC;QACtE,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAkD,GAAG,QAAQ;IAC1G;IACA,KAAK;QAAC,YAAY,CAAC,MAAQ,IAAI,KAAK,CAAC,WAAW;KAAE;IAClD,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,YAAY;gBAAC;oBACZ,MAAM;oBACN,IAAI;oBACJ,aAAa;oBACb,UAAU;oBACV,QAAQ;wBAAE,MAAM;oBAAS;gBAC1B;gBAAG;oBACF,MAAM;oBACN,IAAI;oBACJ,aAAa;oBACb,UAAU;oBACV,QAAQ;wBAAE,MAAM;oBAAS;gBAC1B;aAAE;YACF,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,MAAM;wCACL,MAAM;wCACN,MAAM;oCACP;oCACA,QAAQ;wCACP,MAAM;wCACN,aAAa;oCACd;gCACD;gCACA,UAAU;oCAAC;oCAAQ;iCAAS;4BAC7B;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,SAAS,gBAAgB,OAAO;QAC/B,IAAI,IAAI,KAAK,CAAC,WAAW,EAAE;YAC1B,IAAI,IAAI,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,MAAM,IAAI,QAAQ,CAAC,GAAG,IAAI,KAAK,CAAC,WAAW,CAAC,OAAO,EAAE,SAAS;YACvG,MAAM,IAAI,QAAQ,CAAC,GAAG,IAAI,KAAK,CAAC,WAAW,CAAC,OAAO,EAAE,SAAS;QAC/D;QACA,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;YAAE,SAAS;QAAQ;IACvD;IACA,MAAM,EAAE,KAAK,EAAE,GAAG,IAAI,KAAK;IAC3B,IAAI;IACJ,IAAI;QACH,MAAM,MAAM,IAAA,oKAAS,EAAC,OAAO,IAAI,cAAc,MAAM,CAAC,IAAI,OAAO,CAAC,MAAM,GAAG;YAAE,YAAY;gBAAC;aAAQ;QAAC;IACpG,EAAE,OAAO,GAAG;QACX,IAAI,aAAa,sKAAU,EAAE,OAAO,gBAAgB;QACpD,OAAO,gBAAgB;IACxB;IACA,MAAM,SAAS,yJAAQ,CAAC;QACvB,OAAO,wJAAO;QACd,UAAU,yJAAQ,GAAG,QAAQ;QAC7B,aAAa,yJAAQ,GAAG,QAAQ;IACjC,GAAG,KAAK,CAAC,IAAI,OAAO;IACpB,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,CAAC,OAAO,KAAK;IAC3E,IAAI,CAAC,MAAM,OAAO,gBAAgB;IAClC,IAAI,OAAO,QAAQ,EAAE;QACpB,IAAI,UAAU,MAAM,IAAA,oKAAiB,EAAC;QACtC,IAAI,WAAW,QAAQ,IAAI,CAAC,KAAK,KAAK,OAAO,KAAK,EAAE,OAAO,gBAAgB;QAC3E,IAAI,OAAO,WAAW,KAAK,6BAA6B;YACvD,MAAM,aAAa,MAAM,6BAA6B,IAAI,OAAO,CAAC,MAAM,EAAE,OAAO,KAAK,EAAE,OAAO,QAAQ,EAAE,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,WAAW;gBAAE,aAAa;YAA4B;YACtM,MAAM,sBAAsB,IAAI,KAAK,CAAC,WAAW,GAAG,mBAAmB,IAAI,KAAK,CAAC,WAAW,IAAI,mBAAmB;YACnH,MAAM,MAAM,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,oBAAoB,EAAE,WAAW,aAAa,EAAE,qBAAqB;YACxG,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,wBAAwB;gBACpE,MAAM;oBACL,GAAG,KAAK,IAAI;oBACZ,OAAO,OAAO,QAAQ;gBACvB;gBACA;gBACA,OAAO;YACR,GAAG,IAAI,OAAO;YACd,IAAI,IAAI,KAAK,CAAC,WAAW,EAAE,MAAM,IAAI,QAAQ,CAAC,IAAI,KAAK,CAAC,WAAW;YACnE,OAAO,IAAI,IAAI,CAAC;gBAAE,QAAQ;YAAK;QAChC;QACA,IAAI,CAAC,SAAS;YACb,MAAM,aAAa,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,KAAK,IAAI,CAAC,EAAE;YAC/E,IAAI,CAAC,YAAY,MAAM,IAAI,2JAAQ,CAAC,yBAAyB;gBAAE,SAAS;YAA2B;YACnG,UAAU;gBACT,SAAS;gBACT,MAAM,KAAK,IAAI;YAChB;QACD;QACA,IAAI,OAAO,WAAW,KAAK,6BAA6B;YACvD,MAAM,gBAAgB,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,iBAAiB,CAAC,OAAO,KAAK,EAAE;gBACvF,OAAO,OAAO,QAAQ;gBACtB,eAAe;YAChB;YACA,MAAM,IAAA,mKAAgB,EAAC,KAAK;gBAC3B,SAAS,QAAQ,OAAO;gBACxB,MAAM;oBACL,GAAG,QAAQ,IAAI;oBACf,OAAO,OAAO,QAAQ;oBACtB,eAAe;gBAChB;YACD;YACA,IAAI,IAAI,KAAK,CAAC,WAAW,EAAE,MAAM,IAAI,QAAQ,CAAC,IAAI,KAAK,CAAC,WAAW;YACnE,OAAO,IAAI,IAAI,CAAC;gBACf,QAAQ;gBACR,MAAM;YACP;QACD;QACA,MAAM,gBAAgB,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,iBAAiB,CAAC,OAAO,KAAK,EAAE;YACvF,OAAO,OAAO,QAAQ;YACtB,eAAe;QAChB;QACA,MAAM,WAAW,MAAM,6BAA6B,IAAI,OAAO,CAAC,MAAM,EAAE,OAAO,QAAQ;QACvF,MAAM,oBAAoB,IAAI,KAAK,CAAC,WAAW,GAAG,mBAAmB,IAAI,KAAK,CAAC,WAAW,IAAI,mBAAmB;QACjH,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,wBAAwB;YACpE,MAAM;YACN,KAAK,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,oBAAoB,EAAE,SAAS,aAAa,EAAE,mBAAmB;YAC7F,OAAO;QACR,GAAG,IAAI,OAAO;QACd,MAAM,IAAA,mKAAgB,EAAC,KAAK;YAC3B,SAAS,QAAQ,OAAO;YACxB,MAAM;gBACL,GAAG,QAAQ,IAAI;gBACf,OAAO,OAAO,QAAQ;gBACtB,eAAe;YAChB;QACD;QACA,IAAI,IAAI,KAAK,CAAC,WAAW,EAAE,MAAM,IAAI,QAAQ,CAAC,IAAI,KAAK,CAAC,WAAW;QACnE,OAAO,IAAI,IAAI,CAAC;YACf,QAAQ;YACR,MAAM;gBACL,IAAI,cAAc,EAAE;gBACpB,OAAO,cAAc,KAAK;gBAC1B,MAAM,cAAc,IAAI;gBACxB,OAAO,cAAc,KAAK;gBAC1B,eAAe,cAAc,aAAa;gBAC1C,WAAW,cAAc,SAAS;gBAClC,WAAW,cAAc,SAAS;YACnC;QACD;IACD;IACA,IAAI,KAAK,IAAI,CAAC,aAAa,EAAE;QAC5B,IAAI,IAAI,KAAK,CAAC,WAAW,EAAE,MAAM,IAAI,QAAQ,CAAC,IAAI,KAAK,CAAC,WAAW;QACnE,OAAO,IAAI,IAAI,CAAC;YACf,QAAQ;YACR,MAAM;QACP;IACD;IACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,qBAAqB,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,KAAK,IAAI,EAAE,IAAI,OAAO;IACtJ,MAAM,cAAc,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,iBAAiB,CAAC,OAAO,KAAK,EAAE;QAAE,eAAe;IAAK;IAC5G,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,wBAAwB,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,sBAAsB,CAAC,aAAa,IAAI,OAAO;IAC9J,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,6BAA6B;QACvE,MAAM,iBAAiB,MAAM,IAAA,oKAAiB,EAAC;QAC/C,IAAI,CAAC,kBAAkB,eAAe,IAAI,CAAC,KAAK,KAAK,OAAO,KAAK,EAAE;YAClE,MAAM,UAAU,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,KAAK,IAAI,CAAC,EAAE;YAC5E,IAAI,CAAC,SAAS,MAAM,IAAI,2JAAQ,CAAC,yBAAyB;gBAAE,SAAS;YAA2B;YAChG,MAAM,IAAA,mKAAgB,EAAC,KAAK;gBAC3B;gBACA,MAAM;oBACL,GAAG,KAAK,IAAI;oBACZ,eAAe;gBAChB;YACD;QACD,OAAO,MAAM,IAAA,mKAAgB,EAAC,KAAK;YAClC,SAAS,eAAe,OAAO;YAC/B,MAAM;gBACL,GAAG,eAAe,IAAI;gBACtB,eAAe;YAChB;QACD;IACD;IACA,IAAI,IAAI,KAAK,CAAC,WAAW,EAAE,MAAM,IAAI,QAAQ,CAAC,IAAI,KAAK,CAAC,WAAW;IACnE,OAAO,IAAI,IAAI,CAAC;QACf,QAAQ;QACR,MAAM;IACP;AACD;AAEA,YAAY;AACZ,iCAAiC;AACjC,SAAS,SAAS,KAAK;IACtB,OAAO,MAAM,OAAO,CAAC,MAAM,QAAQ,OAAO,CAAC,MAAM,QAAQ,OAAO,CAAC,MAAM,UAAU,OAAO,CAAC,MAAM,SAAS,OAAO,CAAC,0DAA0D;AAC3K;AACA,MAAM,OAAO,CAAC,SAAS,OAAO,SAAS,EAAE,cAAc,IAAI;IAC1D,MAAM,SAAS,QAAQ,UAAU,EAAE;IACnC,OAAO,CAAC;;;;;;;;;;;qBAWY,EAAE,QAAQ,MAAM,iBAAiB,6FAA6F;oBAC/H,EAAE,QAAQ,QAAQ,cAAc,oBAAoB;;;;;;;;mBAQrD,EAAE,QAAQ,MAAM,UAAU,WAAW;;oBAEpC,EAAE,QAAQ,MAAM,WAAW,SAAS;;oBAEpC,EAAE,QAAQ,MAAM,WAAW,UAAU;;oBAErC,EAAE,QAAQ,MAAM,WAAW,OAAO;;;;;;;kBAOpC,EAAE,QAAQ,MAAM,YAAY,WAAW;oCACrB,EAAE,QAAQ,MAAM,cAAc,yBAAyB;mBACxE,EAAE,QAAQ,QAAQ,WAAW,QAAQ;8BAC1B,EAAE,QAAQ,QAAQ,qBAAqB,QAAQ;sBACvD,EAAE,QAAQ,QAAQ,cAAc,QAAQ;sBACxC,EAAE,QAAQ,QAAQ,cAAc,mBAAmB;kBACvD,EAAE,QAAQ,QAAQ,UAAU,kBAAkB;uBACzC,EAAE,QAAQ,QAAQ,eAAe,0BAA0B;4BACtD,EAAE,QAAQ,QAAQ,mBAAmB,mBAAmB;yBAC3D,EAAE,QAAQ,QAAQ,gBAAgB,UAAU;;;;;;;;;;;;;;;;;;;qBAmBhD,EAAE,QAAQ,QAAQ,WAAW,QAAQ;gCAC1B,EAAE,QAAQ,QAAQ,qBAAqB,QAAQ;wBACvD,EAAE,QAAQ,QAAQ,cAAc,kBAAkB;wBAClD,EAAE,QAAQ,QAAQ,cAAc,kBAAkB;oBACtD,EAAE,QAAQ,QAAQ,UAAU,kBAAkB;yBACzC,EAAE,QAAQ,QAAQ,eAAe,0BAA0B;8BACtD,EAAE,QAAQ,QAAQ,mBAAmB,kBAAkB;2BAC1D,EAAE,QAAQ,QAAQ,gBAAgB,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCvE,EAAE,QAAQ,wBAAwB,KAAK,CAAC;;;;;sDAKc,EAAE,QAAQ,QAAQ,aAAa,gBAAgB;uCAC9D,EAAE,QAAQ,QAAQ,aAAa,gBAAgB;;;;;;;;;;;;;;;sBAehE,EAAE,QAAQ,QAAQ,cAAc,oBAAoB;;;;;;AAM1E,CAAC,CAAC;;;;;;;gBAOc,EAAE,QAAQ,QAAQ,kBAAkB,oBAAoB;;;;;;IAMpE,EAAE,QAAQ,2BAA2B,KAAK,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eA8ChC,CAAC,CAAC;;;;;;;kCAOiB,EAAE,QAAQ,qBAAqB,gBAAgB,QAAQ,QAAQ,eAAe,qBAAqB;;;;;;;;yBAQ5G,EAAE,QAAQ,QAAQ,cAAc,oBAAoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;gBA4D7D,EAAE,SAAS,MAAM;;;;;;;;;;;;;;YAcrB,EAAE,CAAC,cAAc,CAAC,mMAAmM,EAAE,mBAAmB,MAAM,mHAAmH,CAAC,GAAG,YAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sDAkCzU,EAAE,mBAAmB,MAAM,OAAO,EAAE,mBAAmB,CAAC,yBAAyB,EAAE,KAAK,MAAM,CAAC,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;OAyBhJ,CAAC;AACR;AACA,MAAM,QAAQ,IAAA,uLAAkB,EAAC,UAAU;IAC1C,QAAQ;IACR,UAAU;QACT,GAAG,kKAAa;QAChB,SAAS;YACR,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,aAAa;4BAAE,QAAQ;gCACjC,MAAM;gCACN,aAAa;4BACd;wBAAE;oBAAE;gBACL;YAAE;QACH;IACD;AACD,GAAG,OAAO;IACT,MAAM,MAAM,IAAI,IAAI,EAAE,OAAO,EAAE,OAAO;IACtC,MAAM,kBAAkB,IAAI,YAAY,CAAC,GAAG,CAAC,YAAY;IACzD,MAAM,yBAAyB,IAAI,YAAY,CAAC,GAAG,CAAC,wBAAwB;IAC5E,MAAM,WAAW,qBAAqB,IAAI,CAAC,mBAAmB,MAAM,kBAAkB;IACtF,MAAM,kBAAkB,yBAAyB,SAAS,0BAA0B;IACpF,MAAM,cAAc,IAAI;IACxB,YAAY,GAAG,CAAC,SAAS;IACzB,IAAI,wBAAwB,YAAY,GAAG,CAAC,qBAAqB;IACjE,MAAM,UAAU,EAAE,OAAO,CAAC,OAAO;IACjC,MAAM,WAAW,QAAQ,UAAU,EAAE;IACrC,IAAI,UAAU,OAAO,IAAI,SAAS,MAAM;QACvC,QAAQ;QACR,SAAS;YAAE,UAAU,GAAG,WAAW,SAAS,QAAQ,CAAC,OAAO,MAAM,MAAM,YAAY,QAAQ,IAAI;QAAC;IAClG;IACA,IAAI,yNAAY,IAAI,CAAC,QAAQ,UAAU,EAAE,2BAA2B,OAAO,IAAI,SAAS,MAAM;QAC7F,QAAQ;QACR,SAAS;YAAE,UAAU,CAAC,EAAE,EAAE,YAAY,QAAQ,IAAI;QAAC;IACpD;IACA,OAAO,IAAI,SAAS,KAAK,EAAE,OAAO,CAAC,OAAO,EAAE,UAAU,kBAAkB;QAAE,SAAS;YAAE,gBAAgB;QAAY;IAAE;AACpH;AAEA,YAAY;AACZ,8BAA8B;AAC9B,MAAM,KAAK,IAAA,uLAAkB,EAAC,OAAO;IACpC,QAAQ;IACR,UAAU;QACT,GAAG,kKAAa;QAChB,SAAS;YACR,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCAAE,IAAI;wCACjB,MAAM;wCACN,aAAa;oCACd;gCAAE;gCACF,UAAU;oCAAC;iCAAK;4BACjB;wBAAE;oBAAE;gBACL;YAAE;QACH;IACD;AACD,GAAG,OAAO;IACT,OAAO,IAAI,IAAI,CAAC;QAAE,IAAI;IAAK;AAC5B;AAEA,YAAY;AACZ,0CAA0C;AAC1C,SAAS,cAAc,GAAG,EAAE,WAAW,EAAE,KAAK;IAC7C,MAAM,MAAM,cAAc,IAAI,IAAI,aAAa,IAAI,OAAO,IAAI,IAAI,IAAI,GAAG,IAAI,OAAO,CAAC,MAAM,CAAC;IAC5F,IAAI,OAAO,OAAO,OAAO,CAAC,OAAO,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,GAAK,IAAI,YAAY,CAAC,GAAG,CAAC,GAAG;IAC7E,OAAO,IAAI,IAAI;AAChB;AACA,SAAS,iBAAiB,GAAG,EAAE,WAAW,EAAE,KAAK;IAChD,MAAM,MAAM,IAAI,IAAI,aAAa,IAAI,OAAO;IAC5C,IAAI,OAAO,OAAO,OAAO,CAAC,OAAO,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,GAAK,IAAI,YAAY,CAAC,GAAG,CAAC,GAAG;IAC7E,OAAO,IAAI,IAAI;AAChB;AACA,MAAM,uBAAuB,IAAA,uLAAkB,EAAC,2BAA2B;IAC1E,QAAQ;IACR,MAAM,yJAAQ,CAAC;QACd,OAAO,wJAAO,GAAG,IAAI,CAAC;YAAE,aAAa;QAAkE;QACvG,YAAY,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAsP,GAAG,QAAQ;IAC7S;IACA,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,QAAQ;wCAAE,MAAM;oCAAU;oCAC1B,SAAS;wCAAE,MAAM;oCAAS;gCAC3B;4BACD;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,EAAE,mBAAmB;QAC7D,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS;QAA+B;IAC7E;IACA,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,IAAI,IAAI;IACtC,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,CAAC,OAAO;QAAE,iBAAiB;IAAK;IAC9F,IAAI,CAAC,MAAM;QACV;;;EAGA,GACA,IAAA,kKAAU,EAAC;QACX,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,qBAAqB,CAAC;QACxD,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,kCAAkC;YAAE;QAAM;QACnE,OAAO,IAAI,IAAI,CAAC;YACf,QAAQ;YACR,SAAS;QACV;IACD;IACA,MAAM,YAAY,IAAA,kKAAO,EAAC,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,2BAA2B,IAAI,OAAO,GAAG;IACxG,MAAM,oBAAoB,IAAA,kKAAU,EAAC;IACrC,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,uBAAuB,CAAC;QACzD,OAAO,KAAK,IAAI,CAAC,EAAE;QACnB,YAAY,CAAC,eAAe,EAAE,mBAAmB;QACjD;IACD;IACA,MAAM,cAAc,aAAa,mBAAmB,cAAc;IAClE,MAAM,MAAM,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,EAAE,kBAAkB,aAAa,EAAE,aAAa;IACnG,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,iBAAiB,CAAC;QAC5D,MAAM,KAAK,IAAI;QACf;QACA,OAAO;IACR,GAAG,IAAI,OAAO,EAAE,KAAK,CAAC,CAAC;QACtB,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,uCAAuC;IACjE;IACA,OAAO,IAAI,IAAI,CAAC;QACf,QAAQ;QACR,SAAS;IACV;AACD;AACA,MAAM,+BAA+B,IAAA,uLAAkB,EAAC,0BAA0B;IACjF,QAAQ;IACR,aAAa;IACb,OAAO,yJAAQ,CAAC;QAAE,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAuD;IAAG;IACxH,KAAK;QAAC,YAAY,CAAC,MAAQ,IAAI,KAAK,CAAC,WAAW;KAAE;IAClD,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,aAAa;YACb,YAAY;gBAAC;oBACZ,MAAM;oBACN,IAAI;oBACJ,UAAU;oBACV,aAAa;oBACb,QAAQ;wBAAE,MAAM;oBAAS;gBAC1B;gBAAG;oBACF,MAAM;oBACN,IAAI;oBACJ,UAAU;oBACV,aAAa;oBACb,QAAQ;wBAAE,MAAM;oBAAS;gBAC1B;aAAE;YACF,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCAAE,OAAO;wCAAE,MAAM;oCAAS;gCAAE;4BACzC;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,MAAM,EAAE,KAAK,EAAE,GAAG,IAAI,MAAM;IAC5B,MAAM,EAAE,WAAW,EAAE,GAAG,IAAI,KAAK;IACjC,IAAI,CAAC,SAAS,CAAC,aAAa,MAAM,IAAI,QAAQ,CAAC,cAAc,IAAI,OAAO,EAAE,aAAa;QAAE,OAAO;IAAgB;IAChH,MAAM,eAAe,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,qBAAqB,CAAC,CAAC,eAAe,EAAE,OAAO;IACtG,IAAI,CAAC,gBAAgB,aAAa,SAAS,GAAG,aAAa,GAAG,IAAI,QAAQ,MAAM,IAAI,QAAQ,CAAC,cAAc,IAAI,OAAO,EAAE,aAAa;QAAE,OAAO;IAAgB;IAC9J,MAAM,IAAI,QAAQ,CAAC,iBAAiB,IAAI,OAAO,EAAE,aAAa;QAAE;IAAM;AACvE;AACA,MAAM,gBAAgB,IAAA,uLAAkB,EAAC,mBAAmB;IAC3D,QAAQ;IACR,aAAa;IACb,OAAO,yJAAQ,CAAC;QAAE,OAAO,yJAAQ,GAAG,QAAQ;IAAG,GAAG,QAAQ;IAC1D,MAAM,yJAAQ,CAAC;QACd,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA0B;QACtE,OAAO,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAkC,GAAG,QAAQ;IACpF;IACA,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCAAE,QAAQ;wCAAE,MAAM;oCAAU;gCAAE;4BAC3C;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,MAAM,QAAQ,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,KAAK,EAAE;IAC3C,IAAI,CAAC,OAAO,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,mOAAgB,CAAC,aAAa;IAAC;IACxF,MAAM,EAAE,WAAW,EAAE,GAAG,IAAI,IAAI;IAChC,MAAM,YAAY,IAAI,OAAO,CAAC,QAAQ,EAAE,OAAO;IAC/C,MAAM,YAAY,IAAI,OAAO,CAAC,QAAQ,EAAE,OAAO;IAC/C,IAAI,YAAY,MAAM,GAAG,WAAW,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,mOAAgB,CAAC,kBAAkB;IAAC;IACrH,IAAI,YAAY,MAAM,GAAG,WAAW,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,mOAAgB,CAAC,iBAAiB;IAAC;IACpH,MAAM,KAAK,CAAC,eAAe,EAAE,OAAO;IACpC,MAAM,eAAe,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,qBAAqB,CAAC;IAC7E,IAAI,CAAC,gBAAgB,aAAa,SAAS,GAAG,aAAa,GAAG,IAAI,QAAQ,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,mOAAgB,CAAC,aAAa;IAAC;IACtJ,MAAM,SAAS,aAAa,KAAK;IACjC,MAAM,iBAAiB,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC;IACvD,IAAI,CAAC,CAAC,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,KAAO,GAAG,UAAU,KAAK,eAAe,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC;QAC3J;QACA,YAAY;QACZ,UAAU;QACV,WAAW;IACZ;SACK,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,cAAc,CAAC,QAAQ;IAC9D,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,uBAAuB,CAAC,aAAa,EAAE;IACzE,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,EAAE,iBAAiB;QAC1D,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC;QAC5D,IAAI,MAAM,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,eAAe,CAAC;YAAE;QAAK,GAAG,IAAI,OAAO;IAC3F;IACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,EAAE,+BAA+B,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,cAAc,CAAC;IAC1H,OAAO,IAAI,IAAI,CAAC;QAAE,QAAQ;IAAK;AAChC;AAEA,YAAY;AACZ,mCAAmC;AACnC,MAAM,yBAAyB,yJAAQ,CAAC;IACvC,aAAa,yJAAQ,GAAG,IAAI,CAAC;QAAE,aAAa;IAA2D,GAAG,QAAQ;IAClH,oBAAoB,yJAAQ,GAAG,QAAQ;IACvC,kBAAkB,yJAAQ,GAAG,IAAI,CAAC;QAAE,aAAa;IAAkD,GAAG,QAAQ;IAC9G,UAAU,2MAAsB;IAChC,iBAAiB,0JAAS,GAAG,IAAI,CAAC;QAAE,aAAa;IAA8F,GAAG,QAAQ;IAC1J,SAAS,2JAAU,CAAC,yJAAQ,CAAC;QAC5B,OAAO,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA6B;QACnE,OAAO,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAmC,GAAG,QAAQ;QACpF,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAiC,GAAG,QAAQ;QACxF,cAAc,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAkC,GAAG,QAAQ;QAC1F,WAAW,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA2B,GAAG,QAAQ;IACjF;IACA,QAAQ,wJAAO,CAAC,yJAAQ,IAAI,IAAI,CAAC;QAAE,aAAa;IAA8F,GAAG,QAAQ;IACzJ,eAAe,0JAAS,GAAG,IAAI,CAAC;QAAE,aAAa;IAA0F,GAAG,QAAQ;IACpJ,WAAW,yJAAQ,GAAG,IAAI,CAAC;QAAE,aAAa;IAA2D,GAAG,QAAQ;IAChH,gBAAgB,yJAAQ,CAAC,yJAAQ,IAAI,sJAAK,IAAI,QAAQ,GAAG,IAAI,CAAC;QAAE,aAAa;IAAsD;AACpI;AACA,MAAM,eAAe,IAAM,IAAA,uLAAkB,EAAC,mBAAmB;QAChE,QAAQ;QACR,aAAa;QACb,MAAM;QACN,UAAU;YACT,QAAQ;gBACP,MAAM,CAAC;gBACP,UAAU,CAAC;YACZ;YACA,SAAS;gBACR,aAAa;gBACb,aAAa;gBACb,WAAW;oBAAE,OAAO;wBACnB,aAAa;wBACb,SAAS;4BAAE,oBAAoB;gCAAE,QAAQ;oCACxC,MAAM;oCACN,aAAa;oCACb,YAAY;wCACX,OAAO;4CAAE,MAAM;wCAAS;wCACxB,MAAM;4CACL,MAAM;4CACN,MAAM;wCACP;wCACA,KAAK;4CAAE,MAAM;wCAAS;wCACtB,UAAU;4CACT,MAAM;4CACN,MAAM;gDAAC;6CAAM;wCACd;oCACD;oCACA,UAAU;wCACT;wCACA;wCACA;qCACA;gCACF;4BAAE;wBAAE;oBACL;gBAAE;YACH;QACD;IACD,GAAG,OAAO;QACT,MAAM,WAAW,EAAE,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,QAAQ;QAC/E,IAAI,CAAC,UAAU;YACd,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,yEAAyE;gBAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;YAAC;YAC5H,MAAM,IAAI,2JAAQ,CAAC,aAAa;gBAAE,SAAS,mOAAgB,CAAC,kBAAkB;YAAC;QAChF;QACA,IAAI,EAAE,IAAI,CAAC,OAAO,EAAE;YACnB,IAAI,CAAC,SAAS,aAAa,EAAE;gBAC5B,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,mDAAmD;oBAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;gBAAC;gBACtG,MAAM,IAAI,2JAAQ,CAAC,aAAa;oBAAE,SAAS,mOAAgB,CAAC,sBAAsB;gBAAC;YACpF;YACA,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,OAAO;YACvC,IAAI,CAAC,MAAM,SAAS,aAAa,CAAC,OAAO,QAAQ;gBAChD,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,oBAAoB;oBAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;gBAAC;gBACvE,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;oBAAE,SAAS,mOAAgB,CAAC,aAAa;gBAAC;YAC9E;YACA,MAAM,WAAW,MAAM,SAAS,WAAW,CAAC;gBAC3C,SAAS;gBACT,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,WAAW;gBACvC,cAAc,EAAE,IAAI,CAAC,OAAO,CAAC,YAAY;YAC1C;YACA,IAAI,CAAC,YAAY,CAAC,UAAU,MAAM;gBACjC,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,2BAA2B;oBAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;gBAAC;gBAC9E,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;oBAAE,SAAS,mOAAgB,CAAC,uBAAuB;gBAAC;YACxF;YACA,IAAI,CAAC,SAAS,IAAI,CAAC,KAAK,EAAE;gBACzB,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,wBAAwB;oBAAE,UAAU,EAAE,IAAI,CAAC,QAAQ;gBAAC;gBAC3E,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;oBAAE,SAAS,mOAAgB,CAAC,oBAAoB;gBAAC;YACrF;YACA,MAAM,OAAO,MAAM,oBAAoB,GAAG;gBACzC,UAAU;oBACT,GAAG,SAAS,IAAI;oBAChB,OAAO,SAAS,IAAI,CAAC,KAAK;oBAC1B,IAAI,OAAO,SAAS,IAAI,CAAC,EAAE;oBAC3B,MAAM,SAAS,IAAI,CAAC,IAAI,IAAI;oBAC5B,OAAO,SAAS,IAAI,CAAC,KAAK;oBAC1B,eAAe,SAAS,IAAI,CAAC,aAAa,IAAI;gBAC/C;gBACA,SAAS;oBACR,YAAY,SAAS,EAAE;oBACvB,WAAW,OAAO,SAAS,IAAI,CAAC,EAAE;oBAClC,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,WAAW;gBACxC;gBACA,aAAa,EAAE,IAAI,CAAC,WAAW;gBAC/B,eAAe,SAAS,qBAAqB,IAAI,CAAC,EAAE,IAAI,CAAC,aAAa,IAAI,SAAS,aAAa;YACjG;YACA,IAAI,KAAK,KAAK,EAAE,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;gBAAE,SAAS,KAAK,KAAK;YAAC;YACzE,MAAM,IAAA,mKAAgB,EAAC,GAAG,KAAK,IAAI;YACnC,OAAO,EAAE,IAAI,CAAC;gBACb,UAAU;gBACV,OAAO,KAAK,IAAI,CAAC,OAAO,CAAC,KAAK;gBAC9B,KAAK,KAAK;gBACV,MAAM,IAAA,kKAAe,EAAC,EAAE,OAAO,CAAC,OAAO,EAAE,KAAK,IAAI,CAAC,IAAI;YACxD;QACD;QACA,MAAM,EAAE,YAAY,EAAE,KAAK,EAAE,GAAG,MAAM,IAAA,kKAAa,EAAC,GAAG,KAAK,GAAG,EAAE,IAAI,CAAC,cAAc;QACpF,MAAM,MAAM,MAAM,SAAS,sBAAsB,CAAC;YACjD;YACA;YACA,aAAa,GAAG,EAAE,OAAO,CAAC,OAAO,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;YAC3D,QAAQ,EAAE,IAAI,CAAC,MAAM;YACrB,WAAW,EAAE,IAAI,CAAC,SAAS;QAC5B;QACA,OAAO,EAAE,IAAI,CAAC;YACb,KAAK,IAAI,QAAQ;YACjB,UAAU,CAAC,EAAE,IAAI,CAAC,eAAe;QAClC;IACD;AACA,MAAM,cAAc,IAAM,IAAA,uLAAkB,EAAC,kBAAkB;QAC9D,QAAQ;QACR,aAAa;QACb,MAAM,yJAAQ,CAAC;YACd,OAAO,yJAAQ,GAAG,IAAI,CAAC;gBAAE,aAAa;YAAoB;YAC1D,UAAU,yJAAQ,GAAG,IAAI,CAAC;gBAAE,aAAa;YAAuB;YAChE,aAAa,yJAAQ,GAAG,IAAI,CAAC;gBAAE,aAAa;YAA2D,GAAG,QAAQ;YAClH,YAAY,0JAAS,GAAG,IAAI,CAAC;gBAAE,aAAa;YAA2E,GAAG,OAAO,CAAC,MAAM,QAAQ;QACjJ;QACA,UAAU;YACT,QAAQ;gBACP,MAAM,CAAC;gBACP,UAAU,CAAC;YACZ;YACA,SAAS;gBACR,aAAa;gBACb,aAAa;gBACb,WAAW;oBAAE,OAAO;wBACnB,aAAa;wBACb,SAAS;4BAAE,oBAAoB;gCAAE,QAAQ;oCACxC,MAAM;oCACN,aAAa;oCACb,YAAY;wCACX,UAAU;4CACT,MAAM;4CACN,MAAM;gDAAC;6CAAM;wCACd;wCACA,OAAO;4CACN,MAAM;4CACN,aAAa;wCACd;wCACA,KAAK;4CACJ,MAAM;4CACN,UAAU;wCACX;wCACA,MAAM;4CACL,MAAM;4CACN,MAAM;wCACP;oCACD;oCACA,UAAU;wCACT;wCACA;wCACA;qCACA;gCACF;4BAAE;wBAAE;oBACL;gBAAE;YACH;QACD;IACD,GAAG,OAAO;QACT,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,EAAE,kBAAkB,SAAS;YACpD,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;YACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;gBAAE,SAAS;YAAoC;QAClF;QACA,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAI,IAAI;QACpC,IAAI,CAAC,wJAAO,GAAG,SAAS,CAAC,OAAO,OAAO,EAAE,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS,mOAAgB,CAAC,aAAa;QAAC;QACrH,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,CAAC,OAAO;YAAE,iBAAiB;QAAK;QAC9F,IAAI,CAAC,MAAM;YACV,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC;YAChC,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,kBAAkB;gBAAE;YAAM;YACnD,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;gBAAE,SAAS,mOAAgB,CAAC,yBAAyB;YAAC;QAC1F;QACA,MAAM,oBAAoB,KAAK,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK;QACrE,IAAI,CAAC,mBAAmB;YACvB,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC;YAChC,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,gCAAgC;gBAAE;YAAM;YACjE,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;gBAAE,SAAS,mOAAgB,CAAC,yBAAyB;YAAC;QAC1F;QACA,MAAM,kBAAkB,mBAAmB;QAC3C,IAAI,CAAC,iBAAiB;YACrB,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC;YAChC,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,sBAAsB;gBAAE;YAAM;YACvD,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;gBAAE,SAAS,mOAAgB,CAAC,yBAAyB;YAAC;QAC1F;QACA,IAAI,CAAC,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC;YACtC,MAAM;YACN;QACD,IAAI;YACH,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;YACzB,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;gBAAE,SAAS,mOAAgB,CAAC,yBAAyB;YAAC;QAC1F;QACA,IAAI,IAAI,OAAO,CAAC,OAAO,EAAE,kBAAkB,4BAA4B,CAAC,KAAK,IAAI,CAAC,aAAa,EAAE;YAChG,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,EAAE,mBAAmB,uBAAuB,MAAM,IAAI,2JAAQ,CAAC,aAAa;gBAAE,SAAS,mOAAgB,CAAC,kBAAkB;YAAC;YACnJ,IAAI,IAAI,OAAO,CAAC,OAAO,EAAE,mBAAmB,cAAc;gBACzD,MAAM,QAAQ,MAAM,6BAA6B,IAAI,OAAO,CAAC,MAAM,EAAE,KAAK,IAAI,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE;gBACrI,MAAM,cAAc,IAAI,IAAI,CAAC,WAAW,GAAG,mBAAmB,IAAI,IAAI,CAAC,WAAW,IAAI,mBAAmB;gBACzG,MAAM,MAAM,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,oBAAoB,EAAE,MAAM,aAAa,EAAE,aAAa;gBAC3F,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,qBAAqB,CAAC;oBACjE,MAAM,KAAK,IAAI;oBACf;oBACA;gBACD,GAAG,IAAI,OAAO;YACf;YACA,MAAM,IAAI,2JAAQ,CAAC,aAAa;gBAAE,SAAS,mOAAgB,CAAC,kBAAkB;YAAC;QAChF;QACA,MAAM,UAAU,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,KAAK,IAAI,CAAC,EAAE,EAAE,IAAI,IAAI,CAAC,UAAU,KAAK;QACtG,IAAI,CAAC,SAAS;YACb,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;YACzB,MAAM,IAAI,2JAAQ,CAAC,gBAAgB;gBAAE,SAAS,mOAAgB,CAAC,wBAAwB;YAAC;QACzF;QACA,MAAM,IAAA,mKAAgB,EAAC,KAAK;YAC3B;YACA,MAAM,KAAK,IAAI;QAChB,GAAG,IAAI,IAAI,CAAC,UAAU,KAAK;QAC3B,OAAO,IAAI,IAAI,CAAC;YACf,UAAU,CAAC,CAAC,IAAI,IAAI,CAAC,WAAW;YAChC,OAAO,QAAQ,KAAK;YACpB,KAAK,IAAI,IAAI,CAAC,WAAW;YACzB,MAAM,IAAA,kKAAe,EAAC,IAAI,OAAO,CAAC,OAAO,EAAE,KAAK,IAAI;QACrD;IACD;AAEA,YAAY;AACZ,oCAAoC;AACpC,MAAM,UAAU,IAAA,uLAAkB,EAAC,aAAa;IAC/C,QAAQ;IACR,aAAa;IACb,gBAAgB;IAChB,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCAAE,SAAS;wCAAE,MAAM;oCAAU;gCAAE;4BAC5C;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,MAAM,qBAAqB,MAAM,IAAI,eAAe,CAAC,IAAI,OAAO,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,OAAO,CAAC,MAAM;IAClH,IAAI,oBAAoB,IAAI;QAC3B,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC;IACjD,EAAE,OAAO,GAAG;QACX,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,0CAA0C;IACpE;IACA,IAAA,mKAAmB,EAAC;IACpB,OAAO,IAAI,IAAI,CAAC;QAAE,SAAS;IAAK;AACjC;AAEA,YAAY;AACZ,mCAAmC;AACnC,MAAM,cAAc,IAAM,IAAA,uLAAkB,EAAC,kBAAkB;QAC9D,QAAQ;QACR,aAAa;QACb,MAAM,yJAAQ,CAAC,yJAAQ,IAAI,sJAAK;QAChC,UAAU;YACT,QAAQ;gBACP,MAAM,CAAC;gBACP,UAAU,CAAC;YACZ;YACA,SAAS;gBACR,aAAa;gBACb,aAAa;gBACb,aAAa;oBAAE,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACvD,MAAM;gCACN,YAAY;oCACX,MAAM;wCACL,MAAM;wCACN,aAAa;oCACd;oCACA,OAAO;wCACN,MAAM;wCACN,aAAa;oCACd;oCACA,UAAU;wCACT,MAAM;wCACN,aAAa;oCACd;oCACA,OAAO;wCACN,MAAM;wCACN,aAAa;oCACd;oCACA,aAAa;wCACZ,MAAM;wCACN,aAAa;oCACd;oCACA,YAAY;wCACX,MAAM;wCACN,aAAa;oCACd;gCACD;gCACA,UAAU;oCACT;oCACA;oCACA;iCACA;4BACF;wBAAE;oBAAE;gBAAE;gBACN,WAAW;oBACV,OAAO;wBACN,aAAa;wBACb,SAAS;4BAAE,oBAAoB;gCAAE,QAAQ;oCACxC,MAAM;oCACN,YAAY;wCACX,OAAO;4CACN,MAAM;4CACN,UAAU;4CACV,aAAa;wCACd;wCACA,MAAM;4CACL,MAAM;4CACN,YAAY;gDACX,IAAI;oDACH,MAAM;oDACN,aAAa;gDACd;gDACA,OAAO;oDACN,MAAM;oDACN,QAAQ;oDACR,aAAa;gDACd;gDACA,MAAM;oDACL,MAAM;oDACN,aAAa;gDACd;gDACA,OAAO;oDACN,MAAM;oDACN,QAAQ;oDACR,UAAU;oDACV,aAAa;gDACd;gDACA,eAAe;oDACd,MAAM;oDACN,aAAa;gDACd;gDACA,WAAW;oDACV,MAAM;oDACN,QAAQ;oDACR,aAAa;gDACd;gDACA,WAAW;oDACV,MAAM;oDACN,QAAQ;oDACR,aAAa;gDACd;4CACD;4CACA,UAAU;gDACT;gDACA;gDACA;gDACA;gDACA;gDACA;6CACA;wCACF;oCACD;oCACA,UAAU;wCAAC;qCAAO;gCACnB;4BAAE;wBAAE;oBACL;oBACA,OAAO;wBACN,aAAa;wBACb,SAAS;4BAAE,oBAAoB;gCAAE,QAAQ;oCACxC,MAAM;oCACN,YAAY;wCAAE,SAAS;4CAAE,MAAM;wCAAS;oCAAE;gCAC3C;4BAAE;wBAAE;oBACL;gBACD;YACD;QACD;IACD,GAAG,OAAO;QACT,OAAO,IAAA,yOAAkB,EAAC,IAAI,OAAO,CAAC,OAAO,EAAE;YAC9C,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,EAAE,WAAW,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,EAAE,eAAe,MAAM,IAAI,2JAAQ,CAAC,eAAe;gBAAE,SAAS;YAA4C;YACpM,MAAM,OAAO,IAAI,IAAI;YACrB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,WAAW,EAAE,UAAU,EAAE,GAAG,MAAM,GAAG;YAC3E,IAAI,CAAC,wJAAO,GAAG,SAAS,CAAC,OAAO,OAAO,EAAE,MAAM,IAAI,2JAAQ,CAAC,eAAe;gBAAE,SAAS,mOAAgB,CAAC,aAAa;YAAC;YACrH,MAAM,oBAAoB,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB;YACvE,IAAI,SAAS,MAAM,GAAG,mBAAmB;gBACxC,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;gBACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;oBAAE,SAAS,mOAAgB,CAAC,kBAAkB;gBAAC;YAClF;YACA,MAAM,oBAAoB,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB;YACvE,IAAI,SAAS,MAAM,GAAG,mBAAmB;gBACxC,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;gBACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;oBAAE,SAAS,mOAAgB,CAAC,iBAAiB;gBAAC;YACjF;YACA,IAAI,CAAC,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,CAAC,MAAM,GAAG,MAAM;gBACrE,IAAI,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,oCAAoC,EAAE,OAAO;gBACtE,MAAM,IAAI,2JAAQ,CAAC,wBAAwB;oBAAE,SAAS,mOAAgB,CAAC,qCAAqC;gBAAC;YAC9G;YACA;;;;;;;EAOA,GACA,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC;YAC7C,IAAI;YACJ,IAAI;gBACH,MAAM,OAAO,IAAA,kKAAc,EAAC,IAAI,OAAO,CAAC,OAAO,EAAE,MAAM;gBACvD,cAAc,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,UAAU,CAAC;oBAC1D,OAAO,MAAM,WAAW;oBACxB;oBACA;oBACA,GAAG,IAAI;oBACP,eAAe;gBAChB;gBACA,IAAI,CAAC,aAAa,MAAM,IAAI,2JAAQ,CAAC,eAAe;oBAAE,SAAS,mOAAgB,CAAC,qBAAqB;gBAAC;YACvG,EAAE,OAAO,GAAG;gBACX,IAAI,IAAA,2NAAa,KAAI,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,yBAAyB;gBACvE,IAAI,aAAa,2JAAQ,EAAE,MAAM;gBACjC,IAAI,OAAO,CAAC,MAAM,EAAE,MAAM,yBAAyB;gBACnD,MAAM,IAAI,2JAAQ,CAAC,wBAAwB;oBAC1C,SAAS,mOAAgB,CAAC,qBAAqB;oBAC/C,SAAS;gBACV;YACD;YACA,IAAI,CAAC,aAAa,MAAM,IAAI,2JAAQ,CAAC,wBAAwB;gBAAE,SAAS,mOAAgB,CAAC,qBAAqB;YAAC;YAC/G,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,WAAW,CAAC;gBAC7C,QAAQ,YAAY,EAAE;gBACtB,YAAY;gBACZ,WAAW,YAAY,EAAE;gBACzB,UAAU;YACX;YACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,gBAAgB,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,wBAAwB,EAAE;gBACzH,MAAM,QAAQ,MAAM,6BAA6B,IAAI,OAAO,CAAC,MAAM,EAAE,YAAY,KAAK,EAAE,KAAK,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE;gBACvI,MAAM,gBAAgB,KAAK,WAAW,GAAG,mBAAmB,KAAK,WAAW,IAAI,mBAAmB;gBACnG,MAAM,MAAM,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,oBAAoB,EAAE,MAAM,aAAa,EAAE,eAAe;gBAC7F,MAAM,OAAO,IAAI,OAAO,GAAG;oBAAC;wBAC3B,MAAM;wBACN;wBACA;oBACD;oBAAG,IAAI,OAAO;iBAAC,GAAG;oBAAC;wBAClB,MAAM;wBACN;wBACA;oBACD;iBAAE;gBACF,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,2BAA2B;YACzE;YACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,UAAU,KAAK,SAAS,IAAI,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,wBAAwB,EAAE,OAAO,IAAI,IAAI,CAAC;gBAC/I,OAAO;gBACP,MAAM,IAAA,kKAAe,EAAC,IAAI,OAAO,CAAC,OAAO,EAAE;YAC5C;YACA,MAAM,UAAU,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,YAAY,EAAE,EAAE,eAAe;YAC/F,IAAI,CAAC,SAAS,MAAM,IAAI,2JAAQ,CAAC,eAAe;gBAAE,SAAS,mOAAgB,CAAC,wBAAwB;YAAC;YACrG,MAAM,IAAA,mKAAgB,EAAC,KAAK;gBAC3B;gBACA,MAAM;YACP,GAAG,eAAe;YAClB,OAAO,IAAI,IAAI,CAAC;gBACf,OAAO,QAAQ,KAAK;gBACpB,MAAM,IAAA,kKAAe,EAAC,IAAI,OAAO,CAAC,OAAO,EAAE;YAC5C;QACD;IACD;AAEA,YAAY;AACZ,uCAAuC;AACvC,MAAM,aAAa,IAAM,IAAA,uLAAkB,EAAC,gBAAgB;QAC3D,QAAQ;QACR,aAAa;QACb,MAAM,yJAAQ,CAAC,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA8B,IAAI,sJAAK;QACrF,KAAK;YAAC,oKAAiB;SAAC;QACxB,UAAU;YACT,QAAQ;gBAAE,MAAM,CAAC;YAAE;YACnB,SAAS;gBACR,aAAa;gBACb,aAAa;gBACb,aAAa;oBAAE,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACvD,MAAM;gCACN,YAAY;oCACX,MAAM;wCACL,MAAM;wCACN,aAAa;oCACd;oCACA,OAAO;wCACN,MAAM;wCACN,aAAa;wCACb,UAAU;oCACX;gCACD;4BACD;wBAAE;oBAAE;gBAAE;gBACN,WAAW;oBAAE,OAAO;wBACnB,aAAa;wBACb,SAAS;4BAAE,oBAAoB;gCAAE,QAAQ;oCACxC,MAAM;oCACN,YAAY;wCAAE,MAAM;4CACnB,MAAM;4CACN,MAAM;wCACP;oCAAE;gCACH;4BAAE;wBAAE;oBACL;gBAAE;YACH;QACD;IACD,GAAG,OAAO;QACT,MAAM,OAAO,IAAI,IAAI;QACrB,IAAI,KAAK,KAAK,EAAE,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS,mOAAgB,CAAC,wBAAwB;QAAC;QACvG,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,GAAG;QACjC,MAAM,UAAU,IAAI,OAAO,CAAC,OAAO;QACnC,MAAM,mBAAmB,IAAA,kKAAc,EAAC,IAAI,OAAO,CAAC,OAAO,EAAE,MAAM;QACnE,IAAI,UAAU,KAAK,KAAK,SAAS,KAAK,KAAK,OAAO,IAAI,CAAC,kBAAkB,MAAM,KAAK,GAAG,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS;QAAsB;QAC1J,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,UAAU,CAAC,QAAQ,IAAI,CAAC,EAAE,EAAE;YAC1E;YACA;YACA,GAAG,gBAAgB;QACpB;QACA;;CAEA,GACA,MAAM,IAAA,mKAAgB,EAAC,KAAK;YAC3B,SAAS,QAAQ,OAAO;YACxB;QACD;QACA,OAAO,IAAI,IAAI,CAAC;YAAE,QAAQ;QAAK;IAChC;AACA,MAAM,iBAAiB,IAAA,uLAAkB,EAAC,oBAAoB;IAC7D,QAAQ;IACR,aAAa;IACb,MAAM,yJAAQ,CAAC;QACd,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA0B;QACtE,iBAAiB,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAmC;QACnF,qBAAqB,0JAAS,GAAG,IAAI,CAAC;YAAE,aAAa;QAA0B,GAAG,QAAQ;IAC3F;IACA,KAAK;QAAC,oKAA0B;KAAC;IACjC,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,OAAO;wCACN,MAAM;wCACN,UAAU;wCACV,aAAa;oCACd;oCACA,MAAM;wCACL,MAAM;wCACN,YAAY;4CACX,IAAI;gDACH,MAAM;gDACN,aAAa;4CACd;4CACA,OAAO;gDACN,MAAM;gDACN,QAAQ;gDACR,aAAa;4CACd;4CACA,MAAM;gDACL,MAAM;gDACN,aAAa;4CACd;4CACA,OAAO;gDACN,MAAM;gDACN,QAAQ;gDACR,UAAU;gDACV,aAAa;4CACd;4CACA,eAAe;gDACd,MAAM;gDACN,aAAa;4CACd;4CACA,WAAW;gDACV,MAAM;gDACN,QAAQ;gDACR,aAAa;4CACd;4CACA,WAAW;gDACV,MAAM;gDACN,QAAQ;gDACR,aAAa;4CACd;wCACD;wCACA,UAAU;4CACT;4CACA;4CACA;4CACA;4CACA;4CACA;yCACA;oCACF;gCACD;gCACA,UAAU;oCAAC;iCAAO;4BACnB;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,MAAM,EAAE,WAAW,EAAE,eAAe,EAAE,qBAAqB,qBAAqB,EAAE,GAAG,IAAI,IAAI;IAC7F,MAAM,UAAU,IAAI,OAAO,CAAC,OAAO;IACnC,MAAM,oBAAoB,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB;IACvE,IAAI,YAAY,MAAM,GAAG,mBAAmB;QAC3C,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS,mOAAgB,CAAC,kBAAkB;QAAC;IAClF;IACA,MAAM,oBAAoB,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB;IACvE,IAAI,YAAY,MAAM,GAAG,mBAAmB;QAC3C,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS,mOAAgB,CAAC,iBAAiB;QAAC;IACjF;IACA,MAAM,UAAU,CAAC,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,QAAQ,IAAI,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,YAAc,UAAU,UAAU,KAAK,gBAAgB,UAAU,QAAQ;IACjK,IAAI,CAAC,WAAW,CAAC,QAAQ,QAAQ,EAAE,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,mOAAgB,CAAC,4BAA4B;IAAC;IAC9H,MAAM,eAAe,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC;IACrD,IAAI,CAAC,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC;QACtC,MAAM,QAAQ,QAAQ;QACtB,UAAU;IACX,IAAI,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS,mOAAgB,CAAC,gBAAgB;IAAC;IACnF,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,QAAQ,EAAE,EAAE;QAAE,UAAU;IAAa;IACrF,IAAI,QAAQ;IACZ,IAAI,uBAAuB;QAC1B,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,cAAc,CAAC,QAAQ,IAAI,CAAC,EAAE;QAChE,MAAM,aAAa,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,QAAQ,IAAI,CAAC,EAAE;QAClF,IAAI,CAAC,YAAY,MAAM,IAAI,2JAAQ,CAAC,yBAAyB;YAAE,SAAS,mOAAgB,CAAC,qBAAqB;QAAC;QAC/G,MAAM,IAAA,mKAAgB,EAAC,KAAK;YAC3B,SAAS;YACT,MAAM,QAAQ,IAAI;QACnB;QACA,QAAQ,WAAW,KAAK;IACzB;IACA,OAAO,IAAI,IAAI,CAAC;QACf;QACA,MAAM;YACL,IAAI,QAAQ,IAAI,CAAC,EAAE;YACnB,OAAO,QAAQ,IAAI,CAAC,KAAK;YACzB,MAAM,QAAQ,IAAI,CAAC,IAAI;YACvB,OAAO,QAAQ,IAAI,CAAC,KAAK;YACzB,eAAe,QAAQ,IAAI,CAAC,aAAa;YACzC,WAAW,QAAQ,IAAI,CAAC,SAAS;YACjC,WAAW,QAAQ,IAAI,CAAC,SAAS;QAClC;IACD;AACD;AACA,MAAM,cAAc,IAAA,uLAAkB,EAAC,iBAAiB;IACvD,QAAQ;IACR,MAAM,yJAAQ,CAAC;QAAE,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAsC;IAAG;IACtG,UAAU;QAAE,aAAa;IAAK;IAC9B,KAAK;QAAC,oKAA0B;KAAC;AAClC,GAAG,OAAO;IACT,MAAM,EAAE,WAAW,EAAE,GAAG,IAAI,IAAI;IAChC,MAAM,UAAU,IAAI,OAAO,CAAC,OAAO;IACnC,MAAM,oBAAoB,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB;IACvE,IAAI,YAAY,MAAM,GAAG,mBAAmB;QAC3C,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS,mOAAgB,CAAC,kBAAkB;QAAC;IAClF;IACA,MAAM,oBAAoB,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB;IACvE,IAAI,YAAY,MAAM,GAAG,mBAAmB;QAC3C,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS,mOAAgB,CAAC,iBAAiB;QAAC;IACjF;IACA,MAAM,UAAU,CAAC,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,QAAQ,IAAI,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,YAAc,UAAU,UAAU,KAAK,gBAAgB,UAAU,QAAQ;IACjK,MAAM,eAAe,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC;IACrD,IAAI,CAAC,SAAS;QACb,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,WAAW,CAAC;YAC7C,QAAQ,QAAQ,IAAI,CAAC,EAAE;YACvB,YAAY;YACZ,WAAW,QAAQ,IAAI,CAAC,EAAE;YAC1B,UAAU;QACX;QACA,OAAO,IAAI,IAAI,CAAC;YAAE,QAAQ;QAAK;IAChC;IACA,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAA8B;AAC5E;AACA,MAAM,aAAa,IAAA,uLAAkB,EAAC,gBAAgB;IACrD,QAAQ;IACR,KAAK;QAAC,oKAA0B;KAAC;IACjC,MAAM,yJAAQ,CAAC;QACd,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA4D,GAAG,QAAQ;QACnH,UAAU,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA0D,GAAG,QAAQ;QAC9G,OAAO,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA2C,GAAG,QAAQ;IAC7F;IACA,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,aAAa;YACb,aAAa;gBAAE,SAAS;oBAAE,oBAAoB;wBAAE,QAAQ;4BACvD,MAAM;4BACN,YAAY;gCACX,aAAa;oCACZ,MAAM;oCACN,aAAa;gCACd;gCACA,UAAU;oCACT,MAAM;oCACN,aAAa;gCACd;gCACA,OAAO;oCACN,MAAM;oCACN,aAAa;gCACd;4BACD;wBACD;oBAAE;gBAAE;YAAE;YACN,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,SAAS;wCACR,MAAM;wCACN,aAAa;oCACd;oCACA,SAAS;wCACR,MAAM;wCACN,MAAM;4CAAC;4CAAgB;yCAA0B;wCACjD,aAAa;oCACd;gCACD;gCACA,UAAU;oCAAC;oCAAW;iCAAU;4BACjC;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,YAAY,SAAS;QACnD,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC;IACpB;IACA,MAAM,UAAU,IAAI,OAAO,CAAC,OAAO;IACnC,IAAI,IAAI,IAAI,CAAC,QAAQ,EAAE;QACtB,MAAM,UAAU,CAAC,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,QAAQ,IAAI,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,YAAc,UAAU,UAAU,KAAK,gBAAgB,UAAU,QAAQ;QACjK,IAAI,CAAC,WAAW,CAAC,QAAQ,QAAQ,EAAE,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS,mOAAgB,CAAC,4BAA4B;QAAC;QAC9H,IAAI,CAAC,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC;YACtC,MAAM,QAAQ,QAAQ;YACtB,UAAU,IAAI,IAAI,CAAC,QAAQ;QAC5B,IAAI,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS,mOAAgB,CAAC,gBAAgB;QAAC;IACpF;IACA,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE;QACnB,MAAM,mBAAmB;YACxB,GAAG,GAAG;YACN,OAAO;gBAAE,OAAO,IAAI,IAAI,CAAC,KAAK;YAAC;QAChC;QACA,OAAO,IAAI,IAAI,CAAC;YACf,SAAS;YACT,SAAS;QACV;IACD;IACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,+BAA+B;QACvE,MAAM,QAAQ,IAAA,kKAAoB,EAAC,IAAI,OAAO;QAC9C,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,uBAAuB,CAAC;YACzD,OAAO,QAAQ,IAAI,CAAC,EAAE;YACtB,YAAY,CAAC,eAAe,EAAE,OAAO;YACrC,WAAW,IAAI,KAAK,KAAK,GAAG,KAAK,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,wBAAwB,OAAO,EAAE,IAAI;QAC7G;QACA,MAAM,MAAM,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,4BAA4B,EAAE,MAAM,aAAa,EAAE,IAAI,IAAI,CAAC,WAAW,IAAI,KAAK;QACnH,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,6BAA6B,CAAC;YACvE,MAAM,QAAQ,IAAI;YAClB;YACA;QACD,GAAG,IAAI,OAAO;QACd,OAAO,IAAI,IAAI,CAAC;YACf,SAAS;YACT,SAAS;QACV;IACD;IACA,IAAI,CAAC,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,OAAO,CAAC,aAAa,CAAC,QAAQ,KAAK,GAAG;QACnE,MAAM,aAAa,IAAI,KAAK,QAAQ,OAAO,CAAC,SAAS,EAAE,OAAO;QAC9D,MAAM,WAAW,IAAI,OAAO,CAAC,aAAa,CAAC,QAAQ,GAAG;QACtD,IAAI,KAAK,GAAG,KAAK,aAAa,WAAW,KAAK,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS,mOAAgB,CAAC,eAAe;QAAC;IAC7H;IACA,MAAM,eAAe,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE;IAC1D,IAAI,cAAc,MAAM,aAAa,QAAQ,IAAI,EAAE,IAAI,OAAO;IAC9D,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,UAAU,CAAC,QAAQ,IAAI,CAAC,EAAE;IAC5D,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,cAAc,CAAC,QAAQ,IAAI,CAAC,EAAE;IAChE,IAAA,mKAAmB,EAAC;IACpB,MAAM,cAAc,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE;IACzD,IAAI,aAAa,MAAM,YAAY,QAAQ,IAAI,EAAE,IAAI,OAAO;IAC5D,OAAO,IAAI,IAAI,CAAC;QACf,SAAS;QACT,SAAS;IACV;AACD;AACA,MAAM,qBAAqB,IAAA,uLAAkB,EAAC,yBAAyB;IACtE,QAAQ;IACR,OAAO,yJAAQ,CAAC;QACf,OAAO,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAA2C;QACjF,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAwC,GAAG,QAAQ;IAChG;IACA,KAAK;QAAC,YAAY,CAAC,MAAQ,IAAI,KAAK,CAAC,WAAW;KAAE;IAClD,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,WAAW;gBAAE,OAAO;oBACnB,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,SAAS;wCACR,MAAM;wCACN,aAAa;oCACd;oCACA,SAAS;wCACR,MAAM;wCACN,MAAM;4CAAC;yCAAe;wCACtB,aAAa;oCACd;gCACD;gCACA,UAAU;oCAAC;oCAAW;iCAAU;4BACjC;wBAAE;oBAAE;gBACL;YAAE;QACH;IAAE;AACH,GAAG,OAAO;IACT,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,YAAY,SAAS;QACnD,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC;IACpB;IACA,MAAM,UAAU,MAAM,IAAA,oKAAiB,EAAC;IACxC,IAAI,CAAC,SAAS,MAAM,IAAI,2JAAQ,CAAC,aAAa;QAAE,SAAS,mOAAgB,CAAC,uBAAuB;IAAC;IAClG,MAAM,QAAQ,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,qBAAqB,CAAC,CAAC,eAAe,EAAE,IAAI,KAAK,CAAC,KAAK,EAAE;IACzG,IAAI,CAAC,SAAS,MAAM,SAAS,GAAG,aAAa,GAAG,IAAI,QAAQ,MAAM,IAAI,2JAAQ,CAAC,aAAa;QAAE,SAAS,mOAAgB,CAAC,aAAa;IAAC;IACtI,IAAI,MAAM,KAAK,KAAK,QAAQ,IAAI,CAAC,EAAE,EAAE,MAAM,IAAI,2JAAQ,CAAC,aAAa;QAAE,SAAS,mOAAgB,CAAC,aAAa;IAAC;IAC/G,MAAM,eAAe,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE;IAC1D,IAAI,cAAc,MAAM,aAAa,QAAQ,IAAI,EAAE,IAAI,OAAO;IAC9D,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,UAAU,CAAC,QAAQ,IAAI,CAAC,EAAE;IAC5D,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,cAAc,CAAC,QAAQ,IAAI,CAAC,EAAE;IAChE,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,cAAc,CAAC,QAAQ,IAAI,CAAC,EAAE;IAChE,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,uBAAuB,CAAC,MAAM,EAAE;IAClE,IAAA,mKAAmB,EAAC;IACpB,MAAM,cAAc,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE;IACzD,IAAI,aAAa,MAAM,YAAY,QAAQ,IAAI,EAAE,IAAI,OAAO;IAC5D,IAAI,IAAI,KAAK,CAAC,WAAW,EAAE,MAAM,IAAI,QAAQ,CAAC,IAAI,KAAK,CAAC,WAAW,IAAI;IACvE,OAAO,IAAI,IAAI,CAAC;QACf,SAAS;QACT,SAAS;IACV;AACD;AACA,MAAM,cAAc,IAAA,uLAAkB,EAAC,iBAAiB;IACvD,QAAQ;IACR,MAAM,yJAAQ,CAAC;QACd,UAAU,wJAAO,GAAG,IAAI,CAAC;YAAE,aAAa;QAA6D;QACrG,aAAa,yJAAQ,GAAG,IAAI,CAAC;YAAE,aAAa;QAAkD,GAAG,QAAQ;IAC1G;IACA,KAAK;QAAC,oKAA0B;KAAC;IACjC,UAAU;QAAE,SAAS;YACpB,aAAa;YACb,WAAW;gBACV,OAAO;oBACN,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCACX,MAAM;wCACL,MAAM;wCACN,MAAM;oCACP;oCACA,QAAQ;wCACP,MAAM;wCACN,aAAa;oCACd;oCACA,SAAS;wCACR,MAAM;wCACN,MAAM;4CAAC;4CAAiB;yCAA0B;wCAClD,aAAa;wCACb,UAAU;oCACX;gCACD;gCACA,UAAU;oCAAC;iCAAS;4BACrB;wBAAE;oBAAE;gBACL;gBACA,OAAO;oBACN,aAAa;oBACb,SAAS;wBAAE,oBAAoB;4BAAE,QAAQ;gCACxC,MAAM;gCACN,YAAY;oCAAE,SAAS;wCAAE,MAAM;oCAAS;gCAAE;4BAC3C;wBAAE;oBAAE;gBACL;YACD;QACD;IAAE;AACH,GAAG,OAAO;IACT,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,aAAa,SAAS;QACpD,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS;QAA2B;IACzE;IACA,MAAM,WAAW,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW;IAC9C,IAAI,aAAa,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE;QAChD,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS;QAAoB;IAClE;IACA,IAAI,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,CAAC,WAAW;QAChE,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,wBAAwB;YAAE,SAAS,mOAAgB,CAAC,qCAAqC;QAAC;IAC9G;IACA;;CAEA,GACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,KAAK,QAAQ,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,8BAA8B,EAAE;QAC3H,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,iBAAiB,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE;YAAE,OAAO;QAAS;QACtG,MAAM,IAAA,mKAAgB,EAAC,KAAK;YAC3B,SAAS,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO;YACpC,MAAM;gBACL,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI;gBAC3B,OAAO;YACR;QACD;QACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,uBAAuB;YACjE,MAAM,UAAU,MAAM,6BAA6B,IAAI,OAAO,CAAC,MAAM,EAAE,UAAU,KAAK,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE;YAChI,MAAM,QAAQ,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,oBAAoB,EAAE,QAAQ,aAAa,EAAE,IAAI,IAAI,CAAC,WAAW,IAAI,KAAK;YAC/G,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,qBAAqB,CAAC;gBACjE,MAAM;oBACL,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI;oBAC3B,OAAO;gBACR;gBACA,KAAK;gBACL,OAAO;YACR,GAAG,IAAI,OAAO;QACf;QACA,OAAO,IAAI,IAAI,CAAC;YAAE,QAAQ;QAAK;IAChC;IACA,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,2BAA2B,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,2BAA2B,GAAG;QACrL,MAAM,UAAU,MAAM,6BAA6B,IAAI,OAAO,CAAC,MAAM,EAAE,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,WAAW;YAAE,aAAa;QAA4B;QAC9M,MAAM,QAAQ,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,oBAAoB,EAAE,QAAQ,aAAa,EAAE,IAAI,IAAI,CAAC,WAAW,IAAI,KAAK;QAC/G,MAAM,SAAS,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,2BAA2B,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,2BAA2B;QACnJ,IAAI,QAAQ,MAAM,OAAO;YACxB,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI;YAC9B;YACA,KAAK;YACL,OAAO;QACR,GAAG,IAAI,OAAO;QACd,OAAO,IAAI,IAAI,CAAC;YAAE,QAAQ;QAAK;IAChC;IACA,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,uBAAuB;QAClE,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QACzB,MAAM,IAAI,2JAAQ,CAAC,eAAe;YAAE,SAAS;QAAmC;IACjF;IACA,MAAM,QAAQ,MAAM,6BAA6B,IAAI,OAAO,CAAC,MAAM,EAAE,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,WAAW;QAAE,aAAa;IAA4B;IAC5M,MAAM,MAAM,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,oBAAoB,EAAE,MAAM,aAAa,EAAE,IAAI,IAAI,CAAC,WAAW,IAAI,KAAK;IAC3G,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,qBAAqB,CAAC;QACjE,MAAM;YACL,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI;YAC3B,OAAO;QACR;QACA;QACA;IACD,GAAG,IAAI,OAAO;IACd,OAAO,IAAI,IAAI,CAAC;QAAE,QAAQ;IAAK;AAChC;AAEA,YAAY;AACZ,sCAAsC;AACtC,MAAM,oBAAoB,IAAA,mJAAU,EAAC,CAAC,KAAK,KAAK;IAC/C,IAAI,MAAM,OAAO,CAAC,GAAG,CAAC,IAAI,KAAK,MAAM,OAAO,CAAC,QAAQ;QACpD,GAAG,CAAC,IAAI,GAAG;QACX,OAAO;IACR;AACD;AACA,SAAS,gBAAgB,SAAS,EAAE,GAAG;IACtC,MAAM,MAAM,CAAC;IACb,KAAK,MAAM,CAAC,KAAK,SAAS,IAAI,OAAO,OAAO,CAAC,WAAY;QACxD,GAAG,CAAC,IAAI,GAAG,OAAO;YACjB,MAAM,MAAM;gBACX,MAAM,cAAc,MAAM;gBAC1B,IAAI,kBAAkB;oBACrB,GAAG,OAAO;oBACV,SAAS;wBACR,GAAG,WAAW;wBACd,UAAU,KAAK;wBACf,iBAAiB,KAAK;wBACtB,SAAS;oBACV;oBACA,MAAM,SAAS,IAAI;oBACnB,SAAS,SAAS,UAAU,IAAI,QAAQ,SAAS,WAAW,KAAK;gBAClE;gBACA,OAAO,IAAA,iPAAsB,EAAC,iBAAiB;oBAC9C,MAAM,EAAE,WAAW,EAAE,UAAU,EAAE,GAAG,SAAS;oBAC7C,MAAM,SAAS,MAAM,eAAe,iBAAiB;oBACrD;;;KAGA,GACA,IAAI,aAAa,UAAU,OAAO,OAAO,IAAI,OAAO,OAAO,OAAO,KAAK,UAAU;wBAChF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,GAAG,OAAO,OAAO;wBAC3C;;;;MAIA,GACA,IAAI,SAAS,QAAQ,OAAO,CAAC,CAAC,OAAO;4BACpC,gBAAgB,OAAO,CAAC,GAAG,CAAC,OAAO;wBACpC;wBACA,kBAAkB,kBAAkB,MAAM;oBAC3C,OAAO,IAAI,QAAQ,OAAO,SAAS,aAAa,IAAA,6JAAU,EAAC,QAAQ;wBAAE,SAAS,SAAS;oBAAQ,KAAK,SAAS,gBAAgB;wBAC5H,SAAS,SAAS;wBAClB,UAAU;oBACX,IAAI;oBACJ,gBAAgB,UAAU,GAAG;oBAC7B,gBAAgB,aAAa,GAAG;oBAChC,gBAAgB,YAAY,GAAG;oBAC/B,MAAM,SAAS,MAAM,IAAA,iPAAsB,EAAC,iBAAiB,IAAM,SAAS,kBAAkB,KAAK,CAAC,CAAC;wBACpG,IAAI,aAAa,2JAAQ,EAC9B;;;MAGK,GACA,OAAO;4BACN,UAAU;4BACV,QAAQ,EAAE,UAAU;4BACpB,SAAS,EAAE,OAAO,GAAG,IAAI,QAAQ,EAAE,OAAO,IAAI;wBAC/C;wBACA,MAAM;oBACP;oBACA,IAAI,UAAU,kBAAkB,UAAU,OAAO;oBACjD,gBAAgB,OAAO,CAAC,QAAQ,GAAG,OAAO,QAAQ;oBAClD,gBAAgB,OAAO,CAAC,eAAe,GAAG,OAAO,OAAO;oBACxD,MAAM,QAAQ,MAAM,cAAc,iBAAiB;oBACnD,IAAI,MAAM,QAAQ,EAAE,OAAO,QAAQ,GAAG,MAAM,QAAQ;oBACpD,IAAI,OAAO,QAAQ,YAAY,2JAAQ,IAAI,IAAA,iOAAgB,EAAC,YAAY,MAAM,CAAC,KAAK,EAAE,UAAU,OAAO,QAAQ,CAAC,KAAK,GAAG,OAAO,QAAQ,CAAC,UAAU;oBAClJ,IAAI,OAAO,QAAQ,YAAY,2JAAQ,IAAI,CAAC,SAAS,YAAY,MAAM,OAAO,QAAQ;oBACtF,OAAO,SAAS,aAAa,IAAA,6JAAU,EAAC,OAAO,QAAQ,EAAE;wBACxD,SAAS,OAAO,OAAO;wBACvB,QAAQ,OAAO,MAAM;oBACtB,KAAK,SAAS,gBAAgB,SAAS,eAAe;wBACrD,SAAS,OAAO,OAAO;wBACvB,UAAU,OAAO,QAAQ;wBACzB,QAAQ,OAAO,MAAM;oBACtB,IAAI;wBACH,SAAS,OAAO,OAAO;wBACvB,UAAU,OAAO,QAAQ;oBAC1B,IAAI,SAAS,eAAe;wBAC3B,UAAU,OAAO,QAAQ;wBACzB,QAAQ,OAAO,MAAM;oBACtB,IAAI,OAAO,QAAQ;gBACpB;YACD;YACA,IAAI,MAAM,IAAA,mOAAe,KAAI,OAAO;iBAC/B,OAAO,IAAA,2OAAmB,EAAC,aAAa,GAAG,IAAI,WAAW;QAChE;QACA,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG,SAAS,IAAI;QAC7B,GAAG,CAAC,IAAI,CAAC,OAAO,GAAG,SAAS,OAAO;IACpC;IACA,OAAO;AACR;AACA,eAAe,eAAe,OAAO,EAAE,KAAK;IAC3C,IAAI,kBAAkB,CAAC;IACvB,KAAK,MAAM,QAAQ,MAAO,IAAI,KAAK,OAAO,CAAC,UAAU;QACpD,MAAM,SAAS,MAAM,KAAK,OAAO,CAAC;YACjC,GAAG,OAAO;YACV,eAAe;QAChB,GAAG,KAAK,CAAC,CAAC;YACT,IAAI,aAAa,2JAAQ,IAAI,IAAA,iOAAgB,EAAC,QAAQ,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,UAAU,EAAE,KAAK,GAAG,EAAE,UAAU;YAC5G,MAAM;QACP;QACA,IAAI,UAAU,OAAO,WAAW,UAAU;YACzC,IAAI,aAAa,UAAU,OAAO,OAAO,OAAO,KAAK,UAAU;gBAC9D,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,GAAG,OAAO,OAAO;gBAC3C,IAAI,mBAAmB,SAAS,IAAI,gBAAgB,OAAO,EAAE,QAAQ,OAAO,CAAC,CAAC,OAAO;oBACpF,gBAAgB,OAAO,EAAE,IAAI,KAAK;gBACnC;qBACK,gBAAgB,OAAO,GAAG;gBAC/B,kBAAkB,kBAAkB,MAAM;gBAC1C;YACD;YACA,OAAO;QACR;IACD;IACA,OAAO;QAAE,SAAS;IAAgB;AACnC;AACA,eAAe,cAAc,OAAO,EAAE,KAAK;IAC1C,KAAK,MAAM,QAAQ,MAAO,IAAI,KAAK,OAAO,CAAC,UAAU;QACpD,MAAM,SAAS,MAAM,KAAK,OAAO,CAAC,SAAS,KAAK,CAAC,CAAC;YACjD,IAAI,aAAa,2JAAQ,EAAE;gBAC1B,IAAI,IAAA,iOAAgB,EAAC,QAAQ,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,UAAU,EAAE,KAAK,GAAG,EAAE,UAAU;gBACnF,OAAO;oBACN,UAAU;oBACV,SAAS,EAAE,OAAO,GAAG,IAAI,QAAQ,EAAE,OAAO,IAAI;gBAC/C;YACD;YACA,MAAM;QACP;QACA,IAAI,OAAO,OAAO,EAAE,OAAO,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO;YAClD,IAAI,CAAC,QAAQ,OAAO,CAAC,eAAe,EAAE,QAAQ,OAAO,CAAC,eAAe,GAAG,IAAI,QAAQ;gBAAE,CAAC,IAAI,EAAE;YAAM;iBAC9F,IAAI,IAAI,WAAW,OAAO,cAAc,QAAQ,OAAO,CAAC,eAAe,CAAC,MAAM,CAAC,KAAK;iBACpF,QAAQ,OAAO,CAAC,eAAe,CAAC,GAAG,CAAC,KAAK;QAC/C;QACA,IAAI,OAAO,QAAQ,EAAE,QAAQ,OAAO,CAAC,QAAQ,GAAG,OAAO,QAAQ;IAChE;IACA,OAAO;QACN,UAAU,QAAQ,OAAO,CAAC,QAAQ;QAClC,SAAS,QAAQ,OAAO,CAAC,eAAe;IACzC;AACD;AACA,SAAS,SAAS,WAAW;IAC5B,MAAM,UAAU,YAAY,OAAO,CAAC,OAAO,IAAI,EAAE;IACjD,MAAM,cAAc,EAAE;IACtB,MAAM,aAAa,EAAE;IACrB,IAAI,YAAY,OAAO,CAAC,KAAK,EAAE,QAAQ,YAAY,IAAI,CAAC;QACvD,SAAS,IAAM;QACf,SAAS,YAAY,OAAO,CAAC,KAAK,CAAC,MAAM;IAC1C;IACA,IAAI,YAAY,OAAO,CAAC,KAAK,EAAE,OAAO,WAAW,IAAI,CAAC;QACrD,SAAS,IAAM;QACf,SAAS,YAAY,OAAO,CAAC,KAAK,CAAC,KAAK;IACzC;IACA,MAAM,oBAAoB,QAAQ,GAAG,CAAC,CAAC;QACtC,IAAI,OAAO,KAAK,EAAE,QAAQ,OAAO,OAAO,KAAK,CAAC,MAAM;IACrD,GAAG,MAAM,CAAC,CAAC,SAAW,WAAW,KAAK,GAAG,IAAI;IAC7C,MAAM,mBAAmB,QAAQ,GAAG,CAAC,CAAC;QACrC,IAAI,OAAO,KAAK,EAAE,OAAO,OAAO,OAAO,KAAK,CAAC,KAAK;IACnD,GAAG,MAAM,CAAC,CAAC,SAAW,WAAW,KAAK,GAAG,IAAI;IAC7C;;CAEA,GACA,IAAI,kBAAkB,MAAM,EAAE,YAAY,IAAI,IAAI;IAClD,IAAI,iBAAiB,MAAM,EAAE,WAAW,IAAI,IAAI;IAChD,OAAO;QACN;QACA;IACD;AACD;AAEA,YAAY;AACZ,0BAA0B;AAC1B,SAAS,uBAAuB,OAAO,EAAE,QAAQ;IAChD,MAAM,mBAAmB,aAAa,GAAG,IAAI;IAC7C,QAAQ,OAAO,EAAE,QAAQ,CAAC;QACzB,IAAI,OAAO,SAAS,EAAE;YACrB,KAAK,MAAM,CAAC,KAAK,SAAS,IAAI,OAAO,OAAO,CAAC,OAAO,SAAS,EAAG,IAAI,YAAY,UAAU,UAAU;gBACnG,MAAM,OAAO,SAAS,IAAI;gBAC1B,IAAI,UAAU,EAAE;gBAChB,IAAI,SAAS,OAAO,IAAI,YAAY,SAAS,OAAO,EAAE;oBACrD,IAAI,MAAM,OAAO,CAAC,SAAS,OAAO,CAAC,MAAM,GAAG,UAAU,SAAS,OAAO,CAAC,MAAM;yBACxE,IAAI,OAAO,SAAS,OAAO,CAAC,MAAM,KAAK,UAAU,UAAU;wBAAC,SAAS,OAAO,CAAC,MAAM;qBAAC;gBAC1F;gBACA,IAAI,QAAQ,MAAM,KAAK,GAAG,UAAU;oBAAC;iBAAI;gBACzC,IAAI,CAAC,iBAAiB,GAAG,CAAC,OAAO,iBAAiB,GAAG,CAAC,MAAM,EAAE;gBAC9D,iBAAiB,GAAG,CAAC,MAAM,IAAI,CAAC;oBAC/B,UAAU,OAAO,EAAE;oBACnB,aAAa;oBACb;gBACD;YACD;QACD;IACD;IACA,MAAM,YAAY,EAAE;IACpB,KAAK,MAAM,CAAC,MAAM,QAAQ,IAAI,iBAAiB,OAAO,GAAI,IAAI,QAAQ,MAAM,GAAG,GAAG;QACjF,MAAM,YAAY,aAAa,GAAG,IAAI;QACtC,IAAI,cAAc;QAClB,KAAK,MAAM,SAAS,QAAS,KAAK,MAAM,UAAU,MAAM,OAAO,CAAE;YAChE,IAAI,CAAC,UAAU,GAAG,CAAC,SAAS,UAAU,GAAG,CAAC,QAAQ,EAAE;YACpD,UAAU,GAAG,CAAC,QAAQ,IAAI,CAAC,MAAM,QAAQ;YACzC,IAAI,UAAU,GAAG,CAAC,QAAQ,MAAM,GAAG,GAAG,cAAc;YACpD,IAAI,WAAW,OAAO,QAAQ,MAAM,GAAG,GAAG,cAAc;iBACnD,IAAI,WAAW,OAAO,UAAU,GAAG,CAAC,MAAM,cAAc;QAC9D;QACA,IAAI,aAAa;YAChB,MAAM,gBAAgB;mBAAI,IAAI,IAAI,QAAQ,GAAG,CAAC,CAAC,IAAM,EAAE,QAAQ;aAAG;YAClE,MAAM,qBAAqB,EAAE;YAC7B,KAAK,MAAM,CAAC,QAAQ,QAAQ,IAAI,UAAU,OAAO,GAAI,IAAI,QAAQ,MAAM,GAAG,KAAK,WAAW,OAAO,QAAQ,MAAM,GAAG,KAAK,WAAW,OAAO,UAAU,GAAG,CAAC,MAAM,mBAAmB,IAAI,CAAC;YACrL,UAAU,IAAI,CAAC;gBACd;gBACA,SAAS;gBACT;YACD;QACD;IACD;IACA,IAAI,UAAU,MAAM,GAAG,GAAG;QACzB,MAAM,mBAAmB,UAAU,GAAG,CAAC,CAAC,WAAa,CAAC,KAAK,EAAE,SAAS,IAAI,CAAC,GAAG,EAAE,SAAS,kBAAkB,CAAC,IAAI,CAAC,MAAM,mBAAmB,EAAE,SAAS,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC;QAChL,SAAS,KAAK,CAAC,CAAC;AAClB,EAAE,iBAAiB;;;;;;AAMnB,CAAC;IACA;AACD;AACA,SAAS,aAAa,GAAG,EAAE,OAAO;IACjC,MAAM,kBAAkB,QAAQ,OAAO,EAAE,OAAO,CAAC,KAAK;QACrD,OAAO;YACN,GAAG,GAAG;YACN,GAAG,OAAO,SAAS;QACpB;IACD,GAAG,CAAC,MAAM,CAAC;IACX,MAAM,cAAc,QAAQ,OAAO,EAAE,IAAI,CAAC,SAAW,OAAO,WAAW,EAAE,IAAI,CAAC;YAC7E,MAAM,aAAc,OAAO;gBAC1B,MAAM,cAAc,MAAM;gBAC1B,OAAO,EAAE,UAAU,CAAC;oBACnB,GAAG,OAAO;oBACV,SAAS;wBACR,GAAG,WAAW;wBACd,GAAG,QAAQ,OAAO;oBACnB;gBACD;YACD;YACA,WAAW,OAAO,GAAG,EAAE,UAAU,CAAC,OAAO;YACzC,OAAO;gBACN,MAAM,EAAE,IAAI;gBACZ;YACD;QACD,IAAI,OAAO,CAAC,SAAW,WAAW,KAAK,GAAG,UAAU,EAAE;IACtD,OAAO;QACN,KAAK,gBAAgB;YACpB,cAAc;YACd;YACA,YAAY,IAAA,oKAAU;YACtB;YACA,aAAa;YACb,aAAa;YACb;YACA;YACA;YACA;YACA;YACA;YACA,YAAY;YACZ;YACA;YACA;YACA,cAAc,IAAA,oKAAY;YAC1B,eAAA,oKAAa;YACb,gBAAA,oKAAc;YACd,qBAAA,oKAAmB;YACnB;YACA;YACA;YACA;YACA;YACA;YACA;YACA,GAAG,eAAe;YAClB;YACA;QACD,GAAG;QACH;IACD;AACD;AACA,MAAM,SAAS,CAAC,KAAK;IACpB,MAAM,EAAE,GAAG,EAAE,WAAW,EAAE,GAAG,aAAa,KAAK;IAC/C,MAAM,WAAW,IAAI,IAAI,IAAI,OAAO,EAAE,QAAQ;IAC9C,OAAO,IAAA,+JAAY,EAAC,KAAK;QACxB,eAAe;QACf,SAAS;YAAE,UAAU;QAAK;QAC1B;QACA,kBAAkB;YAAC;gBAClB,MAAM;gBACN,YAAY;YACb;eAAM;SAAY;QAClB,mBAAmB;YAAC;SAAmB;QACvC,MAAM,WAAU,GAAG;YAClB,MAAM,gBAAgB,IAAI,OAAO,CAAC,aAAa,IAAI,EAAE;YACrD,MAAM,OAAO,IAAI,IAAI,IAAI,GAAG,EAAE,QAAQ,CAAC,OAAO,CAAC,UAAU;YACzD,IAAI,cAAc,QAAQ,CAAC,OAAO,OAAO,IAAI,SAAS,aAAa;gBAAE,QAAQ;YAAI;YACjF,KAAK,MAAM,UAAU,IAAI,OAAO,CAAC,OAAO,IAAI,EAAE,CAAE,IAAI,OAAO,SAAS,EAAE;gBACrE,MAAM,WAAW,MAAM,OAAO,SAAS,CAAC,KAAK;gBAC7C,IAAI,YAAY,cAAc,UAAU,OAAO,SAAS,QAAQ;gBAChE,IAAI,YAAY,aAAa,UAAU;oBACtC,MAAM,sBAAsB,MAAM,mBAAmB,SAAS,OAAO,EAAE;oBACvE,IAAI,qBAAqB,OAAO;oBAChC,OAAO,SAAS,OAAO;gBACxB;YACD;YACA,OAAO,mBAAmB,KAAK;QAChC;QACA,MAAM,YAAW,GAAG;YACnB,KAAK,MAAM,UAAU,IAAI,OAAO,CAAC,OAAO,IAAI,EAAE,CAAE,IAAI,OAAO,UAAU,EAAE;gBACtE,MAAM,WAAW,MAAM,OAAO,UAAU,CAAC,KAAK;gBAC9C,IAAI,UAAU,OAAO,SAAS,QAAQ;YACvC;YACA,OAAO;QACR;QACA,SAAQ,CAAC;YACR,IAAI,aAAa,2JAAQ,IAAI,EAAE,MAAM,KAAK,SAAS;YACnD,IAAI,QAAQ,UAAU,EAAE,OAAO,MAAM;YACrC,IAAI,QAAQ,UAAU,EAAE,SAAS;gBAChC,QAAQ,UAAU,CAAC,OAAO,CAAC,GAAG;gBAC9B;YACD;YACA,MAAM,cAAc,QAAQ,MAAM,EAAE;YACpC,MAAM,MAAM,gBAAgB,WAAW,gBAAgB,UAAU,gBAAgB,UAAU,6MAAM,GAAG,KAAK;YACzG,IAAI,QAAQ,MAAM,EAAE,aAAa,MAAM;gBACtC,IAAI,KAAK,OAAO,MAAM,YAAY,aAAa,KAAK,OAAO,EAAE,OAAO,KAAK,UAAU;oBAClF,IAAI,EAAE,OAAO,CAAC,QAAQ,CAAC,gBAAgB,EAAE,OAAO,CAAC,QAAQ,CAAC,aAAa,EAAE,OAAO,CAAC,QAAQ,CAAC,eAAe,EAAE,OAAO,CAAC,QAAQ,CAAC,YAAY,EAAE,OAAO,CAAC,QAAQ,CAAC,mBAAmB;wBAC7K,IAAI,MAAM,EAAE,MAAM,EAAE,OAAO;wBAC3B;oBACD;gBACD;gBACA,IAAI,aAAa,2JAAQ,EAAE;oBAC1B,IAAI,EAAE,MAAM,KAAK,yBAAyB,IAAI,MAAM,CAAC,KAAK,CAAC,EAAE,MAAM,EAAE;oBACrE,KAAK,MAAM,EAAE,OAAO;gBACrB,OAAO,IAAI,MAAM,EAAE,MAAM,KAAK,OAAO,MAAM,YAAY,UAAU,IAAI,EAAE,IAAI,GAAG,IAAI;YACnF;QACD;IACD;AACD","ignoreList":[0]}},
    {"offset": {"line": 7697, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/password-BFQK0cLg.mjs"],"sourcesContent":["import { APIError } from \"better-call\";\n\n//#region src/utils/password.ts\nasync function validatePassword(ctx, data) {\n\tconst credentialAccount = (await ctx.context.internalAdapter.findAccounts(data.userId))?.find((account) => account.providerId === \"credential\");\n\tconst currentPassword = credentialAccount?.password;\n\tif (!credentialAccount || !currentPassword) return false;\n\treturn await ctx.context.password.verify({\n\t\thash: currentPassword,\n\t\tpassword: data.password\n\t});\n}\nasync function checkPassword(userId, c) {\n\tconst credentialAccount = (await c.context.internalAdapter.findAccounts(userId))?.find((account) => account.providerId === \"credential\");\n\tconst currentPassword = credentialAccount?.password;\n\tif (!credentialAccount || !currentPassword || !c.body.password) throw new APIError(\"BAD_REQUEST\", { message: \"No password credential found\" });\n\tif (!await c.context.password.verify({\n\t\thash: currentPassword,\n\t\tpassword: c.body.password\n\t})) throw new APIError(\"BAD_REQUEST\", { message: \"Invalid password\" });\n\treturn true;\n}\n\n//#endregion\nexport { validatePassword as n, checkPassword as t };"],"names":[],"mappings":";;;;;;AAAA;;AAEA,+BAA+B;AAC/B,eAAe,iBAAiB,GAAG,EAAE,IAAI;IACxC,MAAM,oBAAoB,CAAC,MAAM,IAAI,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,KAAK,MAAM,CAAC,GAAG,KAAK,CAAC,UAAY,QAAQ,UAAU,KAAK;IAClI,MAAM,kBAAkB,mBAAmB;IAC3C,IAAI,CAAC,qBAAqB,CAAC,iBAAiB,OAAO;IACnD,OAAO,MAAM,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC;QACxC,MAAM;QACN,UAAU,KAAK,QAAQ;IACxB;AACD;AACA,eAAe,cAAc,MAAM,EAAE,CAAC;IACrC,MAAM,oBAAoB,CAAC,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,OAAO,GAAG,KAAK,CAAC,UAAY,QAAQ,UAAU,KAAK;IAC3H,MAAM,kBAAkB,mBAAmB;IAC3C,IAAI,CAAC,qBAAqB,CAAC,mBAAmB,CAAC,EAAE,IAAI,CAAC,QAAQ,EAAE,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAA+B;IAC5I,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC;QACpC,MAAM;QACN,UAAU,EAAE,IAAI,CAAC,QAAQ;IAC1B,IAAI,MAAM,IAAI,2JAAQ,CAAC,eAAe;QAAE,SAAS;IAAmB;IACpE,OAAO;AACR","ignoreList":[0]}},
    {"offset": {"line": 7734, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/base-CiRMFqet.mjs"],"sourcesContent":["import { a as getAuthTables } from \"./get-model-name-D4DUV7S2.mjs\";\nimport { a as createInternalAdapter } from \"./get-migration-Bf0TuCzm.mjs\";\nimport { t as generateId } from \"./utils-db7gNqd-.mjs\";\nimport { a as verifyPassword, i as hashPassword } from \"./crypto-CFUhAR9W.mjs\";\nimport { r as getOrigin, t as getBaseURL } from \"./url-CB8xCwz-.mjs\";\nimport { a as getEndpoints, n as checkEndpointConflicts, s as router } from \"./api-CkmycQ2x.mjs\";\nimport { i as getCookies, t as createCookieGetter } from \"./cookies-D72PbWdz.mjs\";\nimport { t as checkPassword } from \"./password-BFQK0cLg.mjs\";\nimport { runWithAdapter } from \"@better-auth/core/context\";\nimport { createLogger, env, isProduction, isTest } from \"@better-auth/core/env\";\nimport { BASE_ERROR_CODES, BetterAuthError } from \"@better-auth/core/error\";\nimport { socialProviders } from \"@better-auth/core/social-providers\";\nimport { createTelemetry } from \"@better-auth/telemetry\";\nimport defu$1, { defu } from \"defu\";\n\n//#region src/utils/constants.ts\nconst DEFAULT_SECRET = \"better-auth-secret-12345678901234567890\";\n\n//#endregion\n//#region src/utils/is-promise.ts\nfunction isPromise(obj) {\n\treturn !!obj && (typeof obj === \"object\" || typeof obj === \"function\") && typeof obj.then === \"function\";\n}\n\n//#endregion\n//#region src/context/helpers.ts\nasync function runPluginInit(ctx) {\n\tlet options = ctx.options;\n\tconst plugins = options.plugins || [];\n\tlet context = ctx;\n\tconst dbHooks = [];\n\tfor (const plugin of plugins) if (plugin.init) {\n\t\tlet initPromise = plugin.init(context);\n\t\tlet result;\n\t\tif (isPromise(initPromise)) result = await initPromise;\n\t\telse result = initPromise;\n\t\tif (typeof result === \"object\") {\n\t\t\tif (result.options) {\n\t\t\t\tconst { databaseHooks, ...restOpts } = result.options;\n\t\t\t\tif (databaseHooks) dbHooks.push(databaseHooks);\n\t\t\t\toptions = defu(options, restOpts);\n\t\t\t}\n\t\t\tif (result.context) context = {\n\t\t\t\t...context,\n\t\t\t\t...result.context\n\t\t\t};\n\t\t}\n\t}\n\tdbHooks.push(options.databaseHooks);\n\tcontext.internalAdapter = createInternalAdapter(context.adapter, {\n\t\toptions,\n\t\tlogger: context.logger,\n\t\thooks: dbHooks.filter((u) => u !== void 0),\n\t\tgenerateId: context.generateId\n\t});\n\tcontext.options = options;\n\treturn { context };\n}\nfunction getInternalPlugins(options) {\n\tconst plugins = [];\n\tif (options.advanced?.crossSubDomainCookies?.enabled) {}\n\treturn plugins;\n}\nfunction getTrustedOrigins(options) {\n\tconst baseURL = getBaseURL(options.baseURL, options.basePath);\n\tif (!baseURL) return [];\n\tconst trustedOrigins = [new URL(baseURL).origin];\n\tif (options.trustedOrigins && Array.isArray(options.trustedOrigins)) trustedOrigins.push(...options.trustedOrigins);\n\tconst envTrustedOrigins = env.BETTER_AUTH_TRUSTED_ORIGINS;\n\tif (envTrustedOrigins) trustedOrigins.push(...envTrustedOrigins.split(\",\"));\n\tif (trustedOrigins.filter((x) => !x).length) throw new BetterAuthError(\"A provided trusted origin is invalid, make sure your trusted origins list is properly defined.\");\n\treturn trustedOrigins;\n}\n\n//#endregion\n//#region src/context/create-context.ts\n/**\n* Estimates the entropy of a string in bits.\n* This is a simple approximation that helps detect low-entropy secrets.\n*/\nfunction estimateEntropy(str) {\n\tconst unique = new Set(str).size;\n\tif (unique === 0) return 0;\n\treturn Math.log2(Math.pow(unique, str.length));\n}\n/**\n* Validates that the secret meets minimum security requirements.\n* Throws BetterAuthError if the secret is invalid.\n* Skips validation for DEFAULT_SECRET in test environments only.\n* Only throws for DEFAULT_SECRET in production environment.\n*/\nfunction validateSecret(secret, logger$1) {\n\tconst isDefaultSecret = secret === DEFAULT_SECRET;\n\tif (isTest()) return;\n\tif (isDefaultSecret && isProduction) throw new BetterAuthError(\"You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.\");\n\tif (!secret) throw new BetterAuthError(\"BETTER_AUTH_SECRET is missing. Set it in your environment or pass `secret` to betterAuth({ secret }).\");\n\tif (secret.length < 32) throw new BetterAuthError(`Invalid BETTER_AUTH_SECRET: must be at least 32 characters long for adequate security. Generate one with \\`npx @better-auth/cli secret\\` or \\`openssl rand -base64 32\\`.`);\n\tif (estimateEntropy(secret) < 120) logger$1.warn(\"[better-auth] Warning: your BETTER_AUTH_SECRET appears low-entropy. Use a randomly generated secret for production.\");\n}\nasync function createAuthContext(adapter, options, getDatabaseType) {\n\tif (!options.database) options = defu$1(options, {\n\t\tsession: { cookieCache: {\n\t\t\tenabled: true,\n\t\t\tstrategy: \"jwe\",\n\t\t\trefreshCache: true\n\t\t} },\n\t\taccount: {\n\t\t\tstoreStateStrategy: \"cookie\",\n\t\t\tstoreAccountCookie: true\n\t\t}\n\t});\n\tconst plugins = options.plugins || [];\n\tconst internalPlugins = getInternalPlugins(options);\n\tconst logger$1 = createLogger(options.logger);\n\tconst baseURL = getBaseURL(options.baseURL, options.basePath);\n\tconst secret = options.secret || env.BETTER_AUTH_SECRET || env.AUTH_SECRET || DEFAULT_SECRET;\n\tvalidateSecret(secret, logger$1);\n\toptions = {\n\t\t...options,\n\t\tsecret,\n\t\tbaseURL: baseURL ? new URL(baseURL).origin : \"\",\n\t\tbasePath: options.basePath || \"/api/auth\",\n\t\tplugins: plugins.concat(internalPlugins)\n\t};\n\tcheckEndpointConflicts(options, logger$1);\n\tconst cookies = getCookies(options);\n\tconst tables = getAuthTables(options);\n\tconst providers = Object.entries(options.socialProviders || {}).map(([key, config]) => {\n\t\tif (config == null) return null;\n\t\tif (config.enabled === false) return null;\n\t\tif (!config.clientId) logger$1.warn(`Social provider ${key} is missing clientId or clientSecret`);\n\t\tconst provider = socialProviders[key](config);\n\t\tprovider.disableImplicitSignUp = config.disableImplicitSignUp;\n\t\treturn provider;\n\t}).filter((x) => x !== null);\n\tconst generateIdFunc = ({ model, size }) => {\n\t\tif (typeof options.advanced?.generateId === \"function\") return options.advanced.generateId({\n\t\t\tmodel,\n\t\t\tsize\n\t\t});\n\t\tif (typeof options?.advanced?.database?.generateId === \"function\") return options.advanced.database.generateId({\n\t\t\tmodel,\n\t\t\tsize\n\t\t});\n\t\treturn generateId(size);\n\t};\n\tconst { publish } = await createTelemetry(options, {\n\t\tadapter: adapter.id,\n\t\tdatabase: typeof options.database === \"function\" ? \"adapter\" : getDatabaseType(options.database)\n\t});\n\tconst initOrPromise = runPluginInit({\n\t\tappName: options.appName || \"Better Auth\",\n\t\tsocialProviders: providers,\n\t\toptions,\n\t\toauthConfig: {\n\t\t\tstoreStateStrategy: options.account?.storeStateStrategy || \"database\",\n\t\t\tskipStateCookieCheck: !!options.account?.skipStateCookieCheck\n\t\t},\n\t\ttables,\n\t\ttrustedOrigins: getTrustedOrigins(options),\n\t\tbaseURL: baseURL || \"\",\n\t\tsessionConfig: {\n\t\t\tupdateAge: options.session?.updateAge !== void 0 ? options.session.updateAge : 1440 * 60,\n\t\t\texpiresIn: options.session?.expiresIn || 3600 * 24 * 7,\n\t\t\tfreshAge: options.session?.freshAge === void 0 ? 3600 * 24 : options.session.freshAge,\n\t\t\tcookieRefreshCache: (() => {\n\t\t\t\tconst refreshCache = options.session?.cookieCache?.refreshCache;\n\t\t\t\tconst maxAge = options.session?.cookieCache?.maxAge || 300;\n\t\t\t\tif (refreshCache === false || refreshCache === void 0) return false;\n\t\t\t\tif (refreshCache === true) return {\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tupdateAge: Math.floor(maxAge * .2)\n\t\t\t\t};\n\t\t\t\treturn {\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tupdateAge: refreshCache.updateAge !== void 0 ? refreshCache.updateAge : Math.floor(maxAge * .2)\n\t\t\t\t};\n\t\t\t})()\n\t\t},\n\t\tsecret,\n\t\trateLimit: {\n\t\t\t...options.rateLimit,\n\t\t\tenabled: options.rateLimit?.enabled ?? isProduction,\n\t\t\twindow: options.rateLimit?.window || 10,\n\t\t\tmax: options.rateLimit?.max || 100,\n\t\t\tstorage: options.rateLimit?.storage || (options.secondaryStorage ? \"secondary-storage\" : \"memory\")\n\t\t},\n\t\tauthCookies: cookies,\n\t\tlogger: logger$1,\n\t\tgenerateId: generateIdFunc,\n\t\tsession: null,\n\t\tsecondaryStorage: options.secondaryStorage,\n\t\tpassword: {\n\t\t\thash: options.emailAndPassword?.password?.hash || hashPassword,\n\t\t\tverify: options.emailAndPassword?.password?.verify || verifyPassword,\n\t\t\tconfig: {\n\t\t\t\tminPasswordLength: options.emailAndPassword?.minPasswordLength || 8,\n\t\t\t\tmaxPasswordLength: options.emailAndPassword?.maxPasswordLength || 128\n\t\t\t},\n\t\t\tcheckPassword\n\t\t},\n\t\tsetNewSession(session) {\n\t\t\tthis.newSession = session;\n\t\t},\n\t\tnewSession: null,\n\t\tadapter,\n\t\tinternalAdapter: createInternalAdapter(adapter, {\n\t\t\toptions,\n\t\t\tlogger: logger$1,\n\t\t\thooks: options.databaseHooks ? [options.databaseHooks] : [],\n\t\t\tgenerateId: generateIdFunc\n\t\t}),\n\t\tcreateAuthCookie: createCookieGetter(options),\n\t\tasync runMigrations() {\n\t\t\tthrow new BetterAuthError(\"runMigrations will be set by the specific init implementation\");\n\t\t},\n\t\tpublishTelemetry: publish,\n\t\tskipCSRFCheck: !!options.advanced?.disableCSRFCheck,\n\t\tskipOriginCheck: options.advanced?.disableOriginCheck !== void 0 ? options.advanced.disableOriginCheck : isTest() ? true : false\n\t});\n\tlet context;\n\tif (isPromise(initOrPromise)) ({context} = await initOrPromise);\n\telse ({context} = initOrPromise);\n\treturn context;\n}\n\n//#endregion\n//#region src/auth/base.ts\nconst createBetterAuth = (options, initFn) => {\n\tconst authContext = initFn(options);\n\tconst { api } = getEndpoints(authContext, options);\n\treturn {\n\t\thandler: async (request) => {\n\t\t\tconst ctx = await authContext;\n\t\t\tconst basePath = ctx.options.basePath || \"/api/auth\";\n\t\t\tif (!ctx.options.baseURL) {\n\t\t\t\tconst baseURL = getBaseURL(void 0, basePath, request, void 0, ctx.options.advanced?.trustedProxyHeaders);\n\t\t\t\tif (baseURL) {\n\t\t\t\t\tctx.baseURL = baseURL;\n\t\t\t\t\tctx.options.baseURL = getOrigin(ctx.baseURL) || void 0;\n\t\t\t\t} else throw new BetterAuthError(\"Could not get base URL from request. Please provide a valid base URL.\");\n\t\t\t}\n\t\t\tctx.trustedOrigins = [...options.trustedOrigins ? Array.isArray(options.trustedOrigins) ? options.trustedOrigins : await options.trustedOrigins(request) : [], ctx.options.baseURL];\n\t\t\tconst { handler } = router(ctx, options);\n\t\t\treturn runWithAdapter(ctx.adapter, () => handler(request));\n\t\t},\n\t\tapi,\n\t\toptions,\n\t\t$context: authContext,\n\t\t$ERROR_CODES: {\n\t\t\t...options.plugins?.reduce((acc, plugin) => {\n\t\t\t\tif (plugin.$ERROR_CODES) return {\n\t\t\t\t\t...acc,\n\t\t\t\t\t...plugin.$ERROR_CODES\n\t\t\t\t};\n\t\t\t\treturn acc;\n\t\t\t}, {}),\n\t\t\t...BASE_ERROR_CODES\n\t\t}\n\t};\n};\n\n//#endregion\nexport { createAuthContext as n, createBetterAuth as t };"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 8031, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/auth-DfR8_5w3.mjs"],"sourcesContent":["import { n as getKyselyDatabaseType } from \"./dialect-D9ZUZA4J.mjs\";\nimport { t as getMigrations, u as getAdapter } from \"./get-migration-Bf0TuCzm.mjs\";\nimport { n as createAuthContext, t as createBetterAuth } from \"./base-CiRMFqet.mjs\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\n\n//#region src/context/init.ts\nconst init = async (options) => {\n\tconst adapter = await getAdapter(options);\n\tconst getDatabaseType = (database) => getKyselyDatabaseType(database) || \"unknown\";\n\tconst ctx = await createAuthContext(adapter, options, getDatabaseType);\n\tctx.runMigrations = async function() {\n\t\tif (!options.database || \"updateMany\" in options.database) throw new BetterAuthError(\"Database is not provided or it's an adapter. Migrations are only supported with a database instance.\");\n\t\tconst { runMigrations } = await getMigrations(options);\n\t\tawait runMigrations();\n\t};\n\treturn ctx;\n};\n\n//#endregion\n//#region src/auth/auth.ts\n/**\n* Better Auth initializer for full mode (with Kysely)\n*\n* Check `minimal.ts` for minimal mode (without Kysely)\n*/\nconst betterAuth = (options) => {\n\treturn createBetterAuth(options, init);\n};\n\n//#endregion\nexport { betterAuth as t };"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AAAA;;;;;AAEA,6BAA6B;AAC7B,MAAM,OAAO,OAAO;IACnB,MAAM,UAAU,MAAM,IAAA,4KAAU,EAAC;IACjC,MAAM,kBAAkB,CAAC,WAAa,IAAA,mKAAqB,EAAC,aAAa;IACzE,MAAM,MAAM,MAAM,IAAA,gKAAiB,EAAC,SAAS,SAAS;IACtD,IAAI,aAAa,GAAG;QACnB,IAAI,CAAC,QAAQ,QAAQ,IAAI,gBAAgB,QAAQ,QAAQ,EAAE,MAAM,IAAI,iOAAe,CAAC;QACrF,MAAM,EAAE,aAAa,EAAE,GAAG,MAAM,IAAA,4KAAa,EAAC;QAC9C,MAAM;IACP;IACA,OAAO;AACR;AAEA,YAAY;AACZ,0BAA0B;AAC1B;;;;AAIA,GACA,MAAM,aAAa,CAAC;IACnB,OAAO,IAAA,gKAAgB,EAAC,SAAS;AAClC","ignoreList":[0]}},
    {"offset": {"line": 8070, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 8076, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/index.mjs"],"sourcesContent":["import \"./dialect-D9ZUZA4J.mjs\";\nimport \"./get-model-name-D4DUV7S2.mjs\";\nimport \"./get-migration-Bf0TuCzm.mjs\";\nimport { i as parseState, n as HIDE_METADATA, r as generateState, t as generateId } from \"./utils-db7gNqd-.mjs\";\nimport \"./crypto-CFUhAR9W.mjs\";\nimport { t as capitalizeFirstLetter } from \"./misc-BwNc0MKr.mjs\";\nimport \"./schema-Bb7wzeK_.mjs\";\nimport \"./get-request-ip-D6st-mto.mjs\";\nimport \"./json-CnHxKYpj.mjs\";\nimport \"./url-CB8xCwz-.mjs\";\nimport { t as APIError } from \"./api-CkmycQ2x.mjs\";\nimport \"./cookies-D72PbWdz.mjs\";\nimport \"./session-AaRl3_x-.mjs\";\nimport \"./base-CiRMFqet.mjs\";\nimport \"./password-BFQK0cLg.mjs\";\nimport { t as betterAuth } from \"./auth-DfR8_5w3.mjs\";\nimport \"./types-BOTDmeLz.mjs\";\nimport { getCurrentAdapter } from \"@better-auth/core/context\";\nimport { createTelemetry, getTelemetryAuthConfig } from \"@better-auth/telemetry\";\n\nexport * from \"@better-auth/core\"\n\nexport * from \"@better-auth/core/db\"\n\nexport * from \"@better-auth/core/env\"\n\nexport * from \"@better-auth/core/error\"\n\nexport * from \"@better-auth/core/oauth2\"\n\nexport * from \"@better-auth/core/utils\"\n\nexport { APIError, HIDE_METADATA, betterAuth, capitalizeFirstLetter, createTelemetry, generateId, generateState, getCurrentAdapter, getTelemetryAuthConfig, parseState };"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AAEA;AAEA;AAEA;AAEA;AAEA","ignoreList":[0]}},
    {"offset": {"line": 8143, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/adapter-factory-HF3JB9cT.mjs"],"sourcesContent":["import { a as getAuthTables, i as initGetDefaultModelName, n as initGetFieldName, r as initGetDefaultFieldName, t as initGetModelName } from \"./get-model-name-D4DUV7S2.mjs\";\nimport { t as generateId } from \"./utils-db7gNqd-.mjs\";\nimport { t as safeJSONParse } from \"./json-CnHxKYpj.mjs\";\nimport { TTY_COLORS, getColorDepth, logger } from \"@better-auth/core/env\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\n\n//#region src/adapters/utils.ts\nfunction withApplyDefault(value, field, action) {\n\tif (action === \"update\") {\n\t\tif (value === void 0 && field.onUpdate !== void 0) {\n\t\t\tif (typeof field.onUpdate === \"function\") return field.onUpdate();\n\t\t\treturn field.onUpdate;\n\t\t}\n\t\treturn value;\n\t}\n\tif (action === \"create\") {\n\t\tif (value === void 0 || field.required === true && value === null) {\n\t\t\tif (field.defaultValue !== void 0) {\n\t\t\t\tif (typeof field.defaultValue === \"function\") return field.defaultValue();\n\t\t\t\treturn field.defaultValue;\n\t\t\t}\n\t\t}\n\t}\n\treturn value;\n}\n\n//#endregion\n//#region src/adapters/adapter-factory/get-id-field.ts\nconst initGetIdField = ({ usePlural, schema, disableIdGeneration, options, customIdGenerator, supportsUUIDs }) => {\n\tconst getDefaultModelName = initGetDefaultModelName({\n\t\tusePlural,\n\t\tschema\n\t});\n\tconst idField = ({ customModelName, forceAllowId }) => {\n\t\tconst useNumberId = options.advanced?.database?.useNumberId || options.advanced?.database?.generateId === \"serial\";\n\t\tconst useUUIDs = options.advanced?.database?.generateId === \"uuid\";\n\t\tlet shouldGenerateId = (() => {\n\t\t\tif (disableIdGeneration) return false;\n\t\t\telse if (useNumberId && !forceAllowId) return false;\n\t\t\telse if (useUUIDs) return !supportsUUIDs;\n\t\t\telse return true;\n\t\t})();\n\t\tconst model = getDefaultModelName(customModelName ?? \"id\");\n\t\treturn {\n\t\t\ttype: useNumberId ? \"number\" : \"string\",\n\t\t\trequired: shouldGenerateId ? true : false,\n\t\t\t...shouldGenerateId ? { defaultValue() {\n\t\t\t\tif (disableIdGeneration) return void 0;\n\t\t\t\tlet generateId$1 = options.advanced?.database?.generateId;\n\t\t\t\tif (generateId$1 === false || useNumberId) return void 0;\n\t\t\t\tif (typeof generateId$1 === \"function\") return generateId$1({ model });\n\t\t\t\tif (customIdGenerator) return customIdGenerator({ model });\n\t\t\t\tif (generateId$1 === \"uuid\") return crypto.randomUUID();\n\t\t\t\treturn generateId();\n\t\t\t} } : {},\n\t\t\ttransform: {\n\t\t\t\tinput: (value) => {\n\t\t\t\t\tif (!value) return void 0;\n\t\t\t\t\tif (useNumberId) {\n\t\t\t\t\t\tconst numberValue = Number(value);\n\t\t\t\t\t\tif (isNaN(numberValue)) return;\n\t\t\t\t\t\treturn numberValue;\n\t\t\t\t\t}\n\t\t\t\t\tif (useUUIDs) {\n\t\t\t\t\t\tif (shouldGenerateId && !forceAllowId) return value;\n\t\t\t\t\t\tif (disableIdGeneration) return void 0;\n\t\t\t\t\t\tif (supportsUUIDs) return void 0;\n\t\t\t\t\t\tif (forceAllowId && typeof value === \"string\") if (/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(value)) return value;\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tconst stack = (/* @__PURE__ */ new Error()).stack?.split(\"\\n\").filter((_, i) => i !== 1).join(\"\\n\").replace(\"Error:\", \"\");\n\t\t\t\t\t\t\tlogger.warn(\"[Adapter Factory] - Invalid UUID value for field `id` provided when `forceAllowId` is true. Generating a new UUID.\", stack);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof value !== \"string\" && !supportsUUIDs) return crypto.randomUUID();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t},\n\t\t\t\toutput: (value) => {\n\t\t\t\t\tif (!value) return void 0;\n\t\t\t\t\treturn String(value);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t};\n\treturn idField;\n};\n\n//#endregion\n//#region src/adapters/adapter-factory/get-field-attributes.ts\nconst initGetFieldAttributes = ({ usePlural, schema, options, customIdGenerator, disableIdGeneration }) => {\n\tconst getDefaultModelName = initGetDefaultModelName({\n\t\tusePlural,\n\t\tschema\n\t});\n\tconst getDefaultFieldName = initGetDefaultFieldName({\n\t\tusePlural,\n\t\tschema\n\t});\n\tconst idField = initGetIdField({\n\t\tusePlural,\n\t\tschema,\n\t\toptions,\n\t\tcustomIdGenerator,\n\t\tdisableIdGeneration\n\t});\n\tconst getFieldAttributes = ({ model, field }) => {\n\t\tconst defaultModelName = getDefaultModelName(model);\n\t\tconst defaultFieldName = getDefaultFieldName({\n\t\t\tfield,\n\t\t\tmodel: defaultModelName\n\t\t});\n\t\tconst fields = schema[defaultModelName].fields;\n\t\tfields.id = idField({ customModelName: defaultModelName });\n\t\tconst fieldAttributes = fields[defaultFieldName];\n\t\tif (!fieldAttributes) throw new BetterAuthError(`Field ${field} not found in model ${model}`);\n\t\treturn fieldAttributes;\n\t};\n\treturn getFieldAttributes;\n};\n\n//#endregion\n//#region src/adapters/adapter-factory/index.ts\nlet debugLogs = [];\nlet transactionId = -1;\nconst createAsIsTransaction = (adapter) => (fn) => fn(adapter);\nconst createAdapterFactory = ({ adapter: customAdapter, config: cfg }) => (options) => {\n\tconst uniqueAdapterFactoryInstanceId = Math.random().toString(36).substring(2, 15);\n\tconst config = {\n\t\t...cfg,\n\t\tsupportsBooleans: cfg.supportsBooleans ?? true,\n\t\tsupportsDates: cfg.supportsDates ?? true,\n\t\tsupportsJSON: cfg.supportsJSON ?? false,\n\t\tadapterName: cfg.adapterName ?? cfg.adapterId,\n\t\tsupportsNumericIds: cfg.supportsNumericIds ?? true,\n\t\tsupportsUUIDs: cfg.supportsUUIDs ?? false,\n\t\ttransaction: cfg.transaction ?? false,\n\t\tdisableTransformInput: cfg.disableTransformInput ?? false,\n\t\tdisableTransformOutput: cfg.disableTransformOutput ?? false,\n\t\tdisableTransformJoin: cfg.disableTransformJoin ?? false\n\t};\n\tif ((options.advanced?.database?.useNumberId === true || options.advanced?.database?.generateId === \"serial\") && config.supportsNumericIds === false) throw new BetterAuthError(`[${config.adapterName}] Your database or database adapter does not support numeric ids. Please disable \"useNumberId\" in your config.`);\n\tconst schema = getAuthTables(options);\n\tconst debugLog = (...args) => {\n\t\tif (config.debugLogs === true || typeof config.debugLogs === \"object\") {\n\t\t\tif (typeof config.debugLogs === \"object\" && \"isRunningAdapterTests\" in config.debugLogs) {\n\t\t\t\tif (config.debugLogs.isRunningAdapterTests) {\n\t\t\t\t\targs.shift();\n\t\t\t\t\tdebugLogs.push({\n\t\t\t\t\t\tinstance: uniqueAdapterFactoryInstanceId,\n\t\t\t\t\t\targs\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (typeof config.debugLogs === \"object\" && config.debugLogs.logCondition && !config.debugLogs.logCondition?.()) return;\n\t\t\tif (typeof args[0] === \"object\" && \"method\" in args[0]) {\n\t\t\t\tconst method = args.shift().method;\n\t\t\t\tif (typeof config.debugLogs === \"object\") {\n\t\t\t\t\tif (method === \"create\" && !config.debugLogs.create) return;\n\t\t\t\t\telse if (method === \"update\" && !config.debugLogs.update) return;\n\t\t\t\t\telse if (method === \"updateMany\" && !config.debugLogs.updateMany) return;\n\t\t\t\t\telse if (method === \"findOne\" && !config.debugLogs.findOne) return;\n\t\t\t\t\telse if (method === \"findMany\" && !config.debugLogs.findMany) return;\n\t\t\t\t\telse if (method === \"delete\" && !config.debugLogs.delete) return;\n\t\t\t\t\telse if (method === \"deleteMany\" && !config.debugLogs.deleteMany) return;\n\t\t\t\t\telse if (method === \"count\" && !config.debugLogs.count) return;\n\t\t\t\t}\n\t\t\t\tlogger.info(`[${config.adapterName}]`, ...args);\n\t\t\t} else logger.info(`[${config.adapterName}]`, ...args);\n\t\t}\n\t};\n\tconst getDefaultModelName = initGetDefaultModelName({\n\t\tusePlural: config.usePlural,\n\t\tschema\n\t});\n\tconst getDefaultFieldName = initGetDefaultFieldName({\n\t\tusePlural: config.usePlural,\n\t\tschema\n\t});\n\tconst getModelName = initGetModelName({\n\t\tusePlural: config.usePlural,\n\t\tschema\n\t});\n\tconst getFieldName = initGetFieldName({\n\t\tschema,\n\t\tusePlural: config.usePlural\n\t});\n\tconst idField = initGetIdField({\n\t\tschema,\n\t\toptions,\n\t\tusePlural: config.usePlural,\n\t\tdisableIdGeneration: config.disableIdGeneration,\n\t\tcustomIdGenerator: config.customIdGenerator,\n\t\tsupportsUUIDs: config.supportsUUIDs\n\t});\n\tconst getFieldAttributes = initGetFieldAttributes({\n\t\tschema,\n\t\toptions,\n\t\tusePlural: config.usePlural,\n\t\tdisableIdGeneration: config.disableIdGeneration,\n\t\tcustomIdGenerator: config.customIdGenerator\n\t});\n\tconst transformInput = async (data, defaultModelName, action, forceAllowId) => {\n\t\tconst transformedData = {};\n\t\tconst fields = schema[defaultModelName].fields;\n\t\tconst newMappedKeys = config.mapKeysTransformInput ?? {};\n\t\tconst useNumberId = options.advanced?.database?.useNumberId || options.advanced?.database?.generateId === \"serial\";\n\t\tfields.id = idField({\n\t\t\tcustomModelName: defaultModelName,\n\t\t\tforceAllowId: forceAllowId && \"id\" in data\n\t\t});\n\t\tfor (const field in fields) {\n\t\t\tlet value = data[field];\n\t\t\tconst fieldAttributes = fields[field];\n\t\t\tlet newFieldName = newMappedKeys[field] || fields[field].fieldName || field;\n\t\t\tif (value === void 0 && (fieldAttributes.defaultValue === void 0 && !fieldAttributes.transform?.input && !(action === \"update\" && fieldAttributes.onUpdate) || action === \"update\" && !fieldAttributes.onUpdate)) continue;\n\t\t\tif (fieldAttributes && fieldAttributes.type === \"date\" && !(value instanceof Date) && typeof value === \"string\") try {\n\t\t\t\tvalue = new Date(value);\n\t\t\t} catch {\n\t\t\t\tlogger.error(\"[Adapter Factory] Failed to convert string to date\", {\n\t\t\t\t\tvalue,\n\t\t\t\t\tfield\n\t\t\t\t});\n\t\t\t}\n\t\t\tlet newValue = withApplyDefault(value, fieldAttributes, action);\n\t\t\tif (fieldAttributes.transform?.input) newValue = await fieldAttributes.transform.input(newValue);\n\t\t\tif (fieldAttributes.references?.field === \"id\" && useNumberId) if (Array.isArray(newValue)) newValue = newValue.map((x) => x !== null ? Number(x) : null);\n\t\t\telse newValue = newValue !== null ? Number(newValue) : null;\n\t\t\telse if (config.supportsJSON === false && typeof newValue === \"object\" && fieldAttributes.type === \"json\") newValue = JSON.stringify(newValue);\n\t\t\telse if (config.supportsJSON === false && Array.isArray(newValue) && (fieldAttributes.type === \"string[]\" || fieldAttributes.type === \"number[]\")) newValue = JSON.stringify(newValue);\n\t\t\telse if (config.supportsDates === false && newValue instanceof Date && fieldAttributes.type === \"date\") newValue = newValue.toISOString();\n\t\t\telse if (config.supportsBooleans === false && typeof newValue === \"boolean\") newValue = newValue ? 1 : 0;\n\t\t\tif (config.customTransformInput) newValue = config.customTransformInput({\n\t\t\t\tdata: newValue,\n\t\t\t\taction,\n\t\t\t\tfield: newFieldName,\n\t\t\t\tfieldAttributes,\n\t\t\t\tmodel: getModelName(defaultModelName),\n\t\t\t\tschema,\n\t\t\t\toptions\n\t\t\t});\n\t\t\tif (newValue !== void 0) transformedData[newFieldName] = newValue;\n\t\t}\n\t\treturn transformedData;\n\t};\n\tconst transformOutput = async (data, unsafe_model, select = [], join) => {\n\t\tconst transformSingleOutput = async (data$1, unsafe_model$1, select$1 = []) => {\n\t\t\tif (!data$1) return null;\n\t\t\tconst newMappedKeys = config.mapKeysTransformOutput ?? {};\n\t\t\tconst transformedData$1 = {};\n\t\t\tconst tableSchema = schema[getDefaultModelName(unsafe_model$1)].fields;\n\t\t\tconst idKey = Object.entries(newMappedKeys).find(([_, v]) => v === \"id\")?.[0];\n\t\t\ttableSchema[idKey ?? \"id\"] = { type: options.advanced?.database?.useNumberId || options.advanced?.database?.generateId === \"serial\" ? \"number\" : \"string\" };\n\t\t\tfor (const key in tableSchema) {\n\t\t\t\tif (select$1.length && !select$1.includes(key)) continue;\n\t\t\t\tconst field = tableSchema[key];\n\t\t\t\tif (field) {\n\t\t\t\t\tconst originalKey = field.fieldName || key;\n\t\t\t\t\tlet newValue = data$1[Object.entries(newMappedKeys).find(([_, v]) => v === originalKey)?.[0] || originalKey];\n\t\t\t\t\tif (field.transform?.output) newValue = await field.transform.output(newValue);\n\t\t\t\t\tlet newFieldName = newMappedKeys[key] || key;\n\t\t\t\t\tif (originalKey === \"id\" || field.references?.field === \"id\") {\n\t\t\t\t\t\tif (typeof newValue !== \"undefined\" && newValue !== null) newValue = String(newValue);\n\t\t\t\t\t} else if (config.supportsJSON === false && typeof newValue === \"string\" && field.type === \"json\") newValue = safeJSONParse(newValue);\n\t\t\t\t\telse if (config.supportsJSON === false && typeof newValue === \"string\" && (field.type === \"string[]\" || field.type === \"number[]\")) newValue = safeJSONParse(newValue);\n\t\t\t\t\telse if (config.supportsDates === false && typeof newValue === \"string\" && field.type === \"date\") newValue = new Date(newValue);\n\t\t\t\t\telse if (config.supportsBooleans === false && typeof newValue === \"number\" && field.type === \"boolean\") newValue = newValue === 1;\n\t\t\t\t\tif (config.customTransformOutput) newValue = config.customTransformOutput({\n\t\t\t\t\t\tdata: newValue,\n\t\t\t\t\t\tfield: newFieldName,\n\t\t\t\t\t\tfieldAttributes: field,\n\t\t\t\t\t\tselect: select$1,\n\t\t\t\t\t\tmodel: getModelName(unsafe_model$1),\n\t\t\t\t\t\tschema,\n\t\t\t\t\t\toptions\n\t\t\t\t\t});\n\t\t\t\t\ttransformedData$1[newFieldName] = newValue;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn transformedData$1;\n\t\t};\n\t\tif (!join || Object.keys(join).length === 0) return await transformSingleOutput(data, unsafe_model, select);\n\t\tunsafe_model = getDefaultModelName(unsafe_model);\n\t\tlet transformedData = await transformSingleOutput(data, unsafe_model, select);\n\t\tconst requiredModels = Object.entries(join).map(([model, joinConfig]) => ({\n\t\t\tmodelName: getModelName(model),\n\t\t\tdefaultModelName: getDefaultModelName(model),\n\t\t\tjoinConfig\n\t\t}));\n\t\tif (!data) return null;\n\t\tfor (const { modelName, defaultModelName, joinConfig } of requiredModels) {\n\t\t\tlet joinedData = await (async () => {\n\t\t\t\tif (options.experimental?.joins) return data[modelName];\n\t\t\t\telse return await handleFallbackJoin({\n\t\t\t\t\tbaseModel: unsafe_model,\n\t\t\t\t\tbaseData: transformedData,\n\t\t\t\t\tjoinModel: modelName,\n\t\t\t\t\tspecificJoinConfig: joinConfig\n\t\t\t\t});\n\t\t\t})();\n\t\t\tif (joinedData === void 0 || joinedData === null) joinedData = joinConfig.relation === \"one-to-one\" ? null : [];\n\t\t\tif (joinConfig.relation === \"one-to-many\" && !Array.isArray(joinedData)) joinedData = [joinedData];\n\t\t\tlet transformed = [];\n\t\t\tif (Array.isArray(joinedData)) for (const item of joinedData) {\n\t\t\t\tconst transformedItem = await transformSingleOutput(item, modelName, []);\n\t\t\t\ttransformed.push(transformedItem);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconst transformedItem = await transformSingleOutput(joinedData, modelName, []);\n\t\t\t\ttransformed.push(transformedItem);\n\t\t\t}\n\t\t\ttransformedData[defaultModelName] = (joinConfig.relation === \"one-to-one\" ? transformed[0] : transformed) ?? null;\n\t\t}\n\t\treturn transformedData;\n\t};\n\tconst transformWhereClause = ({ model, where }) => {\n\t\tif (!where) return void 0;\n\t\tconst newMappedKeys = config.mapKeysTransformInput ?? {};\n\t\treturn where.map((w) => {\n\t\t\tconst { field: unsafe_field, value, operator = \"eq\", connector = \"AND\" } = w;\n\t\t\tif (operator === \"in\") {\n\t\t\t\tif (!Array.isArray(value)) throw new BetterAuthError(\"Value must be an array\");\n\t\t\t}\n\t\t\tlet newValue = value;\n\t\t\tconst defaultModelName = getDefaultModelName(model);\n\t\t\tconst defaultFieldName = getDefaultFieldName({\n\t\t\t\tfield: unsafe_field,\n\t\t\t\tmodel\n\t\t\t});\n\t\t\tconst fieldName = newMappedKeys[defaultFieldName] || getFieldName({\n\t\t\t\tfield: defaultFieldName,\n\t\t\t\tmodel: defaultModelName\n\t\t\t});\n\t\t\tconst fieldAttr = getFieldAttributes({\n\t\t\t\tfield: defaultFieldName,\n\t\t\t\tmodel: defaultModelName\n\t\t\t});\n\t\t\tconst useNumberId = options.advanced?.database?.useNumberId || options.advanced?.database?.generateId === \"serial\";\n\t\t\tif (defaultFieldName === \"id\" || fieldAttr.references?.field === \"id\") {\n\t\t\t\tif (useNumberId) if (Array.isArray(value)) newValue = value.map(Number);\n\t\t\t\telse newValue = Number(value);\n\t\t\t}\n\t\t\tif (fieldAttr.type === \"date\" && value instanceof Date && !config.supportsDates) newValue = value.toISOString();\n\t\t\tif (fieldAttr.type === \"boolean\" && typeof value === \"boolean\" && !config.supportsBooleans) newValue = value ? 1 : 0;\n\t\t\tif (fieldAttr.type === \"json\" && typeof value === \"object\" && !config.supportsJSON) try {\n\t\t\t\tnewValue = JSON.stringify(value);\n\t\t\t} catch (error) {\n\t\t\t\tthrow new Error(`Failed to stringify JSON value for field ${fieldName}`, { cause: error });\n\t\t\t}\n\t\t\treturn {\n\t\t\t\toperator,\n\t\t\t\tconnector,\n\t\t\t\tfield: fieldName,\n\t\t\t\tvalue: newValue\n\t\t\t};\n\t\t});\n\t};\n\tconst transformJoinClause = (baseModel, unsanitizedJoin, select) => {\n\t\tif (!unsanitizedJoin) return void 0;\n\t\tif (Object.keys(unsanitizedJoin).length === 0) return void 0;\n\t\tconst transformedJoin = {};\n\t\tfor (const [model, join] of Object.entries(unsanitizedJoin)) {\n\t\t\tif (!join) continue;\n\t\t\tconst defaultModelName = getDefaultModelName(model);\n\t\t\tconst defaultBaseModelName = getDefaultModelName(baseModel);\n\t\t\tlet foreignKeys = Object.entries(schema[defaultModelName].fields).filter(([field, fieldAttributes]) => fieldAttributes.references && getDefaultModelName(fieldAttributes.references.model) === defaultBaseModelName);\n\t\t\tlet isForwardJoin = true;\n\t\t\tif (!foreignKeys.length) {\n\t\t\t\tforeignKeys = Object.entries(schema[defaultBaseModelName].fields).filter(([field, fieldAttributes]) => fieldAttributes.references && getDefaultModelName(fieldAttributes.references.model) === defaultModelName);\n\t\t\t\tisForwardJoin = false;\n\t\t\t}\n\t\t\tif (!foreignKeys.length) throw new BetterAuthError(`No foreign key found for model ${model} and base model ${baseModel} while performing join operation.`);\n\t\t\telse if (foreignKeys.length > 1) throw new BetterAuthError(`Multiple foreign keys found for model ${model} and base model ${baseModel} while performing join operation. Only one foreign key is supported.`);\n\t\t\tconst [foreignKey, foreignKeyAttributes] = foreignKeys[0];\n\t\t\tif (!foreignKeyAttributes.references) throw new BetterAuthError(`No references found for foreign key ${foreignKey} on model ${model} while performing join operation.`);\n\t\t\tlet from;\n\t\t\tlet to;\n\t\t\tlet requiredSelectField;\n\t\t\tif (isForwardJoin) {\n\t\t\t\trequiredSelectField = foreignKeyAttributes.references.field;\n\t\t\t\tfrom = getFieldName({\n\t\t\t\t\tmodel: baseModel,\n\t\t\t\t\tfield: requiredSelectField\n\t\t\t\t});\n\t\t\t\tto = getFieldName({\n\t\t\t\t\tmodel,\n\t\t\t\t\tfield: foreignKey\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\trequiredSelectField = foreignKey;\n\t\t\t\tfrom = getFieldName({\n\t\t\t\t\tmodel: baseModel,\n\t\t\t\t\tfield: requiredSelectField\n\t\t\t\t});\n\t\t\t\tto = getFieldName({\n\t\t\t\t\tmodel,\n\t\t\t\t\tfield: foreignKeyAttributes.references.field\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (select && !select.includes(requiredSelectField)) select.push(requiredSelectField);\n\t\t\tconst isUnique = to === \"id\" ? true : foreignKeyAttributes.unique ?? false;\n\t\t\tlet limit = options.advanced?.database?.defaultFindManyLimit ?? 100;\n\t\t\tif (isUnique) limit = 1;\n\t\t\telse if (typeof join === \"object\" && typeof join.limit === \"number\") limit = join.limit;\n\t\t\ttransformedJoin[getModelName(model)] = {\n\t\t\t\ton: {\n\t\t\t\t\tfrom,\n\t\t\t\t\tto\n\t\t\t\t},\n\t\t\t\tlimit,\n\t\t\t\trelation: isUnique ? \"one-to-one\" : \"one-to-many\"\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tjoin: transformedJoin,\n\t\t\tselect\n\t\t};\n\t};\n\t/**\n\t* Handle joins by making separate queries and combining results (fallback for adapters that don't support native joins).\n\t*/\n\tconst handleFallbackJoin = async ({ baseModel, baseData, joinModel, specificJoinConfig: joinConfig }) => {\n\t\tif (!baseData) return baseData;\n\t\tconst modelName = getModelName(joinModel);\n\t\tconst field = joinConfig.on.to;\n\t\tconst value = baseData[getDefaultFieldName({\n\t\t\tfield: joinConfig.on.from,\n\t\t\tmodel: baseModel\n\t\t})];\n\t\tif (value === null || value === void 0) return joinConfig.relation === \"one-to-one\" ? null : [];\n\t\tlet result;\n\t\tconst where = transformWhereClause({\n\t\t\tmodel: modelName,\n\t\t\twhere: [{\n\t\t\t\tfield,\n\t\t\t\tvalue,\n\t\t\t\toperator: \"eq\",\n\t\t\t\tconnector: \"AND\"\n\t\t\t}]\n\t\t});\n\t\ttry {\n\t\t\tif (joinConfig.relation === \"one-to-one\") result = await adapterInstance.findOne({\n\t\t\t\tmodel: modelName,\n\t\t\t\twhere\n\t\t\t});\n\t\t\telse {\n\t\t\t\tconst limit = joinConfig.limit ?? options.advanced?.database?.defaultFindManyLimit ?? 100;\n\t\t\t\tresult = await adapterInstance.findMany({\n\t\t\t\t\tmodel: modelName,\n\t\t\t\t\twhere,\n\t\t\t\t\tlimit\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tlogger.error(`Failed to query fallback join for model ${modelName}:`, {\n\t\t\t\twhere,\n\t\t\t\tlimit: joinConfig.limit\n\t\t\t});\n\t\t\tconsole.error(error);\n\t\t\tthrow error;\n\t\t}\n\t\treturn result;\n\t};\n\tconst adapterInstance = customAdapter({\n\t\toptions,\n\t\tschema,\n\t\tdebugLog,\n\t\tgetFieldName,\n\t\tgetModelName,\n\t\tgetDefaultModelName,\n\t\tgetDefaultFieldName,\n\t\tgetFieldAttributes,\n\t\ttransformInput,\n\t\ttransformOutput,\n\t\ttransformWhereClause\n\t});\n\tlet lazyLoadTransaction = null;\n\tconst adapter = {\n\t\ttransaction: async (cb) => {\n\t\t\tif (!lazyLoadTransaction) if (!config.transaction) lazyLoadTransaction = createAsIsTransaction(adapter);\n\t\t\telse {\n\t\t\t\tlogger.debug(`[${config.adapterName}] - Using provided transaction implementation.`);\n\t\t\t\tlazyLoadTransaction = config.transaction;\n\t\t\t}\n\t\t\treturn lazyLoadTransaction(cb);\n\t\t},\n\t\tcreate: async ({ data: unsafeData, model: unsafeModel, select, forceAllowId = false }) => {\n\t\t\ttransactionId++;\n\t\t\tlet thisTransactionId = transactionId;\n\t\t\tconst model = getModelName(unsafeModel);\n\t\t\tunsafeModel = getDefaultModelName(unsafeModel);\n\t\t\tif (\"id\" in unsafeData && typeof unsafeData.id !== \"undefined\" && !forceAllowId) {\n\t\t\t\tlogger.warn(`[${config.adapterName}] - You are trying to create a record with an id. This is not allowed as we handle id generation for you, unless you pass in the \\`forceAllowId\\` parameter. The id will be ignored.`);\n\t\t\t\tconst stack = (/* @__PURE__ */ new Error()).stack?.split(\"\\n\").filter((_, i) => i !== 1).join(\"\\n\").replace(\"Error:\", \"Create method with `id` being called at:\");\n\t\t\t\tconsole.log(stack);\n\t\t\t\tunsafeData.id = void 0;\n\t\t\t}\n\t\t\tdebugLog({ method: \"create\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`, `${formatMethod(\"create\")} ${formatAction(\"Unsafe Input\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: unsafeData\n\t\t\t});\n\t\t\tlet data = unsafeData;\n\t\t\tif (!config.disableTransformInput) data = await transformInput(unsafeData, unsafeModel, \"create\", forceAllowId);\n\t\t\tdebugLog({ method: \"create\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`, `${formatMethod(\"create\")} ${formatAction(\"Parsed Input\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata\n\t\t\t});\n\t\t\tconst res = await adapterInstance.create({\n\t\t\t\tdata,\n\t\t\t\tmodel\n\t\t\t});\n\t\t\tdebugLog({ method: \"create\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`, `${formatMethod(\"create\")} ${formatAction(\"DB Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tres\n\t\t\t});\n\t\t\tlet transformed = res;\n\t\t\tif (!config.disableTransformOutput) transformed = await transformOutput(res, unsafeModel, select, void 0);\n\t\t\tdebugLog({ method: \"create\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`, `${formatMethod(\"create\")} ${formatAction(\"Parsed Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: transformed\n\t\t\t});\n\t\t\treturn transformed;\n\t\t},\n\t\tupdate: async ({ model: unsafeModel, where: unsafeWhere, update: unsafeData }) => {\n\t\t\ttransactionId++;\n\t\t\tlet thisTransactionId = transactionId;\n\t\t\tunsafeModel = getDefaultModelName(unsafeModel);\n\t\t\tconst model = getModelName(unsafeModel);\n\t\t\tconst where = transformWhereClause({\n\t\t\t\tmodel: unsafeModel,\n\t\t\t\twhere: unsafeWhere\n\t\t\t});\n\t\t\tdebugLog({ method: \"update\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`, `${formatMethod(\"update\")} ${formatAction(\"Unsafe Input\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: unsafeData\n\t\t\t});\n\t\t\tlet data = unsafeData;\n\t\t\tif (!config.disableTransformInput) data = await transformInput(unsafeData, unsafeModel, \"update\");\n\t\t\tdebugLog({ method: \"update\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`, `${formatMethod(\"update\")} ${formatAction(\"Parsed Input\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata\n\t\t\t});\n\t\t\tconst res = await adapterInstance.update({\n\t\t\t\tmodel,\n\t\t\t\twhere,\n\t\t\t\tupdate: data\n\t\t\t});\n\t\t\tdebugLog({ method: \"update\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`, `${formatMethod(\"update\")} ${formatAction(\"DB Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: res\n\t\t\t});\n\t\t\tlet transformed = res;\n\t\t\tif (!config.disableTransformOutput) transformed = await transformOutput(res, unsafeModel, void 0, void 0);\n\t\t\tdebugLog({ method: \"update\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`, `${formatMethod(\"update\")} ${formatAction(\"Parsed Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: transformed\n\t\t\t});\n\t\t\treturn transformed;\n\t\t},\n\t\tupdateMany: async ({ model: unsafeModel, where: unsafeWhere, update: unsafeData }) => {\n\t\t\ttransactionId++;\n\t\t\tlet thisTransactionId = transactionId;\n\t\t\tconst model = getModelName(unsafeModel);\n\t\t\tconst where = transformWhereClause({\n\t\t\t\tmodel: unsafeModel,\n\t\t\t\twhere: unsafeWhere\n\t\t\t});\n\t\t\tunsafeModel = getDefaultModelName(unsafeModel);\n\t\t\tdebugLog({ method: \"updateMany\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`, `${formatMethod(\"updateMany\")} ${formatAction(\"Unsafe Input\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: unsafeData\n\t\t\t});\n\t\t\tlet data = unsafeData;\n\t\t\tif (!config.disableTransformInput) data = await transformInput(unsafeData, unsafeModel, \"update\");\n\t\t\tdebugLog({ method: \"updateMany\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`, `${formatMethod(\"updateMany\")} ${formatAction(\"Parsed Input\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata\n\t\t\t});\n\t\t\tconst updatedCount = await adapterInstance.updateMany({\n\t\t\t\tmodel,\n\t\t\t\twhere,\n\t\t\t\tupdate: data\n\t\t\t});\n\t\t\tdebugLog({ method: \"updateMany\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`, `${formatMethod(\"updateMany\")} ${formatAction(\"DB Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: updatedCount\n\t\t\t});\n\t\t\tdebugLog({ method: \"updateMany\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`, `${formatMethod(\"updateMany\")} ${formatAction(\"Parsed Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: updatedCount\n\t\t\t});\n\t\t\treturn updatedCount;\n\t\t},\n\t\tfindOne: async ({ model: unsafeModel, where: unsafeWhere, select, join: unsafeJoin }) => {\n\t\t\ttransactionId++;\n\t\t\tlet thisTransactionId = transactionId;\n\t\t\tconst model = getModelName(unsafeModel);\n\t\t\tconst where = transformWhereClause({\n\t\t\t\tmodel: unsafeModel,\n\t\t\t\twhere: unsafeWhere\n\t\t\t});\n\t\t\tunsafeModel = getDefaultModelName(unsafeModel);\n\t\t\tlet join;\n\t\t\tlet passJoinToAdapter = true;\n\t\t\tif (!config.disableTransformJoin) {\n\t\t\t\tconst result = transformJoinClause(unsafeModel, unsafeJoin, select);\n\t\t\t\tif (result) {\n\t\t\t\t\tjoin = result.join;\n\t\t\t\t\tselect = result.select;\n\t\t\t\t}\n\t\t\t\tif (!options.experimental?.joins && join && Object.keys(join).length > 0) passJoinToAdapter = false;\n\t\t\t} else join = unsafeJoin;\n\t\t\tdebugLog({ method: \"findOne\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(1, 3)}`, `${formatMethod(\"findOne\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\twhere,\n\t\t\t\tselect,\n\t\t\t\tjoin\n\t\t\t});\n\t\t\tconst res = await adapterInstance.findOne({\n\t\t\t\tmodel,\n\t\t\t\twhere,\n\t\t\t\tselect,\n\t\t\t\tjoin: passJoinToAdapter ? join : void 0\n\t\t\t});\n\t\t\tdebugLog({ method: \"findOne\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(2, 3)}`, `${formatMethod(\"findOne\")} ${formatAction(\"DB Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: res\n\t\t\t});\n\t\t\tlet transformed = res;\n\t\t\tif (!config.disableTransformOutput) transformed = await transformOutput(res, unsafeModel, select, join);\n\t\t\tdebugLog({ method: \"findOne\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(3, 3)}`, `${formatMethod(\"findOne\")} ${formatAction(\"Parsed Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: transformed\n\t\t\t});\n\t\t\treturn transformed;\n\t\t},\n\t\tfindMany: async ({ model: unsafeModel, where: unsafeWhere, limit: unsafeLimit, sortBy, offset, join: unsafeJoin }) => {\n\t\t\ttransactionId++;\n\t\t\tlet thisTransactionId = transactionId;\n\t\t\tconst limit = unsafeLimit ?? options.advanced?.database?.defaultFindManyLimit ?? 100;\n\t\t\tconst model = getModelName(unsafeModel);\n\t\t\tconst where = transformWhereClause({\n\t\t\t\tmodel: unsafeModel,\n\t\t\t\twhere: unsafeWhere\n\t\t\t});\n\t\t\tunsafeModel = getDefaultModelName(unsafeModel);\n\t\t\tlet join;\n\t\t\tlet passJoinToAdapter = true;\n\t\t\tif (!config.disableTransformJoin) {\n\t\t\t\tconst result = transformJoinClause(unsafeModel, unsafeJoin, void 0);\n\t\t\t\tif (result) join = result.join;\n\t\t\t\tif (!options.experimental?.joins && join && Object.keys(join).length > 0) passJoinToAdapter = false;\n\t\t\t} else join = unsafeJoin;\n\t\t\tdebugLog({ method: \"findMany\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(1, 3)}`, `${formatMethod(\"findMany\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\twhere,\n\t\t\t\tlimit,\n\t\t\t\tsortBy,\n\t\t\t\toffset,\n\t\t\t\tjoin\n\t\t\t});\n\t\t\tconst res = await adapterInstance.findMany({\n\t\t\t\tmodel,\n\t\t\t\twhere,\n\t\t\t\tlimit,\n\t\t\t\tsortBy,\n\t\t\t\toffset,\n\t\t\t\tjoin: passJoinToAdapter ? join : void 0\n\t\t\t});\n\t\t\tdebugLog({ method: \"findMany\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(2, 3)}`, `${formatMethod(\"findMany\")} ${formatAction(\"DB Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: res\n\t\t\t});\n\t\t\tlet transformed = res;\n\t\t\tif (!config.disableTransformOutput) transformed = await Promise.all(res.map(async (r) => {\n\t\t\t\treturn await transformOutput(r, unsafeModel, void 0, join);\n\t\t\t}));\n\t\t\tdebugLog({ method: \"findMany\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(3, 3)}`, `${formatMethod(\"findMany\")} ${formatAction(\"Parsed Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: transformed\n\t\t\t});\n\t\t\treturn transformed;\n\t\t},\n\t\tdelete: async ({ model: unsafeModel, where: unsafeWhere }) => {\n\t\t\ttransactionId++;\n\t\t\tlet thisTransactionId = transactionId;\n\t\t\tconst model = getModelName(unsafeModel);\n\t\t\tconst where = transformWhereClause({\n\t\t\t\tmodel: unsafeModel,\n\t\t\t\twhere: unsafeWhere\n\t\t\t});\n\t\t\tunsafeModel = getDefaultModelName(unsafeModel);\n\t\t\tdebugLog({ method: \"delete\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`, `${formatMethod(\"delete\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\twhere\n\t\t\t});\n\t\t\tawait adapterInstance.delete({\n\t\t\t\tmodel,\n\t\t\t\twhere\n\t\t\t});\n\t\t\tdebugLog({ method: \"delete\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`, `${formatMethod(\"delete\")} ${formatAction(\"DB Result\")}:`, { model });\n\t\t},\n\t\tdeleteMany: async ({ model: unsafeModel, where: unsafeWhere }) => {\n\t\t\ttransactionId++;\n\t\t\tlet thisTransactionId = transactionId;\n\t\t\tconst model = getModelName(unsafeModel);\n\t\t\tconst where = transformWhereClause({\n\t\t\t\tmodel: unsafeModel,\n\t\t\t\twhere: unsafeWhere\n\t\t\t});\n\t\t\tunsafeModel = getDefaultModelName(unsafeModel);\n\t\t\tdebugLog({ method: \"deleteMany\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`, `${formatMethod(\"deleteMany\")} ${formatAction(\"DeleteMany\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\twhere\n\t\t\t});\n\t\t\tconst res = await adapterInstance.deleteMany({\n\t\t\t\tmodel,\n\t\t\t\twhere\n\t\t\t});\n\t\t\tdebugLog({ method: \"deleteMany\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`, `${formatMethod(\"deleteMany\")} ${formatAction(\"DB Result\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: res\n\t\t\t});\n\t\t\treturn res;\n\t\t},\n\t\tcount: async ({ model: unsafeModel, where: unsafeWhere }) => {\n\t\t\ttransactionId++;\n\t\t\tlet thisTransactionId = transactionId;\n\t\t\tconst model = getModelName(unsafeModel);\n\t\t\tconst where = transformWhereClause({\n\t\t\t\tmodel: unsafeModel,\n\t\t\t\twhere: unsafeWhere\n\t\t\t});\n\t\t\tunsafeModel = getDefaultModelName(unsafeModel);\n\t\t\tdebugLog({ method: \"count\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`, `${formatMethod(\"count\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\twhere\n\t\t\t});\n\t\t\tconst res = await adapterInstance.count({\n\t\t\t\tmodel,\n\t\t\t\twhere\n\t\t\t});\n\t\t\tdebugLog({ method: \"count\" }, `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`, `${formatMethod(\"count\")}:`, {\n\t\t\t\tmodel,\n\t\t\t\tdata: res\n\t\t\t});\n\t\t\treturn res;\n\t\t},\n\t\tcreateSchema: adapterInstance.createSchema ? async (_, file) => {\n\t\t\tconst tables = getAuthTables(options);\n\t\t\tif (options.secondaryStorage && !options.session?.storeSessionInDatabase) delete tables.session;\n\t\t\tif (options.rateLimit && options.rateLimit.storage === \"database\" && (typeof options.rateLimit.enabled === \"undefined\" || options.rateLimit.enabled === true)) tables.ratelimit = {\n\t\t\t\tmodelName: options.rateLimit.modelName ?? \"ratelimit\",\n\t\t\t\tfields: {\n\t\t\t\t\tkey: {\n\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\tunique: true,\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tfieldName: options.rateLimit.fields?.key ?? \"key\"\n\t\t\t\t\t},\n\t\t\t\t\tcount: {\n\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tfieldName: options.rateLimit.fields?.count ?? \"count\"\n\t\t\t\t\t},\n\t\t\t\t\tlastRequest: {\n\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tbigint: true,\n\t\t\t\t\t\tdefaultValue: () => Date.now(),\n\t\t\t\t\t\tfieldName: options.rateLimit.fields?.lastRequest ?? \"lastRequest\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn adapterInstance.createSchema({\n\t\t\t\tfile,\n\t\t\t\ttables\n\t\t\t});\n\t\t} : void 0,\n\t\toptions: {\n\t\t\tadapterConfig: config,\n\t\t\t...adapterInstance.options ?? {}\n\t\t},\n\t\tid: config.adapterId,\n\t\t...config.debugLogs?.isRunningAdapterTests ? { adapterTestDebugLogs: {\n\t\t\tresetDebugLogs() {\n\t\t\t\tdebugLogs = debugLogs.filter((log) => log.instance !== uniqueAdapterFactoryInstanceId);\n\t\t\t},\n\t\t\tprintDebugLogs() {\n\t\t\t\tconst separator = ``.repeat(80);\n\t\t\t\tconst logs = debugLogs.filter((log$1) => log$1.instance === uniqueAdapterFactoryInstanceId);\n\t\t\t\tif (logs.length === 0) return;\n\t\t\t\tlet log = logs.reverse().map((log$1) => {\n\t\t\t\t\tlog$1.args[0] = `\\n${log$1.args[0]}`;\n\t\t\t\t\treturn [...log$1.args, \"\\n\"];\n\t\t\t\t}).reduce((prev, curr) => {\n\t\t\t\t\treturn [...curr, ...prev];\n\t\t\t\t}, [`\\n${separator}`]);\n\t\t\t\tconsole.log(...log);\n\t\t\t}\n\t\t} } : {}\n\t};\n\treturn adapter;\n};\nfunction formatTransactionId(transactionId$1) {\n\tif (getColorDepth() < 8) return `#${transactionId$1}`;\n\treturn `${TTY_COLORS.fg.magenta}#${transactionId$1}${TTY_COLORS.reset}`;\n}\nfunction formatStep(step, total) {\n\treturn `${TTY_COLORS.bg.black}${TTY_COLORS.fg.yellow}[${step}/${total}]${TTY_COLORS.reset}`;\n}\nfunction formatMethod(method) {\n\treturn `${TTY_COLORS.bright}${method}${TTY_COLORS.reset}`;\n}\nfunction formatAction(action) {\n\treturn `${TTY_COLORS.dim}(${action})${TTY_COLORS.reset}`;\n}\n\n//#endregion\nexport { initGetFieldAttributes as n, initGetIdField as r, createAdapterFactory as t };"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 9053, "column": 0}, "map": {"version":3,"sources":["file:///Users/jacklau/Documents/GitHub/Trading-app/node_modules/better-auth/dist/adapters/drizzle-adapter/index.mjs"],"sourcesContent":["import \"../../get-model-name-D4DUV7S2.mjs\";\nimport \"../../utils-db7gNqd-.mjs\";\nimport \"../../crypto-CFUhAR9W.mjs\";\nimport \"../../misc-BwNc0MKr.mjs\";\nimport \"../../json-CnHxKYpj.mjs\";\nimport { t as createAdapterFactory } from \"../../adapter-factory-HF3JB9cT.mjs\";\nimport { logger } from \"@better-auth/core/env\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\nimport { and, asc, count, desc, eq, gt, gte, inArray, like, lt, lte, ne, notInArray, or, sql } from \"drizzle-orm\";\n\n//#region src/adapters/drizzle-adapter/drizzle-adapter.ts\nconst drizzleAdapter = (db, config) => {\n\tlet lazyOptions = null;\n\tconst createCustomAdapter = (db$1) => ({ getFieldName, options }) => {\n\t\tfunction getSchema(model) {\n\t\t\tconst schema = config.schema || db$1._.fullSchema;\n\t\t\tif (!schema) throw new BetterAuthError(\"Drizzle adapter failed to initialize. Schema not found. Please provide a schema object in the adapter options object.\");\n\t\t\tconst schemaModel = schema[model];\n\t\t\tif (!schemaModel) throw new BetterAuthError(`[# Drizzle Adapter]: The model \"${model}\" was not found in the schema object. Please pass the schema directly to the adapter options.`);\n\t\t\treturn schemaModel;\n\t\t}\n\t\tconst withReturning = async (model, builder, data, where) => {\n\t\t\tif (config.provider !== \"mysql\") return (await builder.returning())[0];\n\t\t\tawait builder.execute();\n\t\t\tconst schemaModel = getSchema(model);\n\t\t\tconst builderVal = builder.config?.values;\n\t\t\tif (where?.length) {\n\t\t\t\tconst clause = convertWhereClause(where.map((w) => {\n\t\t\t\t\tif (data[w.field] !== void 0) return {\n\t\t\t\t\t\t...w,\n\t\t\t\t\t\tvalue: data[w.field]\n\t\t\t\t\t};\n\t\t\t\t\treturn w;\n\t\t\t\t}), model);\n\t\t\t\treturn (await db$1.select().from(schemaModel).where(...clause))[0];\n\t\t\t} else if (builderVal && builderVal[0]?.id?.value) {\n\t\t\t\tlet tId = builderVal[0]?.id?.value;\n\t\t\t\tif (!tId) tId = (await db$1.select({ id: sql`LAST_INSERT_ID()` }).from(schemaModel).orderBy(desc(schemaModel.id)).limit(1))[0].id;\n\t\t\t\treturn (await db$1.select().from(schemaModel).where(eq(schemaModel.id, tId)).limit(1).execute())[0];\n\t\t\t} else if (data.id) return (await db$1.select().from(schemaModel).where(eq(schemaModel.id, data.id)).limit(1).execute())[0];\n\t\t\telse {\n\t\t\t\tif (!(\"id\" in schemaModel)) throw new BetterAuthError(`The model \"${model}\" does not have an \"id\" field. Please use the \"id\" field as your primary key.`);\n\t\t\t\treturn (await db$1.select().from(schemaModel).orderBy(desc(schemaModel.id)).limit(1).execute())[0];\n\t\t\t}\n\t\t};\n\t\tfunction convertWhereClause(where, model) {\n\t\t\tconst schemaModel = getSchema(model);\n\t\t\tif (!where) return [];\n\t\t\tif (where.length === 1) {\n\t\t\t\tconst w = where[0];\n\t\t\t\tif (!w) return [];\n\t\t\t\tconst field = getFieldName({\n\t\t\t\t\tmodel,\n\t\t\t\t\tfield: w.field\n\t\t\t\t});\n\t\t\t\tif (!schemaModel[field]) throw new BetterAuthError(`The field \"${w.field}\" does not exist in the schema for the model \"${model}\". Please update your schema.`);\n\t\t\t\tif (w.operator === \"in\") {\n\t\t\t\t\tif (!Array.isArray(w.value)) throw new BetterAuthError(`The value for the field \"${w.field}\" must be an array when using the \"in\" operator.`);\n\t\t\t\t\treturn [inArray(schemaModel[field], w.value)];\n\t\t\t\t}\n\t\t\t\tif (w.operator === \"not_in\") {\n\t\t\t\t\tif (!Array.isArray(w.value)) throw new BetterAuthError(`The value for the field \"${w.field}\" must be an array when using the \"not_in\" operator.`);\n\t\t\t\t\treturn [notInArray(schemaModel[field], w.value)];\n\t\t\t\t}\n\t\t\t\tif (w.operator === \"contains\") return [like(schemaModel[field], `%${w.value}%`)];\n\t\t\t\tif (w.operator === \"starts_with\") return [like(schemaModel[field], `${w.value}%`)];\n\t\t\t\tif (w.operator === \"ends_with\") return [like(schemaModel[field], `%${w.value}`)];\n\t\t\t\tif (w.operator === \"lt\") return [lt(schemaModel[field], w.value)];\n\t\t\t\tif (w.operator === \"lte\") return [lte(schemaModel[field], w.value)];\n\t\t\t\tif (w.operator === \"ne\") return [ne(schemaModel[field], w.value)];\n\t\t\t\tif (w.operator === \"gt\") return [gt(schemaModel[field], w.value)];\n\t\t\t\tif (w.operator === \"gte\") return [gte(schemaModel[field], w.value)];\n\t\t\t\treturn [eq(schemaModel[field], w.value)];\n\t\t\t}\n\t\t\tconst andGroup = where.filter((w) => w.connector === \"AND\" || !w.connector);\n\t\t\tconst orGroup = where.filter((w) => w.connector === \"OR\");\n\t\t\tconst andClause = and(...andGroup.map((w) => {\n\t\t\t\tconst field = getFieldName({\n\t\t\t\t\tmodel,\n\t\t\t\t\tfield: w.field\n\t\t\t\t});\n\t\t\t\tif (w.operator === \"in\") {\n\t\t\t\t\tif (!Array.isArray(w.value)) throw new BetterAuthError(`The value for the field \"${w.field}\" must be an array when using the \"in\" operator.`);\n\t\t\t\t\treturn inArray(schemaModel[field], w.value);\n\t\t\t\t}\n\t\t\t\tif (w.operator === \"not_in\") {\n\t\t\t\t\tif (!Array.isArray(w.value)) throw new BetterAuthError(`The value for the field \"${w.field}\" must be an array when using the \"not_in\" operator.`);\n\t\t\t\t\treturn notInArray(schemaModel[field], w.value);\n\t\t\t\t}\n\t\t\t\tif (w.operator === \"contains\") return like(schemaModel[field], `%${w.value}%`);\n\t\t\t\tif (w.operator === \"starts_with\") return like(schemaModel[field], `${w.value}%`);\n\t\t\t\tif (w.operator === \"ends_with\") return like(schemaModel[field], `%${w.value}`);\n\t\t\t\tif (w.operator === \"lt\") return lt(schemaModel[field], w.value);\n\t\t\t\tif (w.operator === \"lte\") return lte(schemaModel[field], w.value);\n\t\t\t\tif (w.operator === \"gt\") return gt(schemaModel[field], w.value);\n\t\t\t\tif (w.operator === \"gte\") return gte(schemaModel[field], w.value);\n\t\t\t\tif (w.operator === \"ne\") return ne(schemaModel[field], w.value);\n\t\t\t\treturn eq(schemaModel[field], w.value);\n\t\t\t}));\n\t\t\tconst orClause = or(...orGroup.map((w) => {\n\t\t\t\tconst field = getFieldName({\n\t\t\t\t\tmodel,\n\t\t\t\t\tfield: w.field\n\t\t\t\t});\n\t\t\t\tif (w.operator === \"in\") {\n\t\t\t\t\tif (!Array.isArray(w.value)) throw new BetterAuthError(`The value for the field \"${w.field}\" must be an array when using the \"in\" operator.`);\n\t\t\t\t\treturn inArray(schemaModel[field], w.value);\n\t\t\t\t}\n\t\t\t\tif (w.operator === \"not_in\") {\n\t\t\t\t\tif (!Array.isArray(w.value)) throw new BetterAuthError(`The value for the field \"${w.field}\" must be an array when using the \"not_in\" operator.`);\n\t\t\t\t\treturn notInArray(schemaModel[field], w.value);\n\t\t\t\t}\n\t\t\t\tif (w.operator === \"contains\") return like(schemaModel[field], `%${w.value}%`);\n\t\t\t\tif (w.operator === \"starts_with\") return like(schemaModel[field], `${w.value}%`);\n\t\t\t\tif (w.operator === \"ends_with\") return like(schemaModel[field], `%${w.value}`);\n\t\t\t\tif (w.operator === \"lt\") return lt(schemaModel[field], w.value);\n\t\t\t\tif (w.operator === \"lte\") return lte(schemaModel[field], w.value);\n\t\t\t\tif (w.operator === \"gt\") return gt(schemaModel[field], w.value);\n\t\t\t\tif (w.operator === \"gte\") return gte(schemaModel[field], w.value);\n\t\t\t\tif (w.operator === \"ne\") return ne(schemaModel[field], w.value);\n\t\t\t\treturn eq(schemaModel[field], w.value);\n\t\t\t}));\n\t\t\tconst clause = [];\n\t\t\tif (andGroup.length) clause.push(andClause);\n\t\t\tif (orGroup.length) clause.push(orClause);\n\t\t\treturn clause;\n\t\t}\n\t\tfunction checkMissingFields(schema, model, values) {\n\t\t\tif (!schema) throw new BetterAuthError(\"Drizzle adapter failed to initialize. Drizzle Schema not found. Please provide a schema object in the adapter options object.\");\n\t\t\tfor (const key in values) if (!schema[key]) throw new BetterAuthError(`The field \"${key}\" does not exist in the \"${model}\" Drizzle schema. Please update your drizzle schema or re-generate using \"npx @better-auth/cli@latest generate\".`);\n\t\t}\n\t\treturn {\n\t\t\tasync create({ model, data: values }) {\n\t\t\t\tconst schemaModel = getSchema(model);\n\t\t\t\tcheckMissingFields(schemaModel, model, values);\n\t\t\t\treturn await withReturning(model, db$1.insert(schemaModel).values(values), values);\n\t\t\t},\n\t\t\tasync findOne({ model, where, join }) {\n\t\t\t\tconst schemaModel = getSchema(model);\n\t\t\t\tconst clause = convertWhereClause(where, model);\n\t\t\t\tif (options.experimental?.joins) if (!db$1.query || !db$1.query[model]) {\n\t\t\t\t\tlogger.error(`[# Drizzle Adapter]: The model \"${model}\" was not found in the query object. Please update your Drizzle schema to include relations or re-generate using \"npx @better-auth/cli@latest generate\".`);\n\t\t\t\t\tlogger.info(\"Falling back to regular query\");\n\t\t\t\t} else {\n\t\t\t\t\tlet includes;\n\t\t\t\t\tconst pluralJoinResults = [];\n\t\t\t\t\tif (join) {\n\t\t\t\t\t\tincludes = {};\n\t\t\t\t\t\tconst joinEntries = Object.entries(join);\n\t\t\t\t\t\tfor (const [model$1, joinAttr] of joinEntries) {\n\t\t\t\t\t\t\tconst limit = joinAttr.limit ?? options.advanced?.database?.defaultFindManyLimit ?? 100;\n\t\t\t\t\t\t\tconst isUnique = joinAttr.relation === \"one-to-one\";\n\t\t\t\t\t\t\tconst pluralSuffix = isUnique || config.usePlural ? \"\" : \"s\";\n\t\t\t\t\t\t\tincludes[`${model$1}${pluralSuffix}`] = isUnique ? true : { limit };\n\t\t\t\t\t\t\tif (!isUnique) pluralJoinResults.push(`${model$1}${pluralSuffix}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconst res$1 = await db$1.query[model].findFirst({\n\t\t\t\t\t\twhere: clause[0],\n\t\t\t\t\t\twith: includes\n\t\t\t\t\t});\n\t\t\t\t\tif (res$1) for (const pluralJoinResult of pluralJoinResults) {\n\t\t\t\t\t\tlet singularKey = !config.usePlural ? pluralJoinResult.slice(0, -1) : pluralJoinResult;\n\t\t\t\t\t\tres$1[singularKey] = res$1[pluralJoinResult];\n\t\t\t\t\t\tif (pluralJoinResult !== singularKey) delete res$1[pluralJoinResult];\n\t\t\t\t\t}\n\t\t\t\t\treturn res$1;\n\t\t\t\t}\n\t\t\t\tconst res = await db$1.select().from(schemaModel).where(...clause);\n\t\t\t\tif (!res.length) return null;\n\t\t\t\treturn res[0];\n\t\t\t},\n\t\t\tasync findMany({ model, where, sortBy, limit, offset, join }) {\n\t\t\t\tconst schemaModel = getSchema(model);\n\t\t\t\tconst clause = where ? convertWhereClause(where, model) : [];\n\t\t\t\tconst sortFn = sortBy?.direction === \"desc\" ? desc : asc;\n\t\t\t\tif (options.experimental?.joins) if (!db$1.query[model]) {\n\t\t\t\t\tlogger.error(`[# Drizzle Adapter]: The model \"${model}\" was not found in the query object. Please update your Drizzle schema to include relations or re-generate using \"npx @better-auth/cli@latest generate\".`);\n\t\t\t\t\tlogger.info(\"Falling back to regular query\");\n\t\t\t\t} else {\n\t\t\t\t\tlet includes;\n\t\t\t\t\tconst pluralJoinResults = [];\n\t\t\t\t\tif (join) {\n\t\t\t\t\t\tincludes = {};\n\t\t\t\t\t\tconst joinEntries = Object.entries(join);\n\t\t\t\t\t\tfor (const [model$1, joinAttr] of joinEntries) {\n\t\t\t\t\t\t\tconst isUnique = joinAttr.relation === \"one-to-one\";\n\t\t\t\t\t\t\tconst limit$1 = joinAttr.limit ?? options.advanced?.database?.defaultFindManyLimit ?? 100;\n\t\t\t\t\t\t\tlet pluralSuffix = isUnique || config.usePlural ? \"\" : \"s\";\n\t\t\t\t\t\t\tincludes[`${model$1}${pluralSuffix}`] = isUnique ? true : { limit: limit$1 };\n\t\t\t\t\t\t\tif (!isUnique) pluralJoinResults.push(`${model$1}${pluralSuffix}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlet orderBy = void 0;\n\t\t\t\t\tif (sortBy?.field) orderBy = [sortFn(schemaModel[getFieldName({\n\t\t\t\t\t\tmodel,\n\t\t\t\t\t\tfield: sortBy?.field\n\t\t\t\t\t})])];\n\t\t\t\t\tlet res = await db$1.query[model].findMany({\n\t\t\t\t\t\twhere: clause[0],\n\t\t\t\t\t\twith: includes,\n\t\t\t\t\t\tlimit: limit ?? 100,\n\t\t\t\t\t\toffset: offset ?? 0,\n\t\t\t\t\t\torderBy\n\t\t\t\t\t});\n\t\t\t\t\tif (res) for (const item of res) for (const pluralJoinResult of pluralJoinResults) {\n\t\t\t\t\t\tconst singularKey = !config.usePlural ? pluralJoinResult.slice(0, -1) : pluralJoinResult;\n\t\t\t\t\t\tif (singularKey === pluralJoinResult) continue;\n\t\t\t\t\t\titem[singularKey] = item[pluralJoinResult];\n\t\t\t\t\t\tdelete item[pluralJoinResult];\n\t\t\t\t\t}\n\t\t\t\t\treturn res;\n\t\t\t\t}\n\t\t\t\tlet builder = db$1.select().from(schemaModel);\n\t\t\t\tconst effectiveLimit = limit;\n\t\t\t\tconst effectiveOffset = offset;\n\t\t\t\tif (typeof effectiveLimit !== \"undefined\") builder = builder.limit(effectiveLimit);\n\t\t\t\tif (typeof effectiveOffset !== \"undefined\") builder = builder.offset(effectiveOffset);\n\t\t\t\tif (sortBy?.field) builder = builder.orderBy(sortFn(schemaModel[getFieldName({\n\t\t\t\t\tmodel,\n\t\t\t\t\tfield: sortBy?.field\n\t\t\t\t})]));\n\t\t\t\treturn await builder.where(...clause);\n\t\t\t},\n\t\t\tasync count({ model, where }) {\n\t\t\t\tconst schemaModel = getSchema(model);\n\t\t\t\tconst clause = where ? convertWhereClause(where, model) : [];\n\t\t\t\treturn (await db$1.select({ count: count() }).from(schemaModel).where(...clause))[0].count;\n\t\t\t},\n\t\t\tasync update({ model, where, update: values }) {\n\t\t\t\tconst schemaModel = getSchema(model);\n\t\t\t\tconst clause = convertWhereClause(where, model);\n\t\t\t\treturn await withReturning(model, db$1.update(schemaModel).set(values).where(...clause), values, where);\n\t\t\t},\n\t\t\tasync updateMany({ model, where, update: values }) {\n\t\t\t\tconst schemaModel = getSchema(model);\n\t\t\t\tconst clause = convertWhereClause(where, model);\n\t\t\t\treturn await db$1.update(schemaModel).set(values).where(...clause);\n\t\t\t},\n\t\t\tasync delete({ model, where }) {\n\t\t\t\tconst schemaModel = getSchema(model);\n\t\t\t\tconst clause = convertWhereClause(where, model);\n\t\t\t\treturn await db$1.delete(schemaModel).where(...clause);\n\t\t\t},\n\t\t\tasync deleteMany({ model, where }) {\n\t\t\t\tconst schemaModel = getSchema(model);\n\t\t\t\tconst clause = convertWhereClause(where, model);\n\t\t\t\tconst res = await db$1.delete(schemaModel).where(...clause);\n\t\t\t\tlet count$1 = 0;\n\t\t\t\tif (res && \"rowCount\" in res) count$1 = res.rowCount;\n\t\t\t\telse if (Array.isArray(res)) count$1 = res.length;\n\t\t\t\telse if (res && (\"affectedRows\" in res || \"rowsAffected\" in res || \"changes\" in res)) count$1 = res.affectedRows ?? res.rowsAffected ?? res.changes;\n\t\t\t\tif (typeof count$1 !== \"number\") logger.error(\"[Drizzle Adapter] The result of the deleteMany operation is not a number. This is likely a bug in the adapter. Please report this issue to the Better Auth team.\", {\n\t\t\t\t\tres,\n\t\t\t\t\tmodel,\n\t\t\t\t\twhere\n\t\t\t\t});\n\t\t\t\treturn count$1;\n\t\t\t},\n\t\t\toptions: config\n\t\t};\n\t};\n\tlet adapterOptions = null;\n\tadapterOptions = {\n\t\tconfig: {\n\t\t\tadapterId: \"drizzle\",\n\t\t\tadapterName: \"Drizzle Adapter\",\n\t\t\tusePlural: config.usePlural ?? false,\n\t\t\tdebugLogs: config.debugLogs ?? false,\n\t\t\tsupportsUUIDs: config.provider === \"pg\" ? true : false,\n\t\t\ttransaction: config.transaction ?? false ? (cb) => db.transaction((tx) => {\n\t\t\t\treturn cb(createAdapterFactory({\n\t\t\t\t\tconfig: adapterOptions.config,\n\t\t\t\t\tadapter: createCustomAdapter(tx)\n\t\t\t\t})(lazyOptions));\n\t\t\t}) : false\n\t\t},\n\t\tadapter: createCustomAdapter(db)\n\t};\n\tconst adapter = createAdapterFactory(adapterOptions);\n\treturn (options) => {\n\t\tlazyOptions = options;\n\t\treturn adapter(options);\n\t};\n};\n\n//#endregion\nexport { drizzleAdapter };"],"names":[],"mappings":"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","ignoreList":[0]}}]
}