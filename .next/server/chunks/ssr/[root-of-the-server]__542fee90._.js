module.exports=[25372,(a,b,c)=>{b.exports=a.x("better-sqlite3",()=>require("better-sqlite3"))},22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},47844,a=>{"use strict";var b=a.i(37936),c=a.i(9223),d=a.i(5246),e=a.i(66879),f=a.i(15545),g=a.i(93321),h=a.i(30385),i=a.i(18558);async function j(){let a=await c.auth.api.getSession({headers:await (0,d.headers)()});if(!a?.user)throw Error("Unauthorized");return a.user}async function k(){let a=await j(),b=(0,e.getDb)(),c=await b.select().from(f.trades).where((0,g.eq)(f.trades.userId,a.id)).orderBy((0,h.desc)(f.trades.date)),d=c.map(a=>a.id),i={};return d.length>0&&(await b.select().from(f.tradeTags).where((0,g.inArray)(f.tradeTags.tradeId,d))).forEach(a=>{i[a.tradeId]||(i[a.tradeId]=[]),i[a.tradeId].push(a.tagId)}),c.map(a=>({...a,tags:i[a.id]||[]}))}async function l(a){let b=await j(),c=(0,e.getDb)(),d=await c.select().from(f.trades).where((0,g.and)((0,g.eq)(f.trades.id,a),(0,g.eq)(f.trades.userId,b.id))).get();if(!d)return null;let h=await c.select().from(f.tradeTags).where((0,g.eq)(f.tradeTags.tradeId,a));return{...d,tags:h.map(a=>a.tagId)}}async function m(a){let b=await j(),c=(0,e.getDb)(),{tags:d,...g}=a,h={...g,userId:b.id,createdAt:new Date,updatedAt:new Date};if(await c.insert(f.trades).values(h),d&&d.length>0)for(let a of d)await c.insert(f.tradeTags).values({tradeId:h.id,tagId:a});return(0,i.revalidatePath)("/trades"),(0,i.revalidatePath)("/"),(0,i.revalidatePath)("/reports"),{success:!0}}async function n(a,b){let c=await j(),d=(0,e.getDb)(),{tags:h,...k}=b;if(Object.keys(k).length>0&&await d.update(f.trades).set({...k,updatedAt:new Date}).where((0,g.and)((0,g.eq)(f.trades.id,a),(0,g.eq)(f.trades.userId,c.id))),void 0!==h&&(await d.delete(f.tradeTags).where((0,g.eq)(f.tradeTags.tradeId,a)),h.length>0))for(let b of h)await d.insert(f.tradeTags).values({tradeId:a,tagId:b});return(0,i.revalidatePath)("/trades"),(0,i.revalidatePath)(`/trades/${a}`),(0,i.revalidatePath)("/"),(0,i.revalidatePath)("/reports"),{success:!0}}async function o(a){let b=await j(),c=(0,e.getDb)();return await c.delete(f.trades).where((0,g.and)((0,g.eq)(f.trades.id,a),(0,g.eq)(f.trades.userId,b.id))),(0,i.revalidatePath)("/trades"),(0,i.revalidatePath)("/"),(0,i.revalidatePath)("/reports"),{success:!0}}(0,a.i(13095).ensureServerEntryExports)([k,l,m,n,o]),(0,b.registerServerReference)(k,"003bdb41977fafc385b089ea1b1a363d738935fdfc",null),(0,b.registerServerReference)(l,"404d76a0830acf0ac4288e23290c039cbd3c7de1ce",null),(0,b.registerServerReference)(m,"40a6cc6f1f2178696141d579a69bfb77252b4d97f8",null),(0,b.registerServerReference)(n,"60ebe67b8ff8ece876c43cb6478d274e72270a4de9",null),(0,b.registerServerReference)(o,"40ff44ff1593cccb6762fa1dfdda55b4f154bce892",null),a.s(["createTrade",()=>m,"deleteTrade",()=>o,"getTrade",()=>l,"getTrades",()=>k,"updateTrade",()=>n])},55249,a=>{"use strict";var b=a.i(47844);a.s([],38237),a.i(38237),a.s(["003bdb41977fafc385b089ea1b1a363d738935fdfc",()=>b.getTrades,"404d76a0830acf0ac4288e23290c039cbd3c7de1ce",()=>b.getTrade,"40a6cc6f1f2178696141d579a69bfb77252b4d97f8",()=>b.createTrade,"40ff44ff1593cccb6762fa1dfdda55b4f154bce892",()=>b.deleteTrade,"60ebe67b8ff8ece876c43cb6478d274e72270a4de9",()=>b.updateTrade],55249)},80487,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_bun-sqlite-dialect-C3P_ISb5_mjs_579c5392._.js"].map(b=>a.l(b))).then(()=>b(66292)))},97873,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_node-sqlite-dialect-D6w8Ekdz_mjs_a3ae38cf._.js"].map(b=>a.l(b))).then(()=>b(35607)))},88010,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_adapters_memory-adapter_index_mjs_35d2dbfd._.js"].map(b=>a.l(b))).then(()=>b(31)))},60484,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_adapters_kysely-adapter_index_mjs_0abbd964._.js"].map(b=>a.l(b))).then(()=>b(36063)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__542fee90._.js.map