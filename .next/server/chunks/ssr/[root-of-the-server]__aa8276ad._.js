module.exports=[25372,(a,b,c)=>{b.exports=a.x("better-sqlite3",()=>require("better-sqlite3"))},22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},47844,a=>{"use strict";var b=a.i(37936),c=a.i(9223),d=a.i(5246),e=a.i(66879),f=a.i(15545),g=a.i(93321),h=a.i(30385),i=a.i(18558);async function j(){let a=await c.auth.api.getSession({headers:await (0,d.headers)()});if(!a?.user)throw Error("Unauthorized");return a.user}async function k(){let a=await j(),b=(0,e.getDb)(),c=await b.select().from(f.trades).where((0,g.eq)(f.trades.userId,a.id)).orderBy((0,h.desc)(f.trades.date)),d=c.map(a=>a.id),i={};return d.length>0&&(await b.select().from(f.tradeTags).where((0,g.inArray)(f.tradeTags.tradeId,d))).forEach(a=>{i[a.tradeId]||(i[a.tradeId]=[]),i[a.tradeId].push(a.tagId)}),c.map(a=>({...a,tags:i[a.id]||[]}))}async function l(a){let b=await j(),c=(0,e.getDb)(),d=await c.select().from(f.trades).where((0,g.and)((0,g.eq)(f.trades.id,a),(0,g.eq)(f.trades.userId,b.id))).get();if(!d)return null;let h=await c.select().from(f.tradeTags).where((0,g.eq)(f.tradeTags.tradeId,a));return{...d,tags:h.map(a=>a.tagId)}}async function m(a){let b=await j(),c=(0,e.getDb)(),{tags:d,...g}=a,h={...g,userId:b.id,createdAt:new Date,updatedAt:new Date};if(await c.insert(f.trades).values(h),d&&d.length>0)for(let a of d)await c.insert(f.tradeTags).values({tradeId:h.id,tagId:a});return(0,i.revalidatePath)("/trades"),(0,i.revalidatePath)("/"),(0,i.revalidatePath)("/reports"),{success:!0}}async function n(a,b){let c=await j(),d=(0,e.getDb)(),{tags:h,...k}=b;if(Object.keys(k).length>0&&await d.update(f.trades).set({...k,updatedAt:new Date}).where((0,g.and)((0,g.eq)(f.trades.id,a),(0,g.eq)(f.trades.userId,c.id))),void 0!==h&&(await d.delete(f.tradeTags).where((0,g.eq)(f.tradeTags.tradeId,a)),h.length>0))for(let b of h)await d.insert(f.tradeTags).values({tradeId:a,tagId:b});return(0,i.revalidatePath)("/trades"),(0,i.revalidatePath)(`/trades/${a}`),(0,i.revalidatePath)("/"),(0,i.revalidatePath)("/reports"),{success:!0}}async function o(a){let b=await j(),c=(0,e.getDb)();return await c.delete(f.trades).where((0,g.and)((0,g.eq)(f.trades.id,a),(0,g.eq)(f.trades.userId,b.id))),(0,i.revalidatePath)("/trades"),(0,i.revalidatePath)("/"),(0,i.revalidatePath)("/reports"),{success:!0}}(0,a.i(13095).ensureServerEntryExports)([k,l,m,n,o]),(0,b.registerServerReference)(k,"003bdb41977fafc385b089ea1b1a363d738935fdfc",null),(0,b.registerServerReference)(l,"404d76a0830acf0ac4288e23290c039cbd3c7de1ce",null),(0,b.registerServerReference)(m,"40a6cc6f1f2178696141d579a69bfb77252b4d97f8",null),(0,b.registerServerReference)(n,"60ebe67b8ff8ece876c43cb6478d274e72270a4de9",null),(0,b.registerServerReference)(o,"40ff44ff1593cccb6762fa1dfdda55b4f154bce892",null),a.s(["createTrade",()=>m,"deleteTrade",()=>o,"getTrade",()=>l,"getTrades",()=>k,"updateTrade",()=>n])},82446,a=>{"use strict";var b=a.i(37936),c=a.i(9223),d=a.i(5246),e=a.i(66879),f=a.i(15545),g=a.i(93321),h=a.i(18558);async function i(){let a=await c.auth.api.getSession({headers:await (0,d.headers)()});if(!a?.user)throw Error("Unauthorized");return a.user}async function j(){let a=await i(),b=(0,e.getDb)(),c=await b.select().from(f.categories).where((0,g.eq)(f.categories.userId,a.id)),d=await b.select().from(f.tags).where((0,g.eq)(f.tags.userId,a.id));return c.map(a=>({...a,tags:d.filter(b=>b.categoryId===a.id)}))}async function k(a){let b=await i(),c=(0,e.getDb)();return await c.insert(f.categories).values({...a,userId:b.id}),(0,h.revalidatePath)("/tags"),(0,h.revalidatePath)("/reports"),{success:!0}}async function l(a){let b=await i(),c=(0,e.getDb)();return await c.delete(f.categories).where((0,g.and)((0,g.eq)(f.categories.id,a),(0,g.eq)(f.categories.userId,b.id))),(0,h.revalidatePath)("/tags"),{success:!0}}async function m(a,b){let c=await i(),d=(0,e.getDb)();return await d.update(f.categories).set({...b,updatedAt:new Date}).where((0,g.and)((0,g.eq)(f.categories.id,a),(0,g.eq)(f.categories.userId,c.id))),b.color&&await d.update(f.tags).set({color:b.color}).where((0,g.and)((0,g.eq)(f.tags.categoryId,a),(0,g.eq)(f.tags.userId,c.id))),(0,h.revalidatePath)("/tags"),{success:!0}}async function n(a){let b=await i(),c=(0,e.getDb)();return await c.insert(f.tags).values({...a,userId:b.id}),(0,h.revalidatePath)("/tags"),{success:!0}}async function o(a){let b=await i(),c=(0,e.getDb)();return await c.delete(f.tags).where((0,g.and)((0,g.eq)(f.tags.id,a),(0,g.eq)(f.tags.userId,b.id))),(0,h.revalidatePath)("/tags"),{success:!0}}(0,a.i(13095).ensureServerEntryExports)([j,k,l,m,n,o]),(0,b.registerServerReference)(j,"0053c2991b153a5bfd651fb43ef45a92e50dedd5aa",null),(0,b.registerServerReference)(k,"40265b30102208e2dbfd12633e96636836ce67eda6",null),(0,b.registerServerReference)(l,"40a11be9358d3ebe9de33ae0c86d1ada70bf8b7562",null),(0,b.registerServerReference)(m,"6027cde55327f090e4abf24830ed1af39fdc545367",null),(0,b.registerServerReference)(n,"406890b07abd01545dd838dd5e595466dd49672ebd",null),(0,b.registerServerReference)(o,"40483b3fa33e4e7224b9332c539e22dffe6158a91c",null),a.s(["createCategory",()=>k,"createTag",()=>n,"deleteCategory",()=>l,"deleteTag",()=>o,"getCategories",()=>j,"updateCategory",()=>m])},41705,a=>{"use strict";var b=a.i(47844),c=a.i(82446);a.s([],45200),a.i(45200),a.s(["003bdb41977fafc385b089ea1b1a363d738935fdfc",()=>b.getTrades,"0053c2991b153a5bfd651fb43ef45a92e50dedd5aa",()=>c.getCategories,"40265b30102208e2dbfd12633e96636836ce67eda6",()=>c.createCategory,"40483b3fa33e4e7224b9332c539e22dffe6158a91c",()=>c.deleteTag,"404d76a0830acf0ac4288e23290c039cbd3c7de1ce",()=>b.getTrade,"406890b07abd01545dd838dd5e595466dd49672ebd",()=>c.createTag,"40a11be9358d3ebe9de33ae0c86d1ada70bf8b7562",()=>c.deleteCategory,"40a6cc6f1f2178696141d579a69bfb77252b4d97f8",()=>b.createTrade,"40ff44ff1593cccb6762fa1dfdda55b4f154bce892",()=>b.deleteTrade,"6027cde55327f090e4abf24830ed1af39fdc545367",()=>c.updateCategory,"60ebe67b8ff8ece876c43cb6478d274e72270a4de9",()=>b.updateTrade],41705)},80487,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_bun-sqlite-dialect-C3P_ISb5_mjs_579c5392._.js"].map(b=>a.l(b))).then(()=>b(66292)))},97873,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_node-sqlite-dialect-D6w8Ekdz_mjs_a3ae38cf._.js"].map(b=>a.l(b))).then(()=>b(35607)))},88010,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_adapters_memory-adapter_index_mjs_35d2dbfd._.js"].map(b=>a.l(b))).then(()=>b(31)))},60484,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_adapters_kysely-adapter_index_mjs_0abbd964._.js"].map(b=>a.l(b))).then(()=>b(36063)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__aa8276ad._.js.map