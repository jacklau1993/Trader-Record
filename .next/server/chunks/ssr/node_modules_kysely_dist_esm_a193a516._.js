module.exports=[52460,a=>{"use strict";function b(a){return void 0===a||void 0===a}function c(a){return"string"==typeof a}function d(a){return"number"==typeof a}function e(a){return"boolean"==typeof a}function f(a){return null===a}function g(a){return a instanceof Date}function h(a){return"bigint"==typeof a}function i(a){return"undefined"!=typeof Buffer&&Buffer.isBuffer(a)}function j(a){return"function"==typeof a}function k(a){return"object"==typeof a&&null!==a}function l(a){return a[a.length-1]}function m(a){return Object.freeze(a)}function n(a){return o(a)?a:[a]}function o(a){return Array.isArray(a)}function p(a){return a}Object.prototype.toString,a.s(["asArray",()=>n,"freeze",()=>m,"getLast",()=>l,"isBigInt",()=>h,"isBoolean",()=>e,"isBuffer",()=>i,"isDate",()=>g,"isFunction",()=>j,"isNull",()=>f,"isNumber",()=>d,"isObject",()=>k,"isReadonlyArray",()=>o,"isString",()=>c,"isUndefined",()=>b,"noop",()=>p])},20860,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"IdentifierNode"===a.kind,create:a=>(0,b.freeze)({kind:"IdentifierNode",name:a})});a.s(["IdentifierNode",0,c])},19945,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"CreateTableNode"===a.kind,create:a=>(0,b.freeze)({kind:"CreateTableNode",table:a,columns:(0,b.freeze)([])}),cloneWithColumn:(a,c)=>(0,b.freeze)({...a,columns:(0,b.freeze)([...a.columns,c])}),cloneWithConstraint:(a,c)=>(0,b.freeze)({...a,constraints:a.constraints?(0,b.freeze)([...a.constraints,c]):(0,b.freeze)([c])}),cloneWithFrontModifier:(a,c)=>(0,b.freeze)({...a,frontModifiers:a.frontModifiers?(0,b.freeze)([...a.frontModifiers,c]):(0,b.freeze)([c])}),cloneWithEndModifier:(a,c)=>(0,b.freeze)({...a,endModifiers:a.endModifiers?(0,b.freeze)([...a.endModifiers,c]):(0,b.freeze)([c])}),cloneWith:(a,c)=>(0,b.freeze)({...a,...c})});a.s(["CreateTableNode",0,c,"ON_COMMIT_ACTIONS",0,["preserve rows","delete rows","drop"]])},8896,a=>{"use strict";var b=a.i(52460),c=a.i(20860);let d=(0,b.freeze)({is:a=>"SchemableIdentifierNode"===a.kind,create:a=>(0,b.freeze)({kind:"SchemableIdentifierNode",identifier:c.IdentifierNode.create(a)}),createWithSchema:(a,d)=>(0,b.freeze)({kind:"SchemableIdentifierNode",schema:c.IdentifierNode.create(a),identifier:c.IdentifierNode.create(d)})});a.s(["SchemableIdentifierNode",0,d])},24054,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"AliasNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"AliasNode",node:a,alias:c})});a.s(["AliasNode",0,c])},6770,a=>{"use strict";var b=a.i(52460),c=a.i(8896);let d=(0,b.freeze)({is:a=>"TableNode"===a.kind,create:a=>(0,b.freeze)({kind:"TableNode",table:c.SchemableIdentifierNode.create(a)}),createWithSchema:(a,d)=>(0,b.freeze)({kind:"TableNode",table:c.SchemableIdentifierNode.createWithSchema(a,d)})});a.s(["TableNode",0,d])},58758,a=>{"use strict";var b=a.i(52460);function c(a){return(0,b.isObject)(a)&&(0,b.isFunction)(a.toOperationNode)}a.s(["isOperationNodeSource",()=>c])},635,67653,a=>{"use strict";var b=a.i(58758),c=a.i(52460);function d(a){return(0,c.isObject)(a)&&"expressionType"in a&&(0,b.isOperationNodeSource)(a)}function e(a){return(0,c.isObject)(a)&&"expression"in a&&(0,c.isString)(a.alias)&&(0,b.isOperationNodeSource)(a)}a.s(["isAliasedExpression",()=>e,"isExpression",()=>d],635);let f=(0,c.freeze)({is:a=>"SelectModifierNode"===a.kind,create:(a,b)=>(0,c.freeze)({kind:"SelectModifierNode",modifier:a,of:b}),createWithExpression:a=>(0,c.freeze)({kind:"SelectModifierNode",rawModifier:a})});a.s(["SelectModifierNode",0,f],67653)},67319,51861,25283,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"AndNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"AndNode",left:a,right:c})});a.s(["AndNode",0,c],51861);let d=(0,b.freeze)({is:a=>"OrNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"OrNode",left:a,right:c})});a.s(["OrNode",0,d],25283);let e=(0,b.freeze)({is:a=>"OnNode"===a.kind,create:a=>(0,b.freeze)({kind:"OnNode",on:a}),cloneWithOperation:(a,e,f)=>(0,b.freeze)({...a,on:"And"===e?c.create(a.on,f):d.create(a.on,f)})}),f=(0,b.freeze)({is:a=>"JoinNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"JoinNode",joinType:a,table:c,on:void 0}),createWithOn:(a,c,d)=>(0,b.freeze)({kind:"JoinNode",joinType:a,table:c,on:e.create(d)}),cloneWithOn:(a,c)=>(0,b.freeze)({...a,on:a.on?e.cloneWithOperation(a.on,"And",c):e.create(c)})});a.s(["JoinNode",0,f],67319)},44447,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"BinaryOperationNode"===a.kind,create:(a,c,d)=>(0,b.freeze)({kind:"BinaryOperationNode",leftOperand:a,operator:c,rightOperand:d})});a.s(["BinaryOperationNode",0,c])},13123,a=>{"use strict";var b=a.i(52460);let c=["->","->>"],d=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","^@","&&","?","?&","?|","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from","+","-","*","/","%","^","&","|","#","<<",">>","&&","||",...c,"not","-","exists","not exists","between","between symmetric"],e=(0,b.freeze)({is:a=>"OperatorNode"===a.kind,create:a=>(0,b.freeze)({kind:"OperatorNode",operator:a})});function f(a){return(0,b.isString)(a)&&c.includes(a)}a.s(["OPERATORS",0,d,"OperatorNode",0,e,"isJSONOperator",()=>f])},40672,98722,62088,a=>{"use strict";var b=a.i(52460),c=a.i(20860);let d=(0,b.freeze)({is:a=>"ColumnNode"===a.kind,create:a=>(0,b.freeze)({kind:"ColumnNode",column:c.IdentifierNode.create(a)})});a.s(["ColumnNode",0,d],40672);let e=(0,b.freeze)({is:a=>"SelectAllNode"===a.kind,create:()=>(0,b.freeze)({kind:"SelectAllNode"})});a.s(["SelectAllNode",0,e],98722);let f=(0,b.freeze)({is:a=>"ReferenceNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"ReferenceNode",table:c,column:a}),createSelectAll:a=>(0,b.freeze)({kind:"ReferenceNode",table:a,column:e.create()})});a.s(["ReferenceNode",0,f],62088)},27675,22703,a=>{"use strict";a.s(["DynamicReferenceBuilder",()=>e,"isDynamicReferenceBuilder",()=>f],27675);var b=a.i(58758),c=a.i(89774),d=a.i(52460);class e{#a;get dynamicReference(){return this.#a}get refType(){}constructor(a){this.#a=a}toOperationNode(){return(0,c.parseSimpleReferenceExpression)(this.#a)}}function f(a){return(0,d.isObject)(a)&&(0,b.isOperationNodeSource)(a)&&(0,d.isString)(a.dynamicReference)}let g=(0,d.freeze)({is:a=>"OrderByItemNode"===a.kind,create:(a,b)=>(0,d.freeze)({kind:"OrderByItemNode",orderBy:a,direction:b}),cloneWith:(a,b)=>(0,d.freeze)({...a,...b})});a.s(["OrderByItemNode",0,g],22703)},93807,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"RawNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"RawNode",sqlFragments:(0,b.freeze)(a),parameters:(0,b.freeze)(c)}),createWithSql:a=>c.create([a],[]),createWithChild:a=>c.create(["",""],[a]),createWithChildren:a=>c.create(Array(a.length+1).fill(""),a)});a.s(["RawNode",0,c])},76752,a=>{"use strict";var b=a.i(52460),c=a.i(20860),d=a.i(22703),e=a.i(93807);class f{#b;constructor(a){this.#b=(0,b.freeze)(a)}desc(){return new f({node:d.OrderByItemNode.cloneWith(this.#b.node,{direction:e.RawNode.createWithSql("desc")})})}asc(){return new f({node:d.OrderByItemNode.cloneWith(this.#b.node,{direction:e.RawNode.createWithSql("asc")})})}nullsLast(){return new f({node:d.OrderByItemNode.cloneWith(this.#b.node,{nulls:"last"})})}nullsFirst(){return new f({node:d.OrderByItemNode.cloneWith(this.#b.node,{nulls:"first"})})}collate(a){let e;return new f({node:d.OrderByItemNode.cloneWith(this.#b.node,{collation:(e=a,(0,b.freeze)({kind:"CollateNode",collation:c.IdentifierNode.create(e)}))})})}toOperationNode(){return this.#b.node}}a.s(["OrderByItemBuilder",()=>f],76752)},28283,a=>{"use strict";let b=new Set;function c(a){b.has(a)||(b.add(a),console.log(a))}a.s(["logOnce",()=>c])},95398,a=>{"use strict";a.s(["isOrderByDirection",()=>j,"parseOrderBy",()=>k]);var b=a.i(27675),c=a.i(635),d=a.i(22703),e=a.i(93807),f=a.i(76752),g=a.i(28283),h=a.i(4789),i=a.i(89774);function j(a){return"asc"===a||"desc"===a}function k(a){if(2===a.length)return[l(a[0],a[1])];if(1===a.length){let[b]=a;return Array.isArray(b)?((0,g.logOnce)("orderBy(array) is deprecated, use multiple orderBy calls instead."),b.map(a=>l(a))):[l(b)]}throw Error(`Invalid number of arguments at order by! expected 1-2, received ${a.length}`)}function l(a,c){let e=function(a){if((0,h.isExpressionOrFactory)(a))return(0,h.parseExpression)(a);if((0,b.isDynamicReferenceBuilder)(a))return a.toOperationNode();let[c,d]=a.split(" ");return d?((0,g.logOnce)("`orderBy('column asc')` is deprecated. Use `orderBy('column', 'asc')` instead."),m((0,i.parseStringReference)(c),d)):(0,i.parseStringReference)(a)}(a);if(d.OrderByItemNode.is(e)){if(c)throw Error("Cannot specify direction twice!");return e}return m(e,c)}function m(a,b){if("string"==typeof b){if(!j(b))throw Error(`Invalid order by direction: ${b}`);return d.OrderByItemNode.create(a,e.RawNode.createWithSql(b))}if((0,c.isExpression)(b))return(0,g.logOnce)("`orderBy(..., expr)` is deprecated. Use `orderBy(..., 'asc')` or `orderBy(..., (ob) => ...)` instead."),d.OrderByItemNode.create(a,b.toOperationNode());let h=d.OrderByItemNode.create(a);return b?b(new f.OrderByItemBuilder({node:h})).toOperationNode():h}},91362,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"JSONReferenceNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"JSONReferenceNode",reference:a,traversal:c}),cloneWithTraversal:(a,c)=>(0,b.freeze)({...a,traversal:c})});a.s(["JSONReferenceNode",0,c])},85134,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"JSONOperatorChainNode"===a.kind,create:a=>(0,b.freeze)({kind:"JSONOperatorChainNode",operator:a,values:(0,b.freeze)([])}),cloneWithValue:(a,c)=>(0,b.freeze)({...a,values:(0,b.freeze)([...a.values,c])})});a.s(["JSONOperatorChainNode",0,c])},52738,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"JSONPathNode"===a.kind,create:a=>(0,b.freeze)({kind:"JSONPathNode",inOperator:a,pathLegs:(0,b.freeze)([])}),cloneWithLeg:(a,c)=>(0,b.freeze)({...a,pathLegs:(0,b.freeze)([...a.pathLegs,c])})});a.s(["JSONPathNode",0,c])},89774,a=>{"use strict";a.s(["parseAliasedStringReference",()=>s,"parseColumnName",()=>t,"parseJSONReference",()=>q,"parseOrderedColumnName",()=>u,"parseReferenceExpression",()=>p,"parseReferenceExpressionOrList",()=>o,"parseSimpleReferenceExpression",()=>n,"parseStringReference",()=>r]);var b=a.i(24054),c=a.i(40672),d=a.i(62088),e=a.i(6770),f=a.i(52460),g=a.i(4789),h=a.i(20860),i=a.i(95398),j=a.i(13123),k=a.i(91362),l=a.i(85134),m=a.i(52738);function n(a){return(0,f.isString)(a)?r(a):a.toOperationNode()}function o(a){return(0,f.isReadonlyArray)(a)?a.map(a=>p(a)):[p(a)]}function p(a){return(0,g.isExpressionOrFactory)(a)?(0,g.parseExpression)(a):n(a)}function q(a,b){let c=r(a);if((0,j.isJSONOperator)(b))return k.JSONReferenceNode.create(c,l.JSONOperatorChainNode.create(j.OperatorNode.create(b)));let d=b.slice(0,-1);if((0,j.isJSONOperator)(d))return k.JSONReferenceNode.create(c,m.JSONPathNode.create(j.OperatorNode.create(d)));throw Error(`Invalid JSON operator: ${b}`)}function r(a){if(!a.includes("."))return d.ReferenceNode.create(c.ColumnNode.create(a));let b=a.split(".").map(v);if(3===b.length)return function(a){let[b,f,g]=a;return d.ReferenceNode.create(c.ColumnNode.create(g),e.TableNode.createWithSchema(b,f))}(b);if(2===b.length)return function(a){let[b,f]=a;return d.ReferenceNode.create(c.ColumnNode.create(f),e.TableNode.create(b))}(b);throw Error(`invalid column reference ${a}`)}function s(a){let c=" as ";if(!a.includes(c))return r(a);{let[d,e]=a.split(c).map(v);return b.AliasNode.create(r(d),h.IdentifierNode.create(e))}}function t(a){return c.ColumnNode.create(a)}function u(a){if(!a.includes(" "))return t(a);{let[b,c]=a.split(" ").map(v);if(!(0,i.isOrderByDirection)(c))throw Error(`invalid order direction "${c}" next to "${b}"`);return(0,i.parseOrderBy)([b,c])[0]}}function v(a){return a.trim()}},6285,72590,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"PrimitiveValueListNode"===a.kind,create:a=>(0,b.freeze)({kind:"PrimitiveValueListNode",values:(0,b.freeze)([...a])})});a.s(["PrimitiveValueListNode",0,c],6285);let d=(0,b.freeze)({is:a=>"ValueListNode"===a.kind,create:a=>(0,b.freeze)({kind:"ValueListNode",values:(0,b.freeze)(a)})});a.s(["ValueListNode",0,d],72590)},20033,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"ValueNode"===a.kind,create:a=>(0,b.freeze)({kind:"ValueNode",value:a}),createImmediate:a=>(0,b.freeze)({kind:"ValueNode",value:a,immediate:!0})});a.s(["ValueNode",0,c])},9638,a=>{"use strict";a.s(["isSafeImmediateValue",()=>i,"parseSafeImmediateValue",()=>j,"parseValueExpression",()=>h,"parseValueExpressionOrList",()=>g]);var b=a.i(6285),c=a.i(72590),d=a.i(20033),e=a.i(52460),f=a.i(4789);function g(a){var d;return(0,e.isReadonlyArray)(a)?(d=a).some(f.isExpressionOrFactory)?c.ValueListNode.create(d.map(a=>h(a))):b.PrimitiveValueListNode.create(d):h(a)}function h(a){return(0,f.isExpressionOrFactory)(a)?(0,f.parseExpression)(a):d.ValueNode.create(a)}function i(a){return(0,e.isNumber)(a)||(0,e.isBoolean)(a)||(0,e.isNull)(a)}function j(a){if(!i(a))throw Error(`unsafe immediate value ${JSON.stringify(a)}`);return d.ValueNode.createImmediate(a)}},77804,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"ParensNode"===a.kind,create:a=>(0,b.freeze)({kind:"ParensNode",node:a})});a.s(["ParensNode",0,c])},45228,78606,97107,88966,29890,80243,a=>{"use strict";a.s(["parseFilterList",()=>p,"parseFilterObject",()=>o,"parseReferentialBinaryOperation",()=>n,"parseValueBinaryOperation",()=>m,"parseValueBinaryOperationOrExpression",()=>l],45228);var b=a.i(44447),c=a.i(52460),d=a.i(58758),e=a.i(13123),f=a.i(89774),g=a.i(9638),h=a.i(20033),i=a.i(51861),j=a.i(77804),k=a.i(25283);function l(a){if(3===a.length)return m(a[0],a[1],a[2]);if(1===a.length)return(0,g.parseValueExpression)(a[0]);throw Error(`invalid arguments: ${JSON.stringify(a)}`)}function m(a,c,d){var e;return("is"===(e=c)||"is not"===e)&&q(d)?b.BinaryOperationNode.create((0,f.parseReferenceExpression)(a),r(c),h.ValueNode.createImmediate(d)):b.BinaryOperationNode.create((0,f.parseReferenceExpression)(a),r(c),(0,g.parseValueExpressionOrList)(d))}function n(a,c,d){return b.BinaryOperationNode.create((0,f.parseReferenceExpression)(a),r(c),(0,f.parseReferenceExpression)(d))}function o(a,b){return p(Object.entries(a).filter(([,a])=>!(0,c.isUndefined)(a)).map(([a,b])=>m(a,q(b)?"is":"=",b)),b)}function p(a,c,d=!0){let f="and"===c?i.AndNode.create:k.OrNode.create;if(0===a.length)return b.BinaryOperationNode.create(h.ValueNode.createImmediate(1),e.OperatorNode.create("="),h.ValueNode.createImmediate(+("and"===c)));let g=s(a[0]);for(let b=1;b<a.length;++b)g=f(g,s(a[b]));return a.length>1&&d?j.ParensNode.create(g):g}function q(a){return(0,c.isNull)(a)||(0,c.isBoolean)(a)}function r(a){if((0,c.isString)(a)&&e.OPERATORS.includes(a))return e.OperatorNode.create(a);if((0,d.isOperationNodeSource)(a))return a.toOperationNode();throw Error(`invalid operator ${JSON.stringify(a)}`)}function s(a){return(0,d.isOperationNodeSource)(a)?a.toOperationNode():a}let t=(0,c.freeze)({is:a=>"OrderByNode"===a.kind,create:a=>(0,c.freeze)({kind:"OrderByNode",items:(0,c.freeze)([...a])}),cloneWithItems:(a,b)=>(0,c.freeze)({...a,items:(0,c.freeze)([...a.items,...b])})});a.s(["OrderByNode",0,t],78606);let u=(0,c.freeze)({is:a=>"PartitionByNode"===a.kind,create:a=>(0,c.freeze)({kind:"PartitionByNode",items:(0,c.freeze)(a)}),cloneWithItems:(a,b)=>(0,c.freeze)({...a,items:(0,c.freeze)([...a.items,...b])})}),v=(0,c.freeze)({is:a=>"OverNode"===a.kind,create:()=>(0,c.freeze)({kind:"OverNode"}),cloneWithOrderByItems:(a,b)=>(0,c.freeze)({...a,orderBy:a.orderBy?t.cloneWithItems(a.orderBy,b):t.create(b)}),cloneWithPartitionByItems:(a,b)=>(0,c.freeze)({...a,partitionBy:a.partitionBy?u.cloneWithItems(a.partitionBy,b):u.create(b)})});a.s(["OverNode",0,v],97107);let w=(0,c.freeze)({is:a=>"FromNode"===a.kind,create:a=>(0,c.freeze)({kind:"FromNode",froms:(0,c.freeze)(a)}),cloneWithFroms:(a,b)=>(0,c.freeze)({...a,froms:(0,c.freeze)([...a.froms,...b])})});a.s(["FromNode",0,w],88966);let x=(0,c.freeze)({is:a=>"GroupByNode"===a.kind,create:a=>(0,c.freeze)({kind:"GroupByNode",items:(0,c.freeze)(a)}),cloneWithItems:(a,b)=>(0,c.freeze)({...a,items:(0,c.freeze)([...a.items,...b])})});a.s(["GroupByNode",0,x],29890);let y=(0,c.freeze)({is:a=>"HavingNode"===a.kind,create:a=>(0,c.freeze)({kind:"HavingNode",having:a}),cloneWithOperation:(a,b,d)=>(0,c.freeze)({...a,having:"And"===b?i.AndNode.create(a.having,d):k.OrNode.create(a.having,d)})});a.s(["HavingNode",0,y],80243)},19910,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"InsertQueryNode"===a.kind,create:(a,c,d)=>(0,b.freeze)({kind:"InsertQueryNode",into:a,...c&&{with:c},replace:d}),createWithoutInto:()=>(0,b.freeze)({kind:"InsertQueryNode"}),cloneWith:(a,c)=>(0,b.freeze)({...a,...c})});a.s(["InsertQueryNode",0,c])},34730,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"ListNode"===a.kind,create:a=>(0,b.freeze)({kind:"ListNode",items:(0,b.freeze)(a)})});a.s(["ListNode",0,c])},12475,48565,27466,867,37186,a=>{"use strict";var b=a.i(52460),c=a.i(88966),d=a.i(34730);let e=(0,b.freeze)({is:a=>"UpdateQueryNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"UpdateQueryNode",table:1===a.length?a[0]:d.ListNode.create(a),...c&&{with:c}}),createWithoutTable:()=>(0,b.freeze)({kind:"UpdateQueryNode"}),cloneWithFromItems:(a,d)=>(0,b.freeze)({...a,from:a.from?c.FromNode.cloneWithFroms(a.from,d):c.FromNode.create(d)}),cloneWithUpdates:(a,c)=>(0,b.freeze)({...a,updates:a.updates?(0,b.freeze)([...a.updates,...c]):c}),cloneWithLimit:(a,c)=>(0,b.freeze)({...a,limit:c})});a.s(["UpdateQueryNode",0,e],12475),a.s(["DeleteQueryNode",()=>h],48565);let f=(0,b.freeze)({is:a=>"UsingNode"===a.kind,create:a=>(0,b.freeze)({kind:"UsingNode",tables:(0,b.freeze)(a)}),cloneWithTables:(a,c)=>(0,b.freeze)({...a,tables:(0,b.freeze)([...a.tables,...c])})});var g=a.i(39399);let h=(0,b.freeze)({is:a=>"DeleteQueryNode"===a.kind,create:(a,d)=>(0,b.freeze)({kind:"DeleteQueryNode",from:c.FromNode.create(a),...d&&{with:d}}),cloneWithOrderByItems:(a,b)=>g.QueryNode.cloneWithOrderByItems(a,b),cloneWithoutOrderBy:a=>g.QueryNode.cloneWithoutOrderBy(a),cloneWithLimit:(a,c)=>(0,b.freeze)({...a,limit:c}),cloneWithoutLimit:a=>(0,b.freeze)({...a,limit:void 0}),cloneWithUsing:(a,c)=>(0,b.freeze)({...a,using:void 0!==a.using?f.cloneWithTables(a.using,c):f.create(c)})});var i=a.i(51861),j=a.i(25283);let k=(0,b.freeze)({is:a=>"WhereNode"===a.kind,create:a=>(0,b.freeze)({kind:"WhereNode",where:a}),cloneWithOperation:(a,c,d)=>(0,b.freeze)({...a,where:"And"===c?i.AndNode.create(a.where,d):j.OrNode.create(a.where,d)})});a.s(["WhereNode",0,k],27466);let l=(0,b.freeze)({is:a=>"ReturningNode"===a.kind,create:a=>(0,b.freeze)({kind:"ReturningNode",selections:(0,b.freeze)(a)}),cloneWithSelections:(a,c)=>(0,b.freeze)({...a,selections:a.selections?(0,b.freeze)([...a.selections,...c]):(0,b.freeze)(c)})});a.s(["ReturningNode",0,l],867);let m=(0,b.freeze)({is:a=>"ExplainNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"ExplainNode",format:a,options:c})});a.s(["ExplainNode",0,m],37186)},99297,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"WhenNode"===a.kind,create:a=>(0,b.freeze)({kind:"WhenNode",condition:a}),cloneWithResult:(a,c)=>(0,b.freeze)({...a,result:c})});a.s(["WhenNode",0,c])},41595,37193,39399,84873,a=>{"use strict";a.s(["SelectQueryNode",()=>q],41595);var b=a.i(52460),c=a.i(88966),d=a.i(29890),e=a.i(80243);a.s(["QueryNode",()=>p],39399);var f=a.i(19910),g=a.i(12475),h=a.i(48565),i=a.i(27466),j=a.i(867),k=a.i(37186),l=a.i(99297);let m=(0,b.freeze)({is:a=>"MergeQueryNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"MergeQueryNode",into:a,...c&&{with:c}}),cloneWithUsing:(a,c)=>(0,b.freeze)({...a,using:c}),cloneWithWhen:(a,c)=>(0,b.freeze)({...a,whens:a.whens?(0,b.freeze)([...a.whens,c]):(0,b.freeze)([c])}),cloneWithThen:(a,c)=>(0,b.freeze)({...a,whens:a.whens?(0,b.freeze)([...a.whens.slice(0,-1),l.WhenNode.cloneWithResult(a.whens[a.whens.length-1],c)]):void 0})});a.s(["MergeQueryNode",0,m],37193);let n=(0,b.freeze)({is:a=>"OutputNode"===a.kind,create:a=>(0,b.freeze)({kind:"OutputNode",selections:(0,b.freeze)(a)}),cloneWithSelections:(a,c)=>(0,b.freeze)({...a,selections:a.selections?(0,b.freeze)([...a.selections,...c]):(0,b.freeze)(c)})});var o=a.i(78606);let p=(0,b.freeze)({is:a=>q.is(a)||f.InsertQueryNode.is(a)||g.UpdateQueryNode.is(a)||h.DeleteQueryNode.is(a)||m.is(a),cloneWithEndModifier:(a,c)=>(0,b.freeze)({...a,endModifiers:a.endModifiers?(0,b.freeze)([...a.endModifiers,c]):(0,b.freeze)([c])}),cloneWithWhere:(a,c)=>(0,b.freeze)({...a,where:a.where?i.WhereNode.cloneWithOperation(a.where,"And",c):i.WhereNode.create(c)}),cloneWithJoin:(a,c)=>(0,b.freeze)({...a,joins:a.joins?(0,b.freeze)([...a.joins,c]):(0,b.freeze)([c])}),cloneWithReturning:(a,c)=>(0,b.freeze)({...a,returning:a.returning?j.ReturningNode.cloneWithSelections(a.returning,c):j.ReturningNode.create(c)}),cloneWithoutReturning:a=>(0,b.freeze)({...a,returning:void 0}),cloneWithoutWhere:a=>(0,b.freeze)({...a,where:void 0}),cloneWithExplain:(a,c,d)=>(0,b.freeze)({...a,explain:k.ExplainNode.create(c,d?.toOperationNode())}),cloneWithTop:(a,c)=>(0,b.freeze)({...a,top:c}),cloneWithOutput:(a,c)=>(0,b.freeze)({...a,output:a.output?n.cloneWithSelections(a.output,c):n.create(c)}),cloneWithOrderByItems:(a,c)=>(0,b.freeze)({...a,orderBy:a.orderBy?o.OrderByNode.cloneWithItems(a.orderBy,c):o.OrderByNode.create(c)}),cloneWithoutOrderBy:a=>(0,b.freeze)({...a,orderBy:void 0})}),q=(0,b.freeze)({is:a=>"SelectQueryNode"===a.kind,create:a=>(0,b.freeze)({kind:"SelectQueryNode",...a&&{with:a}}),createFrom:(a,d)=>(0,b.freeze)({kind:"SelectQueryNode",from:c.FromNode.create(a),...d&&{with:d}}),cloneWithSelections:(a,c)=>(0,b.freeze)({...a,selections:a.selections?(0,b.freeze)([...a.selections,...c]):(0,b.freeze)(c)}),cloneWithDistinctOn:(a,c)=>(0,b.freeze)({...a,distinctOn:a.distinctOn?(0,b.freeze)([...a.distinctOn,...c]):(0,b.freeze)(c)}),cloneWithFrontModifier:(a,c)=>(0,b.freeze)({...a,frontModifiers:a.frontModifiers?(0,b.freeze)([...a.frontModifiers,c]):(0,b.freeze)([c])}),cloneWithOrderByItems:(a,b)=>p.cloneWithOrderByItems(a,b),cloneWithGroupByItems:(a,c)=>(0,b.freeze)({...a,groupBy:a.groupBy?d.GroupByNode.cloneWithItems(a.groupBy,c):d.GroupByNode.create(c)}),cloneWithLimit:(a,c)=>(0,b.freeze)({...a,limit:c}),cloneWithOffset:(a,c)=>(0,b.freeze)({...a,offset:c}),cloneWithFetch:(a,c)=>(0,b.freeze)({...a,fetch:c}),cloneWithHaving:(a,c)=>(0,b.freeze)({...a,having:a.having?e.HavingNode.cloneWithOperation(a.having,"And",c):e.HavingNode.create(c)}),cloneWithSetOperations:(a,c)=>(0,b.freeze)({...a,setOperations:a.setOperations?(0,b.freeze)([...a.setOperations,...c]):(0,b.freeze)([...c])}),cloneWithoutSelections:a=>(0,b.freeze)({...a,selections:[]}),cloneWithoutLimit:a=>(0,b.freeze)({...a,limit:void 0}),cloneWithoutOffset:a=>(0,b.freeze)({...a,offset:void 0}),cloneWithoutOrderBy:a=>p.cloneWithoutOrderBy(a),cloneWithoutGroupBy:a=>(0,b.freeze)({...a,groupBy:void 0})});a.s(["JoinBuilder",()=>u],84873);var r=a.i(67319),s=a.i(93807),t=a.i(45228);class u{#b;constructor(a){this.#b=(0,b.freeze)(a)}on(...a){return new u({...this.#b,joinNode:r.JoinNode.cloneWithOn(this.#b.joinNode,(0,t.parseValueBinaryOperationOrExpression)(a))})}onRef(a,b,c){return new u({...this.#b,joinNode:r.JoinNode.cloneWithOn(this.#b.joinNode,(0,t.parseReferentialBinaryOperation)(a,b,c))})}onTrue(){return new u({...this.#b,joinNode:r.JoinNode.cloneWithOn(this.#b.joinNode,s.RawNode.createWithSql("true"))})}$call(a){return a(this)}toOperationNode(){return this.#b.joinNode}}},75476,14789,a=>{"use strict";a.s(["OverBuilder",()=>h],75476);var b=a.i(97107),c=a.i(39399),d=a.i(95398),e=a.i(52460);let f=(0,e.freeze)({is:a=>"PartitionByItemNode"===a.kind,create:a=>(0,e.freeze)({kind:"PartitionByItemNode",partitionBy:a})});var g=a.i(89774);class h{#b;constructor(a){this.#b=(0,e.freeze)(a)}orderBy(...a){return new h({overNode:b.OverNode.cloneWithOrderByItems(this.#b.overNode,(0,d.parseOrderBy)(a))})}clearOrderBy(){return new h({overNode:c.QueryNode.cloneWithoutOrderBy(this.#b.overNode)})}partitionBy(a){return new h({overNode:b.OverNode.cloneWithPartitionByItems(this.#b.overNode,(0,g.parseReferenceExpressionOrList)(a).map(f.create))})}$call(a){return a(this)}toOperationNode(){return this.#b.overNode}}var i=a.i(62088),j=a.i(98722);let k=(0,e.freeze)({is:a=>"SelectionNode"===a.kind,create:a=>(0,e.freeze)({kind:"SelectionNode",selection:a}),createSelectAll:()=>(0,e.freeze)({kind:"SelectionNode",selection:j.SelectAllNode.create()}),createSelectAllFromTable:a=>(0,e.freeze)({kind:"SelectionNode",selection:i.ReferenceNode.createSelectAll(a)})});a.s(["SelectionNode",0,k],14789)},7599,44891,84257,49957,78969,33635,71340,57507,76375,95305,a=>{"use strict";a.s(["InsertQueryBuilder",()=>L],7599),a.s(["parseSelectAll",()=>k,"parseSelectArg",()=>i],44891);var b=a.i(52460),c=a.i(14789),d=a.i(89774),e=a.i(27675),f=a.i(4789),g=a.i(66101),h=a.i(97806);function i(a){return(0,b.isFunction)(a)?i(a((0,h.expressionBuilder)())):(0,b.isReadonlyArray)(a)?a.map(a=>j(a)):[j(a)]}function j(a){return(0,b.isString)(a)?c.SelectionNode.create((0,d.parseAliasedStringReference)(a)):(0,e.isDynamicReferenceBuilder)(a)?c.SelectionNode.create(a.toOperationNode()):c.SelectionNode.create((0,f.parseAliasedExpression)(a))}function k(a){return a?Array.isArray(a)?a.map(l):[l(a)]:[c.SelectionNode.createSelectAll()]}function l(a){if((0,b.isString)(a))return c.SelectionNode.createSelectAllFromTable((0,g.parseTable)(a));throw Error(`invalid value selectAll expression: ${JSON.stringify(a)}`)}a.s(["parseInsertExpression",()=>s],84257);var m=a.i(40672),n=a.i(6285),o=a.i(72590),p=a.i(9638);let q=(0,b.freeze)({is:a=>"ValuesNode"===a.kind,create:a=>(0,b.freeze)({kind:"ValuesNode",values:(0,b.freeze)(a)})}),r=(0,b.freeze)({is:a=>"DefaultInsertValueNode"===a.kind,create:()=>(0,b.freeze)({kind:"DefaultInsertValueNode"})});function s(a){var c;let d,e=(0,b.isFunction)(a)?a((0,h.expressionBuilder)()):a;return d=function(a){let b=new Map;for(let c of a)for(let a of Object.keys(c))b.has(a)||void 0===c[a]||b.set(a,b.size);return b}(c=(0,b.isReadonlyArray)(e)?e:(0,b.freeze)([e])),[(0,b.freeze)([...d.keys()].map(m.ColumnNode.create)),q.create(c.map(a=>(function(a,c){let d=Object.keys(a),e=Array.from({length:c.size}),g=!1,h=d.length;for(let i of d){let d=c.get(i);if((0,b.isUndefined)(d)){h--;continue}let j=a[i];((0,b.isUndefined)(j)||(0,f.isExpressionOrFactory)(j))&&(g=!0),e[d]=j}if(h<c.size||g){let a=r.create();return o.ValueListNode.create(e.map(c=>(0,b.isUndefined)(c)?a:(0,p.parseValueExpression)(c)))}return n.PrimitiveValueListNode.create(e)})(a,d)))]}var t=a.i(19910),u=a.i(39399);let v=(0,b.freeze)({is:a=>"ColumnUpdateNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"ColumnUpdateNode",column:a,value:c})});function w(a){return Object.entries((0,b.isFunction)(a)?a((0,h.expressionBuilder)()):a).filter(([a,b])=>void 0!==b).map(([a,b])=>v.create(m.ColumnNode.create(a),(0,p.parseValueExpression)(b)))}let x=(0,b.freeze)({is:a=>"OnDuplicateKeyNode"===a.kind,create:a=>(0,b.freeze)({kind:"OnDuplicateKeyNode",updates:a})});class y{insertId;numInsertedOrUpdatedRows;constructor(a,b){this.insertId=a,this.numInsertedOrUpdatedRows=b}}class z extends Error{node;constructor(a){super("no result"),this.node=a}}function A(a){return Object.prototype.hasOwnProperty.call(a,"prototype")}a.s(["NoResultError",()=>z,"isNoResultErrorConstructor",()=>A],49957);var B=a.i(20860),C=a.i(27466);let D=(0,b.freeze)({is:a=>"OnConflictNode"===a.kind,create:()=>(0,b.freeze)({kind:"OnConflictNode"}),cloneWith:(a,c)=>(0,b.freeze)({...a,...c}),cloneWithIndexWhere:(a,c)=>(0,b.freeze)({...a,indexWhere:a.indexWhere?C.WhereNode.cloneWithOperation(a.indexWhere,"And",c):C.WhereNode.create(c)}),cloneWithIndexOrWhere:(a,c)=>(0,b.freeze)({...a,indexWhere:a.indexWhere?C.WhereNode.cloneWithOperation(a.indexWhere,"Or",c):C.WhereNode.create(c)}),cloneWithUpdateWhere:(a,c)=>(0,b.freeze)({...a,updateWhere:a.updateWhere?C.WhereNode.cloneWithOperation(a.updateWhere,"And",c):C.WhereNode.create(c)}),cloneWithUpdateOrWhere:(a,c)=>(0,b.freeze)({...a,updateWhere:a.updateWhere?C.WhereNode.cloneWithOperation(a.updateWhere,"Or",c):C.WhereNode.create(c)}),cloneWithoutIndexWhere:a=>(0,b.freeze)({...a,indexWhere:void 0}),cloneWithoutUpdateWhere:a=>(0,b.freeze)({...a,updateWhere:void 0})});var E=a.i(45228);class F{#b;constructor(a){this.#b=(0,b.freeze)(a)}column(a){let c=m.ColumnNode.create(a);return new F({...this.#b,onConflictNode:D.cloneWith(this.#b.onConflictNode,{columns:this.#b.onConflictNode.columns?(0,b.freeze)([...this.#b.onConflictNode.columns,c]):(0,b.freeze)([c])})})}columns(a){let c=a.map(m.ColumnNode.create);return new F({...this.#b,onConflictNode:D.cloneWith(this.#b.onConflictNode,{columns:this.#b.onConflictNode.columns?(0,b.freeze)([...this.#b.onConflictNode.columns,...c]):(0,b.freeze)(c)})})}constraint(a){return new F({...this.#b,onConflictNode:D.cloneWith(this.#b.onConflictNode,{constraint:B.IdentifierNode.create(a)})})}expression(a){return new F({...this.#b,onConflictNode:D.cloneWith(this.#b.onConflictNode,{indexExpression:a.toOperationNode()})})}where(...a){return new F({...this.#b,onConflictNode:D.cloneWithIndexWhere(this.#b.onConflictNode,(0,E.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new F({...this.#b,onConflictNode:D.cloneWithIndexWhere(this.#b.onConflictNode,(0,E.parseReferentialBinaryOperation)(a,b,c))})}clearWhere(){return new F({...this.#b,onConflictNode:D.cloneWithoutIndexWhere(this.#b.onConflictNode)})}doNothing(){return new G({...this.#b,onConflictNode:D.cloneWith(this.#b.onConflictNode,{doNothing:!0})})}doUpdateSet(a){return new H({...this.#b,onConflictNode:D.cloneWith(this.#b.onConflictNode,{updates:w(a)})})}$call(a){return a(this)}}class G{#b;constructor(a){this.#b=(0,b.freeze)(a)}toOperationNode(){return this.#b.onConflictNode}}class H{#b;constructor(a){this.#b=(0,b.freeze)(a)}where(...a){return new H({...this.#b,onConflictNode:D.cloneWithUpdateWhere(this.#b.onConflictNode,(0,E.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new H({...this.#b,onConflictNode:D.cloneWithUpdateWhere(this.#b.onConflictNode,(0,E.parseReferentialBinaryOperation)(a,b,c))})}clearWhere(){return new H({...this.#b,onConflictNode:D.cloneWithoutUpdateWhere(this.#b.onConflictNode)})}$call(a){return a(this)}toOperationNode(){return this.#b.onConflictNode}}let I=(0,b.freeze)({is:a=>"TopNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"TopNode",expression:a,modifiers:c})});function J(a,c){var d;if(!(0,b.isNumber)(a)&&!(0,b.isBigInt)(a))throw Error(`Invalid top expression: ${a}`);if(!(0,b.isUndefined)(c)&&"percent"!==(d=c)&&"with ties"!==d&&"percent with ties"!==d)throw Error(`Invalid top modifiers: ${c}`);return I.create(a,c)}a.s(["parseTop",()=>J],78969);let K=(0,b.freeze)({is:a=>"OrActionNode"===a.kind,create:a=>(0,b.freeze)({kind:"OrActionNode",action:a})});class L{#b;constructor(a){this.#b=(0,b.freeze)(a)}values(a){let[b,c]=s(a);return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{columns:b,values:c})})}columns(a){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{columns:(0,b.freeze)(a.map(m.ColumnNode.create))})})}expression(a){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{values:(0,f.parseExpression)(a)})})}defaultValues(){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{defaultValues:!0})})}modifyEnd(a){return new L({...this.#b,queryNode:u.QueryNode.cloneWithEndModifier(this.#b.queryNode,a.toOperationNode())})}ignore(){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{orAction:K.create("ignore")})})}orIgnore(){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{orAction:K.create("ignore")})})}orAbort(){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{orAction:K.create("abort")})})}orFail(){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{orAction:K.create("fail")})})}orReplace(){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{orAction:K.create("replace")})})}orRollback(){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{orAction:K.create("rollback")})})}top(a,b){return new L({...this.#b,queryNode:u.QueryNode.cloneWithTop(this.#b.queryNode,J(a,b))})}onConflict(a){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{onConflict:a(new F({onConflictNode:D.create()})).toOperationNode()})})}onDuplicateKeyUpdate(a){return new L({...this.#b,queryNode:t.InsertQueryNode.cloneWith(this.#b.queryNode,{onDuplicateKey:x.create(w(a))})})}returning(a){return new L({...this.#b,queryNode:u.QueryNode.cloneWithReturning(this.#b.queryNode,i(a))})}returningAll(){return new L({...this.#b,queryNode:u.QueryNode.cloneWithReturning(this.#b.queryNode,k())})}output(a){return new L({...this.#b,queryNode:u.QueryNode.cloneWithOutput(this.#b.queryNode,i(a))})}outputAll(a){return new L({...this.#b,queryNode:u.QueryNode.cloneWithOutput(this.#b.queryNode,k(a))})}clearReturning(){return new L({...this.#b,queryNode:u.QueryNode.cloneWithoutReturning(this.#b.queryNode)})}$call(a){return a(this)}$if(a,b){return a?b(this):new L({...this.#b})}$castTo(){return new L(this.#b)}$narrowType(){return new L(this.#b)}$assertType(){return new L(this.#b)}withPlugin(a){return new L({...this.#b,executor:this.#b.executor.withPlugin(a)})}toOperationNode(){return this.#b.executor.transformQuery(this.#b.queryNode,this.#b.queryId)}compile(){return this.#b.executor.compileQuery(this.toOperationNode(),this.#b.queryId)}async execute(){let a=this.compile(),b=await this.#b.executor.executeQuery(a),{adapter:c}=this.#b.executor,d=a.query;return d.returning&&c.supportsReturning||d.output&&c.supportsOutput?b.rows:[new y(b.insertId,b.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=z){let b=await this.executeTakeFirst();if(void 0===b)throw A(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}async *stream(a=100){let b=this.compile();for await(let c of this.#b.executor.stream(b,a))yield*c.rows}async explain(a,b){let c=new L({...this.#b,queryNode:u.QueryNode.cloneWithExplain(this.#b.queryNode,a,b)});return await c.execute()}}a.s(["DeleteQueryBuilder",()=>R],71340);var M=a.i(20584);class N{numDeletedRows;constructor(a){this.numDeletedRows=a}}var O=a.i(48565);let P=(0,b.freeze)({is:a=>"LimitNode"===a.kind,create:a=>(0,b.freeze)({kind:"LimitNode",limit:a})});a.s(["LimitNode",0,P],33635);var Q=a.i(95398);class R{#b;constructor(a){this.#b=(0,b.freeze)(a)}where(...a){return new R({...this.#b,queryNode:u.QueryNode.cloneWithWhere(this.#b.queryNode,(0,E.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new R({...this.#b,queryNode:u.QueryNode.cloneWithWhere(this.#b.queryNode,(0,E.parseReferentialBinaryOperation)(a,b,c))})}clearWhere(){return new R({...this.#b,queryNode:u.QueryNode.cloneWithoutWhere(this.#b.queryNode)})}top(a,b){return new R({...this.#b,queryNode:u.QueryNode.cloneWithTop(this.#b.queryNode,J(a,b))})}using(a){return new R({...this.#b,queryNode:O.DeleteQueryNode.cloneWithUsing(this.#b.queryNode,(0,g.parseTableExpressionOrList)(a))})}innerJoin(...a){return this.#c("InnerJoin",a)}leftJoin(...a){return this.#c("LeftJoin",a)}rightJoin(...a){return this.#c("RightJoin",a)}fullJoin(...a){return this.#c("FullJoin",a)}#c(a,b){return new R({...this.#b,queryNode:u.QueryNode.cloneWithJoin(this.#b.queryNode,(0,M.parseJoin)(a,b))})}returning(a){return new R({...this.#b,queryNode:u.QueryNode.cloneWithReturning(this.#b.queryNode,i(a))})}returningAll(a){return new R({...this.#b,queryNode:u.QueryNode.cloneWithReturning(this.#b.queryNode,k(a))})}output(a){return new R({...this.#b,queryNode:u.QueryNode.cloneWithOutput(this.#b.queryNode,i(a))})}outputAll(a){return new R({...this.#b,queryNode:u.QueryNode.cloneWithOutput(this.#b.queryNode,k(a))})}clearReturning(){return new R({...this.#b,queryNode:u.QueryNode.cloneWithoutReturning(this.#b.queryNode)})}clearLimit(){return new R({...this.#b,queryNode:O.DeleteQueryNode.cloneWithoutLimit(this.#b.queryNode)})}orderBy(...a){return new R({...this.#b,queryNode:u.QueryNode.cloneWithOrderByItems(this.#b.queryNode,(0,Q.parseOrderBy)(a))})}clearOrderBy(){return new R({...this.#b,queryNode:u.QueryNode.cloneWithoutOrderBy(this.#b.queryNode)})}limit(a){return new R({...this.#b,queryNode:O.DeleteQueryNode.cloneWithLimit(this.#b.queryNode,P.create((0,p.parseValueExpression)(a)))})}modifyEnd(a){return new R({...this.#b,queryNode:u.QueryNode.cloneWithEndModifier(this.#b.queryNode,a.toOperationNode())})}$call(a){return a(this)}$if(a,b){return a?b(this):new R({...this.#b})}$castTo(){return new R(this.#b)}$narrowType(){return new R(this.#b)}$assertType(){return new R(this.#b)}withPlugin(a){return new R({...this.#b,executor:this.#b.executor.withPlugin(a)})}toOperationNode(){return this.#b.executor.transformQuery(this.#b.queryNode,this.#b.queryId)}compile(){return this.#b.executor.compileQuery(this.toOperationNode(),this.#b.queryId)}async execute(){let a=this.compile(),b=await this.#b.executor.executeQuery(a),{adapter:c}=this.#b.executor,d=a.query;return d.returning&&c.supportsReturning||d.output&&c.supportsOutput?b.rows:[new N(b.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=z){let b=await this.executeTakeFirst();if(void 0===b)throw A(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}async *stream(a=100){let b=this.compile();for await(let c of this.#b.executor.stream(b,a))yield*c.rows}async explain(a,b){let c=new R({...this.#b,queryNode:u.QueryNode.cloneWithExplain(this.#b.queryNode,a,b)});return await c.execute()}}a.s(["UpdateQueryBuilder",()=>U],57507);var S=a.i(12475);class T{numUpdatedRows;numChangedRows;constructor(a,b){this.numUpdatedRows=a,this.numChangedRows=b}}class U{#b;constructor(a){this.#b=(0,b.freeze)(a)}where(...a){return new U({...this.#b,queryNode:u.QueryNode.cloneWithWhere(this.#b.queryNode,(0,E.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new U({...this.#b,queryNode:u.QueryNode.cloneWithWhere(this.#b.queryNode,(0,E.parseReferentialBinaryOperation)(a,b,c))})}clearWhere(){return new U({...this.#b,queryNode:u.QueryNode.cloneWithoutWhere(this.#b.queryNode)})}top(a,b){return new U({...this.#b,queryNode:u.QueryNode.cloneWithTop(this.#b.queryNode,J(a,b))})}from(a){return new U({...this.#b,queryNode:S.UpdateQueryNode.cloneWithFromItems(this.#b.queryNode,(0,g.parseTableExpressionOrList)(a))})}innerJoin(...a){return this.#c("InnerJoin",a)}leftJoin(...a){return this.#c("LeftJoin",a)}rightJoin(...a){return this.#c("RightJoin",a)}fullJoin(...a){return this.#c("FullJoin",a)}#c(a,b){return new U({...this.#b,queryNode:u.QueryNode.cloneWithJoin(this.#b.queryNode,(0,M.parseJoin)(a,b))})}orderBy(...a){return new U({...this.#b,queryNode:u.QueryNode.cloneWithOrderByItems(this.#b.queryNode,(0,Q.parseOrderBy)(a))})}clearOrderBy(){return new U({...this.#b,queryNode:u.QueryNode.cloneWithoutOrderBy(this.#b.queryNode)})}limit(a){return new U({...this.#b,queryNode:S.UpdateQueryNode.cloneWithLimit(this.#b.queryNode,P.create((0,p.parseValueExpression)(a)))})}set(...a){return new U({...this.#b,queryNode:S.UpdateQueryNode.cloneWithUpdates(this.#b.queryNode,function(...a){return 2===a.length?[v.create((0,d.parseReferenceExpression)(a[0]),(0,p.parseValueExpression)(a[1]))]:w(a[0])}(...a))})}returning(a){return new U({...this.#b,queryNode:u.QueryNode.cloneWithReturning(this.#b.queryNode,i(a))})}returningAll(a){return new U({...this.#b,queryNode:u.QueryNode.cloneWithReturning(this.#b.queryNode,k(a))})}output(a){return new U({...this.#b,queryNode:u.QueryNode.cloneWithOutput(this.#b.queryNode,i(a))})}outputAll(a){return new U({...this.#b,queryNode:u.QueryNode.cloneWithOutput(this.#b.queryNode,k(a))})}modifyEnd(a){return new U({...this.#b,queryNode:u.QueryNode.cloneWithEndModifier(this.#b.queryNode,a.toOperationNode())})}clearReturning(){return new U({...this.#b,queryNode:u.QueryNode.cloneWithoutReturning(this.#b.queryNode)})}$call(a){return a(this)}$if(a,b){return a?b(this):new U({...this.#b})}$castTo(){return new U(this.#b)}$narrowType(){return new U(this.#b)}$assertType(){return new U(this.#b)}withPlugin(a){return new U({...this.#b,executor:this.#b.executor.withPlugin(a)})}toOperationNode(){return this.#b.executor.transformQuery(this.#b.queryNode,this.#b.queryId)}compile(){return this.#b.executor.compileQuery(this.toOperationNode(),this.#b.queryId)}async execute(){let a=this.compile(),b=await this.#b.executor.executeQuery(a),{adapter:c}=this.#b.executor,d=a.query;return d.returning&&c.supportsReturning||d.output&&c.supportsOutput?b.rows:[new T(b.numAffectedRows??BigInt(0),b.numChangedRows)]}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=z){let b=await this.executeTakeFirst();if(void 0===b)throw A(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}async *stream(a=100){let b=this.compile();for await(let c of this.#b.executor.stream(b,a))yield*c.rows}async explain(a,b){let c=new U({...this.#b,queryNode:u.QueryNode.cloneWithExplain(this.#b.queryNode,a,b)});return await c.execute()}}a.s(["parseCommonTableExpression",()=>$],76375);var V=a.i(6770);let W=(0,b.freeze)({is:a=>"CommonTableExpressionNameNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"CommonTableExpressionNameNode",table:V.TableNode.create(a),columns:c?(0,b.freeze)(c.map(m.ColumnNode.create)):void 0})});var X=a.i(82223);let Y=(0,b.freeze)({is:a=>"CommonTableExpressionNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"CommonTableExpressionNode",name:a,expression:c}),cloneWith:(a,c)=>(0,b.freeze)({...a,...c})});class Z{#b;constructor(a){this.#b=(0,b.freeze)(a)}materialized(){return new Z({...this.#b,node:Y.cloneWith(this.#b.node,{materialized:!0})})}notMaterialized(){return new Z({...this.#b,node:Y.cloneWith(this.#b.node,{materialized:!1})})}toOperationNode(){return this.#b.node}}function $(a,c){var d;let e=c((0,X.createQueryCreator)()).toOperationNode();return(0,b.isFunction)(a)?a((d=e,a=>new Z({node:Y.create(_(a),d)}))).toOperationNode():Y.create(_(a),e)}function _(a){if(!a.includes("("))return W.create(a);{let b=a.split(/[\(\)]/),c=b[0],d=b[1].split(",").map(a=>a.trim());return W.create(c,d)}}let aa=(0,b.freeze)({is:a=>"WithNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"WithNode",expressions:(0,b.freeze)([a]),...c}),cloneWithExpression:(a,c)=>(0,b.freeze)({...a,expressions:(0,b.freeze)([...a.expressions,c])})});a.s(["WithNode",0,aa],95305)},13344,52779,a=>{"use strict";let b=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function c(a){let c="";for(let d=0;d<a;++d)c+=b[~~(Math.random()*b.length)];return c}function d(){return new e}a.s(["randomString",()=>c],52779);class e{#d;get queryId(){return void 0===this.#d&&(this.#d=c(8)),this.#d}}a.s(["createQueryId",()=>d],13344)},97365,a=>{"use strict";var b=a.i(52460);class c{nodeStack=[];#e=(0,b.freeze)({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),RenameConstraintNode:this.transformRenameConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),RefreshMaterializedViewNode:this.transformRefreshMaterializedView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this),OutputNode:this.transformOutput.bind(this),OrActionNode:this.transformOrAction.bind(this),CollateNode:this.transformCollate.bind(this)});transformNode(a,c){if(!a)return a;this.nodeStack.push(a);let d=this.transformNodeImpl(a,c);return this.nodeStack.pop(),(0,b.freeze)(d)}transformNodeImpl(a,b){return this.#e[a.kind](a,b)}transformNodeList(a,c){return a?(0,b.freeze)(a.map(a=>this.transformNode(a,c))):a}transformSelectQuery(a,b){return{kind:"SelectQueryNode",from:this.transformNode(a.from,b),selections:this.transformNodeList(a.selections,b),distinctOn:this.transformNodeList(a.distinctOn,b),joins:this.transformNodeList(a.joins,b),groupBy:this.transformNode(a.groupBy,b),orderBy:this.transformNode(a.orderBy,b),where:this.transformNode(a.where,b),frontModifiers:this.transformNodeList(a.frontModifiers,b),endModifiers:this.transformNodeList(a.endModifiers,b),limit:this.transformNode(a.limit,b),offset:this.transformNode(a.offset,b),with:this.transformNode(a.with,b),having:this.transformNode(a.having,b),explain:this.transformNode(a.explain,b),setOperations:this.transformNodeList(a.setOperations,b),fetch:this.transformNode(a.fetch,b),top:this.transformNode(a.top,b)}}transformSelection(a,b){return{kind:"SelectionNode",selection:this.transformNode(a.selection,b)}}transformColumn(a,b){return{kind:"ColumnNode",column:this.transformNode(a.column,b)}}transformAlias(a,b){return{kind:"AliasNode",node:this.transformNode(a.node,b),alias:this.transformNode(a.alias,b)}}transformTable(a,b){return{kind:"TableNode",table:this.transformNode(a.table,b)}}transformFrom(a,b){return{kind:"FromNode",froms:this.transformNodeList(a.froms,b)}}transformReference(a,b){return{kind:"ReferenceNode",column:this.transformNode(a.column,b),table:this.transformNode(a.table,b)}}transformAnd(a,b){return{kind:"AndNode",left:this.transformNode(a.left,b),right:this.transformNode(a.right,b)}}transformOr(a,b){return{kind:"OrNode",left:this.transformNode(a.left,b),right:this.transformNode(a.right,b)}}transformValueList(a,b){return{kind:"ValueListNode",values:this.transformNodeList(a.values,b)}}transformParens(a,b){return{kind:"ParensNode",node:this.transformNode(a.node,b)}}transformJoin(a,b){return{kind:"JoinNode",joinType:a.joinType,table:this.transformNode(a.table,b),on:this.transformNode(a.on,b)}}transformRaw(a,c){return{kind:"RawNode",sqlFragments:(0,b.freeze)([...a.sqlFragments]),parameters:this.transformNodeList(a.parameters,c)}}transformWhere(a,b){return{kind:"WhereNode",where:this.transformNode(a.where,b)}}transformInsertQuery(a,b){return{kind:"InsertQueryNode",into:this.transformNode(a.into,b),columns:this.transformNodeList(a.columns,b),values:this.transformNode(a.values,b),returning:this.transformNode(a.returning,b),onConflict:this.transformNode(a.onConflict,b),onDuplicateKey:this.transformNode(a.onDuplicateKey,b),endModifiers:this.transformNodeList(a.endModifiers,b),with:this.transformNode(a.with,b),ignore:a.ignore,orAction:this.transformNode(a.orAction,b),replace:a.replace,explain:this.transformNode(a.explain,b),defaultValues:a.defaultValues,top:this.transformNode(a.top,b),output:this.transformNode(a.output,b)}}transformValues(a,b){return{kind:"ValuesNode",values:this.transformNodeList(a.values,b)}}transformDeleteQuery(a,b){return{kind:"DeleteQueryNode",from:this.transformNode(a.from,b),using:this.transformNode(a.using,b),joins:this.transformNodeList(a.joins,b),where:this.transformNode(a.where,b),returning:this.transformNode(a.returning,b),endModifiers:this.transformNodeList(a.endModifiers,b),with:this.transformNode(a.with,b),orderBy:this.transformNode(a.orderBy,b),limit:this.transformNode(a.limit,b),explain:this.transformNode(a.explain,b),top:this.transformNode(a.top,b),output:this.transformNode(a.output,b)}}transformReturning(a,b){return{kind:"ReturningNode",selections:this.transformNodeList(a.selections,b)}}transformCreateTable(a,b){return{kind:"CreateTableNode",table:this.transformNode(a.table,b),columns:this.transformNodeList(a.columns,b),constraints:this.transformNodeList(a.constraints,b),temporary:a.temporary,ifNotExists:a.ifNotExists,onCommit:a.onCommit,frontModifiers:this.transformNodeList(a.frontModifiers,b),endModifiers:this.transformNodeList(a.endModifiers,b),selectQuery:this.transformNode(a.selectQuery,b)}}transformColumnDefinition(a,b){return{kind:"ColumnDefinitionNode",column:this.transformNode(a.column,b),dataType:this.transformNode(a.dataType,b),references:this.transformNode(a.references,b),primaryKey:a.primaryKey,autoIncrement:a.autoIncrement,unique:a.unique,notNull:a.notNull,unsigned:a.unsigned,defaultTo:this.transformNode(a.defaultTo,b),check:this.transformNode(a.check,b),generated:this.transformNode(a.generated,b),frontModifiers:this.transformNodeList(a.frontModifiers,b),endModifiers:this.transformNodeList(a.endModifiers,b),nullsNotDistinct:a.nullsNotDistinct,identity:a.identity,ifNotExists:a.ifNotExists}}transformAddColumn(a,b){return{kind:"AddColumnNode",column:this.transformNode(a.column,b)}}transformDropTable(a,b){return{kind:"DropTableNode",table:this.transformNode(a.table,b),ifExists:a.ifExists,cascade:a.cascade}}transformOrderBy(a,b){return{kind:"OrderByNode",items:this.transformNodeList(a.items,b)}}transformOrderByItem(a,b){return{kind:"OrderByItemNode",orderBy:this.transformNode(a.orderBy,b),direction:this.transformNode(a.direction,b),collation:this.transformNode(a.collation,b),nulls:a.nulls}}transformGroupBy(a,b){return{kind:"GroupByNode",items:this.transformNodeList(a.items,b)}}transformGroupByItem(a,b){return{kind:"GroupByItemNode",groupBy:this.transformNode(a.groupBy,b)}}transformUpdateQuery(a,b){return{kind:"UpdateQueryNode",table:this.transformNode(a.table,b),from:this.transformNode(a.from,b),joins:this.transformNodeList(a.joins,b),where:this.transformNode(a.where,b),updates:this.transformNodeList(a.updates,b),returning:this.transformNode(a.returning,b),endModifiers:this.transformNodeList(a.endModifiers,b),with:this.transformNode(a.with,b),explain:this.transformNode(a.explain,b),limit:this.transformNode(a.limit,b),top:this.transformNode(a.top,b),output:this.transformNode(a.output,b),orderBy:this.transformNode(a.orderBy,b)}}transformColumnUpdate(a,b){return{kind:"ColumnUpdateNode",column:this.transformNode(a.column,b),value:this.transformNode(a.value,b)}}transformLimit(a,b){return{kind:"LimitNode",limit:this.transformNode(a.limit,b)}}transformOffset(a,b){return{kind:"OffsetNode",offset:this.transformNode(a.offset,b)}}transformOnConflict(a,b){return{kind:"OnConflictNode",columns:this.transformNodeList(a.columns,b),constraint:this.transformNode(a.constraint,b),indexExpression:this.transformNode(a.indexExpression,b),indexWhere:this.transformNode(a.indexWhere,b),updates:this.transformNodeList(a.updates,b),updateWhere:this.transformNode(a.updateWhere,b),doNothing:a.doNothing}}transformOnDuplicateKey(a,b){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(a.updates,b)}}transformCreateIndex(a,b){return{kind:"CreateIndexNode",name:this.transformNode(a.name,b),table:this.transformNode(a.table,b),columns:this.transformNodeList(a.columns,b),unique:a.unique,using:this.transformNode(a.using,b),ifNotExists:a.ifNotExists,where:this.transformNode(a.where,b),nullsNotDistinct:a.nullsNotDistinct}}transformList(a,b){return{kind:"ListNode",items:this.transformNodeList(a.items,b)}}transformDropIndex(a,b){return{kind:"DropIndexNode",name:this.transformNode(a.name,b),table:this.transformNode(a.table,b),ifExists:a.ifExists,cascade:a.cascade}}transformPrimaryKeyConstraint(a,b){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(a.columns,b),name:this.transformNode(a.name,b),deferrable:a.deferrable,initiallyDeferred:a.initiallyDeferred}}transformUniqueConstraint(a,b){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(a.columns,b),name:this.transformNode(a.name,b),nullsNotDistinct:a.nullsNotDistinct,deferrable:a.deferrable,initiallyDeferred:a.initiallyDeferred}}transformForeignKeyConstraint(a,b){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(a.columns,b),references:this.transformNode(a.references,b),name:this.transformNode(a.name,b),onDelete:a.onDelete,onUpdate:a.onUpdate,deferrable:a.deferrable,initiallyDeferred:a.initiallyDeferred}}transformSetOperation(a,b){return{kind:"SetOperationNode",operator:a.operator,expression:this.transformNode(a.expression,b),all:a.all}}transformReferences(a,b){return{kind:"ReferencesNode",table:this.transformNode(a.table,b),columns:this.transformNodeList(a.columns,b),onDelete:a.onDelete,onUpdate:a.onUpdate}}transformCheckConstraint(a,b){return{kind:"CheckConstraintNode",expression:this.transformNode(a.expression,b),name:this.transformNode(a.name,b)}}transformWith(a,b){return{kind:"WithNode",expressions:this.transformNodeList(a.expressions,b),recursive:a.recursive}}transformCommonTableExpression(a,b){return{kind:"CommonTableExpressionNode",name:this.transformNode(a.name,b),materialized:a.materialized,expression:this.transformNode(a.expression,b)}}transformCommonTableExpressionName(a,b){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(a.table,b),columns:this.transformNodeList(a.columns,b)}}transformHaving(a,b){return{kind:"HavingNode",having:this.transformNode(a.having,b)}}transformCreateSchema(a,b){return{kind:"CreateSchemaNode",schema:this.transformNode(a.schema,b),ifNotExists:a.ifNotExists}}transformDropSchema(a,b){return{kind:"DropSchemaNode",schema:this.transformNode(a.schema,b),ifExists:a.ifExists,cascade:a.cascade}}transformAlterTable(a,b){return{kind:"AlterTableNode",table:this.transformNode(a.table,b),renameTo:this.transformNode(a.renameTo,b),setSchema:this.transformNode(a.setSchema,b),columnAlterations:this.transformNodeList(a.columnAlterations,b),addConstraint:this.transformNode(a.addConstraint,b),dropConstraint:this.transformNode(a.dropConstraint,b),renameConstraint:this.transformNode(a.renameConstraint,b),addIndex:this.transformNode(a.addIndex,b),dropIndex:this.transformNode(a.dropIndex,b)}}transformDropColumn(a,b){return{kind:"DropColumnNode",column:this.transformNode(a.column,b)}}transformRenameColumn(a,b){return{kind:"RenameColumnNode",column:this.transformNode(a.column,b),renameTo:this.transformNode(a.renameTo,b)}}transformAlterColumn(a,b){return{kind:"AlterColumnNode",column:this.transformNode(a.column,b),dataType:this.transformNode(a.dataType,b),dataTypeExpression:this.transformNode(a.dataTypeExpression,b),setDefault:this.transformNode(a.setDefault,b),dropDefault:a.dropDefault,setNotNull:a.setNotNull,dropNotNull:a.dropNotNull}}transformModifyColumn(a,b){return{kind:"ModifyColumnNode",column:this.transformNode(a.column,b)}}transformAddConstraint(a,b){return{kind:"AddConstraintNode",constraint:this.transformNode(a.constraint,b)}}transformDropConstraint(a,b){return{kind:"DropConstraintNode",constraintName:this.transformNode(a.constraintName,b),ifExists:a.ifExists,modifier:a.modifier}}transformRenameConstraint(a,b){return{kind:"RenameConstraintNode",oldName:this.transformNode(a.oldName,b),newName:this.transformNode(a.newName,b)}}transformCreateView(a,b){return{kind:"CreateViewNode",name:this.transformNode(a.name,b),temporary:a.temporary,orReplace:a.orReplace,ifNotExists:a.ifNotExists,materialized:a.materialized,columns:this.transformNodeList(a.columns,b),as:this.transformNode(a.as,b)}}transformRefreshMaterializedView(a,b){return{kind:"RefreshMaterializedViewNode",name:this.transformNode(a.name,b),concurrently:a.concurrently,withNoData:a.withNoData}}transformDropView(a,b){return{kind:"DropViewNode",name:this.transformNode(a.name,b),ifExists:a.ifExists,materialized:a.materialized,cascade:a.cascade}}transformGenerated(a,b){return{kind:"GeneratedNode",byDefault:a.byDefault,always:a.always,identity:a.identity,stored:a.stored,expression:this.transformNode(a.expression,b)}}transformDefaultValue(a,b){return{kind:"DefaultValueNode",defaultValue:this.transformNode(a.defaultValue,b)}}transformOn(a,b){return{kind:"OnNode",on:this.transformNode(a.on,b)}}transformSelectModifier(a,b){return{kind:"SelectModifierNode",modifier:a.modifier,rawModifier:this.transformNode(a.rawModifier,b),of:this.transformNodeList(a.of,b)}}transformCreateType(a,b){return{kind:"CreateTypeNode",name:this.transformNode(a.name,b),enum:this.transformNode(a.enum,b)}}transformDropType(a,b){return{kind:"DropTypeNode",name:this.transformNode(a.name,b),ifExists:a.ifExists}}transformExplain(a,b){return{kind:"ExplainNode",format:a.format,options:this.transformNode(a.options,b)}}transformSchemableIdentifier(a,b){return{kind:"SchemableIdentifierNode",schema:this.transformNode(a.schema,b),identifier:this.transformNode(a.identifier,b)}}transformAggregateFunction(a,b){return{kind:"AggregateFunctionNode",func:a.func,aggregated:this.transformNodeList(a.aggregated,b),distinct:a.distinct,orderBy:this.transformNode(a.orderBy,b),withinGroup:this.transformNode(a.withinGroup,b),filter:this.transformNode(a.filter,b),over:this.transformNode(a.over,b)}}transformOver(a,b){return{kind:"OverNode",orderBy:this.transformNode(a.orderBy,b),partitionBy:this.transformNode(a.partitionBy,b)}}transformPartitionBy(a,b){return{kind:"PartitionByNode",items:this.transformNodeList(a.items,b)}}transformPartitionByItem(a,b){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(a.partitionBy,b)}}transformBinaryOperation(a,b){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(a.leftOperand,b),operator:this.transformNode(a.operator,b),rightOperand:this.transformNode(a.rightOperand,b)}}transformUnaryOperation(a,b){return{kind:"UnaryOperationNode",operator:this.transformNode(a.operator,b),operand:this.transformNode(a.operand,b)}}transformUsing(a,b){return{kind:"UsingNode",tables:this.transformNodeList(a.tables,b)}}transformFunction(a,b){return{kind:"FunctionNode",func:a.func,arguments:this.transformNodeList(a.arguments,b)}}transformCase(a,b){return{kind:"CaseNode",value:this.transformNode(a.value,b),when:this.transformNodeList(a.when,b),else:this.transformNode(a.else,b),isStatement:a.isStatement}}transformWhen(a,b){return{kind:"WhenNode",condition:this.transformNode(a.condition,b),result:this.transformNode(a.result,b)}}transformJSONReference(a,b){return{kind:"JSONReferenceNode",reference:this.transformNode(a.reference,b),traversal:this.transformNode(a.traversal,b)}}transformJSONPath(a,b){return{kind:"JSONPathNode",inOperator:this.transformNode(a.inOperator,b),pathLegs:this.transformNodeList(a.pathLegs,b)}}transformJSONPathLeg(a,b){return{kind:"JSONPathLegNode",type:a.type,value:a.value}}transformJSONOperatorChain(a,b){return{kind:"JSONOperatorChainNode",operator:this.transformNode(a.operator,b),values:this.transformNodeList(a.values,b)}}transformTuple(a,b){return{kind:"TupleNode",values:this.transformNodeList(a.values,b)}}transformMergeQuery(a,b){return{kind:"MergeQueryNode",into:this.transformNode(a.into,b),using:this.transformNode(a.using,b),whens:this.transformNodeList(a.whens,b),with:this.transformNode(a.with,b),top:this.transformNode(a.top,b),endModifiers:this.transformNodeList(a.endModifiers,b),output:this.transformNode(a.output,b),returning:this.transformNode(a.returning,b)}}transformMatched(a,b){return{kind:"MatchedNode",not:a.not,bySource:a.bySource}}transformAddIndex(a,b){return{kind:"AddIndexNode",name:this.transformNode(a.name,b),columns:this.transformNodeList(a.columns,b),unique:a.unique,using:this.transformNode(a.using,b),ifNotExists:a.ifNotExists}}transformCast(a,b){return{kind:"CastNode",expression:this.transformNode(a.expression,b),dataType:this.transformNode(a.dataType,b)}}transformFetch(a,b){return{kind:"FetchNode",rowCount:this.transformNode(a.rowCount,b),modifier:a.modifier}}transformTop(a,b){return{kind:"TopNode",expression:a.expression,modifiers:a.modifiers}}transformOutput(a,b){return{kind:"OutputNode",selections:this.transformNodeList(a.selections,b)}}transformDataType(a,b){return a}transformSelectAll(a,b){return a}transformIdentifier(a,b){return a}transformValue(a,b){return a}transformPrimitiveValueList(a,b){return a}transformOperator(a,b){return a}transformDefaultInsertValue(a,b){return a}transformOrAction(a,b){return a}transformCollate(a,b){return a}}a.s(["OperationNodeTransformer",()=>c],97365)},85545,a=>{"use strict";var b=a.i(24054),c=a.i(20860),d=a.i(67319),e=a.i(34730),f=a.i(97365),g=a.i(8896),h=a.i(6770);let i=(0,a.i(52460).freeze)({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,RefreshMaterializedViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0}),j={json_agg:!0,to_json:!0};class k extends f.OperationNodeTransformer{#f;#g=new Set;#h=new Set;constructor(a){super(),this.#f=a}transformNodeImpl(a,b){if(!this.#i(a))return super.transformNodeImpl(a,b);let c=this.#j(a);for(let a of c)this.#h.add(a);let d=this.#k(a);for(let a of d)this.#g.add(a);let e=super.transformNodeImpl(a,b);for(let a of d)this.#g.delete(a);for(let a of c)this.#h.delete(a);return e}transformSchemableIdentifier(a,b){let d=super.transformSchemableIdentifier(a,b);return d.schema||!this.#g.has(a.identifier.name)?d:{...d,schema:c.IdentifierNode.create(this.#f)}}transformReferences(a,b){let c=super.transformReferences(a,b);return c.table.table.schema?c:{...c,table:h.TableNode.createWithSchema(this.#f,c.table.table.identifier.name)}}transformAggregateFunction(a,b){return{...super.transformAggregateFunction({...a,aggregated:[]},b),aggregated:this.#l(a,b,"aggregated")}}transformFunction(a,b){return{...super.transformFunction({...a,arguments:[]},b),arguments:this.#l(a,b,"arguments")}}#l(a,b,c){return j[a.func]?a[c].map(a=>!h.TableNode.is(a)||a.table.schema?this.transformNode(a,b):{...a,table:this.transformIdentifier(a.table.identifier,b)}):this.transformNodeList(a[c],b)}#i(a){return a.kind in i}#k(a){let b=new Set;if("name"in a&&a.name&&g.SchemableIdentifierNode.is(a.name)&&this.#m(a.name,b),"from"in a&&a.from)for(let c of a.from.froms)this.#n(c,b);if("into"in a&&a.into&&this.#n(a.into,b),"table"in a&&a.table&&this.#n(a.table,b),"joins"in a&&a.joins)for(let c of a.joins)this.#n(c.table,b);return"using"in a&&a.using&&(d.JoinNode.is(a.using)?this.#n(a.using.table,b):this.#n(a.using,b)),b}#j(a){let b=new Set;return"with"in a&&a.with&&this.#o(a.with,b),b}#n(a,c){if(h.TableNode.is(a))this.#m(a.table,c);else if(b.AliasNode.is(a)&&h.TableNode.is(a.node))this.#m(a.node.table,c);else if(e.ListNode.is(a))for(let b of a.items)this.#n(b,c)}#m(a,b){let c=a.identifier.name;this.#g.has(c)||this.#h.has(c)||b.add(c)}#o(a,b){for(let c of a.expressions){let a=c.name.table.table.identifier.name;this.#h.has(a)||b.add(a)}}}class l{#p;constructor(a){this.#p=new k(a)}transformQuery(a){return this.#p.transformNode(a.node,a.queryId)}async transformResult(a){return a.result}}a.s(["WithSchemaPlugin",()=>l],85545)},20584,70557,85184,6271,36478,72839,82223,29196,17999,a=>{"use strict";a.s(["parseJoin",()=>W],20584);var b=a.i(67319),c=a.i(45228);a.s(["createJoinBuilder",()=>U,"createOverBuilder",()=>V,"createQueryCreator",()=>T],82223);var d=a.i(97107),e=a.i(41595),f=a.i(84873),g=a.i(75476),h=a.i(94041);a.s(["QueryCreator",()=>S],72839);var i=a.i(7599),j=a.i(71340),k=a.i(57507),l=a.i(48565),m=a.i(19910),n=a.i(12475),o=a.i(66101),p=a.i(76375),q=a.i(95305),r=a.i(13344),s=a.i(85545),t=a.i(52460),u=a.i(44891),v=a.i(37193),w=a.i(39399),x=a.i(84257);let y=(0,t.freeze)({is:a=>"MatchedNode"===a.kind,create:(a,b=!1)=>(0,t.freeze)({kind:"MatchedNode",not:a,bySource:b})});var z=a.i(58758),A=a.i(93807),B=a.i(99297);function C(a,b,d){return B.WhenNode.create((0,c.parseFilterList)([y.create(!a.isMatched,a.bySource),...b&&b.length>0?[3===b.length&&d?(0,c.parseReferentialBinaryOperation)(b[0],b[1],b[2]):(0,c.parseValueBinaryOperationOrExpression)(b)]:[]],"and",!1))}function D(a){return(0,t.isString)(a)?A.RawNode.create([a],[]):(0,z.isOperationNodeSource)(a)?a.toOperationNode():a}var E=a.i(78969);class F{#q;#r;#s;constructor(){this.#q=new Promise((a,b)=>{this.#s=b,this.#r=a})}get promise(){return this.#q}resolve=a=>{this.#r&&this.#r(a)};reject=a=>{this.#s&&this.#s(a)}}async function G(a){let b=new F,c=new F;return a.provideConnection(async a=>(b.resolve(a),await c.promise)).catch(a=>b.reject(a)),(0,t.freeze)({connection:await b.promise,release:c.resolve})}a.s(["Deferred",()=>F],70557),a.s(["provideControlledConnection",()=>G],85184);var H=a.i(28283);let I=(0,t.freeze)([]);class J{#t;constructor(a=I){this.#t=a}get plugins(){return this.#t}transformQuery(a,b){for(let c of this.#t){let d=c.transformQuery({node:a,queryId:b});if(d.kind===a.kind)a=d;else throw Error(`KyselyPlugin.transformQuery must return a node of the same kind that was given to it. The plugin was given a ${a.kind} but it returned a ${d.kind}`)}return a}async executeQuery(a){return await this.provideConnection(async b=>{let c=await b.executeQuery(a);return"numUpdatedOrDeletedRows"in c&&(0,H.logOnce)("kysely:warning: outdated driver/plugin detected! `QueryResult.numUpdatedOrDeletedRows` has been replaced with `QueryResult.numAffectedRows`."),await this.#u(c,a.queryId)})}async *stream(a,b){let{connection:c,release:d}=await G(this);try{for await(let d of c.streamQuery(a,b))yield await this.#u(d,a.queryId)}finally{d()}}async #u(a,b){for(let c of this.#t)a=await c.transformResult({result:a,queryId:b});return a}}a.s(["QueryExecutorBase",()=>J],6271);class K extends J{get adapter(){throw Error("this query cannot be compiled to SQL")}compileQuery(){throw Error("this query cannot be compiled to SQL")}provideConnection(){throw Error("this query cannot be executed")}withConnectionProvider(){throw Error("this query cannot have a connection provider")}withPlugin(a){return new K([...this.plugins,a])}withPlugins(a){return new K([...this.plugins,...a])}withPluginAtFront(a){return new K([a,...this.plugins])}withoutPlugins(){return new K([])}}let L=new K;a.s(["NOOP_QUERY_EXECUTOR",0,L],36478);class M{numChangedRows;constructor(a){this.numChangedRows=a}}var N=a.i(49957);class O{#b;constructor(a){this.#b=(0,t.freeze)(a)}modifyEnd(a){return new O({...this.#b,queryNode:w.QueryNode.cloneWithEndModifier(this.#b.queryNode,a.toOperationNode())})}top(a,b){return new O({...this.#b,queryNode:w.QueryNode.cloneWithTop(this.#b.queryNode,(0,E.parseTop)(a,b))})}using(...a){return new P({...this.#b,queryNode:v.MergeQueryNode.cloneWithUsing(this.#b.queryNode,W("Using",a))})}returning(a){return new O({...this.#b,queryNode:w.QueryNode.cloneWithReturning(this.#b.queryNode,(0,u.parseSelectArg)(a))})}returningAll(a){return new O({...this.#b,queryNode:w.QueryNode.cloneWithReturning(this.#b.queryNode,(0,u.parseSelectAll)(a))})}output(a){return new O({...this.#b,queryNode:w.QueryNode.cloneWithOutput(this.#b.queryNode,(0,u.parseSelectArg)(a))})}outputAll(a){return new O({...this.#b,queryNode:w.QueryNode.cloneWithOutput(this.#b.queryNode,(0,u.parseSelectAll)(a))})}}class P{#b;constructor(a){this.#b=(0,t.freeze)(a)}modifyEnd(a){return new P({...this.#b,queryNode:w.QueryNode.cloneWithEndModifier(this.#b.queryNode,a.toOperationNode())})}top(a,b){return new P({...this.#b,queryNode:w.QueryNode.cloneWithTop(this.#b.queryNode,(0,E.parseTop)(a,b))})}whenMatched(){return this.#v([])}whenMatchedAnd(...a){return this.#v(a)}whenMatchedAndRef(a,b,c){return this.#v([a,b,c],!0)}#v(a,b){return new Q({...this.#b,queryNode:v.MergeQueryNode.cloneWithWhen(this.#b.queryNode,C({isMatched:!0},a,b))})}whenNotMatched(){return this.#w([])}whenNotMatchedAnd(...a){return this.#w(a)}whenNotMatchedAndRef(a,b,c){return this.#w([a,b,c],!0)}whenNotMatchedBySource(){return this.#w([],!1,!0)}whenNotMatchedBySourceAnd(...a){return this.#w(a,!1,!0)}whenNotMatchedBySourceAndRef(a,b,c){return this.#w([a,b,c],!0,!0)}returning(a){return new P({...this.#b,queryNode:w.QueryNode.cloneWithReturning(this.#b.queryNode,(0,u.parseSelectArg)(a))})}returningAll(a){return new P({...this.#b,queryNode:w.QueryNode.cloneWithReturning(this.#b.queryNode,(0,u.parseSelectAll)(a))})}output(a){return new P({...this.#b,queryNode:w.QueryNode.cloneWithOutput(this.#b.queryNode,(0,u.parseSelectArg)(a))})}outputAll(a){return new P({...this.#b,queryNode:w.QueryNode.cloneWithOutput(this.#b.queryNode,(0,u.parseSelectAll)(a))})}#w(a,b=!1,c=!1){let d={...this.#b,queryNode:v.MergeQueryNode.cloneWithWhen(this.#b.queryNode,C({isMatched:!1,bySource:c},a,b))};return new(c?Q:R)(d)}$call(a){return a(this)}$if(a,b){return a?b(this):new P({...this.#b})}toOperationNode(){return this.#b.executor.transformQuery(this.#b.queryNode,this.#b.queryId)}compile(){return this.#b.executor.compileQuery(this.toOperationNode(),this.#b.queryId)}async execute(){let a=this.compile(),b=await this.#b.executor.executeQuery(a),{adapter:c}=this.#b.executor,d=a.query;return d.returning&&c.supportsReturning||d.output&&c.supportsOutput?b.rows:[new M(b.numAffectedRows)]}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=N.NoResultError){let b=await this.executeTakeFirst();if(void 0===b)throw(0,N.isNoResultErrorConstructor)(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}}class Q{#b;constructor(a){this.#b=(0,t.freeze)(a)}thenDelete(){return new P({...this.#b,queryNode:v.MergeQueryNode.cloneWithThen(this.#b.queryNode,D("delete"))})}thenDoNothing(){return new P({...this.#b,queryNode:v.MergeQueryNode.cloneWithThen(this.#b.queryNode,D("do nothing"))})}thenUpdate(a){return new P({...this.#b,queryNode:v.MergeQueryNode.cloneWithThen(this.#b.queryNode,D(a(new k.UpdateQueryBuilder({queryId:this.#b.queryId,executor:L,queryNode:n.UpdateQueryNode.createWithoutTable()}))))})}thenUpdateSet(...a){return this.thenUpdate(b=>b.set(...a))}}class R{#b;constructor(a){this.#b=(0,t.freeze)(a)}thenDoNothing(){return new P({...this.#b,queryNode:v.MergeQueryNode.cloneWithThen(this.#b.queryNode,D("do nothing"))})}thenInsertValues(a){let[b,c]=(0,x.parseInsertExpression)(a);return new P({...this.#b,queryNode:v.MergeQueryNode.cloneWithThen(this.#b.queryNode,D(m.InsertQueryNode.cloneWith(m.InsertQueryNode.createWithoutInto(),{columns:b,values:c})))})}}class S{#b;constructor(a){this.#b=(0,t.freeze)(a)}selectFrom(a){return(0,h.createSelectQueryBuilder)({queryId:(0,r.createQueryId)(),executor:this.#b.executor,queryNode:e.SelectQueryNode.createFrom((0,o.parseTableExpressionOrList)(a),this.#b.withNode)})}selectNoFrom(a){return(0,h.createSelectQueryBuilder)({queryId:(0,r.createQueryId)(),executor:this.#b.executor,queryNode:e.SelectQueryNode.cloneWithSelections(e.SelectQueryNode.create(this.#b.withNode),(0,u.parseSelectArg)(a))})}insertInto(a){return new i.InsertQueryBuilder({queryId:(0,r.createQueryId)(),executor:this.#b.executor,queryNode:m.InsertQueryNode.create((0,o.parseTable)(a),this.#b.withNode)})}replaceInto(a){return new i.InsertQueryBuilder({queryId:(0,r.createQueryId)(),executor:this.#b.executor,queryNode:m.InsertQueryNode.create((0,o.parseTable)(a),this.#b.withNode,!0)})}deleteFrom(a){return new j.DeleteQueryBuilder({queryId:(0,r.createQueryId)(),executor:this.#b.executor,queryNode:l.DeleteQueryNode.create((0,o.parseTableExpressionOrList)(a),this.#b.withNode)})}updateTable(a){return new k.UpdateQueryBuilder({queryId:(0,r.createQueryId)(),executor:this.#b.executor,queryNode:n.UpdateQueryNode.create((0,o.parseTableExpressionOrList)(a),this.#b.withNode)})}mergeInto(a){return new O({queryId:(0,r.createQueryId)(),executor:this.#b.executor,queryNode:v.MergeQueryNode.create((0,o.parseAliasedTable)(a),this.#b.withNode)})}with(a,b){let c=(0,p.parseCommonTableExpression)(a,b);return new S({...this.#b,withNode:this.#b.withNode?q.WithNode.cloneWithExpression(this.#b.withNode,c):q.WithNode.create(c)})}withRecursive(a,b){let c=(0,p.parseCommonTableExpression)(a,b);return new S({...this.#b,withNode:this.#b.withNode?q.WithNode.cloneWithExpression(this.#b.withNode,c):q.WithNode.create(c,{recursive:!0})})}withPlugin(a){return new S({...this.#b,executor:this.#b.executor.withPlugin(a)})}withoutPlugins(){return new S({...this.#b,executor:this.#b.executor.withoutPlugins()})}withSchema(a){return new S({...this.#b,executor:this.#b.executor.withPluginAtFront(new s.WithSchemaPlugin(a))})}}function T(){return new S({executor:L})}function U(a,c){return new f.JoinBuilder({joinNode:b.JoinNode.create(a,(0,o.parseTableExpression)(c))})}function V(){return new g.OverBuilder({overNode:d.OverNode.create()})}function W(a,d){var e,f,g,h,i,j,k,l;if(3===d.length){return e=a,f=d[0],g=d[1],h=d[2],b.JoinNode.createWithOn(e,(0,o.parseTableExpression)(f),(0,c.parseReferentialBinaryOperation)(g,"=",h))}if(2===d.length){return i=a,j=d[0],(0,d[1])(U(i,j)).toOperationNode()}if(1===d.length){return k=a,l=d[0],b.JoinNode.create(k,(0,o.parseTableExpression)(l))}throw Error("not implemented")}let X=(0,t.freeze)({is:a=>"OffsetNode"===a.kind,create:a=>(0,t.freeze)({kind:"OffsetNode",offset:a})});a.s(["OffsetNode",0,X],29196),a.s(["parseGroupBy",()=>_],17999);let Y=(0,t.freeze)({is:a=>"GroupByItemNode"===a.kind,create:a=>(0,t.freeze)({kind:"GroupByItemNode",groupBy:a})});var Z=a.i(97806),$=a.i(89774);function _(a){return a=(0,t.isFunction)(a)?a((0,Z.expressionBuilder)()):a,(0,$.parseReferenceExpressionOrList)(a).map(Y.create)}},83005,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"SetOperationNode"===a.kind,create:(a,c,d)=>(0,b.freeze)({kind:"SetOperationNode",operator:a,expression:c,all:d})});a.s(["SetOperationNode",0,c])},94041,54378,37327,70925,73664,52817,a=>{"use strict";a.s(["createSelectQueryBuilder",()=>H],94041);var b=a.i(24054),c=a.i(67653),d=a.i(20584),e=a.i(66101),f=a.i(44891),g=a.i(89774),h=a.i(41595),i=a.i(39399),j=a.i(95398),k=a.i(33635),l=a.i(29196),m=a.i(52460),n=a.i(17999),o=a.i(49957),p=a.i(20860),q=a.i(97806),r=a.i(83005),s=a.i(4789);function t(a,b,c){return(0,m.isFunction)(b)&&(b=b((0,q.createExpressionBuilder)())),(0,m.isReadonlyArray)(b)||(b=[b]),b.map(b=>r.SetOperationNode.create(a,(0,s.parseExpression)(b),c))}var u=a.i(45228);a.s(["ExpressionWrapper",()=>z],54378);var v=a.i(51861),w=a.i(58758),x=a.i(25283),y=a.i(77804);class z{#x;constructor(a){this.#x=a}get expressionType(){}as(a){return new A(this,a)}or(...a){return new B(x.OrNode.create(this.#x,(0,u.parseValueBinaryOperationOrExpression)(a)))}and(...a){return new C(v.AndNode.create(this.#x,(0,u.parseValueBinaryOperationOrExpression)(a)))}$castTo(){return new z(this.#x)}$notNull(){return new z(this.#x)}toOperationNode(){return this.#x}}class A{#y;#z;constructor(a,b){this.#y=a,this.#z=b}get expression(){return this.#y}get alias(){return this.#z}toOperationNode(){return b.AliasNode.create(this.#y.toOperationNode(),(0,w.isOperationNodeSource)(this.#z)?this.#z.toOperationNode():p.IdentifierNode.create(this.#z))}}class B{#x;constructor(a){this.#x=a}get expressionType(){}as(a){return new A(this,a)}or(...a){return new B(x.OrNode.create(this.#x,(0,u.parseValueBinaryOperationOrExpression)(a)))}$castTo(){return new B(this.#x)}toOperationNode(){return y.ParensNode.create(this.#x)}}class C{#x;constructor(a){this.#x=a}get expressionType(){}as(a){return new A(this,a)}and(...a){return new C(v.AndNode.create(this.#x,(0,u.parseValueBinaryOperationOrExpression)(a)))}$castTo(){return new C(this.#x)}toOperationNode(){return y.ParensNode.create(this.#x)}}var D=a.i(9638),E=a.i(20033),F=a.i(78969);class G{#b;constructor(a){this.#b=(0,m.freeze)(a)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...a){return new G({...this.#b,queryNode:i.QueryNode.cloneWithWhere(this.#b.queryNode,(0,u.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new G({...this.#b,queryNode:i.QueryNode.cloneWithWhere(this.#b.queryNode,(0,u.parseReferentialBinaryOperation)(a,b,c))})}having(...a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithHaving(this.#b.queryNode,(0,u.parseValueBinaryOperationOrExpression)(a))})}havingRef(a,b,c){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithHaving(this.#b.queryNode,(0,u.parseReferentialBinaryOperation)(a,b,c))})}select(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithSelections(this.#b.queryNode,(0,f.parseSelectArg)(a))})}distinctOn(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithDistinctOn(this.#b.queryNode,(0,g.parseReferenceExpressionOrList)(a))})}modifyFront(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithFrontModifier(this.#b.queryNode,c.SelectModifierNode.createWithExpression(a.toOperationNode()))})}modifyEnd(a){return new G({...this.#b,queryNode:i.QueryNode.cloneWithEndModifier(this.#b.queryNode,c.SelectModifierNode.createWithExpression(a.toOperationNode()))})}distinct(){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithFrontModifier(this.#b.queryNode,c.SelectModifierNode.create("Distinct"))})}forUpdate(a){return new G({...this.#b,queryNode:i.QueryNode.cloneWithEndModifier(this.#b.queryNode,c.SelectModifierNode.create("ForUpdate",a?(0,m.asArray)(a).map(e.parseTable):void 0))})}forShare(a){return new G({...this.#b,queryNode:i.QueryNode.cloneWithEndModifier(this.#b.queryNode,c.SelectModifierNode.create("ForShare",a?(0,m.asArray)(a).map(e.parseTable):void 0))})}forKeyShare(a){return new G({...this.#b,queryNode:i.QueryNode.cloneWithEndModifier(this.#b.queryNode,c.SelectModifierNode.create("ForKeyShare",a?(0,m.asArray)(a).map(e.parseTable):void 0))})}forNoKeyUpdate(a){return new G({...this.#b,queryNode:i.QueryNode.cloneWithEndModifier(this.#b.queryNode,c.SelectModifierNode.create("ForNoKeyUpdate",a?(0,m.asArray)(a).map(e.parseTable):void 0))})}skipLocked(){return new G({...this.#b,queryNode:i.QueryNode.cloneWithEndModifier(this.#b.queryNode,c.SelectModifierNode.create("SkipLocked"))})}noWait(){return new G({...this.#b,queryNode:i.QueryNode.cloneWithEndModifier(this.#b.queryNode,c.SelectModifierNode.create("NoWait"))})}selectAll(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithSelections(this.#b.queryNode,(0,f.parseSelectAll)(a))})}innerJoin(...a){return this.#c("InnerJoin",a)}leftJoin(...a){return this.#c("LeftJoin",a)}rightJoin(...a){return this.#c("RightJoin",a)}fullJoin(...a){return this.#c("FullJoin",a)}crossJoin(...a){return this.#c("CrossJoin",a)}innerJoinLateral(...a){return this.#c("LateralInnerJoin",a)}leftJoinLateral(...a){return this.#c("LateralLeftJoin",a)}crossJoinLateral(...a){return this.#c("LateralCrossJoin",a)}crossApply(...a){return this.#c("CrossApply",a)}outerApply(...a){return this.#c("OuterApply",a)}#c(a,b){return new G({...this.#b,queryNode:i.QueryNode.cloneWithJoin(this.#b.queryNode,(0,d.parseJoin)(a,b))})}orderBy(...a){return new G({...this.#b,queryNode:i.QueryNode.cloneWithOrderByItems(this.#b.queryNode,(0,j.parseOrderBy)(a))})}groupBy(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithGroupByItems(this.#b.queryNode,(0,n.parseGroupBy)(a))})}limit(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithLimit(this.#b.queryNode,k.LimitNode.create((0,D.parseValueExpression)(a)))})}offset(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithOffset(this.#b.queryNode,l.OffsetNode.create((0,D.parseValueExpression)(a)))})}fetch(a,b="only"){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithFetch(this.#b.queryNode,function(a,b){var c;let d,e;if(!(0,m.isNumber)(a)&&!(0,m.isBigInt)(a))throw Error(`Invalid fetch row count: ${a}`);if("only"!==(c=b)&&"with ties"!==c)throw Error(`Invalid fetch modifier: ${b}`);return d=a,e=b,{kind:"FetchNode",rowCount:E.ValueNode.create(d),modifier:e}}(a,b))})}top(a,b){return new G({...this.#b,queryNode:i.QueryNode.cloneWithTop(this.#b.queryNode,(0,F.parseTop)(a,b))})}union(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithSetOperations(this.#b.queryNode,t("union",a,!1))})}unionAll(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithSetOperations(this.#b.queryNode,t("union",a,!0))})}intersect(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithSetOperations(this.#b.queryNode,t("intersect",a,!1))})}intersectAll(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithSetOperations(this.#b.queryNode,t("intersect",a,!0))})}except(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithSetOperations(this.#b.queryNode,t("except",a,!1))})}exceptAll(a){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithSetOperations(this.#b.queryNode,t("except",a,!0))})}as(a){return new I(this,a)}clearSelect(){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithoutSelections(this.#b.queryNode)})}clearWhere(){return new G({...this.#b,queryNode:i.QueryNode.cloneWithoutWhere(this.#b.queryNode)})}clearLimit(){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithoutLimit(this.#b.queryNode)})}clearOffset(){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithoutOffset(this.#b.queryNode)})}clearOrderBy(){return new G({...this.#b,queryNode:i.QueryNode.cloneWithoutOrderBy(this.#b.queryNode)})}clearGroupBy(){return new G({...this.#b,queryNode:h.SelectQueryNode.cloneWithoutGroupBy(this.#b.queryNode)})}$call(a){return a(this)}$if(a,b){return a?b(this):new G({...this.#b})}$castTo(){return new G(this.#b)}$narrowType(){return new G(this.#b)}$assertType(){return new G(this.#b)}$asTuple(){return new z(this.toOperationNode())}$asScalar(){return new z(this.toOperationNode())}withPlugin(a){return new G({...this.#b,executor:this.#b.executor.withPlugin(a)})}toOperationNode(){return this.#b.executor.transformQuery(this.#b.queryNode,this.#b.queryId)}compile(){return this.#b.executor.compileQuery(this.toOperationNode(),this.#b.queryId)}async execute(){let a=this.compile();return(await this.#b.executor.executeQuery(a)).rows}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=o.NoResultError){let b=await this.executeTakeFirst();if(void 0===b)throw(0,o.isNoResultErrorConstructor)(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}async *stream(a=100){let b=this.compile();for await(let c of this.#b.executor.stream(b,a))yield*c.rows}async explain(a,b){let c=new G({...this.#b,queryNode:i.QueryNode.cloneWithExplain(this.#b.queryNode,a,b)});return await c.execute()}}function H(a){return new G(a)}class I{#A;#z;constructor(a,b){this.#A=a,this.#z=b}get expression(){return this.#A}get alias(){return this.#z}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return b.AliasNode.create(this.#A.toOperationNode(),p.IdentifierNode.create(this.#z))}}a.s(["createFunctionModule",()=>Q],37327);var J=a.i(27466),K=a.i(78606);let L=(0,m.freeze)({is:a=>"AggregateFunctionNode"===a.kind,create:(a,b=[])=>(0,m.freeze)({kind:"AggregateFunctionNode",func:a,aggregated:b}),cloneWithDistinct:a=>(0,m.freeze)({...a,distinct:!0}),cloneWithOrderBy(a,b,c=!1){let d=c?"withinGroup":"orderBy";return(0,m.freeze)({...a,[d]:a[d]?K.OrderByNode.cloneWithItems(a[d],b):K.OrderByNode.create(b)})},cloneWithFilter:(a,b)=>(0,m.freeze)({...a,filter:a.filter?J.WhereNode.cloneWithOperation(a.filter,"And",b):J.WhereNode.create(b)}),cloneWithOrFilter:(a,b)=>(0,m.freeze)({...a,filter:a.filter?J.WhereNode.cloneWithOperation(a.filter,"Or",b):J.WhereNode.create(b)}),cloneWithOver:(a,b)=>(0,m.freeze)({...a,over:b})}),M=(0,m.freeze)({is:a=>"FunctionNode"===a.kind,create:(a,b)=>(0,m.freeze)({kind:"FunctionNode",func:a,arguments:b})});var N=a.i(82223);class O{#b;constructor(a){this.#b=(0,m.freeze)(a)}get expressionType(){}as(a){return new P(this,a)}distinct(){return new O({...this.#b,aggregateFunctionNode:L.cloneWithDistinct(this.#b.aggregateFunctionNode)})}orderBy(...a){return new O({...this.#b,aggregateFunctionNode:i.QueryNode.cloneWithOrderByItems(this.#b.aggregateFunctionNode,(0,j.parseOrderBy)(a))})}clearOrderBy(){return new O({...this.#b,aggregateFunctionNode:i.QueryNode.cloneWithoutOrderBy(this.#b.aggregateFunctionNode)})}withinGroupOrderBy(...a){return new O({...this.#b,aggregateFunctionNode:L.cloneWithOrderBy(this.#b.aggregateFunctionNode,(0,j.parseOrderBy)(a),!0)})}filterWhere(...a){return new O({...this.#b,aggregateFunctionNode:L.cloneWithFilter(this.#b.aggregateFunctionNode,(0,u.parseValueBinaryOperationOrExpression)(a))})}filterWhereRef(a,b,c){return new O({...this.#b,aggregateFunctionNode:L.cloneWithFilter(this.#b.aggregateFunctionNode,(0,u.parseReferentialBinaryOperation)(a,b,c))})}over(a){let b=(0,N.createOverBuilder)();return new O({...this.#b,aggregateFunctionNode:L.cloneWithOver(this.#b.aggregateFunctionNode,(a?a(b):b).toOperationNode())})}$call(a){return a(this)}$castTo(){return new O(this.#b)}$notNull(){return new O(this.#b)}toOperationNode(){return this.#b.aggregateFunctionNode}}class P{#B;#z;constructor(a,b){this.#B=a,this.#z=b}get expression(){return this.#B}get alias(){return this.#z}toOperationNode(){return b.AliasNode.create(this.#B.toOperationNode(),p.IdentifierNode.create(this.#z))}}function Q(){let a=(a,b)=>new z(M.create(a,(0,g.parseReferenceExpressionOrList)(b??[]))),b=(a,b)=>new O({aggregateFunctionNode:L.create(a,b?(0,g.parseReferenceExpressionOrList)(b):void 0)});return Object.assign(a,{agg:b,avg:a=>b("avg",[a]),coalesce:(...b)=>a("coalesce",b),count:a=>b("count",[a]),countAll:a=>new O({aggregateFunctionNode:L.create("count",(0,f.parseSelectAll)(a))}),max:a=>b("max",[a]),min:a=>b("min",[a]),sum:a=>b("sum",[a]),any:b=>a("any",[b]),jsonAgg:a=>new O({aggregateFunctionNode:L.create("json_agg",[(0,m.isString)(a)?(0,e.parseTable)(a):a.toOperationNode()])}),toJson:a=>new z(M.create("to_json",[(0,m.isString)(a)?(0,e.parseTable)(a):a.toOperationNode()]))})}a.s(["parseUnaryOperation",()=>T],70925);var R=a.i(13123);let S=(0,m.freeze)({is:a=>"UnaryOperationNode"===a.kind,create:(a,b)=>(0,m.freeze)({kind:"UnaryOperationNode",operator:a,operand:b})});function T(a,b){return S.create(R.OperatorNode.create(a),(0,g.parseReferenceExpression)(b))}a.s(["CaseBuilder",()=>W],52817);var U=a.i(99297);let V=(0,m.freeze)({is:a=>"CaseNode"===a.kind,create:a=>(0,m.freeze)({kind:"CaseNode",value:a}),cloneWithWhen:(a,b)=>(0,m.freeze)({...a,when:(0,m.freeze)(a.when?[...a.when,b]:[b])}),cloneWithThen:(a,b)=>(0,m.freeze)({...a,when:a.when?(0,m.freeze)([...a.when.slice(0,-1),U.WhenNode.cloneWithResult(a.when[a.when.length-1],b)]):void 0}),cloneWith:(a,b)=>(0,m.freeze)({...a,...b})});a.s(["CaseNode",0,V],73664);class W{#b;constructor(a){this.#b=(0,m.freeze)(a)}when(...a){return new X({...this.#b,node:V.cloneWithWhen(this.#b.node,U.WhenNode.create((0,u.parseValueBinaryOperationOrExpression)(a)))})}}class X{#b;constructor(a){this.#b=(0,m.freeze)(a)}then(a){return new Y({...this.#b,node:V.cloneWithThen(this.#b.node,(0,D.isSafeImmediateValue)(a)?(0,D.parseSafeImmediateValue)(a):(0,D.parseValueExpression)(a))})}}class Y{#b;constructor(a){this.#b=(0,m.freeze)(a)}when(...a){return new X({...this.#b,node:V.cloneWithWhen(this.#b.node,U.WhenNode.create((0,u.parseValueBinaryOperationOrExpression)(a)))})}else(a){return new Z({...this.#b,node:V.cloneWith(this.#b.node,{else:(0,D.isSafeImmediateValue)(a)?(0,D.parseSafeImmediateValue)(a):(0,D.parseValueExpression)(a)})})}end(){return new z(V.cloneWith(this.#b.node,{isStatement:!1}))}endCase(){return new z(V.cloneWith(this.#b.node,{isStatement:!0}))}}class Z{#b;constructor(a){this.#b=(0,m.freeze)(a)}end(){return new z(V.cloneWith(this.#b.node,{isStatement:!1}))}endCase(){return new z(V.cloneWith(this.#b.node,{isStatement:!0}))}}},35106,a=>{"use strict";var b=a.i(52460);let c=(0,b.freeze)({is:a=>"JSONPathLegNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"JSONPathLegNode",type:a,value:c})});a.s(["JSONPathLegNode",0,c])},4789,9582,97806,a=>{"use strict";a.s(["isExpressionOrFactory",()=>Q,"parseAliasedExpression",()=>P,"parseExpression",()=>O],4789);var b=a.i(635),c=a.i(58758);a.s(["createExpressionBuilder",()=>M,"expressionBuilder",()=>N],97806);var d=a.i(94041),e=a.i(41595),f=a.i(66101),g=a.i(85545),h=a.i(13344),i=a.i(37327),j=a.i(89774),k=a.i(45228),l=a.i(77804),m=a.i(54378),n=a.i(13123),o=a.i(70925),p=a.i(9638),q=a.i(36478),r=a.i(52817),s=a.i(73664),t=a.i(52460),u=a.i(24054),v=a.i(20860),w=a.i(85134),x=a.i(35106),y=a.i(52738),z=a.i(91362),A=a.i(20033);class B{#x;constructor(a){this.#x=a}at(a){return this.#C("ArrayLocation",a)}key(a){return this.#C("Member",a)}#C(a,b){return new C(z.JSONReferenceNode.is(this.#x)?z.JSONReferenceNode.cloneWithTraversal(this.#x,y.JSONPathNode.is(this.#x.traversal)?y.JSONPathNode.cloneWithLeg(this.#x.traversal,x.JSONPathLegNode.create(a,b)):w.JSONOperatorChainNode.cloneWithValue(this.#x.traversal,A.ValueNode.createImmediate(b))):y.JSONPathNode.cloneWithLeg(this.#x,x.JSONPathLegNode.create(a,b)))}}class C extends B{#x;constructor(a){super(a),this.#x=a}get expressionType(){}as(a){return new D(this,a)}$castTo(){return new C(this.#x)}$notNull(){return new C(this.#x)}toOperationNode(){return this.#x}}class D{#D;#z;constructor(a,b){this.#D=a,this.#z=b}get expression(){return this.#D}get alias(){return this.#z}toOperationNode(){return u.AliasNode.create(this.#D.toOperationNode(),(0,c.isOperationNodeSource)(this.#z)?this.#z.toOperationNode():v.IdentifierNode.create(this.#z))}}var E=a.i(44447),F=a.i(51861);let G=(0,t.freeze)({is:a=>"TupleNode"===a.kind,create:a=>(0,t.freeze)({kind:"TupleNode",values:(0,t.freeze)(a)})}),H=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob","varbinary","int4range","int4multirange","int8range","int8multirange","numrange","nummultirange","tsrange","tsmultirange","tstzrange","tstzmultirange","daterange","datemultirange"],I=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timetz\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/,/^varbinary\(\d+\)$/],J=(0,t.freeze)({is:a=>"DataTypeNode"===a.kind,create:a=>(0,t.freeze)({kind:"DataTypeNode",dataType:a})});function K(a){if((0,c.isOperationNodeSource)(a))return a.toOperationNode();if(H.includes(a)||I.some(b=>b.test(a)))return J.create(a);throw Error(`invalid column data type ${JSON.stringify(a)}`)}a.s(["parseDataTypeExpression",()=>K],9582);let L=(0,t.freeze)({is:a=>"CastNode"===a.kind,create:(a,b)=>(0,t.freeze)({kind:"CastNode",expression:a,dataType:b})});function M(a=q.NOOP_QUERY_EXECUTOR){function b(a,b){return new m.ExpressionWrapper((0,o.parseUnaryOperation)(a,b))}let c=Object.assign(function(a,b,c){return new m.ExpressionWrapper((0,k.parseValueBinaryOperation)(a,b,c))},{fn:void 0,eb:void 0,selectFrom:b=>(0,d.createSelectQueryBuilder)({queryId:(0,h.createQueryId)(),executor:a,queryNode:e.SelectQueryNode.createFrom((0,f.parseTableExpressionOrList)(b))}),case:a=>new r.CaseBuilder({node:s.CaseNode.create((0,t.isUndefined)(a)?void 0:(0,j.parseReferenceExpression)(a))}),ref:(a,b)=>(0,t.isUndefined)(b)?new m.ExpressionWrapper((0,j.parseStringReference)(a)):new B((0,j.parseJSONReference)(a,b)),jsonPath:()=>new B(y.JSONPathNode.create()),table:a=>new m.ExpressionWrapper((0,f.parseTable)(a)),val:a=>new m.ExpressionWrapper((0,p.parseValueExpression)(a)),refTuple:(...a)=>new m.ExpressionWrapper(G.create(a.map(j.parseReferenceExpression))),tuple:(...a)=>new m.ExpressionWrapper(G.create(a.map(p.parseValueExpression))),lit:a=>new m.ExpressionWrapper((0,p.parseSafeImmediateValue)(a)),unary:b,not:a=>b("not",a),exists:a=>b("exists",a),neg:a=>b("-",a),between:(a,b,c)=>new m.ExpressionWrapper(E.BinaryOperationNode.create((0,j.parseReferenceExpression)(a),n.OperatorNode.create("between"),F.AndNode.create((0,p.parseValueExpression)(b),(0,p.parseValueExpression)(c)))),betweenSymmetric:(a,b,c)=>new m.ExpressionWrapper(E.BinaryOperationNode.create((0,j.parseReferenceExpression)(a),n.OperatorNode.create("between symmetric"),F.AndNode.create((0,p.parseValueExpression)(b),(0,p.parseValueExpression)(c)))),and:a=>new m.ExpressionWrapper((0,t.isReadonlyArray)(a)?(0,k.parseFilterList)(a,"and"):(0,k.parseFilterObject)(a,"and")),or:a=>new m.ExpressionWrapper((0,t.isReadonlyArray)(a)?(0,k.parseFilterList)(a,"or"):(0,k.parseFilterObject)(a,"or")),parens(...a){let b=(0,k.parseValueBinaryOperationOrExpression)(a);return new m.ExpressionWrapper(l.ParensNode.is(b)?b:l.ParensNode.create(b))},cast:(a,b)=>new m.ExpressionWrapper(L.create((0,j.parseReferenceExpression)(a),K(b))),withSchema:b=>M(a.withPluginAtFront(new g.WithSchemaPlugin(b)))});return c.fn=(0,i.createFunctionModule)(),c.eb=c,c}function N(a){return M()}function O(a){if((0,c.isOperationNodeSource)(a))return a.toOperationNode();if((0,t.isFunction)(a))return a(M()).toOperationNode();throw Error(`invalid expression: ${JSON.stringify(a)}`)}function P(a){if((0,c.isOperationNodeSource)(a))return a.toOperationNode();if((0,t.isFunction)(a))return a(M()).toOperationNode();throw Error(`invalid aliased expression: ${JSON.stringify(a)}`)}function Q(a){return(0,b.isExpression)(a)||(0,b.isAliasedExpression)(a)||(0,t.isFunction)(a)}},66101,42769,a=>{"use strict";a.s(["parseAliasedTable",()=>m,"parseTable",()=>n,"parseTableExpression",()=>l,"parseTableExpressionOrList",()=>k],66101);var b=a.i(52460),c=a.i(24054),d=a.i(6770),e=a.i(4789),f=a.i(20860);a.s(["DynamicTableBuilder",()=>h,"isAliasedDynamicTableBuilder",()=>j],42769);var g=a.i(58758);class h{#E;get table(){return this.#E}constructor(a){this.#E=a}as(a){return new i(this.#E,a)}}class i{#E;#z;get table(){return this.#E}get alias(){return this.#z}constructor(a,b){this.#E=a,this.#z=b}toOperationNode(){return c.AliasNode.create(n(this.#E),f.IdentifierNode.create(this.#z))}}function j(a){return(0,b.isObject)(a)&&(0,g.isOperationNodeSource)(a)&&(0,b.isString)(a.table)&&(0,b.isString)(a.alias)}function k(a){return(0,b.isReadonlyArray)(a)?a.map(a=>l(a)):[l(a)]}function l(a){return(0,b.isString)(a)?m(a):j(a)?a.toOperationNode():(0,e.parseAliasedExpression)(a)}function m(a){let b=" as ";if(!a.includes(b))return n(a);{let[d,e]=a.split(b).map(o);return c.AliasNode.create(n(d),f.IdentifierNode.create(e))}}function n(a){if(!a.includes("."))return d.TableNode.create(a);{let[b,c]=a.split(".").map(o);return d.TableNode.createWithSchema(b,c)}}function o(a){return a.trim()}},12741,a=>{"use strict";var b=a.i(52460),c=a.i(8896);let d=(0,b.freeze)({is:a=>"CreateViewNode"===a.kind,create:a=>(0,b.freeze)({kind:"CreateViewNode",name:c.SchemableIdentifierNode.create(a)}),cloneWith:(a,c)=>(0,b.freeze)({...a,...c})});a.s(["CreateViewNode",0,d])},95401,a=>{"use strict";class b{transformQuery(a){return a.node}async transformResult(a){return a.result}}a.s(["NoopPlugin",()=>b])},54132,a=>{"use strict";a.i(95401),a.i(85545),(0,a.i(52460).freeze)({__noMigrations__:!0}),a.s(["DEFAULT_MIGRATION_LOCK_TABLE",0,"kysely_migration_lock","DEFAULT_MIGRATION_TABLE",0,"kysely_migration"])},19560,a=>{"use strict";var b=a.i(20860),c=a.i(58758),d=a.i(93807),e=a.i(20033),f=a.i(89774),g=a.i(66101),h=a.i(9638),i=a.i(13344),j=a.i(24054),k=a.i(52460),l=a.i(36478);class m{#b;constructor(a){this.#b=(0,k.freeze)(a)}get expressionType(){}get isRawBuilder(){return!0}as(a){return new o(this,a)}$castTo(){return new m({...this.#b})}$notNull(){return new m(this.#b)}withPlugin(a){return new m({...this.#b,plugins:void 0!==this.#b.plugins?(0,k.freeze)([...this.#b.plugins,a]):(0,k.freeze)([a])})}toOperationNode(){return this.#F(this.#G())}compile(a){return this.#H(this.#G(a))}async execute(a){let b=this.#G(a);return b.executeQuery(this.#H(b))}#G(a){let b=void 0!==a?a.getExecutor():l.NOOP_QUERY_EXECUTOR;return void 0!==this.#b.plugins?b.withPlugins(this.#b.plugins):b}#F(a){return a.transformQuery(this.#b.rawNode,this.#b.queryId)}#H(a){return a.compileQuery(this.#F(a),this.#b.queryId)}}function n(a){return new m(a)}class o{#I;#z;constructor(a,b){this.#I=a,this.#z=b}get expression(){return this.#I}get alias(){return this.#z}get rawBuilder(){return this.#I}toOperationNode(){return j.AliasNode.create(this.#I.toOperationNode(),(0,c.isOperationNodeSource)(this.#z)?this.#z.toOperationNode():b.IdentifierNode.create(this.#z))}}let p=Object.assign((a,...b)=>n({queryId:(0,i.createQueryId)(),rawNode:d.RawNode.create(a,b?.map(q)??[])}),{ref:a=>n({queryId:(0,i.createQueryId)(),rawNode:d.RawNode.createWithChild((0,f.parseStringReference)(a))}),val:a=>n({queryId:(0,i.createQueryId)(),rawNode:d.RawNode.createWithChild((0,h.parseValueExpression)(a))}),value(a){return this.val(a)},table:a=>n({queryId:(0,i.createQueryId)(),rawNode:d.RawNode.createWithChild((0,g.parseTable)(a))}),id(...a){let c=Array(a.length+1).fill(".");return c[0]="",c[c.length-1]="",n({queryId:(0,i.createQueryId)(),rawNode:d.RawNode.create(c,a.map(b.IdentifierNode.create))})},lit:a=>n({queryId:(0,i.createQueryId)(),rawNode:d.RawNode.createWithChild(e.ValueNode.createImmediate(a))}),literal(a){return this.lit(a)},raw:a=>n({queryId:(0,i.createQueryId)(),rawNode:d.RawNode.createWithSql(a)}),join(a,b=p`, `){let c=Array(Math.max(2*a.length-1,0)),e=b.toOperationNode();for(let b=0;b<a.length;++b)c[2*b]=q(a[b]),b!==a.length-1&&(c[2*b+1]=e);return n({queryId:(0,i.createQueryId)(),rawNode:d.RawNode.createWithChildren(c)})}});function q(a){return(0,c.isOperationNodeSource)(a)?a.toOperationNode():(0,h.parseValueExpression)(a)}a.s(["sql",0,p],19560)},4781,a=>{"use strict";var b=a.i(93807),c=a.i(52460),d=a.i(13344);let e=(0,c.freeze)({raw:(a,e=[])=>(0,c.freeze)({sql:a,query:b.RawNode.createWithSql(a),parameters:(0,c.freeze)(e),queryId:(0,d.createQueryId)()})});a.s(["CompiledQuery",0,e])},77973,a=>{"use strict";var b=a.i(52460);class c{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#J=(0,b.freeze)({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),RenameConstraintNode:this.visitRenameConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),RefreshMaterializedViewNode:this.visitRefreshMaterializedView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this),OutputNode:this.visitOutput.bind(this),OrActionNode:this.visitOrAction.bind(this),CollateNode:this.visitCollate.bind(this)});visitNode=a=>{this.nodeStack.push(a),this.#J[a.kind](a),this.nodeStack.pop()}}a.s(["OperationNodeVisitor",()=>c])},76452,a=>{"use strict";var b=a.i(19945),c=a.i(19910),d=a.i(77973),e=a.i(13123),f=a.i(77804),g=a.i(93807),h=a.i(52460),i=a.i(12741),j=a.i(83005),k=a.i(99297),l=a.i(28283);let m=/'/g;class n extends d.OperationNodeVisitor{#K="";#L=[];get numParameters(){return this.#L.length}compileQuery(a,b){return this.#K="",this.#L=[],this.nodeStack.splice(0,this.nodeStack.length),this.visitNode(a),(0,h.freeze)({query:a,queryId:b,sql:this.getSql(),parameters:[...this.#L]})}getSql(){return this.#K}visitSelectQuery(a){let d=void 0!==this.parentNode&&!f.ParensNode.is(this.parentNode)&&!c.InsertQueryNode.is(this.parentNode)&&!b.CreateTableNode.is(this.parentNode)&&!i.CreateViewNode.is(this.parentNode)&&!j.SetOperationNode.is(this.parentNode);void 0===this.parentNode&&a.explain&&(this.visitNode(a.explain),this.append(" ")),d&&this.append("("),a.with&&(this.visitNode(a.with),this.append(" ")),this.append("select"),a.distinctOn&&(this.append(" "),this.compileDistinctOn(a.distinctOn)),a.frontModifiers?.length&&(this.append(" "),this.compileList(a.frontModifiers," ")),a.top&&(this.append(" "),this.visitNode(a.top)),a.selections&&(this.append(" "),this.compileList(a.selections)),a.from&&(this.append(" "),this.visitNode(a.from)),a.joins&&(this.append(" "),this.compileList(a.joins," ")),a.where&&(this.append(" "),this.visitNode(a.where)),a.groupBy&&(this.append(" "),this.visitNode(a.groupBy)),a.having&&(this.append(" "),this.visitNode(a.having)),a.setOperations&&(this.append(" "),this.compileList(a.setOperations," ")),a.orderBy&&(this.append(" "),this.visitNode(a.orderBy)),a.limit&&(this.append(" "),this.visitNode(a.limit)),a.offset&&(this.append(" "),this.visitNode(a.offset)),a.fetch&&(this.append(" "),this.visitNode(a.fetch)),a.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...a.endModifiers])," ")),d&&this.append(")")}visitFrom(a){this.append("from "),this.compileList(a.froms)}visitSelection(a){this.visitNode(a.selection)}visitColumn(a){this.visitNode(a.column)}compileDistinctOn(a){this.append("distinct on ("),this.compileList(a),this.append(")")}compileList(a,b=", "){let c=a.length-1;for(let d=0;d<=c;d++)this.visitNode(a[d]),d<c&&this.append(b)}visitWhere(a){this.append("where "),this.visitNode(a.where)}visitHaving(a){this.append("having "),this.visitNode(a.having)}visitInsertQuery(a){let b=void 0!==this.parentNode&&!f.ParensNode.is(this.parentNode)&&!g.RawNode.is(this.parentNode)&&!k.WhenNode.is(this.parentNode);void 0===this.parentNode&&a.explain&&(this.visitNode(a.explain),this.append(" ")),b&&this.append("("),a.with&&(this.visitNode(a.with),this.append(" ")),this.append(a.replace?"replace":"insert"),a.ignore&&((0,l.logOnce)("`InsertQueryNode.ignore` is deprecated. Use `InsertQueryNode.orAction` instead."),this.append(" ignore")),a.orAction&&(this.append(" "),this.visitNode(a.orAction)),a.top&&(this.append(" "),this.visitNode(a.top)),a.into&&(this.append(" into "),this.visitNode(a.into)),a.columns&&(this.append(" ("),this.compileList(a.columns),this.append(")")),a.output&&(this.append(" "),this.visitNode(a.output)),a.values&&(this.append(" "),this.visitNode(a.values)),a.defaultValues&&(this.append(" "),this.append("default values")),a.onConflict&&(this.append(" "),this.visitNode(a.onConflict)),a.onDuplicateKey&&(this.append(" "),this.visitNode(a.onDuplicateKey)),a.returning&&(this.append(" "),this.visitNode(a.returning)),b&&this.append(")"),a.endModifiers?.length&&(this.append(" "),this.compileList(a.endModifiers," "))}visitValues(a){this.append("values "),this.compileList(a.values)}visitDeleteQuery(a){let b=void 0!==this.parentNode&&!f.ParensNode.is(this.parentNode)&&!g.RawNode.is(this.parentNode);void 0===this.parentNode&&a.explain&&(this.visitNode(a.explain),this.append(" ")),b&&this.append("("),a.with&&(this.visitNode(a.with),this.append(" ")),this.append("delete "),a.top&&(this.visitNode(a.top),this.append(" ")),this.visitNode(a.from),a.output&&(this.append(" "),this.visitNode(a.output)),a.using&&(this.append(" "),this.visitNode(a.using)),a.joins&&(this.append(" "),this.compileList(a.joins," ")),a.where&&(this.append(" "),this.visitNode(a.where)),a.orderBy&&(this.append(" "),this.visitNode(a.orderBy)),a.limit&&(this.append(" "),this.visitNode(a.limit)),a.returning&&(this.append(" "),this.visitNode(a.returning)),b&&this.append(")"),a.endModifiers?.length&&(this.append(" "),this.compileList(a.endModifiers," "))}visitReturning(a){this.append("returning "),this.compileList(a.selections)}visitAlias(a){this.visitNode(a.node),this.append(" as "),this.visitNode(a.alias)}visitReference(a){a.table&&(this.visitNode(a.table),this.append(".")),this.visitNode(a.column)}visitSelectAll(a){this.append("*")}visitIdentifier(a){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(a),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(a){if(!(0,h.isString)(a.name))throw Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(a.name))}visitAnd(a){this.visitNode(a.left),this.append(" and "),this.visitNode(a.right)}visitOr(a){this.visitNode(a.left),this.append(" or "),this.visitNode(a.right)}visitValue(a){a.immediate?this.appendImmediateValue(a.value):this.appendValue(a.value)}visitValueList(a){this.append("("),this.compileList(a.values),this.append(")")}visitTuple(a){this.append("("),this.compileList(a.values),this.append(")")}visitPrimitiveValueList(a){this.append("(");let{values:b}=a;for(let a=0;a<b.length;++a)this.appendValue(b[a]),a!==b.length-1&&this.append(", ");this.append(")")}visitParens(a){this.append("("),this.visitNode(a.node),this.append(")")}visitJoin(a){this.append(q[a.joinType]),this.append(" "),this.visitNode(a.table),a.on&&(this.append(" "),this.visitNode(a.on))}visitOn(a){this.append("on "),this.visitNode(a.on)}visitRaw(a){let{sqlFragments:b,parameters:c}=a;for(let a=0;a<b.length;++a)this.append(b[a]),c.length>a&&this.visitNode(c[a])}visitOperator(a){this.append(a.operator)}visitTable(a){this.visitNode(a.table)}visitSchemableIdentifier(a){a.schema&&(this.visitNode(a.schema),this.append(".")),this.visitNode(a.identifier)}visitCreateTable(a){this.append("create "),a.frontModifiers&&a.frontModifiers.length>0&&(this.compileList(a.frontModifiers," "),this.append(" ")),a.temporary&&this.append("temporary "),this.append("table "),a.ifNotExists&&this.append("if not exists "),this.visitNode(a.table),a.selectQuery?(this.append(" as "),this.visitNode(a.selectQuery)):(this.append(" ("),this.compileList([...a.columns,...a.constraints??[]]),this.append(")"),a.onCommit&&(this.append(" on commit "),this.append(a.onCommit)),a.endModifiers&&a.endModifiers.length>0&&(this.append(" "),this.compileList(a.endModifiers," ")))}visitColumnDefinition(a){a.ifNotExists&&this.append("if not exists "),this.visitNode(a.column),this.append(" "),this.visitNode(a.dataType),a.unsigned&&this.append(" unsigned"),a.frontModifiers&&a.frontModifiers.length>0&&(this.append(" "),this.compileList(a.frontModifiers," ")),a.generated&&(this.append(" "),this.visitNode(a.generated)),a.identity&&this.append(" identity"),a.defaultTo&&(this.append(" "),this.visitNode(a.defaultTo)),a.notNull&&this.append(" not null"),a.unique&&this.append(" unique"),a.nullsNotDistinct&&this.append(" nulls not distinct"),a.primaryKey&&this.append(" primary key"),a.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),a.references&&(this.append(" "),this.visitNode(a.references)),a.check&&(this.append(" "),this.visitNode(a.check)),a.endModifiers&&a.endModifiers.length>0&&(this.append(" "),this.compileList(a.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(a){this.append("references "),this.visitNode(a.table),this.append(" ("),this.compileList(a.columns),this.append(")"),a.onDelete&&(this.append(" on delete "),this.append(a.onDelete)),a.onUpdate&&(this.append(" on update "),this.append(a.onUpdate))}visitDropTable(a){this.append("drop table "),a.ifExists&&this.append("if exists "),this.visitNode(a.table),a.cascade&&this.append(" cascade")}visitDataType(a){this.append(a.dataType)}visitOrderBy(a){this.append("order by "),this.compileList(a.items)}visitOrderByItem(a){this.visitNode(a.orderBy),a.collation&&(this.append(" "),this.visitNode(a.collation)),a.direction&&(this.append(" "),this.visitNode(a.direction)),a.nulls&&(this.append(" nulls "),this.append(a.nulls))}visitGroupBy(a){this.append("group by "),this.compileList(a.items)}visitGroupByItem(a){this.visitNode(a.groupBy)}visitUpdateQuery(a){let b=void 0!==this.parentNode&&!f.ParensNode.is(this.parentNode)&&!g.RawNode.is(this.parentNode)&&!k.WhenNode.is(this.parentNode);if(void 0===this.parentNode&&a.explain&&(this.visitNode(a.explain),this.append(" ")),b&&this.append("("),a.with&&(this.visitNode(a.with),this.append(" ")),this.append("update "),a.top&&(this.visitNode(a.top),this.append(" ")),a.table&&(this.visitNode(a.table),this.append(" ")),this.append("set "),a.updates&&this.compileList(a.updates),a.output&&(this.append(" "),this.visitNode(a.output)),a.from&&(this.append(" "),this.visitNode(a.from)),a.joins){if(!a.from)throw Error("Joins in an update query are only supported as a part of a PostgreSQL 'update set from join' query. If you want to create a MySQL 'update join set' query, see https://kysely.dev/docs/examples/update/my-sql-joins");this.append(" "),this.compileList(a.joins," ")}a.where&&(this.append(" "),this.visitNode(a.where)),a.orderBy&&(this.append(" "),this.visitNode(a.orderBy)),a.limit&&(this.append(" "),this.visitNode(a.limit)),a.returning&&(this.append(" "),this.visitNode(a.returning)),b&&this.append(")"),a.endModifiers?.length&&(this.append(" "),this.compileList(a.endModifiers," "))}visitColumnUpdate(a){this.visitNode(a.column),this.append(" = "),this.visitNode(a.value)}visitLimit(a){this.append("limit "),this.visitNode(a.limit)}visitOffset(a){this.append("offset "),this.visitNode(a.offset)}visitOnConflict(a){this.append("on conflict"),a.columns?(this.append(" ("),this.compileList(a.columns),this.append(")")):a.constraint?(this.append(" on constraint "),this.visitNode(a.constraint)):a.indexExpression&&(this.append(" ("),this.visitNode(a.indexExpression),this.append(")")),a.indexWhere&&(this.append(" "),this.visitNode(a.indexWhere)),!0===a.doNothing?this.append(" do nothing"):a.updates&&(this.append(" do update set "),this.compileList(a.updates),a.updateWhere&&(this.append(" "),this.visitNode(a.updateWhere)))}visitOnDuplicateKey(a){this.append("on duplicate key update "),this.compileList(a.updates)}visitCreateIndex(a){this.append("create "),a.unique&&this.append("unique "),this.append("index "),a.ifNotExists&&this.append("if not exists "),this.visitNode(a.name),a.table&&(this.append(" on "),this.visitNode(a.table)),a.using&&(this.append(" using "),this.visitNode(a.using)),a.columns&&(this.append(" ("),this.compileList(a.columns),this.append(")")),a.nullsNotDistinct&&this.append(" nulls not distinct"),a.where&&(this.append(" "),this.visitNode(a.where))}visitDropIndex(a){this.append("drop index "),a.ifExists&&this.append("if exists "),this.visitNode(a.name),a.table&&(this.append(" on "),this.visitNode(a.table)),a.cascade&&this.append(" cascade")}visitCreateSchema(a){this.append("create schema "),a.ifNotExists&&this.append("if not exists "),this.visitNode(a.schema)}visitDropSchema(a){this.append("drop schema "),a.ifExists&&this.append("if exists "),this.visitNode(a.schema),a.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(a){a.name&&(this.append("constraint "),this.visitNode(a.name),this.append(" ")),this.append("primary key ("),this.compileList(a.columns),this.append(")"),this.buildDeferrable(a)}buildDeferrable(a){void 0!==a.deferrable&&(a.deferrable?this.append(" deferrable"):this.append(" not deferrable")),void 0!==a.initiallyDeferred&&(a.initiallyDeferred?this.append(" initially deferred"):this.append(" initially immediate"))}visitUniqueConstraint(a){a.name&&(this.append("constraint "),this.visitNode(a.name),this.append(" ")),this.append("unique"),a.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(a.columns),this.append(")"),this.buildDeferrable(a)}visitCheckConstraint(a){a.name&&(this.append("constraint "),this.visitNode(a.name),this.append(" ")),this.append("check ("),this.visitNode(a.expression),this.append(")")}visitForeignKeyConstraint(a){a.name&&(this.append("constraint "),this.visitNode(a.name),this.append(" ")),this.append("foreign key ("),this.compileList(a.columns),this.append(") "),this.visitNode(a.references),a.onDelete&&(this.append(" on delete "),this.append(a.onDelete)),a.onUpdate&&(this.append(" on update "),this.append(a.onUpdate)),this.buildDeferrable(a)}visitList(a){this.compileList(a.items)}visitWith(a){this.append("with "),a.recursive&&this.append("recursive "),this.compileList(a.expressions)}visitCommonTableExpression(a){this.visitNode(a.name),this.append(" as "),(0,h.isBoolean)(a.materialized)&&(a.materialized||this.append("not "),this.append("materialized ")),this.visitNode(a.expression)}visitCommonTableExpressionName(a){this.visitNode(a.table),a.columns&&(this.append("("),this.compileList(a.columns),this.append(")"))}visitAlterTable(a){this.append("alter table "),this.visitNode(a.table),this.append(" "),a.renameTo&&(this.append("rename to "),this.visitNode(a.renameTo)),a.setSchema&&(this.append("set schema "),this.visitNode(a.setSchema)),a.addConstraint&&this.visitNode(a.addConstraint),a.dropConstraint&&this.visitNode(a.dropConstraint),a.renameConstraint&&this.visitNode(a.renameConstraint),a.columnAlterations&&this.compileColumnAlterations(a.columnAlterations),a.addIndex&&this.visitNode(a.addIndex),a.dropIndex&&this.visitNode(a.dropIndex)}visitAddColumn(a){this.append("add column "),this.visitNode(a.column)}visitRenameColumn(a){this.append("rename column "),this.visitNode(a.column),this.append(" to "),this.visitNode(a.renameTo)}visitDropColumn(a){this.append("drop column "),this.visitNode(a.column)}visitAlterColumn(a){this.append("alter column "),this.visitNode(a.column),this.append(" "),a.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(a.dataType),a.dataTypeExpression&&(this.append("using "),this.visitNode(a.dataTypeExpression))),a.setDefault&&(this.append("set default "),this.visitNode(a.setDefault)),a.dropDefault&&this.append("drop default"),a.setNotNull&&this.append("set not null"),a.dropNotNull&&this.append("drop not null")}visitModifyColumn(a){this.append("modify column "),this.visitNode(a.column)}visitAddConstraint(a){this.append("add "),this.visitNode(a.constraint)}visitDropConstraint(a){this.append("drop constraint "),a.ifExists&&this.append("if exists "),this.visitNode(a.constraintName),"cascade"===a.modifier?this.append(" cascade"):"restrict"===a.modifier&&this.append(" restrict")}visitRenameConstraint(a){this.append("rename constraint "),this.visitNode(a.oldName),this.append(" to "),this.visitNode(a.newName)}visitSetOperation(a){this.append(a.operator),this.append(" "),a.all&&this.append("all "),this.visitNode(a.expression)}visitCreateView(a){this.append("create "),a.orReplace&&this.append("or replace "),a.materialized&&this.append("materialized "),a.temporary&&this.append("temporary "),this.append("view "),a.ifNotExists&&this.append("if not exists "),this.visitNode(a.name),this.append(" "),a.columns&&(this.append("("),this.compileList(a.columns),this.append(") ")),a.as&&(this.append("as "),this.visitNode(a.as))}visitRefreshMaterializedView(a){this.append("refresh materialized view "),a.concurrently&&this.append("concurrently "),this.visitNode(a.name),a.withNoData?this.append(" with no data"):this.append(" with data")}visitDropView(a){this.append("drop "),a.materialized&&this.append("materialized "),this.append("view "),a.ifExists&&this.append("if exists "),this.visitNode(a.name),a.cascade&&this.append(" cascade")}visitGenerated(a){this.append("generated "),a.always&&this.append("always "),a.byDefault&&this.append("by default "),this.append("as "),a.identity&&this.append("identity"),a.expression&&(this.append("("),this.visitNode(a.expression),this.append(")")),a.stored&&this.append(" stored")}visitDefaultValue(a){this.append("default "),this.visitNode(a.defaultValue)}visitSelectModifier(a){a.rawModifier?this.visitNode(a.rawModifier):this.append(o[a.modifier]),a.of&&(this.append(" of "),this.compileList(a.of,", "))}visitCreateType(a){this.append("create type "),this.visitNode(a.name),a.enum&&(this.append(" as enum "),this.visitNode(a.enum))}visitDropType(a){this.append("drop type "),a.ifExists&&this.append("if exists "),this.visitNode(a.name)}visitExplain(a){this.append("explain"),(a.options||a.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),a.options&&(this.visitNode(a.options),a.format&&this.append(this.getExplainOptionsDelimiter())),a.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(a.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(a){this.append("default")}visitAggregateFunction(a){this.append(a.func),this.append("("),a.distinct&&this.append("distinct "),this.compileList(a.aggregated),a.orderBy&&(this.append(" "),this.visitNode(a.orderBy)),this.append(")"),a.withinGroup&&(this.append(" within group ("),this.visitNode(a.withinGroup),this.append(")")),a.filter&&(this.append(" filter("),this.visitNode(a.filter),this.append(")")),a.over&&(this.append(" "),this.visitNode(a.over))}visitOver(a){this.append("over("),a.partitionBy&&(this.visitNode(a.partitionBy),a.orderBy&&this.append(" ")),a.orderBy&&this.visitNode(a.orderBy),this.append(")")}visitPartitionBy(a){this.append("partition by "),this.compileList(a.items)}visitPartitionByItem(a){this.visitNode(a.partitionBy)}visitBinaryOperation(a){this.visitNode(a.leftOperand),this.append(" "),this.visitNode(a.operator),this.append(" "),this.visitNode(a.rightOperand)}visitUnaryOperation(a){this.visitNode(a.operator),this.isMinusOperator(a.operator)||this.append(" "),this.visitNode(a.operand)}isMinusOperator(a){return e.OperatorNode.is(a)&&"-"===a.operator}visitUsing(a){this.append("using "),this.compileList(a.tables)}visitFunction(a){this.append(a.func),this.append("("),this.compileList(a.arguments),this.append(")")}visitCase(a){this.append("case"),a.value&&(this.append(" "),this.visitNode(a.value)),a.when&&(this.append(" "),this.compileList(a.when," ")),a.else&&(this.append(" else "),this.visitNode(a.else)),this.append(" end"),a.isStatement&&this.append(" case")}visitWhen(a){this.append("when "),this.visitNode(a.condition),a.result&&(this.append(" then "),this.visitNode(a.result))}visitJSONReference(a){this.visitNode(a.reference),this.visitNode(a.traversal)}visitJSONPath(a){for(let b of(a.inOperator&&this.visitNode(a.inOperator),this.append("'$"),a.pathLegs))this.visitNode(b);this.append("'")}visitJSONPathLeg(a){let b="ArrayLocation"===a.type;this.append(b?"[":"."),this.append(String(a.value)),b&&this.append("]")}visitJSONOperatorChain(a){for(let b=0,c=a.values.length;b<c;b++)b===c-1?this.visitNode(a.operator):this.append("->"),this.visitNode(a.values[b])}visitMergeQuery(a){a.with&&(this.visitNode(a.with),this.append(" ")),this.append("merge "),a.top&&(this.visitNode(a.top),this.append(" ")),this.append("into "),this.visitNode(a.into),a.using&&(this.append(" "),this.visitNode(a.using)),a.whens&&(this.append(" "),this.compileList(a.whens," ")),a.returning&&(this.append(" "),this.visitNode(a.returning)),a.output&&(this.append(" "),this.visitNode(a.output)),a.endModifiers?.length&&(this.append(" "),this.compileList(a.endModifiers," "))}visitMatched(a){a.not&&this.append("not "),this.append("matched"),a.bySource&&this.append(" by source")}visitAddIndex(a){this.append("add "),a.unique&&this.append("unique "),this.append("index "),this.visitNode(a.name),a.columns&&(this.append(" ("),this.compileList(a.columns),this.append(")")),a.using&&(this.append(" using "),this.visitNode(a.using))}visitCast(a){this.append("cast("),this.visitNode(a.expression),this.append(" as "),this.visitNode(a.dataType),this.append(")")}visitFetch(a){this.append("fetch next "),this.visitNode(a.rowCount),this.append(` rows ${a.modifier}`)}visitOutput(a){this.append("output "),this.compileList(a.selections)}visitTop(a){this.append(`top(${a.expression})`),a.modifiers&&this.append(` ${a.modifiers}`)}visitOrAction(a){this.append(a.action)}visitCollate(a){this.append("collate "),this.visitNode(a.collation)}append(a){this.#K+=a}appendValue(a){this.addParameter(a),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(a){let b=this.getLeftIdentifierWrapper(),c=this.getRightIdentifierWrapper(),d="";for(let e of a)d+=e,e===b?d+=b:e===c&&(d+=c);return d}sanitizeStringLiteral(a){return a.replace(m,"''")}addParameter(a){this.#L.push(a)}appendImmediateValue(a){if((0,h.isString)(a))this.appendStringLiteral(a);else if((0,h.isNumber)(a)||(0,h.isBoolean)(a)||(0,h.isBigInt)(a))this.append(a.toString());else if((0,h.isNull)(a))this.append("null");else if((0,h.isDate)(a))this.appendImmediateValue(a.toISOString());else throw Error(`invalid immediate value ${a}`)}appendStringLiteral(a){this.append("'"),this.append(this.sanitizeStringLiteral(a)),this.append("'")}sortSelectModifiers(a){return a.sort((a,b)=>a.modifier&&b.modifier?p[a.modifier]-p[b.modifier]:1),(0,h.freeze)(a)}compileColumnAlterations(a){this.compileList(a)}announcesNewColumnDataType(){return!0}}let o=(0,h.freeze)({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),p=(0,h.freeze)({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),q=(0,h.freeze)({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",CrossJoin:"cross join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",LateralCrossJoin:"cross join lateral",OuterApply:"outer apply",CrossApply:"cross apply",Using:"using"});a.s(["DefaultQueryCompiler",()=>n])}];

//# sourceMappingURL=node_modules_kysely_dist_esm_a193a516._.js.map